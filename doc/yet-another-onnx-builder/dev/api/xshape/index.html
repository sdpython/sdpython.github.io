<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="yobx.xshape.expressions_torch" href="expressions_torch.html"><link rel="prev" title="yobx.torch.transformers.models.configs" href="../torch/transformers/models/configs.html">
        <link rel="prefetch" href="../../_static/logo.svg" as="image">

    <link rel="shortcut icon" href="../../_static/logo.svg"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>yobx.xshape - yet-another-onnx-builder 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">yet-another-onnx-builder 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">yet-another-onnx-builder 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cmds/index.html">Command Lines</a><input aria-label="Toggle navigation of Command Lines" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cmds/agg.html">-m yobx agg … aggregate statistics from benchmark runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmds/dot.html">-m yobx dot … convert an onnx model into dot format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmds/find.html">-m yobx find … find nodes consuming or producing a result</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmds/partition.html">-m yobx partition … move layer nodes in local functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmds/print.html">-m yobx print … print an onnx model on standard output</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../design/index.html">Elements of Design</a><input aria-label="Toggle navigation of Elements of Design" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../design/cube.html">Statistics on Logs Through a Cube of Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/evaluator.html">Evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/flatten.html">Flattening Functionalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/helpers.html">Interesting Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/shape.html">ShapeBuilder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../auto_examples/index.html">Gallery of Examples</a><input aria-label="Toggle navigation of Gallery of Examples" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_evaluator_comparison.html">Comparing the three evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_computed_shapes.html">Computed Shapes: Add + Concat + Reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_shape_expressions.html">Expressions in Shape Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_extended_reference_evaluator.html">ExtendedReferenceEvaluator: running models with contrib operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_mini_onnx_builder.html">MiniOnnxBuilder: serialize tensors to an ONNX model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_dot_graph.html">ONNX Graph Visualization with to_dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_flattening.html">Registering a custom class as a pytree node</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../helpers/index.html">yobx.helpers</a><input aria-label="Toggle navigation of yobx.helpers" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../helpers/cube_helper.html">yobx.helpers.cube_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../helpers/dot_helper.html">yobx.helpers.dot_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../helpers/helper.html">yobx.helpers.helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../helpers/mini_onnx_builder.html">yobx.helpers.mini_onnx_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../helpers/onnx_helper.html">yobx.helpers.onnx_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/index.html">yobx.reference</a><input aria-label="Toggle navigation of yobx.reference" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/evaluator.html">yobx.reference.evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/onnxruntime_evaluator.html">yobx.reference.onnxruntime_evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/torch_evaluator.html">yobx.reference.torch_evaluator</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../torch/index.html">yobx.torch</a><input aria-label="Toggle navigation of yobx.torch" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../torch/flatten_helper.html">yobx.torch.flatten_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/input_observer.html">yobx.torch.input_observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/torch_helper.html">yobx.torch.torch_helper</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../torch/transformers/index.html">yobx.torch.transformers</a><input aria-label="Toggle navigation of yobx.torch.transformers" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../torch/transformers/cache_helper.html">yobx.torch.transformers.cache_helper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/transformers/flatten_class.html">yobx.torch.transformers.flatten_class</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../torch/transformers/models/index.html">yobx.torch.transformers.models</a><input aria-label="Toggle navigation of yobx.torch.transformers.models" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../torch/transformers/models/configs.html">yobx.torch.transformers.models.configs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">yobx.xshape</a><input aria-label="Toggle navigation of yobx.xshape" checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="expressions_torch.html">yobx.xshape.expressions_torch</a></li>
<li class="toctree-l3"><a class="reference internal" href="evaluate_expressions.html">yobx.xshape.evaluate_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="rename_expressions.html">yobx.xshape.rename_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="simplify_expressions.html">yobx.xshape.simplify_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="_builder_runtime.html">yobx.xshape._builder_runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="_inference_runtime.html">yobx.xshape._inference_runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="_shape_runtime.html">yobx.xshape._shape_runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="_shape_helper.html">yobx.xshape._shape_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="shape_builder.html">yobx.xshape.shape_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="shape_builder_impl.html">yobx.xshape.shape_builder_impl</a></li>
<li class="toctree-l3"><a class="reference internal" href="shape_type_compute.html">yobx.xshape.shape_type_compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="type_inference.html">yobx.xshape.type_inference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../index_stats.html">Versions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/xadupre/yet-another-onnx-builder/blob/main/docs/api/xshape/index.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/xadupre/yet-another-onnx-builder/edit/main/docs/api/xshape/index.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="yobx-xshape">
<h1>yobx.xshape<a class="headerlink" href="#yobx-xshape" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="expressions_torch.html">yobx.xshape.expressions_torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluate_expressions.html">yobx.xshape.evaluate_expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rename_expressions.html">yobx.xshape.rename_expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="simplify_expressions.html">yobx.xshape.simplify_expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="_builder_runtime.html">yobx.xshape._builder_runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="_inference_runtime.html">yobx.xshape._inference_runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="_shape_runtime.html">yobx.xshape._shape_runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="_shape_helper.html">yobx.xshape._shape_helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="shape_builder.html">yobx.xshape.shape_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="shape_builder_impl.html">yobx.xshape.shape_builder_impl</a></li>
<li class="toctree-l1"><a class="reference internal" href="shape_type_compute.html">yobx.xshape.shape_type_compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="type_inference.html">yobx.xshape.type_inference</a></li>
</ul>
</div>
<section id="basicshapebuilder">
<h2>BasicShapeBuilder<a class="headerlink" href="#basicshapebuilder" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">yobx.xshape.</span></span><span class="sig-name descname"><span class="pre">BasicShapeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L30"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Implements a basic class doing shape inference in an ONNX model.</p>
<p>A couple of environment variables can be set to help debugging any issue.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXSTOPSHAPE=&lt;name&gt;</span></code>: raises an exception when <code class="docutils literal notranslate"><span class="pre">name</span></code> receives a shape.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXSTOPTYPE=&lt;name&gt;</span></code>: raises an exception when <code class="docutils literal notranslate"><span class="pre">name</span></code> receives a type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXDYNDIM=&lt;name&gt;</span></code>: raises an exception when dimension <code class="docutils literal notranslate"><span class="pre">name</span></code> is used</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXCST=1</span></code>: shows which constant is requested</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXSHAPECOMPUTE=1</span></code>: raises an exception when a shape is missing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ONNXSTOPVALUESHAPE=&lt;name&gt;</span></code>: more information in function dealing with shapes</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.add_dynamic_dimension">
<span class="sig-name descname"><span class="pre">add_dynamic_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.add_dynamic_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.add_dynamic_dimension" title="Link to this definition">¶</a></dt>
<dd><p>Adds a dynamic dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.get_constant">
<span class="sig-name descname"><span class="pre">get_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L87"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.get_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.get_constant" title="Link to this definition">¶</a></dt>
<dd><p>The method returns the constant <em>name</em>. It is a tensor (numpy array)
or a NodeProto which must be evaluated.
If <em>computed_value</em> is True, the NodeProto is evaluated with the
ReferenceEvaluator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – constant name</p></li>
<li><p><strong>exc</strong> – raise an exception if anything is impossible to do</p></li>
<li><p><strong>computed_value</strong> – compute the value if not a constant</p></li>
<li><p><strong>as_shape</strong> – returns a tuple for a shape</p></li>
<li><p><strong>multiple_outputs</strong> – allow multiple outputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.get_debug_msg">
<span class="sig-name descname"><span class="pre">get_debug_msg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L562"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.get_debug_msg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.get_debug_msg" title="Link to this definition">¶</a></dt>
<dd><p>Returns a string providing as much information as possible
to help the developer understand why a conversion failed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>limit</strong> – limit the string if the model is big</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>many pieces of information about the on going conversion</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.get_rank">
<span class="sig-name descname"><span class="pre">get_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L416"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.get_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.get_rank" title="Link to this definition">¶</a></dt>
<dd><p>Returns the rank of a result.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.get_shape">
<span class="sig-name descname"><span class="pre">get_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymInt" title="(in PyTorch v2.10)"><span class="pre">torch.SymInt</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymFloat" title="(in PyTorch v2.10)"><span class="pre">torch.SymFloat</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L467"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.get_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.get_shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of a result.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.get_type">
<span class="sig-name descname"><span class="pre">get_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L359"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.get_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.get_type" title="Link to this definition">¶</a></dt>
<dd><p>Returns the type of a result.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.has_rank">
<span class="sig-name descname"><span class="pre">has_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L411"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.has_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.has_rank" title="Link to this definition">¶</a></dt>
<dd><p>Tells if a result has a rank.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.has_shape">
<span class="sig-name descname"><span class="pre">has_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L453"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.has_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.has_shape" title="Link to this definition">¶</a></dt>
<dd><p>Tells if a result has a shape.
If <em>full</em> is True, it returns True if the shape exists and if it
is a static shape with all dimensions &gt; 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.has_type">
<span class="sig-name descname"><span class="pre">has_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L351"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.has_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.has_type" title="Link to this definition">¶</a></dt>
<dd><p>Tells if a result has a type. This should be always true.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.input_names">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">input_names</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.input_names" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of input names of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.is_constant">
<span class="sig-name descname"><span class="pre">is_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L83"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.is_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.is_constant" title="Link to this definition">¶</a></dt>
<dd><p>Tells if a result is a constant.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.output_names">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">output_names</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.output_names" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of output names of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.register_constraint_dimension">
<span class="sig-name descname"><span class="pre">register_constraint_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L677"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.register_constraint_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.register_constraint_dimension" title="Link to this definition">¶</a></dt>
<dd><p>Registers a constraint on a dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_name</strong> – dimension name</p></li>
<li><p><strong>value</strong> – value to register</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.register_dynamic_objects_from_dim">
<span class="sig-name descname"><span class="pre">register_dynamic_objects_from_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L476"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.register_dynamic_objects_from_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.register_dynamic_objects_from_dim" title="Link to this definition">¶</a></dt>
<dd><p>Registers all the dynamic objects required in a dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.run_model">
<span class="sig-name descname"><span class="pre">run_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="(in ONNX v1.21.0)"><span class="pre">ModelProto</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.GraphProto" title="(in ONNX v1.21.0)"><span class="pre">GraphProto</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.FunctionProto" title="(in ONNX v1.21.0)"><span class="pre">FunctionProto</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L647"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.run_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.run_model" title="Link to this definition">¶</a></dt>
<dd><p>Runs inference over a model or a graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.run_node">
<span class="sig-name descname"><span class="pre">run_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L612"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.run_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.run_node" title="Link to this definition">¶</a></dt>
<dd><p>Uses shapes availables in the ShapeBuilder to infer the output shapes
and types.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.run_value_info">
<span class="sig-name descname"><span class="pre">run_value_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.ValueInfoProto" title="(in ONNX v1.21.0)"><span class="pre">ValueInfoProto</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L635"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.run_value_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.run_value_info" title="Link to this definition">¶</a></dt>
<dd><p>Fills ShapeBuilder with information coming from an input or output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_constant">
<span class="sig-name descname"><span class="pre">set_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.TensorProto" title="(in ONNX v1.21.0)"><span class="pre">TensorProto</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L204"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_constant" title="Link to this definition">¶</a></dt>
<dd><p>Tells if a result is a constant.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_device">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><span class="pre">torch.dtype</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_device" title="Link to this definition">¶</a></dt>
<dd><p>Sets the shape for a result. It is exists, it checks the new shape
is equal to the existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name</p></li>
<li><p><strong>device</strong> – an integer or a torch device then converted into an integer</p></li>
<li><p><strong>exc</strong> – raises an exception</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_rank">
<span class="sig-name descname"><span class="pre">set_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L426"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_rank" title="Link to this definition">¶</a></dt>
<dd><p>Sets the rank for a result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – result name</p></li>
<li><p><strong>value</strong> – rank</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if there is no rank conflict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_shape">
<span class="sig-name descname"><span class="pre">set_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymInt" title="(in PyTorch v2.10)"><span class="pre">torch.SymInt</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymFloat" title="(in PyTorch v2.10)"><span class="pre">torch.SymFloat</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L503"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_shape" title="Link to this definition">¶</a></dt>
<dd><p>Sets the shape for a result. It is exists, it checks the new shape
is equal to the existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – result name</p></li>
<li><p><strong>shape</strong> – shape</p></li>
<li><p><strong>exc</strong> – raise an exception if inconsistency</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_type">
<span class="sig-name descname"><span class="pre">set_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L368"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_type" title="Link to this definition">¶</a></dt>
<dd><p>Sets the shape for a result. It is exists, it checks the new shape
is equal to the existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name</p></li>
<li><p><strong>dtype</strong> – element type (an integer, ONNX), 0 (unknown is a possible value)</p></li>
<li><p><strong>exc</strong> – raises an exception</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>returns True if there is no type conflict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.set_value_shape">
<span class="sig-name descname"><span class="pre">set_value_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.set_value_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.set_value_shape" title="Link to this definition">¶</a></dt>
<dd><p>Sets the value for a shape result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name</p></li>
<li><p><strong>value</strong> – it cannot be empty</p></li>
<li><p><strong>equal_to</strong> – if specified, the value is also equal to this value</p></li>
</ul>
</dd>
</dl>
<p>A value can be a string (for an unknown shape, a tuple for a shape,
an integer for a single scalar.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.unique_dimension_name">
<span class="sig-name descname"><span class="pre">unique_dimension_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L494"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.unique_dimension_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.unique_dimension_name" title="Link to this definition">¶</a></dt>
<dd><p>Returns a unique dimension name based on <em>base</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.BasicShapeBuilder.value_as_shape">
<span class="sig-name descname"><span class="pre">value_as_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder_impl.py#L547"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder_impl.html#BasicShapeBuilder.value_as_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.BasicShapeBuilder.value_as_shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the value of a result if it is a shape.</p>
</dd></dl>

</dd></dl>

</section>
<section id="shapebuilder">
<h2>ShapeBuilder<a class="headerlink" href="#shapebuilder" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">yobx.xshape.</span></span><span class="sig-name descname"><span class="pre">ShapeBuilder</span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L22"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder" title="Link to this definition">¶</a></dt>
<dd><p>API for a class computing shapes in an ONNX model.</p>
<p>The main implementation is <a class="reference internal" href="#yobx.xshape.BasicShapeBuilder" title="yobx.xshape.shape_builder_impl.BasicShapeBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicShapeBuilder</span></code></a>.
It walks through all the nodes of an ONNX model and infers output shapes
and types based on the input shapes, using symbolic expressions when the
exact integer values are not known.</p>
<p><strong>Symbolic expressions</strong> — When a dimension cannot be determined as a plain
integer (e.g. because it depends on a dynamic input dimension), it is stored
as a Python-arithmetic string expression built from the input dimension names.
For instance, concatenating tensors of shapes <code class="docutils literal notranslate"><span class="pre">(&quot;batch&quot;,</span> <span class="pre">&quot;seq1&quot;)</span></code> and
<code class="docutils literal notranslate"><span class="pre">(&quot;batch&quot;,</span> <span class="pre">&quot;seq2&quot;)</span></code> along axis 1 yields output shape
<code class="docutils literal notranslate"><span class="pre">(&quot;batch&quot;,</span> <span class="pre">&quot;seq1+seq2&quot;)</span></code>.  The supported operators inside a symbolic
expression are <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">//</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span></code> and <code class="docutils literal notranslate"><span class="pre">^</span></code>
(where <code class="docutils literal notranslate"><span class="pre">^</span></code> means <code class="docutils literal notranslate"><span class="pre">max</span></code>).  Expressions are automatically simplified
by <a class="reference internal" href="simplify_expressions.html#yobx.xshape.simplify_expressions.simplify_expression" title="yobx.xshape.simplify_expressions.simplify_expression"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify_expression</span></code></a> before being stored,
so <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">+</span> <span class="pre">f</span> <span class="pre">-</span> <span class="pre">f</span></code> becomes <code class="docutils literal notranslate"><span class="pre">d</span></code> and <code class="docutils literal notranslate"><span class="pre">2*seq//2</span></code> becomes <code class="docutils literal notranslate"><span class="pre">seq</span></code>.
Once concrete values are available they can be resolved with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate_shape()</span></code> or <a class="reference internal" href="evaluate_expressions.html#yobx.xshape.evaluate_expressions.evaluate_expression" title="yobx.xshape.evaluate_expressions.evaluate_expression"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate_expression</span></code></a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">onnx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">onnx.helper</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">oh</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">yobx.xshape</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicShapeBuilder</span>

<span class="n">TFLOAT</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span>

<span class="c1"># Build a small model: Z = Concat(X, Y, axis=1)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">oh</span><span class="o">.</span><span class="n">make_model</span><span class="p">(</span>
    <span class="n">oh</span><span class="o">.</span><span class="n">make_graph</span><span class="p">(</span>
        <span class="p">[</span><span class="n">oh</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span><span class="s2">&quot;Concat&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)],</span>
        <span class="s2">&quot;graph&quot;</span><span class="p">,</span>
        <span class="p">[</span>
            <span class="n">oh</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">TFLOAT</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;seq1&quot;</span><span class="p">]),</span>
            <span class="n">oh</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">TFLOAT</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;seq2&quot;</span><span class="p">]),</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="n">oh</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="n">TFLOAT</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])],</span>
    <span class="p">),</span>
    <span class="n">opset_imports</span><span class="o">=</span><span class="p">[</span><span class="n">oh</span><span class="o">.</span><span class="n">make_opsetid</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)],</span>
    <span class="n">ir_version</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">BasicShapeBuilder</span><span class="p">()</span>
<span class="n">builder</span><span class="o">.</span><span class="n">run_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;input names :&quot;</span><span class="p">,</span> <span class="n">builder</span><span class="o">.</span><span class="n">input_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;output names:&quot;</span><span class="p">,</span> <span class="n">builder</span><span class="o">.</span><span class="n">output_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape of Z  :&quot;</span><span class="p">,</span> <span class="n">builder</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type of Z   :&quot;</span><span class="p">,</span> <span class="n">builder</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="nb">input</span> <span class="n">names</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]</span>
    <span class="n">output</span> <span class="n">names</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">shape</span> <span class="n">of</span> <span class="n">Z</span>  <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;seq1+seq2&#39;</span><span class="p">)</span>
    <span class="nb">type</span> <span class="n">of</span> <span class="n">Z</span>   <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.compare_with_true_inputs">
<span class="sig-name descname"><span class="pre">compare_with_true_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L378"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.compare_with_true_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.compare_with_true_inputs" title="Link to this definition">¶</a></dt>
<dd><p>Compares the shape of the outputs with what the output shapes would return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – inputs</p></li>
<li><p><strong>outputs</strong> – outputs</p></li>
<li><p><strong>exc</strong> – raises an exception when a discrepancy is met</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of expression, expected value, computed value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">att_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.AttributeProto" title="(in ONNX v1.21.0)"><span class="pre">AttributeProto</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L191"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_attribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_attribute" title="Link to this definition">¶</a></dt>
<dd><p>Returns an attribute for a node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_attribute_with_default">
<span class="sig-name descname"><span class="pre">get_attribute_with_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L204"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_attribute_with_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_attribute_with_default" title="Link to this definition">¶</a></dt>
<dd><p>Returns an attribute or its default value if missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – node</p></li>
<li><p><strong>name</strong> – attribute name</p></li>
<li><p><strong>default_value</strong> – default value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_attributes_with_default">
<span class="sig-name descname"><span class="pre">get_attributes_with_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">default_values</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L234"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_attributes_with_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_attributes_with_default" title="Link to this definition">¶</a></dt>
<dd><p>Returns int or float attributes. If missing, the default value is returned
if it is not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – node</p></li>
<li><p><strong>default_values</strong> – default values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_rank">
<span class="sig-name descname"><span class="pre">get_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L133"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_rank" title="Link to this definition">¶</a></dt>
<dd><p>Returns the rank (number of dimensions) of result <em>name</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – result name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rank as an integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_shape">
<span class="sig-name descname"><span class="pre">get_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymInt" title="(in PyTorch v2.10)"><span class="pre">torch.SymInt</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymFloat" title="(in PyTorch v2.10)"><span class="pre">torch.SymFloat</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of result <em>name</em> as a tuple.
Each dimension is either an integer or a string (symbolic dimension).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – result name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>shape as a tuple of integers and/or strings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.get_type">
<span class="sig-name descname"><span class="pre">get_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L113"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.get_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.get_type" title="Link to this definition">¶</a></dt>
<dd><p>Returns the element type of result <em>name</em> as an ONNX integer
(e.g. <code class="docutils literal notranslate"><span class="pre">onnx.TensorProto.FLOAT</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – result name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>element type as an integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.input_names">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">input_names</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#yobx.xshape.ShapeBuilder.input_names" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of input names of the model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.output_names">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">output_names</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#yobx.xshape.ShapeBuilder.output_names" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of output names of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.pretty_node">
<span class="sig-name descname"><span class="pre">pretty_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/classes.html#onnx.NodeProto" title="(in ONNX v1.21.0)"><span class="pre">NodeProto</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L269"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.pretty_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.pretty_node" title="Link to this definition">¶</a></dt>
<dd><p>Pretty rendering for a node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – node to render</p></li>
<li><p><strong>limit</strong> – to show type and shapes after the limit</p></li>
<li><p><strong>short</strong> – do not display shape information on the left</p></li>
<li><p><strong>shape</strong> – show shape information below</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.register_constraint_dimension">
<span class="sig-name descname"><span class="pre">register_constraint_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.register_constraint_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.register_constraint_dimension" title="Link to this definition">¶</a></dt>
<dd><p>Registers a constraint associating a symbolic dimension name with a value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_name</strong> – symbolic dimension name (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;batch&quot;</span></code>)</p></li>
<li><p><strong>value</strong> – the value or set of values to associate with that dimension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.set_rank">
<span class="sig-name descname"><span class="pre">set_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L142"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.set_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.set_rank" title="Link to this definition">¶</a></dt>
<dd><p>Sets the rank (number of dimensions) for result <em>name</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – result name</p></li>
<li><p><strong>rank</strong> – rank as an integer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.set_shape">
<span class="sig-name descname"><span class="pre">set_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymInt" title="(in PyTorch v2.10)"><span class="pre">torch.SymInt</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/torch.html#torch.SymFloat" title="(in PyTorch v2.10)"><span class="pre">torch.SymFloat</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.set_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.set_shape" title="Link to this definition">¶</a></dt>
<dd><p>Sets the shape for result <em>name</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – result name</p></li>
<li><p><strong>shape</strong> – tuple of integers and/or strings (symbolic dimensions)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.set_type">
<span class="sig-name descname"><span class="pre">set_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">itype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.set_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.set_type" title="Link to this definition">¶</a></dt>
<dd><p>Sets the element type for result <em>name</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – result name</p></li>
<li><p><strong>itype</strong> – element type as an ONNX integer
(e.g. <code class="docutils literal notranslate"><span class="pre">onnx.TensorProto.FLOAT</span> <span class="pre">==</span> <span class="pre">1</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="yobx.xshape.ShapeBuilder.update_shapes">
<span class="sig-name descname"><span class="pre">update_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="(in ONNX v1.21.0)"><span class="pre">ModelProto</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/xadupre/yet-another-onnx-builder/blob/2b0e105/onnx_diagnostic/../../yet-another-onnx-builder/yobx/xshape/shape_builder.py#L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/yobx/xshape/shape_builder.html#ShapeBuilder.update_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yobx.xshape.ShapeBuilder.update_shapes" title="Link to this definition">¶</a></dt>
<dd><p>Updates model shapes with the value stored inside this graph.</p>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="expressions_torch.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">yobx.xshape.expressions_torch</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../torch/transformers/models/configs.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">yobx.torch.transformers.models.configs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">yobx.xshape</a><ul>
<li><a class="reference internal" href="#basicshapebuilder">BasicShapeBuilder</a><ul>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder</span></code></a><ul>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.add_dynamic_dimension"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.add_dynamic_dimension()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.get_constant"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.get_constant()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.get_debug_msg"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.get_debug_msg()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.get_rank"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.get_rank()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.get_shape"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.get_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.get_type"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.get_type()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.has_rank"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.has_rank()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.has_shape"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.has_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.has_type"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.has_type()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.input_names"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.input_names</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.is_constant"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.is_constant()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.output_names"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.output_names</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.register_constraint_dimension"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.register_constraint_dimension()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.register_dynamic_objects_from_dim"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.register_dynamic_objects_from_dim()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.run_model"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.run_model()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.run_node"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.run_node()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.run_value_info"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.run_value_info()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_constant"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_constant()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_device"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_device()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_rank"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_rank()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_shape"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_type"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_type()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.set_value_shape"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.set_value_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.unique_dimension_name"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.unique_dimension_name()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.BasicShapeBuilder.value_as_shape"><code class="docutils literal notranslate"><span class="pre">BasicShapeBuilder.value_as_shape()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#shapebuilder">ShapeBuilder</a><ul>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder</span></code></a><ul>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.compare_with_true_inputs"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.compare_with_true_inputs()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_attribute"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_attribute()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_attribute_with_default"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_attribute_with_default()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_attributes_with_default"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_attributes_with_default()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_rank"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_rank()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_shape"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.get_type"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.get_type()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.input_names"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.input_names</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.output_names"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.output_names</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.pretty_node"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.pretty_node()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.register_constraint_dimension"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.register_constraint_dimension()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.set_rank"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.set_rank()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.set_shape"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.set_shape()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.set_type"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.set_type()</span></code></a></li>
<li><a class="reference internal" href="#yobx.xshape.ShapeBuilder.update_shapes"><code class="docutils literal notranslate"><span class="pre">ShapeBuilder.update_shapes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>