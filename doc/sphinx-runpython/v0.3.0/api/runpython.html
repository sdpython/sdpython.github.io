<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="tools" href="tools.html" /><link rel="prev" title="quote" href="quote.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>runpython - sphinx-runpython 0.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">sphinx-runpython 0.3.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">sphinx-runpython 0.3.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="blocdefs.html">blocref, exref, mathdef</a></li>
<li class="toctree-l2"><a class="reference internal" href="blocdefs_list.html">blocreflist, exreflist, mathdeflist</a></li>
<li class="toctree-l2"><a class="reference internal" href="collapse.html">collapse</a></li>
<li class="toctree-l2"><a class="reference internal" href="docassert.html">docassert</a></li>
<li class="toctree-l2"><a class="reference internal" href="epkg.html">epkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="gdot.html">gdot</a></li>
<li class="toctree-l2"><a class="reference internal" href="quote.html">quote</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">runpython</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst_builder.html">sphinx_rst_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="process_rst.html">helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="import_object_helper.html">import_object_helper</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">Example gallery</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Example gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_profiling.html">Empty example</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="runpython">
<h1>runpython<a class="headerlink" href="#runpython" title="Permalink to this heading">#</a></h1>
<p>This directive executes snippets of code inserted and add
the output to the documentation, as plain text or even RST format.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<p>In <em>conf.py</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span>
    <span class="s1">&#39;sphinx_runpython.runpython&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Documentation means many examples which needs to be updated when a change
happen unless the documentation runs the example itself and update its output.
That’s what this directive does. It adds as raw text whatever comes out
throught the standard output.</p>
<p>One example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">showcode</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">os</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>Which gives:</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">0</span> <span class="o">.</span><span class="n">ruff_cache</span>
    <span class="mi">1</span> <span class="o">.</span><span class="n">gitignore</span>
    <span class="mi">2</span> <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span>
    <span class="mi">3</span> <span class="o">.</span><span class="n">git</span>
    <span class="mi">4</span> <span class="n">dist</span>
    <span class="mi">5</span> <span class="o">.</span><span class="n">github</span>
    <span class="mi">6</span> <span class="n">MANIFEST</span><span class="o">.</span><span class="ow">in</span>
    <span class="mi">7</span> <span class="n">_unittests</span>
    <span class="mi">8</span> <span class="n">setup</span><span class="o">.</span><span class="n">cfg</span>
    <span class="mi">9</span> <span class="n">azure</span><span class="o">-</span><span class="n">pipelines</span><span class="o">.</span><span class="n">yml</span>
    <span class="mi">10</span> <span class="n">requirements</span><span class="o">-</span><span class="n">dev</span><span class="o">.</span><span class="n">txt</span>
    <span class="mi">11</span> <span class="n">CHANGELOGS</span><span class="o">.</span><span class="n">rst</span>
    <span class="mi">12</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
    <span class="mi">13</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
    <span class="mi">14</span> <span class="n">sphinx_runpython</span>
    <span class="mi">15</span> <span class="n">_doc</span>
    <span class="mi">16</span> <span class="n">LICENSE</span><span class="o">.</span><span class="n">txt</span>
    <span class="mi">17</span> <span class="n">README</span><span class="o">.</span><span class="n">rst</span>
</pre></div>
</div>
<p>The output can also be compiled as RST format and the code can be hidden.
It is useful if the documentation is a copy/paste of some external process
or function. This function can be directly called from the documentation.
The output must be converted into RST format. It is then added to the
documentation. It is quite useful to display the version of some installed
modules.</p>
<aside class="sidebar">
<p class="sidebar-title">runpython and rst</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">rst</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">pandas</span><span class="o">,</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">sphinx</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mod</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sphinx</span><span class="p">,</span> <span class="n">pandas</span><span class="p">,</span> <span class="n">numpy</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;* version of *</span><span class="si">{0}</span><span class="s2">*: *</span><span class="si">{1}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s2">&quot;__version__&quot;</span>
        <span class="p">))</span>
</pre></div>
</div>
</aside>
<ul class="simple">
<li><p>file <strong>0</strong>: <em>.ruff_cache</em></p></li>
<li><p>file <strong>1</strong>: <em>.gitignore</em></p></li>
<li><p>file <strong>2</strong>: <em>pyproject.toml</em></p></li>
<li><p>file <strong>3</strong>: <em>.git</em></p></li>
<li><p>file <strong>4</strong>: <em>dist</em></p></li>
<li><p>file <strong>5</strong>: <em>.github</em></p></li>
<li><p>file <strong>6</strong>: <em>MANIFEST.in</em></p></li>
<li><p>file <strong>7</strong>: <em>_unittests</em></p></li>
<li><p>file <strong>8</strong>: <em>setup.cfg</em></p></li>
<li><p>file <strong>9</strong>: <em>azure-pipelines.yml</em></p></li>
<li><p>file <strong>10</strong>: <em>requirements-dev.txt</em></p></li>
<li><p>file <strong>11</strong>: <em>CHANGELOGS.rst</em></p></li>
<li><p>file <strong>12</strong>: <em>setup.py</em></p></li>
<li><p>file <strong>13</strong>: <em>requirements.txt</em></p></li>
<li><p>file <strong>14</strong>: <em>sphinx_runpython</em></p></li>
<li><p>file <strong>15</strong>: <em>_doc</em></p></li>
<li><p>file <strong>16</strong>: <em>LICENSE.txt</em></p></li>
<li><p>file <strong>17</strong>: <em>README.rst</em></p></li>
</ul>
<p>If the code throws an exception (except a syntax error),
it can be caught by adding the option <code class="docutils literal notranslate"><span class="pre">:exception:</span></code>.
The directive displays the traceback.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;not existing&quot;</span><span class="p">)):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    
    <span class="p">[</span><span class="n">runpythonerror</span><span class="p">]</span>
    
    <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">globs</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span>
      <span class="n">File</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">6</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="n">File</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">4</span><span class="p">,</span> <span class="ow">in</span> <span class="n">run_python_script_139720871624128</span>
    <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;not existing&#39;</span>
</pre></div>
</div>
<p>The directive can also be used to display images
with a tweak however. It consists in writing <em>rst</em>
code. The variable <code class="docutils literal notranslate"><span class="pre">__WD__</span></code> indicates the local
directory.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;__WD__=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">__WD__</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">__WD__</span><span class="o">=</span><span class="s1">&#39;/home/xadupre/github/sphinx-runpython/_doc/api&#39;</span>
</pre></div>
</div>
<p>Applied to images…</p>
<aside class="sidebar">
<p class="sidebar-title">runpython and image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">rst</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__WD__</span><span class="p">,</span> <span class="s2">&quot;oo.png&quot;</span><span class="p">))</span>

    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;.. image:: oo.png&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</aside>
<p>The image needs to be save in the same folder than
the <em>rst</em> file.</p>
<a class="reference internal image-reference" href="../_images/oo.png"><img alt="../_images/oo.png" src="../_images/oo.png" style="width: 201px;" /></a>
<p>Option <code class="docutils literal notranslate"><span class="pre">:toggle:</span></code> can hide the code or the output or both
but let the user unhide it by clicking on a button.</p>
<aside class="sidebar">
<p class="sidebar-title">runpython and image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">showcode</span><span class="p">:</span>
    <span class="p">:</span><span class="n">toggle</span><span class="p">:</span> <span class="n">out</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;i=&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</aside>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;i=&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<script>
function myFunction140238178848960() {
    var x = document.getElementById("collapse140238178848960");
    var b = document.getElementById("colidb140238178848960");
    if (x.style.display === "none") { 
        x.style.display = "block"; b.innerText = 'hide output';
    }
    else { x.style.display = "none"; b.innerText = 'unhide output'; }
}
</script>
<p style="margin-bottom:10px;"><button id="colidb140238178848960" onclick="myFunction140238178848960()">unhide output</button></p>
<div id="collapse140238178848960" style="display:none;"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">i</span><span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">1</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">2</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">3</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">4</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">5</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">6</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">7</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">8</span>
    <span class="n">i</span><span class="o">=</span> <span class="mi">9</span>
</pre></div>
</div>
</div><p>The last option of <em>runpython</em> allows the user to keep
some context from one execution to the next one.</p>
<aside class="sidebar">
<p class="sidebar-title">runpython and context</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">showcode</span><span class="p">:</span>
    <span class="p">:</span><span class="n">store</span><span class="p">:</span>

    <span class="n">a_to_keep</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a_to_keep&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">a_to_keep</span><span class="p">)</span>

<span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">showcode</span><span class="p">:</span>
    <span class="p">:</span><span class="n">restore</span><span class="p">:</span>

    <span class="n">a_to_keep</span> <span class="o">+=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a_to_keep&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">a_to_keep</span><span class="p">)</span>
</pre></div>
</div>
</aside>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a_to_keep</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a_to_keep&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">a_to_keep</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">a_to_keep</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a_to_keep</span> <span class="o">+=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a_to_keep&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">a_to_keep</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">a_to_keep</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p id="index-0"><a class="reference external" href="https://pypi.org/project/sphinx-autorun/">sphinx-autorun</a> offers a similar
service except it cannot produce compile <a class="reference external" href="https://fr.wikipedia.org/wiki/ReStructuredText">RST</a> content,
hide the source and a couple of other options.</p>
</section>
<section id="interesting-functions">
<h2>Interesting functions<a class="headerlink" href="#interesting-functions" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sphinx_runpython.runpython.run_cmd">
<span class="sig-prename descclassname"><span class="pre">sphinx_runpython.runpython.</span></span><span class="sig-name descname"><span class="pre">run_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_running_if</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encerror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ignore'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">communicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_exit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tell_if_no_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sphinx_runpython/runpython/run_cmd.html#run_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sphinx_runpython.runpython.run_cmd" title="Permalink to this definition">#</a></dt>
<dd><p>Runs a command line and wait for the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmd</strong> – command line</p></li>
<li><p><strong>sin</strong> – sin: what must be written on the standard input</p></li>
<li><p><strong>shell</strong> – if True, cmd is a shell command (and no command window is opened)</p></li>
<li><p><strong>wait</strong> – call <code class="docutils literal notranslate"><span class="pre">proc.wait</span></code></p></li>
<li><p><strong>log_error</strong> – if log_error, call logf (error)</p></li>
<li><p><strong>stop_running_if</strong> – the function stops waiting if some condition is fulfilled.
The function received the last line from the logs.
Signature: <code class="docutils literal notranslate"><span class="pre">stop_waiting_if(last_out,</span> <span class="pre">last_err)</span> <span class="pre">-&gt;</span> <span class="pre">bool</span></code>.
The function must return True to stop waiting.
This function can also be used to intercept the standard output
and the standard error while running.</p></li>
<li><p><strong>encerror</strong> – encoding errors (ignore by default)
while converting the output into a string</p></li>
<li><p><strong>encoding</strong> – encoding of the output</p></li>
<li><p><strong>change_path</strong> – change the current path if  not None
(put it back after the execution)</p></li>
<li><p><strong>communicate</strong> – use method <a class="reference external" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen.communicate">communicate</a>
which is supposed to be safer, parameter <code class="docutils literal notranslate"><span class="pre">wait</span></code> must be True</p></li>
<li><p><strong>preprocess</strong> – preprocess the command line
if necessary (not available on Windows)
(False to disable that option)</p></li>
<li><p><strong>timeout</strong> – when data is sent to stdin (<code class="docutils literal notranslate"><span class="pre">sin</span></code>), a timeout is needed to avoid
waiting for ever (<em>timeout</em> is in seconds)</p></li>
<li><p><strong>catch_exit</strong> – catch <em>SystemExit</em> exception</p></li>
<li><p><strong>logf</strong> – logging function (if not None, bypass others parameters)</p></li>
<li><p><strong>tell_if_no_output</strong> – tells if there is no output every
<em>tell_if_no_output</em> seconds</p></li>
<li><p><strong>prefix_log</strong> – add a prefix to a line before printing it</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>content of stdout, stdres  (only if wait is True)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sphinx_runpython.runpython</span> <span class="kn">import</span> <span class="n">run_cmd</span>
<span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">run_cmd</span><span class="p">(</span><span class="s2">&quot;python setup.py install&quot;</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are using this function to run <a class="reference external" href="https://git-scm.com/">git</a> function, parameter
<code class="docutils literal notranslate"><span class="pre">shell</span></code> must be True.
The function catches <em>SystemExit</em> exception.
See <a class="reference external" href="http://stackoverflow.com/questions/4417546/constantly-print-subprocess-output-while-process-is-running/4417735">Constantly print Subprocess output while process is running</a>.
If <em>wait</em> is False, the function returns the started process.
<code class="docutils literal notranslate"><span class="pre">__exit__</span></code> should be called if wait if False.
Parameter <em>prefix_log</em> was added.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sphinx_runpython.runpython.sphinx_runpython_extension.remove_extra_spaces_and_black">
<span class="sig-prename descclassname"><span class="pre">sphinx_runpython.runpython.sphinx_runpython_extension.</span></span><span class="sig-name descname"><span class="pre">remove_extra_spaces_and_black</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_black</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/sphinx_runpython/runpython/sphinx_runpython_extension.html#remove_extra_spaces_and_black"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sphinx_runpython.runpython.sphinx_runpython_extension.remove_extra_spaces_and_black" title="Permalink to this definition">#</a></dt>
<dd><p>Removes extra spaces in a filename, replaces the file in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – file name or string (but it assumes it is python).</p></li>
<li><p><strong>apply_black</strong> – if True, calls <a class="reference external" href="https://black.readthedocs.io/en/stable/index.html">black</a> on the file</p></li>
<li><p><strong>is_string</strong> – force <em>filename</em> to be a string</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of removed extra spaces</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="directive">
<h2>Directive<a class="headerlink" href="#directive" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sphinx_runpython.runpython.sphinx_runpython_extension.RunPythonDirective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sphinx_runpython.runpython.sphinx_runpython_extension.</span></span><span class="sig-name descname"><span class="pre">RunPythonDirective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arguments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_machine</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sphinx_runpython/runpython/sphinx_runpython_extension.html#RunPythonDirective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sphinx_runpython.runpython.sphinx_runpython_extension.RunPythonDirective" title="Permalink to this definition">#</a></dt>
<dd><p>Extracts script to run described by <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">runpython::</span></code>
and modifies the documentation.</p>
<p>The following code prints the version of Python
on the standard output. It is added to the documentation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">showcode</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sys.version_info=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">))</span>
</pre></div>
</div>
<p>If give the following results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">micro</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">releaselevel</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">,</span> <span class="n">serial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Options <em>showcode</em> can be used to display the code.
The option <em>rst</em> will assume the output is in RST format and must be
interpreted. <em>showout</em> will complement the RST output with the raw format.</p>
<p>The directive has a couple of options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">:assert:</span></code> condition to validate at the end of the execution
to check it went right</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:current:</span></code> runs the script in the source file directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:exception:</span></code> the code throws an exception but it is expected.
The error is displayed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:indent:&lt;int&gt;</span></code> to indent the output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:language:</span></code>: changes <code class="docutils literal notranslate"><span class="pre">::</span></code> into <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">code-block::</span> <span class="pre">language</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:linenos:</span></code> to show line numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:noblack:</span></code> if present, leaves the code as it is and does
not apply black by default,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:numpy_precision:</span> <span class="pre">&lt;precision&gt;</span></code>, run <code class="docutils literal notranslate"><span class="pre">numpy.set_printoptions(precision=...)</span></code>,
precision is 3 by default</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:process:</span></code> run the script in an another process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:restore:</span></code> restore the local context stored in <a class="reference external" href="https://www.sphinx-doc.org/en/master/">sphinx</a> application
by the previous call to <em>runpython</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:rst:</span></code> to interpret the output, otherwise, it is considered as raw text</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:setsysvar:</span></code> adds a member to <em>sys</em> module,
the module can act differently based on that information,
if the value is left empty, <em>sys.enable_disabled_documented_pieces_of_code</em>
will be be set up to <em>True</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:showcode:</span></code> to show the code before its output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:showout</span></code> if <em>:rst:</em> is set up, this flag adds the raw rst
output to check what is happening</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:sin:&lt;text_for_in&gt;</span></code> which text to display before the code (by default <em>In</em>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:sout:&lt;text_for_in&gt;</span></code> which text to display before the output (by default <em>Out</em>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:sphinx:</span></code> by default, function <a class="reference external" href="https://www.sphinx-doc.org/en/master/extdev/markupapi.html#parsing-directive-content-as-rest">nested_parse_with_titles</a> is
used to parse the output of the script, if this option is set to false,
<a class="reference external" href="http://code.nabla.net/doc/docutils/api/docutils/core/docutils.core.publish_doctree.html">public_doctree</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:store:</span></code> stores the local context in <a class="reference external" href="https://www.sphinx-doc.org/en/master/">sphinx</a>
application to restore it later by another call to <em>runpython</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:toggle:</span></code> add a button to hide or show the code, it takes the values
<code class="docutils literal notranslate"><span class="pre">code</span></code> or <code class="docutils literal notranslate"><span class="pre">out</span></code> or <code class="docutils literal notranslate"><span class="pre">both</span></code>. The direction then hides the given section
but adds a button to show it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:warningout:</span></code> name of warnings to disable (ex: <code class="docutils literal notranslate"><span class="pre">ImportWarning</span></code>),
separated by spaces</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">:store_in_file:</span></code> the directive store the script in a file,</dt><dd><p>then executes this file (only if <code class="docutils literal notranslate"><span class="pre">:process:</span></code> is enabled),
this trick is needed when the script to executes relies on
function such <a class="reference external" href="https://docs.python.org/3/library/inspect.html#inspect.getsource">inspect.getsource</a> which requires
the script to be stored somewhere in order to retrieve it.</p>
</dd>
</dl>
</li>
</ul>
<p>Option <em>rst</em> can be used the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">runpython</span><span class="p">::</span>
    <span class="p">:</span><span class="n">rst</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;**line**&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Which displays interpreted <a class="reference external" href="https://fr.wikipedia.org/wiki/ReStructuredText">RST</a>:</p>
<p><strong>line</strong> <em>0</em></p>
<p><strong>line</strong> <em>1</em></p>
<p><strong>line</strong> <em>2</em></p>
<p><strong>line</strong> <em>3</em></p>
<p><strong>line</strong> <em>4</em></p>
<p><strong>line</strong> <em>5</em></p>
<p><strong>line</strong> <em>6</em></p>
<p><strong>line</strong> <em>7</em></p>
<p><strong>line</strong> <em>8</em></p>
<p><strong>line</strong> <em>9</em></p>
<p>If the directive produces RST text to be included later in the documentation,
it is able to interpret
<a class="reference external" href="http://docutils.sourceforge.net/docs/ref/rst/directives.html">docutils directives</a>
and <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/directives.html">Sphinx directives</a>
with function <a class="reference external" href="https://www.sphinx-doc.org/en/master/extdev/markupapi.html#parsing-directive-content-as-rest">nested_parse_with_titles</a>. However, if this text contains
titles, it is better to use option <code class="docutils literal notranslate"><span class="pre">:sphinx:</span> <span class="pre">false</span></code>.
Unless <em>process</em> option is enabled, global variables cannot be used.
<a class="reference external" href="https://pypi.org/project/sphinx-autorun/">sphinx-autorun</a> offers a similar
service except it cannot produce compile <a class="reference external" href="https://fr.wikipedia.org/wiki/ReStructuredText">RST</a> content,
hide the source and a couple of other options.
Option <em>toggle</em> can hide or unhide the piece of code
or/and its output.
The directive also adds local variables such as
<code class="docutils literal notranslate"><span class="pre">__WD__</span></code> which contains the path to the documentation
which contains the directive. It is useful to load additional
files <code class="docutils literal notranslate"><span class="pre">os.path.join(__WD__,</span> <span class="pre">...)</span></code>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hide or unhide this output.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<script>
function myFunction140238177539152() {
    var x = document.getElementById("collapse140238177539152");
    var b = document.getElementById("colidb140238177539152");
    if (x.style.display === "none") { 
        x.style.display = "block"; b.innerText = 'hide output';
    }
    else { x.style.display = "none"; b.innerText = 'unhide output'; }
}
</script>
<p style="margin-bottom:10px;"><button id="colidb140238177539152" onclick="myFunction140238177539152()">unhide output</button></p>
<div id="collapse140238177539152" style="display:none;"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">Hide</span> <span class="ow">or</span> <span class="n">unhide</span> <span class="n">this</span> <span class="n">output</span><span class="o">.</span>
</pre></div>
</div>
</div></dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tools.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">tools</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="quote.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">quote</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">runpython</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#interesting-functions">Interesting functions</a><ul>
<li><a class="reference internal" href="#sphinx_runpython.runpython.run_cmd"><code class="docutils literal notranslate"><span class="pre">run_cmd()</span></code></a></li>
<li><a class="reference internal" href="#sphinx_runpython.runpython.sphinx_runpython_extension.remove_extra_spaces_and_black"><code class="docutils literal notranslate"><span class="pre">remove_extra_spaces_and_black()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#directive">Directive</a><ul>
<li><a class="reference internal" href="#sphinx_runpython.runpython.sphinx_runpython_extension.RunPythonDirective"><code class="docutils literal notranslate"><span class="pre">RunPythonDirective</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=ea4a43d1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>