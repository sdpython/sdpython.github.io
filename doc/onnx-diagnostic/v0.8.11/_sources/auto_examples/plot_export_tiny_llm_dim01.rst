
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_export_tiny_llm_dim01.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_export_tiny_llm_dim01.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_export_tiny_llm_dim01.py:


.. _l-plot-tiny-llm-export-dim01:

Export with dynamic dimensions in ``{0,1}``
===========================================

The first version of :func:`torch.export.export` did not support
any tensor with a dimension equal to 0, 1 if the dimension was expected
to be dynamic. The latest versions offers more options. Let's check it works.
The experiments consists in exporting the model with different sets of inputs
and checking the exported models works with all set of inputs.

Available input sets
++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 17-36

.. code-block:: Python


    import itertools
    from tqdm import tqdm
    import numpy as np
    import pandas
    import torch
    from onnx_diagnostic import doc
    from onnx_diagnostic.helpers import max_diff, string_type
    from onnx_diagnostic.helpers.torch_helper import torch_deepcopy
    from onnx_diagnostic.torch_models.hghub.model_inputs import get_untrained_model_with_inputs
    from onnx_diagnostic.torch_export_patches.patch_inputs import use_dyn_not_str
    from onnx_diagnostic.torch_export_patches import (
        torch_export_patches,
        register_additional_serialization_functions,
    )

    data = get_untrained_model_with_inputs("arnir0/Tiny-LLM", add_second_input=True)
    model, dynamic_shapes = data["model"], data["dynamic_shapes"]








.. GENERATED FROM PYTHON SOURCE LINES 37-44

The trained model can be obtained with:

.. code-block:: python

  MODEL_NAME = "arnir0/Tiny-LLM"
  tokenizer = transformers.AutoTokenizer.from_pretrained(MODEL_NAME)
  model = transformers.AutoModelForCausalLM.from_pretrained(MODEL_NAME)

.. GENERATED FROM PYTHON SOURCE LINES 44-50

.. code-block:: Python


    input_sets = {k: v for k, v in data.items() if k.startswith("inputs")}

    for k, v in input_sets.items():
        print(f"{k:20}: {string_type(v, with_shape=True)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    inputs              : dict(input_ids:T7s2x3,attention_mask:T7s2x33,position_ids:T7s2x3,past_key_values:DynamicCache(key_cache=#1[T1s2x1x30x96], value_cache=#1[T1s2x1x30x96]))
    inputs_prompt       : dict(input_ids:T7s1x11)
    inputs2             : dict(input_ids:T7s3x4,attention_mask:T7s3x35,position_ids:T7s3x4,past_key_values:DynamicCache(key_cache=#1[T1s3x1x31x96], value_cache=#1[T1s3x1x31x96]))
    inputs_empty_cache  : dict(input_ids:T7s2x3,attention_mask:T7s2x3,position_ids:T7s2x3,past_key_values:DynamicCache(key_cache=#1[T1s2x1x0x96], value_cache=#1[T1s2x1x0x96]))
    inputs_batch1       : dict(input_ids:T7s1x3,attention_mask:T7s1x33,position_ids:T7s1x3,past_key_values:DynamicCache(key_cache=#1[T1s1x1x30x96], value_cache=#1[T1s1x1x30x96]))




.. GENERATED FROM PYTHON SOURCE LINES 51-52

The dynamic shapes are:

.. GENERATED FROM PYTHON SOURCE LINES 52-55

.. code-block:: Python


    print(f"dynamic_shapes: {string_type(dynamic_shapes)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    dynamic_shapes: dict(input_ids:{0:DYN(batch),1:DYN(seq_length)},attention_mask:{0:DYN(batch),1:DYN(cache+seq)},position_ids:{0:DYN(batch),1:DYN(seq_length)},past_key_values:#2[{0:DYN(batch),2:DYN(cache_length)},{0:DYN(batch),2:DYN(cache_length)}])




.. GENERATED FROM PYTHON SOURCE LINES 56-60

.. code-block:: Python


    dynamic_shapes = use_dyn_not_str(dynamic_shapes)
    print(f"dynamic_shapes: {string_type(dynamic_shapes)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    dynamic_shapes: dict(input_ids:{0:DYNAMIC,1:DYNAMIC},attention_mask:{0:DYNAMIC,1:DYNAMIC},position_ids:{0:DYNAMIC,1:DYNAMIC},past_key_values:#2[{0:DYNAMIC,2:DYNAMIC},{0:DYNAMIC,2:DYNAMIC}])




.. GENERATED FROM PYTHON SOURCE LINES 61-63

Let's check they all work and compute the expected values.
We use deepcopy because caches are usually modified inplace.

.. GENERATED FROM PYTHON SOURCE LINES 63-69

.. code-block:: Python


    expected = {}
    for k, v in input_sets.items():
        expected[k] = model(**torch_deepcopy(v))
        print(f"{k:20}: {string_type(expected[k], with_shape=True)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    inputs              : CausalLMOutputWithPast(logits:T1s2x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s2x1x33x96], value_cache=#1[T1s2x1x33x96]))
    inputs_prompt       : CausalLMOutputWithPast(logits:T1s1x11x32000,past_key_values:DynamicCache(key_cache=#1[T1s1x1x11x96], value_cache=#1[T1s1x1x11x96]))
    inputs2             : CausalLMOutputWithPast(logits:T1s3x4x32000,past_key_values:DynamicCache(key_cache=#1[T1s3x1x35x96], value_cache=#1[T1s3x1x35x96]))
    inputs_empty_cache  : CausalLMOutputWithPast(logits:T1s2x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s2x1x3x96], value_cache=#1[T1s2x1x3x96]))
    inputs_batch1       : CausalLMOutputWithPast(logits:T1s1x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s1x1x33x96], value_cache=#1[T1s1x1x33x96]))




.. GENERATED FROM PYTHON SOURCE LINES 70-86

Export with options
+++++++++++++++++++

We try to export with the following options:

- cache registration: register cache serialization with
  :func:`onnx_diagnostic.torch_export_patches.register_additional_serialization_functions`

- oblivious: an option to remove some the exception raises by the exporter

- rt: see ``prefer_deferred_runtime_asserts_over_guards`` in :func:`torch.export.export`

- cache_patch: patches the model before exporting with
  :func:`onnx_diagnostic.torch_export_patches.torch_export_patches`

Some function first.

.. GENERATED FROM PYTHON SOURCE LINES 86-160

.. code-block:: Python



    def export_model(
        model,
        dynamic_shapes,
        inputs,
        cache=False,
        oblivious=False,
        rt=False,
        cache_patch=False,
        strict=False,
    ):
        if cache and not cache_patch:
            with register_additional_serialization_functions(patch_transformers=True):
                return export_model(
                    model, dynamic_shapes, inputs, oblivious=oblivious, rt=rt, strict=strict
                )
        if cache_patch:
            with torch_export_patches(
                patch_torch=cache_patch in ("all", "torch", True, 1),
                patch_transformers=cache_patch in ("all", "transformers", True, 1),
            ):
                return export_model(
                    model, dynamic_shapes, inputs, oblivious=oblivious, rt=rt, strict=strict
                )
        if oblivious:
            with torch.fx.experimental._config.patch(backed_size_oblivious=True):
                return export_model(model, dynamic_shapes, inputs, rt=rt, strict=strict)
        return torch.export.export(
            model,
            (),
            inputs,
            dynamic_shapes=dynamic_shapes,
            strict=strict,
            prefer_deferred_runtime_asserts_over_guards=rt,
        )


    def try_export_model(
        model,
        dynamic_shapes,
        inputs,
        cache=False,
        oblivious=False,
        rt=False,
        cache_patch=False,
        strict=False,
    ):
        try:
            return export_model(
                model,
                dynamic_shapes,
                inputs,
                cache=cache,
                oblivious=oblivious,
                rt=rt,
                cache_patch=cache_patch,
                strict=strict,
            )
        except Exception as e:
            return e


    def validation(ep, input_sets, expected):
        mod = ep.module()
        for k, v in input_sets.items():
            try:
                got = mod(**torch_deepcopy(v))
            except Exception as e:
                yield k, e
                continue
            yield k, max_diff(expected[k], got, verbose=0)









.. GENERATED FROM PYTHON SOURCE LINES 161-163

The main loop
+++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 163-214

.. code-block:: Python


    results = []

    possibilities = [*[[0, 1] for _ in range(5)], list(input_sets)]
    possibilities[1] = [0, "all", "torch", "transformers"]
    with tqdm(list(itertools.product(*possibilities))) as pbar:
        for cache, cache_patch, strict, oblivious, rt, inputs in pbar:
            if cache_patch and not cache:
                # patches include caches.
                continue
            kwargs = dict(
                cache=cache, cache_patch=cache_patch, strict=strict, oblivious=oblivious, rt=rt
            )
            legend = "-".join(
                (k if isinstance(v, int) else f"{k}:{v}") for k, v in kwargs.items() if v
            )
            legend = f"{legend}/{inputs}"
            pbar.set_description(f"{legend} EXPORT")

            # export
            ep = try_export_model(
                model, dynamic_shapes, torch_deepcopy(input_sets[inputs]), **kwargs
            )
            if isinstance(ep, Exception):
                obs = {
                    **kwargs,
                    "export_with": inputs,
                    "EXPORT": 0,
                    "ERR-EXPORT": str(ep).split("\n")[0],
                }
                results.append(obs)
                continue

            pbar.set_description(f"{legend} VALIDATE")
            common = {**kwargs, "export_with": inputs, "EXPORT": 1}
            for inp, res in validation(ep, input_sets, expected):
                if isinstance(res, Exception):
                    obs = {
                        **common,
                        "run_with": inp,
                        "ERR-RUN": str(res).split("\n")[0],
                        "WORKS": 0,
                    }
                else:
                    obs = {
                        **common,
                        "run_with": inp,
                        "WORKS": int(~np.isnan(res["abs"]) and res["abs"] < 1e-3),
                    }
                results.append(obs)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/320 [00:00<?, ?it/s]    /inputs EXPORT:   0%|          | 0/320 [00:00<?, ?it/s]    /inputs VALIDATE:   0%|          | 0/320 [00:01<?, ?it/s]    /inputs VALIDATE:   0%|          | 1/320 [00:01<07:55,  1.49s/it]    /inputs_prompt EXPORT:   0%|          | 1/320 [00:01<07:55,  1.49s/it]    /inputs2 EXPORT:   0%|          | 1/320 [00:01<07:55,  1.49s/it]          /inputs2 VALIDATE:   0%|          | 1/320 [00:03<07:55,  1.49s/it]    /inputs2 VALIDATE:   1%|          | 3/320 [00:03<05:16,  1.00it/s]    /inputs_empty_cache EXPORT:   1%|          | 3/320 [00:03<05:16,  1.00it/s]    /inputs_empty_cache EXPORT:   1%|▏         | 4/320 [00:04<05:40,  1.08s/it]    /inputs_batch1 EXPORT:   1%|▏         | 4/320 [00:04<05:40,  1.08s/it]         /inputs_batch1 EXPORT:   2%|▏         | 5/320 [00:05<05:34,  1.06s/it]    rt/inputs EXPORT:   2%|▏         | 5/320 [00:05<05:34,  1.06s/it]         rt/inputs VALIDATE:   2%|▏         | 5/320 [00:06<05:34,  1.06s/it]    rt/inputs VALIDATE:   2%|▏         | 6/320 [00:06<05:40,  1.08s/it]    rt/inputs_prompt EXPORT:   2%|▏         | 6/320 [00:06<05:40,  1.08s/it]    rt/inputs2 EXPORT:   2%|▏         | 6/320 [00:06<05:40,  1.08s/it]          rt/inputs2 VALIDATE:   2%|▏         | 6/320 [00:07<05:40,  1.08s/it]    rt/inputs2 VALIDATE:   2%|▎         | 8/320 [00:07<04:38,  1.12it/s]    rt/inputs_empty_cache EXPORT:   2%|▎         | 8/320 [00:07<04:38,  1.12it/s]    rt/inputs_empty_cache EXPORT:   3%|▎         | 9/320 [00:09<05:05,  1.02it/s]    rt/inputs_batch1 EXPORT:   3%|▎         | 9/320 [00:09<05:05,  1.02it/s]         rt/inputs_batch1 EXPORT:   3%|▎         | 10/320 [00:10<04:57,  1.04it/s]    oblivious/inputs EXPORT:   3%|▎         | 10/320 [00:10<04:57,  1.04it/s]    oblivious/inputs VALIDATE:   3%|▎         | 10/320 [00:11<04:57,  1.04it/s]    oblivious/inputs VALIDATE:   3%|▎         | 11/320 [00:11<06:14,  1.21s/it]    oblivious/inputs_prompt EXPORT:   3%|▎         | 11/320 [00:11<06:14,  1.21s/it]    oblivious/inputs2 EXPORT:   3%|▎         | 11/320 [00:11<06:14,  1.21s/it]          oblivious/inputs2 VALIDATE:   3%|▎         | 11/320 [00:13<06:14,  1.21s/it]    oblivious/inputs2 VALIDATE:   4%|▍         | 13/320 [00:13<05:05,  1.00it/s]    oblivious/inputs_empty_cache EXPORT:   4%|▍         | 13/320 [00:13<05:05,  1.00it/s]    oblivious/inputs_empty_cache VALIDATE:   4%|▍         | 13/320 [00:14<05:05,  1.00it/s]    oblivious/inputs_empty_cache VALIDATE:   4%|▍         | 14/320 [00:14<05:35,  1.10s/it]    oblivious/inputs_batch1 EXPORT:   4%|▍         | 14/320 [00:14<05:35,  1.10s/it]           oblivious/inputs_batch1 VALIDATE:   4%|▍         | 14/320 [00:15<05:35,  1.10s/it]    oblivious/inputs_batch1 VALIDATE:   5%|▍         | 15/320 [00:16<05:45,  1.13s/it]    oblivious-rt/inputs EXPORT:   5%|▍         | 15/320 [00:16<05:45,  1.13s/it]          oblivious-rt/inputs VALIDATE:   5%|▍         | 15/320 [00:17<05:45,  1.13s/it]    oblivious-rt/inputs VALIDATE:   5%|▌         | 16/320 [00:18<06:59,  1.38s/it]    oblivious-rt/inputs_prompt EXPORT:   5%|▌         | 16/320 [00:18<06:59,  1.38s/it]    oblivious-rt/inputs2 EXPORT:   5%|▌         | 16/320 [00:18<06:59,  1.38s/it]          oblivious-rt/inputs2 VALIDATE:   5%|▌         | 16/320 [00:19<06:59,  1.38s/it]    oblivious-rt/inputs2 VALIDATE:   6%|▌         | 18/320 [00:19<05:25,  1.08s/it]    oblivious-rt/inputs_empty_cache EXPORT:   6%|▌         | 18/320 [00:19<05:25,  1.08s/it]    oblivious-rt/inputs_empty_cache VALIDATE:   6%|▌         | 18/320 [00:21<05:25,  1.08s/it]    oblivious-rt/inputs_empty_cache VALIDATE:   6%|▌         | 19/320 [00:21<06:13,  1.24s/it]    oblivious-rt/inputs_batch1 EXPORT:   6%|▌         | 19/320 [00:21<06:13,  1.24s/it]           oblivious-rt/inputs_batch1 VALIDATE:   6%|▌         | 19/320 [00:22<06:13,  1.24s/it]    oblivious-rt/inputs_batch1 VALIDATE:   6%|▋         | 20/320 [00:22<06:26,  1.29s/it]    strict/inputs EXPORT:   6%|▋         | 20/320 [00:22<06:26,  1.29s/it]                   strict/inputs EXPORT:   7%|▋         | 21/320 [00:26<10:12,  2.05s/it]    strict/inputs_prompt EXPORT:   7%|▋         | 21/320 [00:26<10:12,  2.05s/it]    strict/inputs2 EXPORT:   7%|▋         | 21/320 [00:26<10:12,  2.05s/it]          strict/inputs2 EXPORT:   7%|▋         | 23/320 [00:28<07:59,  1.61s/it]    strict/inputs_empty_cache EXPORT:   7%|▋         | 23/320 [00:28<07:59,  1.61s/it]    strict/inputs_empty_cache EXPORT:   8%|▊         | 24/320 [00:30<08:14,  1.67s/it]    strict/inputs_batch1 EXPORT:   8%|▊         | 24/320 [00:30<08:14,  1.67s/it]         strict/inputs_batch1 EXPORT:   8%|▊         | 25/320 [00:34<10:37,  2.16s/it]    strict-rt/inputs EXPORT:   8%|▊         | 25/320 [00:34<10:37,  2.16s/it]        strict-rt/inputs EXPORT:   8%|▊         | 26/320 [00:39<13:52,  2.83s/it]    strict-rt/inputs_prompt EXPORT:   8%|▊         | 26/320 [00:39<13:52,  2.83s/it]    strict-rt/inputs2 EXPORT:   8%|▊         | 26/320 [00:39<13:52,  2.83s/it]          strict-rt/inputs2 EXPORT:   9%|▉         | 28/320 [00:42<11:55,  2.45s/it]    strict-rt/inputs_empty_cache EXPORT:   9%|▉         | 28/320 [00:42<11:55,  2.45s/it]    strict-rt/inputs_empty_cache EXPORT:   9%|▉         | 29/320 [00:45<12:08,  2.50s/it]    strict-rt/inputs_batch1 EXPORT:   9%|▉         | 29/320 [00:45<12:08,  2.50s/it]         strict-rt/inputs_batch1 EXPORT:   9%|▉         | 30/320 [00:47<11:35,  2.40s/it]    strict-oblivious/inputs EXPORT:   9%|▉         | 30/320 [00:47<11:35,  2.40s/it]    strict-oblivious/inputs EXPORT:  10%|▉         | 31/320 [00:48<10:09,  2.11s/it]    strict-oblivious/inputs_prompt EXPORT:  10%|▉         | 31/320 [00:48<10:09,  2.11s/it]    strict-oblivious/inputs2 EXPORT:  10%|▉         | 31/320 [00:48<10:09,  2.11s/it]          strict-oblivious/inputs2 EXPORT:  10%|█         | 33/320 [00:50<07:21,  1.54s/it]    strict-oblivious/inputs_empty_cache EXPORT:  10%|█         | 33/320 [00:50<07:21,  1.54s/it]    strict-oblivious/inputs_empty_cache EXPORT:  11%|█         | 34/320 [00:51<07:10,  1.51s/it]    strict-oblivious/inputs_batch1 EXPORT:  11%|█         | 34/320 [00:51<07:10,  1.51s/it]         strict-oblivious/inputs_batch1 EXPORT:  11%|█         | 35/320 [00:55<09:02,  1.90s/it]    strict-oblivious-rt/inputs EXPORT:  11%|█         | 35/320 [00:55<09:02,  1.90s/it]        strict-oblivious-rt/inputs EXPORT:  11%|█▏        | 36/320 [00:57<09:56,  2.10s/it]    strict-oblivious-rt/inputs_prompt EXPORT:  11%|█▏        | 36/320 [00:57<09:56,  2.10s/it]    strict-oblivious-rt/inputs2 EXPORT:  11%|█▏        | 36/320 [00:57<09:56,  2.10s/it]          strict-oblivious-rt/inputs2 EXPORT:  12%|█▏        | 38/320 [01:00<07:58,  1.70s/it]    strict-oblivious-rt/inputs_empty_cache EXPORT:  12%|█▏        | 38/320 [01:00<07:58,  1.70s/it]    strict-oblivious-rt/inputs_empty_cache EXPORT:  12%|█▏        | 39/320 [01:02<08:30,  1.82s/it]    strict-oblivious-rt/inputs_batch1 EXPORT:  12%|█▏        | 39/320 [01:02<08:30,  1.82s/it]         strict-oblivious-rt/inputs_batch1 EXPORT:  12%|█▎        | 40/320 [01:04<08:54,  1.91s/it]    cache/inputs EXPORT:  12%|█▎        | 40/320 [01:04<08:54,  1.91s/it]                         cache/inputs VALIDATE:  12%|█▎        | 40/320 [01:05<08:54,  1.91s/it]    cache/inputs VALIDATE:  50%|█████     | 161/320 [01:05<00:08, 19.37it/s]    cache/inputs_prompt EXPORT:  50%|█████     | 161/320 [01:05<00:08, 19.37it/s]    cache/inputs2 EXPORT:  50%|█████     | 161/320 [01:05<00:08, 19.37it/s]          cache/inputs2 VALIDATE:  50%|█████     | 161/320 [01:06<00:08, 19.37it/s]    cache/inputs_empty_cache EXPORT:  50%|█████     | 161/320 [01:06<00:08, 19.37it/s]    cache/inputs_batch1 EXPORT:  50%|█████     | 161/320 [01:07<00:08, 19.37it/s]         cache/inputs_batch1 EXPORT:  52%|█████▏    | 165/320 [01:08<00:12, 12.84it/s]    cache-rt/inputs EXPORT:  52%|█████▏    | 165/320 [01:08<00:12, 12.84it/s]        cache-rt/inputs VALIDATE:  52%|█████▏    | 165/320 [01:08<00:12, 12.84it/s]    cache-rt/inputs_prompt EXPORT:  52%|█████▏    | 165/320 [01:09<00:12, 12.84it/s]    cache-rt/inputs2 EXPORT:  52%|█████▏    | 165/320 [01:09<00:12, 12.84it/s]          cache-rt/inputs2 VALIDATE:  52%|█████▏    | 165/320 [01:09<00:12, 12.84it/s]    cache-rt/inputs2 VALIDATE:  52%|█████▎    | 168/320 [01:10<00:15,  9.67it/s]    cache-rt/inputs_empty_cache EXPORT:  52%|█████▎    | 168/320 [01:10<00:15,  9.67it/s]    cache-rt/inputs_batch1 EXPORT:  52%|█████▎    | 168/320 [01:10<00:15,  9.67it/s]         cache-rt/inputs_batch1 EXPORT:  53%|█████▎    | 170/320 [01:12<00:22,  6.70it/s]    cache-oblivious/inputs EXPORT:  53%|█████▎    | 170/320 [01:12<00:22,  6.70it/s]    cache-oblivious/inputs VALIDATE:  53%|█████▎    | 170/320 [01:13<00:22,  6.70it/s]    cache-oblivious/inputs_prompt EXPORT:  53%|█████▎    | 170/320 [01:13<00:22,  6.70it/s]    cache-oblivious/inputs_prompt EXPORT:  54%|█████▍    | 172/320 [01:13<00:24,  6.02it/s]    cache-oblivious/inputs2 EXPORT:  54%|█████▍    | 172/320 [01:13<00:24,  6.02it/s]          cache-oblivious/inputs2 VALIDATE:  54%|█████▍    | 172/320 [01:14<00:24,  6.02it/s]    cache-oblivious/inputs2 VALIDATE:  54%|█████▍    | 173/320 [01:14<00:28,  5.08it/s]    cache-oblivious/inputs_empty_cache EXPORT:  54%|█████▍    | 173/320 [01:14<00:28,  5.08it/s]    cache-oblivious/inputs_empty_cache VALIDATE:  54%|█████▍    | 173/320 [01:15<00:28,  5.08it/s]    cache-oblivious/inputs_empty_cache VALIDATE:  54%|█████▍    | 174/320 [01:15<00:34,  4.19it/s]    cache-oblivious/inputs_batch1 EXPORT:  54%|█████▍    | 174/320 [01:15<00:34,  4.19it/s]           cache-oblivious/inputs_batch1 VALIDATE:  54%|█████▍    | 174/320 [01:16<00:34,  4.19it/s]    cache-oblivious/inputs_batch1 VALIDATE:  55%|█████▍    | 175/320 [01:16<00:41,  3.50it/s]    cache-oblivious-rt/inputs EXPORT:  55%|█████▍    | 175/320 [01:16<00:41,  3.50it/s]          cache-oblivious-rt/inputs VALIDATE:  55%|█████▍    | 175/320 [01:17<00:41,  3.50it/s]    cache-oblivious-rt/inputs VALIDATE:  55%|█████▌    | 176/320 [01:17<00:49,  2.90it/s]    cache-oblivious-rt/inputs_prompt EXPORT:  55%|█████▌    | 176/320 [01:17<00:49,  2.90it/s]    cache-oblivious-rt/inputs2 EXPORT:  55%|█████▌    | 176/320 [01:17<00:49,  2.90it/s]          cache-oblivious-rt/inputs2 VALIDATE:  55%|█████▌    | 176/320 [01:18<00:49,  2.90it/s]    cache-oblivious-rt/inputs2 VALIDATE:  56%|█████▌    | 178/320 [01:18<00:52,  2.72it/s]    cache-oblivious-rt/inputs_empty_cache EXPORT:  56%|█████▌    | 178/320 [01:18<00:52,  2.72it/s]    cache-oblivious-rt/inputs_empty_cache VALIDATE:  56%|█████▌    | 178/320 [01:18<00:52,  2.72it/s]    cache-oblivious-rt/inputs_empty_cache VALIDATE:  56%|█████▌    | 179/320 [01:19<01:02,  2.26it/s]    cache-oblivious-rt/inputs_batch1 EXPORT:  56%|█████▌    | 179/320 [01:19<01:02,  2.26it/s]           cache-oblivious-rt/inputs_batch1 VALIDATE:  56%|█████▌    | 179/320 [01:19<01:02,  2.26it/s]    cache-oblivious-rt/inputs_batch1 VALIDATE:  56%|█████▋    | 180/320 [01:20<01:13,  1.92it/s]    cache-strict/inputs EXPORT:  56%|█████▋    | 180/320 [01:20<01:13,  1.92it/s]                   cache-strict/inputs EXPORT:  57%|█████▋    | 181/320 [01:21<01:37,  1.43it/s]    cache-strict/inputs_prompt EXPORT:  57%|█████▋    | 181/320 [01:21<01:37,  1.43it/s]    cache-strict/inputs2 EXPORT:  57%|█████▋    | 181/320 [01:21<01:37,  1.43it/s]          cache-strict/inputs2 EXPORT:  57%|█████▋    | 183/320 [01:22<01:35,  1.43it/s]    cache-strict/inputs_empty_cache EXPORT:  57%|█████▋    | 183/320 [01:22<01:35,  1.43it/s]    cache-strict/inputs_empty_cache EXPORT:  57%|█████▊    | 184/320 [01:24<01:50,  1.23it/s]    cache-strict/inputs_batch1 EXPORT:  57%|█████▊    | 184/320 [01:24<01:50,  1.23it/s]         cache-strict/inputs_batch1 EXPORT:  58%|█████▊    | 185/320 [01:26<02:24,  1.07s/it]    cache-strict-rt/inputs EXPORT:  58%|█████▊    | 185/320 [01:26<02:24,  1.07s/it]        cache-strict-rt/inputs EXPORT:  58%|█████▊    | 186/320 [01:28<03:00,  1.34s/it]    cache-strict-rt/inputs_prompt EXPORT:  58%|█████▊    | 186/320 [01:28<03:00,  1.34s/it]    cache-strict-rt/inputs2 EXPORT:  58%|█████▊    | 186/320 [01:28<03:00,  1.34s/it]          cache-strict-rt/inputs2 EXPORT:  59%|█████▉    | 188/320 [01:32<03:23,  1.54s/it]    cache-strict-rt/inputs_empty_cache EXPORT:  59%|█████▉    | 188/320 [01:32<03:23,  1.54s/it]    cache-strict-rt/inputs_empty_cache EXPORT:  59%|█████▉    | 189/320 [01:34<03:43,  1.70s/it]    cache-strict-rt/inputs_batch1 EXPORT:  59%|█████▉    | 189/320 [01:34<03:43,  1.70s/it]         cache-strict-rt/inputs_batch1 EXPORT:  59%|█████▉    | 190/320 [01:36<03:54,  1.80s/it]    cache-strict-oblivious/inputs EXPORT:  59%|█████▉    | 190/320 [01:36<03:54,  1.80s/it]    cache-strict-oblivious/inputs EXPORT:  60%|█████▉    | 191/320 [01:37<03:38,  1.69s/it]    cache-strict-oblivious/inputs_prompt EXPORT:  60%|█████▉    | 191/320 [01:37<03:38,  1.69s/it]    cache-strict-oblivious/inputs2 EXPORT:  60%|█████▉    | 191/320 [01:37<03:38,  1.69s/it]          cache-strict-oblivious/inputs2 EXPORT:  60%|██████    | 193/320 [01:39<02:41,  1.27s/it]    cache-strict-oblivious/inputs_empty_cache EXPORT:  60%|██████    | 193/320 [01:39<02:41,  1.27s/it]    cache-strict-oblivious/inputs_empty_cache EXPORT:  61%|██████    | 194/320 [01:40<02:38,  1.25s/it]    cache-strict-oblivious/inputs_batch1 EXPORT:  61%|██████    | 194/320 [01:40<02:38,  1.25s/it]         cache-strict-oblivious/inputs_batch1 EXPORT:  61%|██████    | 195/320 [01:42<03:02,  1.46s/it]    cache-strict-oblivious-rt/inputs EXPORT:  61%|██████    | 195/320 [01:42<03:02,  1.46s/it]        cache-strict-oblivious-rt/inputs EXPORT:  61%|██████▏   | 196/320 [01:44<03:20,  1.62s/it]    cache-strict-oblivious-rt/inputs_prompt EXPORT:  61%|██████▏   | 196/320 [01:44<03:20,  1.62s/it]    cache-strict-oblivious-rt/inputs2 EXPORT:  61%|██████▏   | 196/320 [01:44<03:20,  1.62s/it]          cache-strict-oblivious-rt/inputs2 EXPORT:  62%|██████▏   | 198/320 [01:46<02:48,  1.38s/it]    cache-strict-oblivious-rt/inputs_empty_cache EXPORT:  62%|██████▏   | 198/320 [01:46<02:48,  1.38s/it]    cache-strict-oblivious-rt/inputs_empty_cache EXPORT:  62%|██████▏   | 199/320 [01:49<03:14,  1.61s/it]    cache-strict-oblivious-rt/inputs_batch1 EXPORT:  62%|██████▏   | 199/320 [01:49<03:14,  1.61s/it]         cache-strict-oblivious-rt/inputs_batch1 EXPORT:  62%|██████▎   | 200/320 [01:52<04:05,  2.04s/it]    cache-cache_patch:all/inputs EXPORT:  62%|██████▎   | 200/320 [01:52<04:05,  2.04s/it]               cache-cache_patch:all/inputs VALIDATE:  62%|██████▎   | 200/320 [01:53<04:05,  2.04s/it]    cache-cache_patch:all/inputs VALIDATE:  63%|██████▎   | 201/320 [01:53<03:35,  1.81s/it]    cache-cache_patch:all/inputs_prompt EXPORT:  63%|██████▎   | 201/320 [01:53<03:35,  1.81s/it]    cache-cache_patch:all/inputs2 EXPORT:  63%|██████▎   | 201/320 [01:53<03:35,  1.81s/it]          cache-cache_patch:all/inputs2 VALIDATE:  63%|██████▎   | 201/320 [01:54<03:35,  1.81s/it]    cache-cache_patch:all/inputs2 VALIDATE:  63%|██████▎   | 203/320 [01:54<02:35,  1.33s/it]    cache-cache_patch:all/inputs_empty_cache EXPORT:  63%|██████▎   | 203/320 [01:54<02:35,  1.33s/it]    cache-cache_patch:all/inputs_empty_cache VALIDATE:  63%|██████▎   | 203/320 [01:55<02:35,  1.33s/it]    cache-cache_patch:all/inputs_empty_cache VALIDATE:  64%|██████▍   | 204/320 [01:55<02:26,  1.26s/it]    cache-cache_patch:all/inputs_batch1 EXPORT:  64%|██████▍   | 204/320 [01:55<02:26,  1.26s/it]           cache-cache_patch:all/inputs_batch1 VALIDATE:  64%|██████▍   | 204/320 [01:56<02:26,  1.26s/it]    cache-cache_patch:all/inputs_batch1 VALIDATE:  64%|██████▍   | 205/320 [01:56<02:11,  1.14s/it]    cache-cache_patch:all-rt/inputs EXPORT:  64%|██████▍   | 205/320 [01:56<02:11,  1.14s/it]          cache-cache_patch:all-rt/inputs VALIDATE:  64%|██████▍   | 205/320 [01:57<02:11,  1.14s/it]    cache-cache_patch:all-rt/inputs VALIDATE:  64%|██████▍   | 206/320 [01:57<02:08,  1.13s/it]    cache-cache_patch:all-rt/inputs_prompt EXPORT:  64%|██████▍   | 206/320 [01:57<02:08,  1.13s/it]    cache-cache_patch:all-rt/inputs2 EXPORT:  64%|██████▍   | 206/320 [01:57<02:08,  1.13s/it]          cache-cache_patch:all-rt/inputs2 VALIDATE:  64%|██████▍   | 206/320 [01:58<02:08,  1.13s/it]    cache-cache_patch:all-rt/inputs2 VALIDATE:  65%|██████▌   | 208/320 [01:58<01:36,  1.16it/s]    cache-cache_patch:all-rt/inputs_empty_cache EXPORT:  65%|██████▌   | 208/320 [01:58<01:36,  1.16it/s]    cache-cache_patch:all-rt/inputs_empty_cache VALIDATE:  65%|██████▌   | 208/320 [01:59<01:36,  1.16it/s]    cache-cache_patch:all-rt/inputs_empty_cache VALIDATE:  65%|██████▌   | 209/320 [01:59<01:37,  1.13it/s]    cache-cache_patch:all-rt/inputs_batch1 EXPORT:  65%|██████▌   | 209/320 [01:59<01:37,  1.13it/s]           cache-cache_patch:all-rt/inputs_batch1 VALIDATE:  65%|██████▌   | 209/320 [02:00<01:37,  1.13it/s]    cache-cache_patch:all-rt/inputs_batch1 VALIDATE:  66%|██████▌   | 210/320 [02:00<01:32,  1.19it/s]    cache-cache_patch:all-oblivious/inputs EXPORT:  66%|██████▌   | 210/320 [02:00<01:32,  1.19it/s]      cache-cache_patch:all-oblivious/inputs VALIDATE:  66%|██████▌   | 210/320 [02:01<01:32,  1.19it/s]    cache-cache_patch:all-oblivious/inputs VALIDATE:  66%|██████▌   | 211/320 [02:02<01:50,  1.01s/it]    cache-cache_patch:all-oblivious/inputs_prompt EXPORT:  66%|██████▌   | 211/320 [02:02<01:50,  1.01s/it]    cache-cache_patch:all-oblivious/inputs2 EXPORT:  66%|██████▌   | 211/320 [02:02<01:50,  1.01s/it]          cache-cache_patch:all-oblivious/inputs2 VALIDATE:  66%|██████▌   | 211/320 [02:03<01:50,  1.01s/it]    cache-cache_patch:all-oblivious/inputs2 VALIDATE:  67%|██████▋   | 213/320 [02:03<01:32,  1.16it/s]    cache-cache_patch:all-oblivious/inputs_empty_cache EXPORT:  67%|██████▋   | 213/320 [02:03<01:32,  1.16it/s]    cache-cache_patch:all-oblivious/inputs_empty_cache VALIDATE:  67%|██████▋   | 213/320 [02:04<01:32,  1.16it/s]    cache-cache_patch:all-oblivious/inputs_empty_cache VALIDATE:  67%|██████▋   | 214/320 [02:04<01:38,  1.07it/s]    cache-cache_patch:all-oblivious/inputs_batch1 EXPORT:  67%|██████▋   | 214/320 [02:04<01:38,  1.07it/s]           cache-cache_patch:all-oblivious/inputs_batch1 VALIDATE:  67%|██████▋   | 214/320 [02:05<01:38,  1.07it/s]    cache-cache_patch:all-oblivious/inputs_batch1 VALIDATE:  67%|██████▋   | 215/320 [02:05<01:51,  1.07s/it]    cache-cache_patch:all-oblivious-rt/inputs EXPORT:  67%|██████▋   | 215/320 [02:05<01:51,  1.07s/it]          cache-cache_patch:all-oblivious-rt/inputs VALIDATE:  67%|██████▋   | 215/320 [02:06<01:51,  1.07s/it]    cache-cache_patch:all-oblivious-rt/inputs VALIDATE:  68%|██████▊   | 216/320 [02:07<01:51,  1.07s/it]    cache-cache_patch:all-oblivious-rt/inputs_prompt EXPORT:  68%|██████▊   | 216/320 [02:07<01:51,  1.07s/it]    cache-cache_patch:all-oblivious-rt/inputs2 EXPORT:  68%|██████▊   | 216/320 [02:07<01:51,  1.07s/it]          cache-cache_patch:all-oblivious-rt/inputs2 VALIDATE:  68%|██████▊   | 216/320 [02:07<01:51,  1.07s/it]    cache-cache_patch:all-oblivious-rt/inputs2 VALIDATE:  68%|██████▊   | 218/320 [02:08<01:24,  1.21it/s]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache EXPORT:  68%|██████▊   | 218/320 [02:08<01:24,  1.21it/s]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache VALIDATE:  68%|██████▊   | 218/320 [02:08<01:24,  1.21it/s]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache VALIDATE:  68%|██████▊   | 219/320 [02:09<01:26,  1.17it/s]    cache-cache_patch:all-oblivious-rt/inputs_batch1 EXPORT:  68%|██████▊   | 219/320 [02:09<01:26,  1.17it/s]           cache-cache_patch:all-oblivious-rt/inputs_batch1 VALIDATE:  68%|██████▊   | 219/320 [02:09<01:26,  1.17it/s]    cache-cache_patch:all-oblivious-rt/inputs_batch1 VALIDATE:  69%|██████▉   | 220/320 [02:09<01:26,  1.16it/s]    cache-cache_patch:all-strict/inputs EXPORT:  69%|██████▉   | 220/320 [02:09<01:26,  1.16it/s]                   cache-cache_patch:all-strict/inputs EXPORT:  69%|██████▉   | 221/320 [02:10<01:26,  1.14it/s]    cache-cache_patch:all-strict/inputs_prompt EXPORT:  69%|██████▉   | 221/320 [02:10<01:26,  1.14it/s]    cache-cache_patch:all-strict/inputs2 EXPORT:  69%|██████▉   | 221/320 [02:10<01:26,  1.14it/s]          cache-cache_patch:all-strict/inputs2 EXPORT:  70%|██████▉   | 223/320 [02:11<01:07,  1.43it/s]    cache-cache_patch:all-strict/inputs_empty_cache EXPORT:  70%|██████▉   | 223/320 [02:11<01:07,  1.43it/s]    cache-cache_patch:all-strict/inputs_empty_cache EXPORT:  70%|███████   | 224/320 [02:13<01:35,  1.00it/s]    cache-cache_patch:all-strict/inputs_batch1 EXPORT:  70%|███████   | 224/320 [02:13<01:35,  1.00it/s]         cache-cache_patch:all-strict/inputs_batch1 EXPORT:  70%|███████   | 225/320 [02:14<01:26,  1.10it/s]    cache-cache_patch:all-strict-rt/inputs EXPORT:  70%|███████   | 225/320 [02:14<01:26,  1.10it/s]        cache-cache_patch:all-strict-rt/inputs EXPORT:  71%|███████   | 226/320 [02:15<01:22,  1.15it/s]    cache-cache_patch:all-strict-rt/inputs_prompt EXPORT:  71%|███████   | 226/320 [02:15<01:22,  1.15it/s]    cache-cache_patch:all-strict-rt/inputs2 EXPORT:  71%|███████   | 226/320 [02:15<01:22,  1.15it/s]          cache-cache_patch:all-strict-rt/inputs2 EXPORT:  71%|███████▏  | 228/320 [02:15<01:00,  1.51it/s]    cache-cache_patch:all-strict-rt/inputs_empty_cache EXPORT:  71%|███████▏  | 228/320 [02:15<01:00,  1.51it/s]    cache-cache_patch:all-strict-rt/inputs_empty_cache EXPORT:  72%|███████▏  | 229/320 [02:16<01:02,  1.46it/s]    cache-cache_patch:all-strict-rt/inputs_batch1 EXPORT:  72%|███████▏  | 229/320 [02:16<01:02,  1.46it/s]         cache-cache_patch:all-strict-rt/inputs_batch1 EXPORT:  72%|███████▏  | 230/320 [02:17<01:01,  1.47it/s]    cache-cache_patch:all-strict-oblivious/inputs EXPORT:  72%|███████▏  | 230/320 [02:17<01:01,  1.47it/s]    cache-cache_patch:all-strict-oblivious/inputs EXPORT:  72%|███████▏  | 231/320 [02:18<01:05,  1.37it/s]    cache-cache_patch:all-strict-oblivious/inputs_prompt EXPORT:  72%|███████▏  | 231/320 [02:18<01:05,  1.37it/s]    cache-cache_patch:all-strict-oblivious/inputs2 EXPORT:  72%|███████▏  | 231/320 [02:18<01:05,  1.37it/s]          cache-cache_patch:all-strict-oblivious/inputs2 EXPORT:  73%|███████▎  | 233/320 [02:19<00:51,  1.68it/s]    cache-cache_patch:all-strict-oblivious/inputs_empty_cache EXPORT:  73%|███████▎  | 233/320 [02:19<00:51,  1.68it/s]    cache-cache_patch:all-strict-oblivious/inputs_empty_cache EXPORT:  73%|███████▎  | 234/320 [02:19<00:54,  1.59it/s]    cache-cache_patch:all-strict-oblivious/inputs_batch1 EXPORT:  73%|███████▎  | 234/320 [02:19<00:54,  1.59it/s]         cache-cache_patch:all-strict-oblivious/inputs_batch1 EXPORT:  73%|███████▎  | 235/320 [02:20<01:02,  1.35it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs EXPORT:  73%|███████▎  | 235/320 [02:20<01:02,  1.35it/s]        cache-cache_patch:all-strict-oblivious-rt/inputs EXPORT:  74%|███████▍  | 236/320 [02:21<01:06,  1.26it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs_prompt EXPORT:  74%|███████▍  | 236/320 [02:21<01:06,  1.26it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs2 EXPORT:  74%|███████▍  | 236/320 [02:21<01:06,  1.26it/s]          cache-cache_patch:all-strict-oblivious-rt/inputs2 EXPORT:  74%|███████▍  | 238/320 [02:22<00:51,  1.59it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs_empty_cache EXPORT:  74%|███████▍  | 238/320 [02:22<00:51,  1.59it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs_empty_cache EXPORT:  75%|███████▍  | 239/320 [02:23<00:53,  1.52it/s]    cache-cache_patch:all-strict-oblivious-rt/inputs_batch1 EXPORT:  75%|███████▍  | 239/320 [02:23<00:53,  1.52it/s]         cache-cache_patch:all-strict-oblivious-rt/inputs_batch1 EXPORT:  75%|███████▌  | 240/320 [02:24<00:53,  1.48it/s]    cache-cache_patch:torch/inputs EXPORT:  75%|███████▌  | 240/320 [02:24<00:53,  1.48it/s]                             cache-cache_patch:torch/inputs VALIDATE:  75%|███████▌  | 240/320 [02:24<00:53,  1.48it/s]    cache-cache_patch:torch/inputs VALIDATE:  75%|███████▌  | 241/320 [02:25<00:59,  1.32it/s]    cache-cache_patch:torch/inputs_prompt EXPORT:  75%|███████▌  | 241/320 [02:25<00:59,  1.32it/s]    cache-cache_patch:torch/inputs2 EXPORT:  75%|███████▌  | 241/320 [02:25<00:59,  1.32it/s]          cache-cache_patch:torch/inputs2 VALIDATE:  75%|███████▌  | 241/320 [02:25<00:59,  1.32it/s]    cache-cache_patch:torch/inputs2 VALIDATE:  76%|███████▌  | 243/320 [02:25<00:47,  1.61it/s]    cache-cache_patch:torch/inputs_empty_cache EXPORT:  76%|███████▌  | 243/320 [02:25<00:47,  1.61it/s]    cache-cache_patch:torch/inputs_empty_cache VALIDATE:  76%|███████▌  | 243/320 [02:26<00:47,  1.61it/s]    cache-cache_patch:torch/inputs_empty_cache VALIDATE:  76%|███████▋  | 244/320 [02:26<00:51,  1.48it/s]    cache-cache_patch:torch/inputs_batch1 EXPORT:  76%|███████▋  | 244/320 [02:26<00:51,  1.48it/s]           cache-cache_patch:torch/inputs_batch1 VALIDATE:  76%|███████▋  | 244/320 [02:27<00:51,  1.48it/s]    cache-cache_patch:torch/inputs_batch1 VALIDATE:  77%|███████▋  | 245/320 [02:27<00:51,  1.46it/s]    cache-cache_patch:torch-rt/inputs EXPORT:  77%|███████▋  | 245/320 [02:27<00:51,  1.46it/s]          cache-cache_patch:torch-rt/inputs VALIDATE:  77%|███████▋  | 245/320 [02:28<00:51,  1.46it/s]    cache-cache_patch:torch-rt/inputs VALIDATE:  77%|███████▋  | 246/320 [02:28<00:54,  1.35it/s]    cache-cache_patch:torch-rt/inputs_prompt EXPORT:  77%|███████▋  | 246/320 [02:28<00:54,  1.35it/s]    cache-cache_patch:torch-rt/inputs2 EXPORT:  77%|███████▋  | 246/320 [02:28<00:54,  1.35it/s]          cache-cache_patch:torch-rt/inputs2 VALIDATE:  77%|███████▋  | 246/320 [02:29<00:54,  1.35it/s]    cache-cache_patch:torch-rt/inputs2 VALIDATE:  78%|███████▊  | 248/320 [02:29<00:45,  1.57it/s]    cache-cache_patch:torch-rt/inputs_empty_cache EXPORT:  78%|███████▊  | 248/320 [02:29<00:45,  1.57it/s]    cache-cache_patch:torch-rt/inputs_empty_cache VALIDATE:  78%|███████▊  | 248/320 [02:30<00:45,  1.57it/s]    cache-cache_patch:torch-rt/inputs_empty_cache VALIDATE:  78%|███████▊  | 249/320 [02:30<00:48,  1.47it/s]    cache-cache_patch:torch-rt/inputs_batch1 EXPORT:  78%|███████▊  | 249/320 [02:30<00:48,  1.47it/s]           cache-cache_patch:torch-rt/inputs_batch1 VALIDATE:  78%|███████▊  | 249/320 [02:30<00:48,  1.47it/s]    cache-cache_patch:torch-rt/inputs_batch1 VALIDATE:  78%|███████▊  | 250/320 [02:30<00:46,  1.49it/s]    cache-cache_patch:torch-oblivious/inputs EXPORT:  78%|███████▊  | 250/320 [02:30<00:46,  1.49it/s]      cache-cache_patch:torch-oblivious/inputs VALIDATE:  78%|███████▊  | 250/320 [02:31<00:46,  1.49it/s]    cache-cache_patch:torch-oblivious/inputs VALIDATE:  78%|███████▊  | 251/320 [02:31<00:52,  1.32it/s]    cache-cache_patch:torch-oblivious/inputs_prompt EXPORT:  78%|███████▊  | 251/320 [02:31<00:52,  1.32it/s]    cache-cache_patch:torch-oblivious/inputs2 EXPORT:  78%|███████▊  | 251/320 [02:31<00:52,  1.32it/s]          cache-cache_patch:torch-oblivious/inputs2 VALIDATE:  78%|███████▊  | 251/320 [02:34<00:52,  1.32it/s]    cache-cache_patch:torch-oblivious/inputs2 VALIDATE:  79%|███████▉  | 253/320 [02:34<01:07,  1.01s/it]    cache-cache_patch:torch-oblivious/inputs_empty_cache EXPORT:  79%|███████▉  | 253/320 [02:34<01:07,  1.01s/it]    cache-cache_patch:torch-oblivious/inputs_empty_cache VALIDATE:  79%|███████▉  | 253/320 [02:35<01:07,  1.01s/it]    cache-cache_patch:torch-oblivious/inputs_empty_cache VALIDATE:  79%|███████▉  | 254/320 [02:35<01:06,  1.01s/it]    cache-cache_patch:torch-oblivious/inputs_batch1 EXPORT:  79%|███████▉  | 254/320 [02:35<01:06,  1.01s/it]           cache-cache_patch:torch-oblivious/inputs_batch1 VALIDATE:  79%|███████▉  | 254/320 [02:36<01:06,  1.01s/it]    cache-cache_patch:torch-oblivious/inputs_batch1 VALIDATE:  80%|███████▉  | 255/320 [02:36<01:04,  1.00it/s]    cache-cache_patch:torch-oblivious-rt/inputs EXPORT:  80%|███████▉  | 255/320 [02:36<01:04,  1.00it/s]          cache-cache_patch:torch-oblivious-rt/inputs VALIDATE:  80%|███████▉  | 255/320 [02:37<01:04,  1.00it/s]    cache-cache_patch:torch-oblivious-rt/inputs VALIDATE:  80%|████████  | 256/320 [02:37<01:03,  1.01it/s]    cache-cache_patch:torch-oblivious-rt/inputs_prompt EXPORT:  80%|████████  | 256/320 [02:37<01:03,  1.01it/s]    cache-cache_patch:torch-oblivious-rt/inputs2 EXPORT:  80%|████████  | 256/320 [02:37<01:03,  1.01it/s]          cache-cache_patch:torch-oblivious-rt/inputs2 VALIDATE:  80%|████████  | 256/320 [02:38<01:03,  1.01it/s]    cache-cache_patch:torch-oblivious-rt/inputs2 VALIDATE:  81%|████████  | 258/320 [02:38<00:47,  1.31it/s]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache EXPORT:  81%|████████  | 258/320 [02:38<00:47,  1.31it/s]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache VALIDATE:  81%|████████  | 258/320 [02:39<00:47,  1.31it/s]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache VALIDATE:  81%|████████  | 259/320 [02:39<00:50,  1.22it/s]    cache-cache_patch:torch-oblivious-rt/inputs_batch1 EXPORT:  81%|████████  | 259/320 [02:39<00:50,  1.22it/s]           cache-cache_patch:torch-oblivious-rt/inputs_batch1 VALIDATE:  81%|████████  | 259/320 [02:40<00:50,  1.22it/s]    cache-cache_patch:torch-oblivious-rt/inputs_batch1 VALIDATE:  81%|████████▏ | 260/320 [02:40<00:50,  1.18it/s]    cache-cache_patch:torch-strict/inputs EXPORT:  81%|████████▏ | 260/320 [02:40<00:50,  1.18it/s]                   cache-cache_patch:torch-strict/inputs EXPORT:  82%|████████▏ | 261/320 [02:41<00:57,  1.03it/s]    cache-cache_patch:torch-strict/inputs_prompt EXPORT:  82%|████████▏ | 261/320 [02:41<00:57,  1.03it/s]    cache-cache_patch:torch-strict/inputs2 EXPORT:  82%|████████▏ | 261/320 [02:41<00:57,  1.03it/s]          cache-cache_patch:torch-strict/inputs2 EXPORT:  82%|████████▏ | 263/320 [02:42<00:46,  1.22it/s]    cache-cache_patch:torch-strict/inputs_empty_cache EXPORT:  82%|████████▏ | 263/320 [02:42<00:46,  1.22it/s]    cache-cache_patch:torch-strict/inputs_empty_cache EXPORT:  82%|████████▎ | 264/320 [02:44<00:50,  1.10it/s]    cache-cache_patch:torch-strict/inputs_batch1 EXPORT:  82%|████████▎ | 264/320 [02:44<00:50,  1.10it/s]         cache-cache_patch:torch-strict/inputs_batch1 EXPORT:  83%|████████▎ | 265/320 [02:45<01:00,  1.10s/it]    cache-cache_patch:torch-strict-rt/inputs EXPORT:  83%|████████▎ | 265/320 [02:45<01:00,  1.10s/it]        cache-cache_patch:torch-strict-rt/inputs EXPORT:  83%|████████▎ | 266/320 [02:47<01:12,  1.35s/it]    cache-cache_patch:torch-strict-rt/inputs_prompt EXPORT:  83%|████████▎ | 266/320 [02:47<01:12,  1.35s/it]    cache-cache_patch:torch-strict-rt/inputs2 EXPORT:  83%|████████▎ | 266/320 [02:47<01:12,  1.35s/it]          cache-cache_patch:torch-strict-rt/inputs2 EXPORT:  84%|████████▍ | 268/320 [02:49<01:02,  1.20s/it]    cache-cache_patch:torch-strict-rt/inputs_empty_cache EXPORT:  84%|████████▍ | 268/320 [02:49<01:02,  1.20s/it]    cache-cache_patch:torch-strict-rt/inputs_empty_cache EXPORT:  84%|████████▍ | 269/320 [02:51<01:09,  1.36s/it]    cache-cache_patch:torch-strict-rt/inputs_batch1 EXPORT:  84%|████████▍ | 269/320 [02:51<01:09,  1.36s/it]         cache-cache_patch:torch-strict-rt/inputs_batch1 EXPORT:  84%|████████▍ | 270/320 [02:53<01:13,  1.47s/it]    cache-cache_patch:torch-strict-oblivious/inputs EXPORT:  84%|████████▍ | 270/320 [02:53<01:13,  1.47s/it]    cache-cache_patch:torch-strict-oblivious/inputs EXPORT:  85%|████████▍ | 271/320 [02:57<01:42,  2.09s/it]    cache-cache_patch:torch-strict-oblivious/inputs_prompt EXPORT:  85%|████████▍ | 271/320 [02:57<01:42,  2.09s/it]    cache-cache_patch:torch-strict-oblivious/inputs2 EXPORT:  85%|████████▍ | 271/320 [02:57<01:42,  2.09s/it]          cache-cache_patch:torch-strict-oblivious/inputs2 EXPORT:  85%|████████▌ | 273/320 [02:59<01:15,  1.61s/it]    cache-cache_patch:torch-strict-oblivious/inputs_empty_cache EXPORT:  85%|████████▌ | 273/320 [02:59<01:15,  1.61s/it]    cache-cache_patch:torch-strict-oblivious/inputs_empty_cache EXPORT:  86%|████████▌ | 274/320 [03:00<01:15,  1.63s/it]    cache-cache_patch:torch-strict-oblivious/inputs_batch1 EXPORT:  86%|████████▌ | 274/320 [03:00<01:15,  1.63s/it]         cache-cache_patch:torch-strict-oblivious/inputs_batch1 EXPORT:  86%|████████▌ | 275/320 [03:03<01:28,  1.96s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs EXPORT:  86%|████████▌ | 275/320 [03:03<01:28,  1.96s/it]        cache-cache_patch:torch-strict-oblivious-rt/inputs EXPORT:  86%|████████▋ | 276/320 [03:07<01:43,  2.36s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs_prompt EXPORT:  86%|████████▋ | 276/320 [03:07<01:43,  2.36s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs2 EXPORT:  86%|████████▋ | 276/320 [03:07<01:43,  2.36s/it]          cache-cache_patch:torch-strict-oblivious-rt/inputs2 EXPORT:  87%|████████▋ | 278/320 [03:10<01:25,  2.04s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs_empty_cache EXPORT:  87%|████████▋ | 278/320 [03:10<01:25,  2.04s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs_empty_cache EXPORT:  87%|████████▋ | 279/320 [03:13<01:32,  2.26s/it]    cache-cache_patch:torch-strict-oblivious-rt/inputs_batch1 EXPORT:  87%|████████▋ | 279/320 [03:13<01:32,  2.26s/it]         cache-cache_patch:torch-strict-oblivious-rt/inputs_batch1 EXPORT:  88%|████████▊ | 280/320 [03:16<01:34,  2.37s/it]    cache-cache_patch:transformers/inputs EXPORT:  88%|████████▊ | 280/320 [03:16<01:34,  2.37s/it]                        cache-cache_patch:transformers/inputs VALIDATE:  88%|████████▊ | 280/320 [03:17<01:34,  2.37s/it]    cache-cache_patch:transformers/inputs VALIDATE:  88%|████████▊ | 281/320 [03:17<01:24,  2.16s/it]    cache-cache_patch:transformers/inputs_prompt EXPORT:  88%|████████▊ | 281/320 [03:17<01:24,  2.16s/it]    cache-cache_patch:transformers/inputs2 EXPORT:  88%|████████▊ | 281/320 [03:17<01:24,  2.16s/it]          cache-cache_patch:transformers/inputs2 VALIDATE:  88%|████████▊ | 281/320 [03:18<01:24,  2.16s/it]    cache-cache_patch:transformers/inputs2 VALIDATE:  88%|████████▊ | 283/320 [03:19<00:55,  1.49s/it]    cache-cache_patch:transformers/inputs_empty_cache EXPORT:  88%|████████▊ | 283/320 [03:19<00:55,  1.49s/it]    cache-cache_patch:transformers/inputs_empty_cache EXPORT:  89%|████████▉ | 284/320 [03:20<00:50,  1.40s/it]    cache-cache_patch:transformers/inputs_batch1 EXPORT:  89%|████████▉ | 284/320 [03:20<00:50,  1.40s/it]         cache-cache_patch:transformers/inputs_batch1 EXPORT:  89%|████████▉ | 285/320 [03:20<00:44,  1.26s/it]    cache-cache_patch:transformers-rt/inputs EXPORT:  89%|████████▉ | 285/320 [03:20<00:44,  1.26s/it]        cache-cache_patch:transformers-rt/inputs VALIDATE:  89%|████████▉ | 285/320 [03:22<00:44,  1.26s/it]    cache-cache_patch:transformers-rt/inputs VALIDATE:  89%|████████▉ | 286/320 [03:22<00:43,  1.27s/it]    cache-cache_patch:transformers-rt/inputs_prompt EXPORT:  89%|████████▉ | 286/320 [03:22<00:43,  1.27s/it]    cache-cache_patch:transformers-rt/inputs2 EXPORT:  89%|████████▉ | 286/320 [03:22<00:43,  1.27s/it]          cache-cache_patch:transformers-rt/inputs2 VALIDATE:  89%|████████▉ | 286/320 [03:23<00:43,  1.27s/it]    cache-cache_patch:transformers-rt/inputs2 VALIDATE:  90%|█████████ | 288/320 [03:23<00:32,  1.00s/it]    cache-cache_patch:transformers-rt/inputs_empty_cache EXPORT:  90%|█████████ | 288/320 [03:23<00:32,  1.00s/it]    cache-cache_patch:transformers-rt/inputs_empty_cache EXPORT:  90%|█████████ | 289/320 [03:24<00:31,  1.01s/it]    cache-cache_patch:transformers-rt/inputs_batch1 EXPORT:  90%|█████████ | 289/320 [03:24<00:31,  1.01s/it]         cache-cache_patch:transformers-rt/inputs_batch1 EXPORT:  91%|█████████ | 290/320 [03:25<00:28,  1.04it/s]    cache-cache_patch:transformers-oblivious/inputs EXPORT:  91%|█████████ | 290/320 [03:25<00:28,  1.04it/s]    cache-cache_patch:transformers-oblivious/inputs VALIDATE:  91%|█████████ | 290/320 [03:26<00:28,  1.04it/s]    cache-cache_patch:transformers-oblivious/inputs VALIDATE:  91%|█████████ | 291/320 [03:26<00:29,  1.02s/it]    cache-cache_patch:transformers-oblivious/inputs_prompt EXPORT:  91%|█████████ | 291/320 [03:26<00:29,  1.02s/it]    cache-cache_patch:transformers-oblivious/inputs2 EXPORT:  91%|█████████ | 291/320 [03:26<00:29,  1.02s/it]          cache-cache_patch:transformers-oblivious/inputs2 VALIDATE:  91%|█████████ | 291/320 [03:27<00:29,  1.02s/it]    cache-cache_patch:transformers-oblivious/inputs2 VALIDATE:  92%|█████████▏| 293/320 [03:27<00:22,  1.18it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache EXPORT:  92%|█████████▏| 293/320 [03:27<00:22,  1.18it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache VALIDATE:  92%|█████████▏| 293/320 [03:28<00:22,  1.18it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache VALIDATE:  92%|█████████▏| 294/320 [03:29<00:24,  1.08it/s]    cache-cache_patch:transformers-oblivious/inputs_batch1 EXPORT:  92%|█████████▏| 294/320 [03:29<00:24,  1.08it/s]           cache-cache_patch:transformers-oblivious/inputs_batch1 VALIDATE:  92%|█████████▏| 294/320 [03:30<00:24,  1.08it/s]    cache-cache_patch:transformers-oblivious/inputs_batch1 VALIDATE:  92%|█████████▏| 295/320 [03:30<00:25,  1.02s/it]    cache-cache_patch:transformers-oblivious-rt/inputs EXPORT:  92%|█████████▏| 295/320 [03:30<00:25,  1.02s/it]          cache-cache_patch:transformers-oblivious-rt/inputs VALIDATE:  92%|█████████▏| 295/320 [03:31<00:25,  1.02s/it]    cache-cache_patch:transformers-oblivious-rt/inputs VALIDATE:  92%|█████████▎| 296/320 [03:33<00:37,  1.57s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_prompt EXPORT:  92%|█████████▎| 296/320 [03:33<00:37,  1.57s/it]    cache-cache_patch:transformers-oblivious-rt/inputs2 EXPORT:  92%|█████████▎| 296/320 [03:33<00:37,  1.57s/it]          cache-cache_patch:transformers-oblivious-rt/inputs2 VALIDATE:  92%|█████████▎| 296/320 [03:34<00:37,  1.57s/it]    cache-cache_patch:transformers-oblivious-rt/inputs2 VALIDATE:  93%|█████████▎| 298/320 [03:34<00:25,  1.16s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache EXPORT:  93%|█████████▎| 298/320 [03:34<00:25,  1.16s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache VALIDATE:  93%|█████████▎| 298/320 [03:35<00:25,  1.16s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache VALIDATE:  93%|█████████▎| 299/320 [03:35<00:24,  1.19s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_batch1 EXPORT:  93%|█████████▎| 299/320 [03:35<00:24,  1.19s/it]           cache-cache_patch:transformers-oblivious-rt/inputs_batch1 VALIDATE:  93%|█████████▎| 299/320 [03:37<00:24,  1.19s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_batch1 VALIDATE:  94%|█████████▍| 300/320 [03:37<00:24,  1.20s/it]    cache-cache_patch:transformers-strict/inputs EXPORT:  94%|█████████▍| 300/320 [03:37<00:24,  1.20s/it]                   cache-cache_patch:transformers-strict/inputs EXPORT:  94%|█████████▍| 301/320 [03:38<00:22,  1.19s/it]    cache-cache_patch:transformers-strict/inputs_prompt EXPORT:  94%|█████████▍| 301/320 [03:38<00:22,  1.19s/it]    cache-cache_patch:transformers-strict/inputs2 EXPORT:  94%|█████████▍| 301/320 [03:38<00:22,  1.19s/it]          cache-cache_patch:transformers-strict/inputs2 EXPORT:  95%|█████████▍| 303/320 [03:39<00:15,  1.08it/s]    cache-cache_patch:transformers-strict/inputs_empty_cache EXPORT:  95%|█████████▍| 303/320 [03:39<00:15,  1.08it/s]    cache-cache_patch:transformers-strict/inputs_empty_cache EXPORT:  95%|█████████▌| 304/320 [03:40<00:15,  1.05it/s]    cache-cache_patch:transformers-strict/inputs_batch1 EXPORT:  95%|█████████▌| 304/320 [03:40<00:15,  1.05it/s]         cache-cache_patch:transformers-strict/inputs_batch1 EXPORT:  95%|█████████▌| 305/320 [03:41<00:14,  1.04it/s]    cache-cache_patch:transformers-strict-rt/inputs EXPORT:  95%|█████████▌| 305/320 [03:41<00:14,  1.04it/s]        cache-cache_patch:transformers-strict-rt/inputs EXPORT:  96%|█████████▌| 306/320 [03:42<00:13,  1.01it/s]    cache-cache_patch:transformers-strict-rt/inputs_prompt EXPORT:  96%|█████████▌| 306/320 [03:42<00:13,  1.01it/s]    cache-cache_patch:transformers-strict-rt/inputs2 EXPORT:  96%|█████████▌| 306/320 [03:42<00:13,  1.01it/s]          cache-cache_patch:transformers-strict-rt/inputs2 EXPORT:  96%|█████████▋| 308/320 [03:43<00:09,  1.23it/s]    cache-cache_patch:transformers-strict-rt/inputs_empty_cache EXPORT:  96%|█████████▋| 308/320 [03:43<00:09,  1.23it/s]    cache-cache_patch:transformers-strict-rt/inputs_empty_cache EXPORT:  97%|█████████▋| 309/320 [03:44<00:09,  1.14it/s]    cache-cache_patch:transformers-strict-rt/inputs_batch1 EXPORT:  97%|█████████▋| 309/320 [03:44<00:09,  1.14it/s]         cache-cache_patch:transformers-strict-rt/inputs_batch1 EXPORT:  97%|█████████▋| 310/320 [03:45<00:08,  1.13it/s]    cache-cache_patch:transformers-strict-oblivious/inputs EXPORT:  97%|█████████▋| 310/320 [03:45<00:08,  1.13it/s]    cache-cache_patch:transformers-strict-oblivious/inputs EXPORT:  97%|█████████▋| 311/320 [03:46<00:08,  1.06it/s]    cache-cache_patch:transformers-strict-oblivious/inputs_prompt EXPORT:  97%|█████████▋| 311/320 [03:46<00:08,  1.06it/s]    cache-cache_patch:transformers-strict-oblivious/inputs2 EXPORT:  97%|█████████▋| 311/320 [03:46<00:08,  1.06it/s]          cache-cache_patch:transformers-strict-oblivious/inputs2 EXPORT:  98%|█████████▊| 313/320 [03:47<00:05,  1.31it/s]    cache-cache_patch:transformers-strict-oblivious/inputs_empty_cache EXPORT:  98%|█████████▊| 313/320 [03:47<00:05,  1.31it/s]    cache-cache_patch:transformers-strict-oblivious/inputs_empty_cache EXPORT:  98%|█████████▊| 314/320 [03:48<00:04,  1.22it/s]    cache-cache_patch:transformers-strict-oblivious/inputs_batch1 EXPORT:  98%|█████████▊| 314/320 [03:48<00:04,  1.22it/s]         cache-cache_patch:transformers-strict-oblivious/inputs_batch1 EXPORT:  98%|█████████▊| 315/320 [03:49<00:04,  1.14it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs EXPORT:  98%|█████████▊| 315/320 [03:49<00:04,  1.14it/s]        cache-cache_patch:transformers-strict-oblivious-rt/inputs EXPORT:  99%|█████████▉| 316/320 [03:50<00:03,  1.10it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs_prompt EXPORT:  99%|█████████▉| 316/320 [03:50<00:03,  1.10it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs2 EXPORT:  99%|█████████▉| 316/320 [03:50<00:03,  1.10it/s]          cache-cache_patch:transformers-strict-oblivious-rt/inputs2 EXPORT:  99%|█████████▉| 318/320 [03:51<00:01,  1.35it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs_empty_cache EXPORT:  99%|█████████▉| 318/320 [03:51<00:01,  1.35it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs_empty_cache EXPORT: 100%|█████████▉| 319/320 [03:52<00:00,  1.25it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs_batch1 EXPORT: 100%|█████████▉| 319/320 [03:52<00:00,  1.25it/s]         cache-cache_patch:transformers-strict-oblivious-rt/inputs_batch1 EXPORT: 100%|██████████| 320/320 [03:54<00:00,  1.16it/s]    cache-cache_patch:transformers-strict-oblivious-rt/inputs_batch1 EXPORT: 100%|██████████| 320/320 [03:54<00:00,  1.37it/s]




.. GENERATED FROM PYTHON SOURCE LINES 215-216

Let's save the results.

.. GENERATED FROM PYTHON SOURCE LINES 216-221

.. code-block:: Python


    df = pandas.DataFrame(results)
    df.to_excel("plot_export_tiny_llm_dim01.xlsx")
    df






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th>EXPORT</th>
          <th>run_with</th>
          <th>WORKS</th>
          <th>ERR-RUN</th>
          <th>ERR-EXPORT</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0.0</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs2</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0.0</td>
          <td>Guard failed: attention_mask.size()[1] &gt;= 4</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>467</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>468</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>469</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs2</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>470</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>471</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
      </tbody>
    </table>
    <p>472 rows × 11 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 222-227

.. code-block:: Python


    no_export = df[df.EXPORT == 0]
    no_export.to_excel("plot_export_tiny_llm_dim01.no_export.xlsx")
    no_export






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th>EXPORT</th>
          <th>run_with</th>
          <th>WORKS</th>
          <th>ERR-RUN</th>
          <th>ERR-EXPORT</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>5</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>11</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>12</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>18</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>24</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>467</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>468</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>469</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs2</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>470</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
        <tr>
          <th>471</th>
          <td>1</td>
          <td>transformers</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Can't extract message from torch._check()</td>
        </tr>
      </tbody>
    </table>
    <p>132 rows × 11 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 228-229

The validation failures.

.. GENERATED FROM PYTHON SOURCE LINES 229-238

.. code-block:: Python


    invalid = df[(df.EXPORT == 1) & (df.WORKS == 0)].pivot(
        index=["cache", "cache_patch", "strict", "oblivious", "rt", "export_with"],
        columns=["run_with"],
        values=["WORKS", "ERR-RUN"],
    )
    invalid.to_excel("plot_export_tiny_llm_dim01.invalid.xlsx")
    invalid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th colspan="5" halign="left">WORKS</th>
          <th colspan="5" halign="left">ERR-RUN</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>run_with</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_batch1</th>
          <th>inputs_empty_cache</th>
          <th>inputs_prompt</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_batch1</th>
          <th>inputs_empty_cache</th>
          <th>inputs_prompt</th>
        </tr>
        <tr>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="4" valign="top">0</th>
          <th rowspan="2" valign="top">0</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: attention_mask.size()[1] &gt;= 4</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: attention_mask.size()[1] &gt;= 4</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">1</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: attention_mask.size()[1] &gt;= 4</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: attention_mask.size()[1] &gt;= 4</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>1</th>
          <th>0</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: position_ids.size()[0] != 1</td>
          <td>NaN</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">1</th>
          <th rowspan="5" valign="top">transformers</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">1</th>
          <th>0</th>
          <th>inputs_empty_cache</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Guard failed: position_ids.size()[0] != 1</td>
          <td>NaN</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th rowspan="4" valign="top">1</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Runtime assertion failed for expression Ne(s44...</td>
          <td>NaN</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Runtime assertion failed for expression Ne(s44...</td>
          <td>NaN</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>inputs_batch1</th>
          <td>0.0</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>Runtime assertion failed for expression Eq(s44...</td>
          <td>Guard failed: input_ids.size()[0] &lt;= 2</td>
          <td>NaN</td>
          <td>Runtime assertion failed for expression Eq(s44...</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
        <tr>
          <th>inputs_empty_cache</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Runtime assertion failed for expression Ne(s44...</td>
          <td>NaN</td>
          <td>Ran into a kwarg keyword mismatch: Got the fol...</td>
        </tr>
      </tbody>
    </table>
    <p>68 rows × 10 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 239-249

.. code-block:: Python


    success = df[(df.EXPORT == 1) & (df.WORKS == 1)].pivot(
        index=["cache", "cache_patch", "strict", "oblivious", "rt", "export_with"],
        columns=["run_with"],
        values=["WORKS"],
    )
    success.to_excel("plot_export_tiny_llm_dim01.success.xlsx")
    success







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th colspan="4" halign="left">WORKS</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>run_with</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_batch1</th>
          <th>inputs_empty_cache</th>
        </tr>
        <tr>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="4" valign="top">0</th>
          <th rowspan="2" valign="top">0</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">1</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <th>0</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">1</th>
          <th rowspan="5" valign="top">transformers</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">1</th>
          <th>0</th>
          <th>inputs_empty_cache</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th rowspan="4" valign="top">1</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs_batch1</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>1.0</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>inputs_empty_cache</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>1.0</td>
        </tr>
      </tbody>
    </table>
    <p>68 rows × 4 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 250-252

If you have any error, then look at example
:ref:`l-plot-tiny-llm-export-patched`.

.. GENERATED FROM PYTHON SOURCE LINES 252-254

.. code-block:: Python


    doc.plot_legend("Tiny-LLM\nexport with\ndimension in {0,1}", "torch.export.export", "tomato")



.. image-sg:: /auto_examples/images/sphx_glr_plot_export_tiny_llm_dim01_001.png
   :alt: plot export tiny llm dim01
   :srcset: /auto_examples/images/sphx_glr_plot_export_tiny_llm_dim01_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (3 minutes 54.430 seconds)


.. _sphx_glr_download_auto_examples_plot_export_tiny_llm_dim01.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_export_tiny_llm_dim01.ipynb <plot_export_tiny_llm_dim01.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_export_tiny_llm_dim01.py <plot_export_tiny_llm_dim01.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_export_tiny_llm_dim01.zip <plot_export_tiny_llm_dim01.zip>`


.. include:: plot_export_tiny_llm_dim01.recommendations


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
