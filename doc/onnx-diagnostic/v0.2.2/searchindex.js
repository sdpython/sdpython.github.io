Search.setIndex({"alltitles": {"0.1.0": [[0, "id3"]], "0.2.0": [[0, "id2"]], "0.2.1": [[0, "id1"]], "A failing model": [[52, "a-failing-model"], [53, "a-failing-model"], [54, "a-failing-model"]], "A model with a test": [[46, "a-model-with-a-test"]], "A model with an export issue": [[47, "a-model-with-an-export-issue"]], "API of onnx_diagnostic": [[7, null]], "Back to the original model": [[48, "back-to-the-original-model"]], "Change Logs": [[0, null]], "Computation times": [[55, null], [58, null]], "Contents": [[56, null]], "Detect an issue with shape Inference": [[52, "detect-an-issue-with-shape-inference"]], "DynamicCache": [[50, "dynamiccache"]], "Enlightening Examples": [[56, "enlightening-examples"]], "Errors": [[49, "errors"]], "Examples Gallery": [[45, null]], "Export Tiny-LLM with patches": [[49, null]], "Export a model with a control flow (If)": [[46, null]], "Export with DynamicCache and dynamic shapes": [[50, null]], "ExportedProgram": [[48, "exportedprogram"]], "ExtendedReferenceEvaluator": [[11, "extendedreferenceevaluator"], [54, "extendedreferenceevaluator"]], "Find and fix an export issue due to dynamic shapes": [[47, null]], "Find where a model is failing by running submodels": [[52, null]], "Getting started": [[56, "getting-started"]], "Intermediate results with (ONNX) ReferenceEvaluator": [[54, null]], "Intermediate results with onnxruntime": [[53, null]], "License": [[57, null]], "Looping over the nodes": [[52, "looping-over-the-nodes"]], "ModelInputs": [[4, "modelinputs"]], "More": [[56, null]], "Older versions": [[56, "older-versions"]], "OnnxruntimeEvaluator": [[11, "onnxruntimeevaluator"], [53, "onnxruntimeevaluator"]], "Other functions": [[4, "module-onnx_diagnostic.export"], [11, "module-onnx_diagnostic.reference"]], "Shape Inference": [[52, "shape-inference"]], "Simple Examples": [[50, "simple-examples"]], "Steel method forward to guess the dynamic shapes (with Tiny-LLM)": [[48, null]], "Steel the forward method": [[48, "steel-the-forward-method"]], "Stop when a dynamic dimension turns static": [[47, "stop-when-a-dynamic-dimension-turns-static"]], "Suggested Patch": [[46, "suggested-patch"]], "Untrained model": [[48, "untrained-model"]], "Use DYNAMIC or AUTO when exporting if dynamic shapes has constraints": [[51, null]], "With the original model": [[49, "with-the-original-model"]], "args": [[50, "args"]], "args and kwargs": [[50, "args-and-kwargs"]], "dx + dy not allowed?": [[51, "dx-dy-not-allowed"]], "kwargs": [[50, "kwargs"]], "modules": [[4, null], [7, null], [11, null], [12, null], [39, null]], "onnx-diagnostic: investigate onnx models": [[56, null]], "onnx_diagnostic.args": [[1, null]], "onnx_diagnostic.cache_helpers": [[2, null]], "onnx_diagnostic.export": [[4, null]], "onnx_diagnostic.export.dynamic_shapes": [[3, null]], "onnx_diagnostic.ext_test_case": [[5, null]], "onnx_diagnostic.helpers": [[6, null]], "onnx_diagnostic.onnx_tools": [[8, null]], "onnx_diagnostic.ort_session": [[9, null]], "onnx_diagnostic.reference": [[11, null]], "onnx_diagnostic.reference.evaluator": [[10, null]], "onnx_diagnostic.reference.ops": [[12, null]], "onnx_diagnostic.reference.ops.op_add_add_mul_mul": [[13, null]], "onnx_diagnostic.reference.ops.op_average_pool_grad": [[14, null]], "onnx_diagnostic.reference.ops.op_cast_like": [[15, null]], "onnx_diagnostic.reference.ops.op_complex": [[16, null]], "onnx_diagnostic.reference.ops.op_concat": [[17, null]], "onnx_diagnostic.reference.ops.op_constant_of_shape": [[18, null]], "onnx_diagnostic.reference.ops.op_fused_matmul": [[19, null]], "onnx_diagnostic.reference.ops.op_gather_grad": [[20, null]], "onnx_diagnostic.reference.ops.op_memcpy_host": [[21, null]], "onnx_diagnostic.reference.ops.op_mul_sigmoid": [[22, null]], "onnx_diagnostic.reference.ops.op_negxplus1": [[23, null]], "onnx_diagnostic.reference.ops.op_qlinear_average_pool": [[24, null]], "onnx_diagnostic.reference.ops.op_qlinear_conv": [[25, null]], "onnx_diagnostic.reference.ops.op_quick_gelu": [[26, null]], "onnx_diagnostic.reference.ops.op_replace_zero": [[27, null]], "onnx_diagnostic.reference.ops.op_rotary": [[28, null]], "onnx_diagnostic.reference.ops.op_scatter_elements": [[29, null]], "onnx_diagnostic.reference.ops.op_scatternd_of_shape": [[30, null]], "onnx_diagnostic.reference.ops.op_simplified_layer_normalization": [[31, null]], "onnx_diagnostic.reference.ops.op_skip_layer_normalization": [[32, null]], "onnx_diagnostic.reference.ops.op_slice": [[33, null]], "onnx_diagnostic.reference.ops.op_transpose_cast": [[34, null]], "onnx_diagnostic.reference.ops.op_tri_matrix": [[35, null]], "onnx_diagnostic.reference.ort_evaluator": [[36, null]], "onnx_diagnostic.reference.quantized_tensor": [[37, null]], "onnx_diagnostic.torch_export_patches": [[38, null]], "onnx_diagnostic.torch_export_patches.patches": [[39, null]], "onnx_diagnostic.torch_export_patches.patches.patch_torch": [[40, null]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers": [[41, null]], "onnx_diagnostic.torch_models": [[42, null]], "onnx_diagnostic.torch_models.llms": [[43, null]], "onnx_diagnostic.torch_test_helper": [[44, null]], "submodules": [[7, null], [11, null], [38, null], [42, null]]}, "docnames": ["CHANGELOGS", "api/args", "api/cache_helpers", "api/export/dynamic_shapes", "api/export/index", "api/ext_test_case", "api/helpers", "api/index", "api/onnx_tools", "api/ort_session", "api/reference/evaluator", "api/reference/index", "api/reference/ops/index", "api/reference/ops/op_add_add_mul_mul", "api/reference/ops/op_average_pool_grad", "api/reference/ops/op_cast_like", "api/reference/ops/op_complex", "api/reference/ops/op_concat", "api/reference/ops/op_constant_of_shape", "api/reference/ops/op_fused_matmul", "api/reference/ops/op_gather_grad", "api/reference/ops/op_memcpy_host", "api/reference/ops/op_mul_sigmoid", "api/reference/ops/op_negxplus1", "api/reference/ops/op_qlinear_average_pool", "api/reference/ops/op_qlinear_conv", "api/reference/ops/op_quick_gelu", "api/reference/ops/op_replace_zero", "api/reference/ops/op_rotary", "api/reference/ops/op_scatter_elements", "api/reference/ops/op_scatternd_of_shape", "api/reference/ops/op_simplified_layer_normalization", "api/reference/ops/op_skip_layer_normalization", "api/reference/ops/op_slice", "api/reference/ops/op_transpose_cast", "api/reference/ops/op_tri_matrix", "api/reference/ort_evaluator", "api/reference/quantized_tensor", "api/torch_export_patches/index", "api/torch_export_patches/patches/index", "api/torch_export_patches/patches/patch_torch", "api/torch_export_patches/patches/patch_transformers", "api/torch_models/index", "api/torch_models/llms", "api/torch_test_helper", "auto_examples/index", "auto_examples/plot_export_cond", "auto_examples/plot_export_locate_issue", "auto_examples/plot_export_tiny_llm", "auto_examples/plot_export_tiny_llm_patched", "auto_examples/plot_export_with_dynamic_cache", "auto_examples/plot_export_with_dynamic_shapes_auto", "auto_examples/plot_failing_model_extract", "auto_examples/plot_failing_onnxruntime_evaluator", "auto_examples/plot_failing_reference_evaluator", "auto_examples/sg_execution_times", "index", "license", "sg_execution_times"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["CHANGELOGS.rst", "api/args.rst", "api/cache_helpers.rst", "api/export/dynamic_shapes.rst", "api/export/index.rst", "api/ext_test_case.rst", "api/helpers.rst", "api/index.rst", "api/onnx_tools.rst", "api/ort_session.rst", "api/reference/evaluator.rst", "api/reference/index.rst", "api/reference/ops/index.rst", "api/reference/ops/op_add_add_mul_mul.rst", "api/reference/ops/op_average_pool_grad.rst", "api/reference/ops/op_cast_like.rst", "api/reference/ops/op_complex.rst", "api/reference/ops/op_concat.rst", "api/reference/ops/op_constant_of_shape.rst", "api/reference/ops/op_fused_matmul.rst", "api/reference/ops/op_gather_grad.rst", "api/reference/ops/op_memcpy_host.rst", "api/reference/ops/op_mul_sigmoid.rst", "api/reference/ops/op_negxplus1.rst", "api/reference/ops/op_qlinear_average_pool.rst", "api/reference/ops/op_qlinear_conv.rst", "api/reference/ops/op_quick_gelu.rst", "api/reference/ops/op_replace_zero.rst", "api/reference/ops/op_rotary.rst", "api/reference/ops/op_scatter_elements.rst", "api/reference/ops/op_scatternd_of_shape.rst", "api/reference/ops/op_simplified_layer_normalization.rst", "api/reference/ops/op_skip_layer_normalization.rst", "api/reference/ops/op_slice.rst", "api/reference/ops/op_transpose_cast.rst", "api/reference/ops/op_tri_matrix.rst", "api/reference/ort_evaluator.rst", "api/reference/quantized_tensor.rst", "api/torch_export_patches/index.rst", "api/torch_export_patches/patches/index.rst", "api/torch_export_patches/patches/patch_torch.rst", "api/torch_export_patches/patches/patch_transformers.rst", "api/torch_models/index.rst", "api/torch_models/llms.rst", "api/torch_test_helper.rst", "auto_examples/index.rst", "auto_examples/plot_export_cond.rst", "auto_examples/plot_export_locate_issue.rst", "auto_examples/plot_export_tiny_llm.rst", "auto_examples/plot_export_tiny_llm_patched.rst", "auto_examples/plot_export_with_dynamic_cache.rst", "auto_examples/plot_export_with_dynamic_shapes_auto.rst", "auto_examples/plot_failing_model_extract.rst", "auto_examples/plot_failing_onnxruntime_evaluator.rst", "auto_examples/plot_failing_reference_evaluator.rst", "auto_examples/sg_execution_times.rst", "index.rst", "license.rst", "sg_execution_times.rst"], "indexentries": {}, "objects": {"": [[7, 0, 0, "-", "onnx_diagnostic"]], "onnx_diagnostic": [[1, 0, 0, "-", "args"], [2, 0, 0, "-", "cache_helpers"], [4, 0, 0, "-", "export"], [5, 0, 0, "-", "ext_test_case"], [6, 0, 0, "-", "helpers"], [8, 0, 0, "-", "onnx_tools"], [9, 0, 0, "-", "ort_session"], [11, 0, 0, "-", "reference"], [38, 0, 0, "-", "torch_export_patches"], [42, 0, 0, "-", "torch_models"], [44, 0, 0, "-", "torch_test_helper"]], "onnx_diagnostic.args": [[1, 1, 1, "", "check_cuda_availability"], [1, 1, 1, "", "get_parsed_args"]], "onnx_diagnostic.cache_helpers": [[2, 1, 1, "", "is_cache_dynamic_registered"], [2, 1, 1, "", "make_dynamic_cache"]], "onnx_diagnostic.export": [[4, 2, 1, "", "ModelInputs"], [3, 0, 0, "-", "dynamic_shapes"]], "onnx_diagnostic.export.ModelInputs": [[4, 3, 1, "", "full_name"], [4, 4, 1, "", "guess_dynamic_dimensions"], [4, 4, 1, "", "guess_dynamic_shape_object"], [4, 4, 1, "", "guess_dynamic_shapes"], [4, 3, 1, "", "module_name_type"], [4, 4, 1, "", "move_to_kwargs"], [4, 4, 1, "", "process_inputs"], [4, 3, 1, "", "true_model_name"]], "onnx_diagnostic.export.dynamic_shapes": [[3, 2, 1, "", "ModelInputs"]], "onnx_diagnostic.export.dynamic_shapes.ModelInputs": [[3, 3, 1, "", "full_name"], [3, 4, 1, "", "guess_dynamic_dimensions"], [3, 4, 1, "", "guess_dynamic_shape_object"], [3, 4, 1, "", "guess_dynamic_shapes"], [3, 3, 1, "", "module_name_type"], [3, 4, 1, "", "move_to_kwargs"], [3, 4, 1, "", "process_inputs"], [3, 3, 1, "", "true_model_name"]], "onnx_diagnostic.ext_test_case": [[5, 2, 1, "", "ExtTestCase"], [5, 1, 1, "", "get_figure"], [5, 1, 1, "", "has_cuda"], [5, 1, 1, "", "has_onnxruntime_training"], [5, 1, 1, "", "has_onnxscript"], [5, 1, 1, "", "has_torch"], [5, 1, 1, "", "has_transformers"], [5, 1, 1, "", "hide_stdout"], [5, 1, 1, "", "ignore_warnings"], [5, 1, 1, "", "is_azure"], [5, 1, 1, "", "long_test"], [5, 1, 1, "", "measure_time"], [5, 1, 1, "", "never_test"], [5, 1, 1, "", "requires_cuda"], [5, 1, 1, "", "requires_diffusers"], [5, 1, 1, "", "requires_numpy"], [5, 1, 1, "", "requires_onnx"], [5, 1, 1, "", "requires_onnx_array_api"], [5, 1, 1, "", "requires_onnxruntime"], [5, 1, 1, "", "requires_onnxruntime_training"], [5, 1, 1, "", "requires_onnxscript"], [5, 1, 1, "", "requires_sklearn"], [5, 1, 1, "", "requires_torch"], [5, 1, 1, "", "requires_transformers"], [5, 1, 1, "", "requires_zoo"], [5, 1, 1, "", "skipif_ci_apple"], [5, 1, 1, "", "skipif_ci_linux"], [5, 1, 1, "", "skipif_ci_windows"], [5, 1, 1, "", "statistics_on_file"], [5, 1, 1, "", "statistics_on_folder"], [5, 1, 1, "", "unit_test_going"]], "onnx_diagnostic.ext_test_case.ExtTestCase": [[5, 4, 1, "", "assertAlmostEqual"], [5, 4, 1, "", "assertEmpty"], [5, 4, 1, "", "assertEqual"], [5, 4, 1, "", "assertEqualArray"], [5, 4, 1, "", "assertEqualArrays"], [5, 4, 1, "", "assertExists"], [5, 4, 1, "", "assertGreaterOrEqual"], [5, 4, 1, "", "assertIn"], [5, 4, 1, "", "assertNotEmpty"], [5, 4, 1, "", "assertRaise"], [5, 4, 1, "", "assertSetContained"], [5, 4, 1, "", "assertStartsWith"], [5, 4, 1, "", "assert_onnx_disc"], [5, 4, 1, "", "capture"], [5, 4, 1, "", "dump_onnx"], [5, 4, 1, "", "get_dump_file"], [5, 4, 1, "", "print_model"], [5, 4, 1, "", "print_onnx"], [5, 4, 1, "", "setUpClass"], [5, 4, 1, "", "tearDownClass"], [5, 4, 1, "", "todo"], [5, 4, 1, "", "tryCall"]], "onnx_diagnostic.helpers": [[6, 1, 1, "", "convert_endian"], [6, 1, 1, "", "dtype_to_tensor_dtype"], [6, 1, 1, "", "flatten_object"], [6, 1, 1, "", "from_array_extended"], [6, 1, 1, "", "from_array_ml_dtypes"], [6, 1, 1, "", "get_onnx_signature"], [6, 1, 1, "", "make_hash"], [6, 1, 1, "", "max_diff"], [6, 1, 1, "", "np_dtype_to_tensor_dtype"], [6, 1, 1, "", "onnx_dtype_name"], [6, 1, 1, "", "onnx_dtype_to_np_dtype"], [6, 1, 1, "", "onnx_dtype_to_torch_dtype"], [6, 1, 1, "", "pretty_onnx"], [6, 1, 1, "", "proto_from_tensor"], [6, 1, 1, "", "rename_dynamic_dimensions"], [6, 1, 1, "", "rename_dynamic_expression"], [6, 1, 1, "", "size_type"], [6, 1, 1, "", "string_diff"], [6, 1, 1, "", "string_sig"], [6, 1, 1, "", "string_signature"], [6, 1, 1, "", "string_type"], [6, 1, 1, "", "tensor_dtype_to_np_dtype"], [6, 1, 1, "", "to_array_extended"], [6, 1, 1, "", "torch_dtype_to_onnx_dtype"], [6, 1, 1, "", "type_info"]], "onnx_diagnostic.onnx_tools": [[8, 1, 1, "", "onnx_find"], [8, 1, 1, "", "onnx_lighten"], [8, 1, 1, "", "onnx_unlighten"]], "onnx_diagnostic.ort_session": [[9, 2, 1, "", "InferenceSessionForNumpy"], [9, 2, 1, "", "InferenceSessionForTorch"], [9, 1, 1, "", "investigate_onnxruntime_issue"]], "onnx_diagnostic.ort_session.InferenceSessionForNumpy": [[9, 4, 1, "", "run"], [9, 4, 1, "", "run_dlpack"]], "onnx_diagnostic.ort_session.InferenceSessionForTorch": [[9, 4, 1, "", "run"], [9, 4, 1, "", "run_dlpack"], [9, 4, 1, "", "run_training_api"]], "onnx_diagnostic.reference": [[11, 2, 1, "", "ExtendedReferenceEvaluator"], [11, 2, 1, "", "OnnxruntimeEvaluator"], [10, 0, 0, "-", "evaluator"], [12, 0, 0, "-", "ops"], [36, 0, 0, "-", "ort_evaluator"], [37, 0, 0, "-", "quantized_tensor"]], "onnx_diagnostic.reference.ExtendedReferenceEvaluator": [[11, 4, 1, "", "run"]], "onnx_diagnostic.reference.OnnxruntimeEvaluator": [[11, 3, 1, "", "input_names"], [11, 3, 1, "", "input_types"], [11, 3, 1, "", "output_names"], [11, 3, 1, "", "output_types"], [11, 4, 1, "", "run"]], "onnx_diagnostic.reference.ops": [[13, 0, 0, "-", "op_add_add_mul_mul"], [14, 0, 0, "-", "op_average_pool_grad"], [15, 0, 0, "-", "op_cast_like"], [16, 0, 0, "-", "op_complex"], [17, 0, 0, "-", "op_concat"], [18, 0, 0, "-", "op_constant_of_shape"], [19, 0, 0, "-", "op_fused_matmul"], [20, 0, 0, "-", "op_gather_grad"], [21, 0, 0, "-", "op_memcpy_host"], [22, 0, 0, "-", "op_mul_sigmoid"], [23, 0, 0, "-", "op_negxplus1"], [24, 0, 0, "-", "op_qlinear_average_pool"], [25, 0, 0, "-", "op_qlinear_conv"], [26, 0, 0, "-", "op_quick_gelu"], [27, 0, 0, "-", "op_replace_zero"], [28, 0, 0, "-", "op_rotary"], [29, 0, 0, "-", "op_scatter_elements"], [30, 0, 0, "-", "op_scatternd_of_shape"], [31, 0, 0, "-", "op_simplified_layer_normalization"], [32, 0, 0, "-", "op_skip_layer_normalization"], [33, 0, 0, "-", "op_slice"], [34, 0, 0, "-", "op_transpose_cast"], [35, 0, 0, "-", "op_tri_matrix"]], "onnx_diagnostic.reference.ops.op_add_add_mul_mul": [[13, 2, 1, "", "AddAdd"], [13, 2, 1, "", "AddMul"], [13, 2, 1, "", "AddSharedInput"], [13, 2, 1, "", "MulAdd"], [13, 2, 1, "", "MulMul"], [13, 2, 1, "", "MulSharedInput"], [13, 2, 1, "", "MulSub"], [13, 2, 1, "", "SubMul"]], "onnx_diagnostic.reference.ops.op_average_pool_grad": [[14, 2, 1, "", "AveragePoolGrad"]], "onnx_diagnostic.reference.ops.op_cast_like": [[15, 2, 1, "", "CastLike_15"], [15, 2, 1, "", "CastLike_19"]], "onnx_diagnostic.reference.ops.op_complex": [[16, 2, 1, "", "ComplexModule"], [16, 2, 1, "", "ToComplex"]], "onnx_diagnostic.reference.ops.op_concat": [[17, 2, 1, "", "Concat"]], "onnx_diagnostic.reference.ops.op_constant_of_shape": [[18, 2, 1, "", "ConstantOfShape"]], "onnx_diagnostic.reference.ops.op_fused_matmul": [[19, 2, 1, "", "FusedMatMul"]], "onnx_diagnostic.reference.ops.op_gather_grad": [[20, 2, 1, "", "GatherGrad"]], "onnx_diagnostic.reference.ops.op_memcpy_host": [[21, 2, 1, "", "MemcpyFromHost"], [21, 2, 1, "", "MemcpyToHost"]], "onnx_diagnostic.reference.ops.op_mul_sigmoid": [[22, 2, 1, "", "MulSigmoid"]], "onnx_diagnostic.reference.ops.op_negxplus1": [[23, 2, 1, "", "NegXplus1"]], "onnx_diagnostic.reference.ops.op_qlinear_average_pool": [[24, 2, 1, "", "QLinearAveragePool"]], "onnx_diagnostic.reference.ops.op_qlinear_conv": [[25, 2, 1, "", "QLinearConv"]], "onnx_diagnostic.reference.ops.op_quick_gelu": [[26, 2, 1, "", "QuickGelu"]], "onnx_diagnostic.reference.ops.op_replace_zero": [[27, 2, 1, "", "ReplaceZero"]], "onnx_diagnostic.reference.ops.op_rotary": [[28, 2, 1, "", "Rotary"]], "onnx_diagnostic.reference.ops.op_scatter_elements": [[29, 2, 1, "", "ScatterElements"]], "onnx_diagnostic.reference.ops.op_scatternd_of_shape": [[30, 2, 1, "", "MaskedScatterNDOfShape"], [30, 2, 1, "", "ScatterNDOfShape"]], "onnx_diagnostic.reference.ops.op_simplified_layer_normalization": [[31, 2, 1, "", "SimplifiedLayerNormalization"]], "onnx_diagnostic.reference.ops.op_skip_layer_normalization": [[32, 2, 1, "", "SkipLayerNormalization"]], "onnx_diagnostic.reference.ops.op_slice": [[33, 2, 1, "", "Slice_1"], [33, 2, 1, "", "Slice_10"]], "onnx_diagnostic.reference.ops.op_transpose_cast": [[34, 2, 1, "", "Transpose2DCastFP16"], [34, 2, 1, "", "Transpose2DCastFP32"]], "onnx_diagnostic.reference.ops.op_tri_matrix": [[35, 2, 1, "", "TriMatrix"]], "onnx_diagnostic.reference.quantized_tensor": [[37, 2, 1, "", "QuantizedTensor"]], "onnx_diagnostic.reference.quantized_tensor.QuantizedTensor": [[37, 3, 1, "", "qtensor"], [37, 3, 1, "", "scale"], [37, 3, 1, "", "shape"], [37, 3, 1, "", "zero_point"]], "onnx_diagnostic.torch_export_patches": [[38, 1, 1, "", "bypass_export_some_errors"], [39, 0, 0, "-", "patches"], [38, 1, 1, "", "register_additional_serialization_functions"]], "onnx_diagnostic.torch_export_patches.patches": [[40, 0, 0, "-", "patch_torch"], [41, 0, 0, "-", "patch_transformers"]], "onnx_diagnostic.torch_export_patches.patches.patch_torch": [[40, 1, 1, "", "patch__check_input_constraints_for_graph"], [40, 2, 1, "", "patched_ShapeEnv"], [40, 1, 1, "", "patched__broadcast_shapes"], [40, 1, 1, "", "patched_infer_size"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers": [[41, 2, 1, "", "patched_AttentionMaskConverter"], [41, 2, 1, "", "patched_DynamicCache"], [41, 2, 1, "", "patched_GenerationMixin"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_DynamicCache": [[41, 4, 1, "", "crop"], [41, 4, 1, "", "from_batch_splits"], [41, 4, 1, "", "get_seq_length"], [41, 4, 1, "", "reorder_cache"], [41, 4, 1, "", "update"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_GenerationMixin": [[41, 4, 1, "", "prepare_inputs_for_generation"]], "onnx_diagnostic.torch_models": [[43, 0, 0, "-", "llms"]], "onnx_diagnostic.torch_models.llms": [[43, 1, 1, "", "get_phi2"], [43, 1, 1, "", "get_tiny_llm"]], "onnx_diagnostic.torch_test_helper": [[44, 1, 1, "", "check_model_ort"], [44, 1, 1, "", "dummy_llm"], [44, 1, 1, "", "is_torchdynamo_exporting"], [44, 1, 1, "", "to_numpy"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "property", "Python property"], "4": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:property", "4": "py:method"}, "terms": {"": [6, 38, 46, 47, 48, 49, 52, 53, 54], "0": [1, 3, 4, 5, 6, 8, 9, 11, 37, 38, 40, 41, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 58], "00": [55, 58], "000": [55, 58], "001": 5, "0021": [], "0024": [], "0040": 50, "004064715622091023": 48, "0042": 50, "00439453125": 6, "0045914474782276175": 48, "00465187738084796": 48, "0046593989174174896": 48, "004670132180078023": 48, "004711315192932059": 48, "004745883260943909": 48, "00490483474958915": 48, "004946331530976694": 48, "00515750024143455": 48, "0052": 50, "005234265772050212": 48, "005242380537907189": 48, "005347465156880775": 48, "005362754381385078": 48, "005399935928891056": 48, "0054": 50, "005460804806473387": 48, "005540032730943985": 48, "005612376343678323": 48, "005613603910806627": 48, "005620337307131454": 48, "005623818974484607": 48, "005670651629194018": 48, "005672597131955803": 48, "005882191799989467": 48, "0060061092495356854": 48, "0061109000237391025": 48, "006212282752589441": 48, "006257893364750089": 48, "006281428459469434": 48, "0064081840467255635": 48, "006566355677001584": 48, "006578563628465872": 48, "00661465932787406": 48, "0066723718805153315": 48, "0067138671875": 53, "00714091036518817": 48, "007227749521139988": 48, "0076829137735568934": 48, "007809057273613705": 48, "0078125": [], "007871791164327591": 48, "00837615266990807": 48, "008463278700810406": 48, "008778290737794762": 48, "0087890625": 6, "0090": [], "0095": [], "01": [], "0101": 50, "0108": 47, "010898790322244167": 54, "01171875": 53, "0120": 50, "0133": 50, "0168": 47, "0174": 50, "0190": 50, "019287109375": 53, "01953125": 53, "02": [], "0209": 47, "0214": 47, "0219": [], "0233": [], "0234375": 53, "0243": [], "0249": [], "0250": 50, "0271": [], "0298": 50, "03": 56, "0301e": [], "03125": 53, "0320": 50, "0330": 50, "03401044011116028": 54, "0342": 50, "0352": [], "0362": 50, "0437": [], "0462": [], "046875": 53, "0485": [], "0490": 50, "04915718734264374": 54, "05": [5, 44, 48, 49], "0511": [], "052025128155947e": 5, "052847862243652": 48, "054": 54, "0541": 50, "054443359375": [], "055616240948438644": 54, "0559": 50, "05637273617952703": 48, "0570": [], "05760709743605032": 48, "0580": 50, "05824511129190177": 48, "05859375": [], "05882268034876217": 48, "058899736090880755": 48, "060946521573455495": 48, "0613": [], "0614": 50, "0617": 50, "061756996103297775": 48, "0625": 6, "0627": 50, "06273026103340343": 48, "0628541645154012": 48, "06562370558746504": 48, "0659": 50, "06591796875": [], "0662": 50, "06640625": [], "0666": 50, "06949802690050683": 48, "07": 5, "07012538888073665": 48, "07316075543306536": 48, "07514602015667368": 48, "0752": [], "07634669775328533": 48, "0768": 50, "078125": [], "07817058410283709": 48, "07948427112209103": 48, "08": 5, "08051488317592732": 48, "08056640625": 53, "0819": [], "08203125": 53, "0851": 50, "08525467339006687": 48, "0878": [], "0883": [], "0890": [], "0892": 50, "0894": [], "0896": [], "0897": [], "08984375": [], "0899": [], "09": 5, "0919": 47, "09255540540483101": 48, "0940": [], "0941": [], "0943": [], "0954": [], "09692871276567383": 48, "0987": [], "0x7f3a2d3946e0": 48, "0x7f3a2d8853a0": 48, "0x7f3a38ff0110": [], "1": [1, 3, 4, 5, 6, 9, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "10": [1, 5, 6, 9, 11, 48, 49, 53, 54], "100": 44, "101": 5, "1014": 50, "1015625": 53, "102": 47, "10206207261596575": [48, 49], "1024": [44, 48, 49], "1025098547061134": 48, "1028": [], "10284": 5, "102940": 56, "10320": 56, "1036": [], "1039e": [], "1044": 50, "1069": [], "1072": 47, "108": 49, "1086": [], "1089": [], "1091": 5, "10919084175403429": 48, "109375": [], "1097": [], "1099": 47, "11": [0, 5, 48], "1108": [], "111": 50, "1112": [], "1115": 56, "11230627737766041": 48, "11251380358313327": 48, "11282": 5, "11321351693110653": 48, "11352129460079374": 48, "1139": 5, "11391830670491901": 48, "11419484736873436": 48, "1147": [], "115": 5, "1154754161834717": 48, "1161": 5, "1163": 50, "118": [], "11858383356172006": 48, "1187": 47, "12": [46, 47, 48, 49, 50, 51, 53, 55, 58], "1203": 50, "122": 47, "1220": 50, "12225772721065671": 48, "12251733124104053": 48, "1233257284622798": 48, "12379566539572504": 48, "1240": 50, "1242": 47, "12438850456218413": 48, "125": [46, 48, 49], "1255": [], "12714": 5, "128": 44, "1282": 47, "1283": [48, 50], "1288": [], "1290": 47, "1292427302262998": 48, "13": [5, 48, 49], "1302": 47, "1316": [], "13278416968655837": 48, "133": [48, 49], "1333": 56, "1337": 47, "1338236682991515": 48, "134": [48, 49], "13467349399519055": 48, "1348": [], "1349": [], "1352": [], "13599621835535985": 48, "136": 5, "1368": [], "139": [48, 49], "1392": 47, "13926869702104508": 48, "1393": 47, "14": [5, 48, 56], "140": [5, 48, 49], "1405": 5, "14064827534512556": 48, "141": [48, 49], "1419": 5, "142": [44, 48, 49], "1423": [], "1433": 50, "1434e": [], "14453125": 53, "145": [48, 49], "146": [48, 49], "1461": 50, "147": 5, "14760": 5, "1479": 47, "148": [46, 47, 48, 49, 50, 51], "1483": 5, "1493e": [], "15": [5, 48, 56], "1508": 50, "1519": [], "1522": 50, "15234375": [], "1527": 47, "155": 50, "1552": [], "15625": [], "15649": 48, "1569e": [], "1571": 47, "1574e": [], "1576": 50, "1583": 50, "1589762568473816": 54, "16": [0, 5, 44, 48, 51], "1623": 47, "1625": [], "1639": 48, "1650390625": [], "166": 56, "1675": 50, "17": [5, 48], "1703": 47, "1708984375": [], "172": 44, "1724": 48, "1751": 47, "1762": 47, "1770": 50, "1775": [], "1787109375": 53, "1793": 50, "17942315340042114": 54, "18": [9, 48, 52, 53, 54, 56], "1808": 50, "1812": [], "1821": 47, "1823": 47, "1828": 47, "18359375": 53, "1838": 50, "184": 47, "1844": 47, "18528": 5, "1853": [], "1875": [], "1884": [], "1884765625": 53, "1886": [], "1896": 47, "19": 48, "190": [44, 48, 49], "1907": 50, "1914": 48, "1916": 47, "192": [48, 49], "1925": 48, "1935": [], "1940": 50, "1943": 50, "195": 44, "197": [48, 49], "1972e": [], "1973": 47, "1987": 47, "19921875": [], "1999": 50, "1e": [5, 44, 48, 49], "1hsuttvvyh1ptew89rtpeu84ht3nqeftyhax3ypa_xj": 46, "2": [1, 2, 5, 6, 9, 43, 44, 46, 47, 48, 49, 50, 51, 52, 56], "20": [5, 48, 51], "2020": 48, "2025": [50, 56, 57], "203125": [], "2037": [], "204": [], "2041": 47, "2046": 50, "205": 44, "2066": [], "2070": [], "20703125": 53, "208": 44, "21": [48, 56], "210": 44, "2107": 48, "2111": 47, "213": 5, "21484375": 53, "2154": 50, "216": [5, 53, 55, 58], "2160": [], "2162": 47, "2181": 50, "2187": [], "2188e": [], "219": 5, "2191": 47, "22": 48, "220": 5, "2201": 50, "2202": 5, "2203": 50, "2218": 50, "2229": [], "2236e": [], "224": 5, "2253": [47, 48], "2267": 5, "226877689361572": 48, "2275390625": [], "2286": [], "23": 48, "2304": [], "2314": 47, "2329": 50, "2330": [], "234375": 53, "2355": 48, "2358": [], "23828125": 53, "24": [5, 48], "240234375": [], "2421875": [], "2430": 50, "24373231828212738": 54, "2462": [], "247": 44, "2471": [], "2482": 50, "25": [46, 47, 48], "2517": 5, "2538": [], "254": [], "2543": 50, "2544": 50, "255": 37, "257": 50, "2573": 50, "2578125": [], "2582": 5, "2595": [], "2597": [], "25986": 5, "26": [48, 56], "2604": 50, "2620": 50, "263": [47, 48], "2633": 50, "2633e": [], "2650": 5, "2655734419822693": 54, "2667e": [], "2688": [], "2693": 47, "27": [5, 47, 48], "2714": [], "2719": [], "274": 47, "2756": 50, "276": 5, "2763": [], "2765": 50, "2769": 50, "277": [48, 49], "27734375": 53, "278": [48, 49], "279": [48, 49], "2793": 50, "28": 48, "2804253101348877": 54, "282": [48, 49], "2838": [], "2846e": [], "2851": 50, "28515625": 53, "2856": [], "287": [48, 49], "2874": [], "2878": 5, "29": 48, "2932": [], "294": 44, "2948": 50, "294921875": 53, "295": 5, "2954": [], "296": 47, "296875": 53, "2983": [], "29889": 48, "29892": 48, "299": [48, 49], "29901": 48, "29908": 48, "29915": 48, "29956": 48, "2996": [], "29973": 48, "3": [2, 3, 4, 5, 6, 9, 43, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "30": [43, 48], "3013": [], "3025": [], "3032": 50, "3038": [], "304": 48, "3046875": 53, "306": 48, "3073": 50, "3092": [], "31": [5, 48, 56], "310": [48, 49], "3105": [], "3110": 50, "3125": 53, "316": 47, "3166": [], "317": 5, "3173": 5, "32": [44, 48], "32000": [48, 49], "32045426964759827": 54, "3226": [], "3267": [], "3290": [], "33": [5, 48], "3323": [], "3332": [], "3341": 50, "3348": [], "3355": 50, "3359375": 53, "337": 44, "3372": [], "3379": 50, "3382": [], "3388": 50, "339": 5, "3394": [], "3396": [], "34": [5, 48, 56], "3434": 47, "34375": 53, "3453": 50, "3461": [], "3465": [], "3471984099596735e": 5, "3471984099596737e": 5, "34765625": 53, "3484": 50, "3494": [], "35": [5, 47, 48], "350": 5, "3519": 47, "3528": 47, "354": [5, 48, 49], "355": 56, "3554": [], "3558": 56, "356": 5, "357": 44, "3578": [], "359375": [], "36": [5, 48], "360": [48, 49], "36311": 48, "3633": 47, "36652": [41, 48], "367": 48, "3671875": [], "3681": [], "3699": 48, "37": 48, "37109375": 53, "3712": 50, "3721": 50, "3724": 50, "373386": 56, "3736": [], "375": 48, "3752": [], "3788e": [], "38": [48, 49], "380": 5, "3812": 50, "382": 44, "3829": 50, "383": 5, "38318": 56, "384": 5, "3855": 50, "3880": [], "3890": [], "3891": 50, "39": 48, "390625": 53, "399": 5, "3996": [], "39993": 56, "4": [2, 5, 6, 47, 48, 49, 50, 53, 54, 56], "40": [48, 49, 50], "4008": [], "4012": 50, "4021": 50, "40234375": [], "4026": 50, "4028234663852886e": [48, 49], "4030": [], "4034": [], "40421": 5, "4044": 47, "408": 47, "4088": [], "4090": 50, "4096": [48, 49], "41": 48, "4101": 50, "4123": 50, "4140625": 53, "4143": 47, "4161": [], "418": 44, "42": 48, "4200": [], "4207": 47, "421": 44, "4216": 50, "421875": [], "4234": [], "4235": 47, "4265": 50, "4266": 50, "4280": 50, "4282": [], "4291": 50, "43": 48, "432": [48, 49], "43359375": [], "4339": [], "434": 5, "4346": 50, "4360": 50, "4368": [], "4387": 50, "439": 5, "44": [5, 48], "440": 52, "4409": [], "44140625": [], "4415": [], "4423": 50, "4428": 50, "4429": [], "4435": 50, "4447": [], "445": 44, "4456": 50, "4470": [], "4477": 50, "448": 48, "4483": [], "45": 48, "4519": [], "4536": [], "455": 5, "4553": 50, "4555": [], "4559": 50, "4565": [], "458": 5, "4598e": [], "46": 48, "4609": [], "4633": 50, "4644": [], "4646": [], "46484375": [], "4679": [], "47": 48, "4722e": [], "4743": [], "4751953125": 6, "4765625": [], "48": [48, 49], "4801025390625": 6, "4816": 50, "4827": [], "4849": 47, "4858": 50, "4874": [], "4876": 50, "4880": 50, "4887": 50, "490959167480469": 48, "4924": 50, "4933": [], "4937": [], "4953": [], "49568021297454834": 48, "4966": 50, "4981e": [], "4d": 41, "5": [1, 3, 4, 5, 6, 9, 48, 50, 51, 52, 53, 56], "50": [2, 5, 48, 49, 50], "500": 44, "5009e": [], "5015": [], "5027246475219727": 54, "5028": [], "5034": [], "50390625": 53, "5043": 50, "505": 48, "5062": 50, "5064371824264526": 54, "5065": [], "51": [5, 47, 56], "510": [47, 48], "5113955543154762": 6, "51171875": 53, "5122868418693542": 54, "512286901473999": 54, "5135": 50, "5139": [], "5146": 50, "5150": 50, "5150525569915771": 48, "5156": 50, "515625": 53, "5157": 50, "5181": [], "5194e": [], "51953125": 53, "52": 5, "5243956446647644": 54, "5249": 56, "52734375": [], "531": [5, 47], "53125": 53, "5344": [], "5349": [], "5350": 50, "53515625": 53, "5361": [], "5370": [], "5376": 48, "539": 44, "5396605730056763": 54, "54296875": 53, "5436": 50, "5440": [], "544735848903656": 54, "5447359085083008": 54, "546875": 53, "55078125": 53, "5511": 50, "5519": 50, "5546875": 53, "5584": [], "559": 5, "5599": [], "5625": [], "564": [48, 49], "565": [48, 49], "5650": [], "565155982971191": 48, "5658": [], "5660058856010437": 54, "5660059452056885": 54, "5664": 5, "5669112205505371": 54, "5689": [], "5703125": 53, "571": [48, 49], "5722": 47, "5737": [], "57421875": 53, "5749": 50, "575259804725647": 48, "578125": 53, "58203125": 53, "5825": 50, "5832": 50, "5855": 50, "5857": [], "5859375": [], "5864": 50, "588": 47, "5890": [], "59": 5, "591": 48, "5914e": [], "5922": 50, "5925e": [], "5931": [], "595": 44, "596": 48, "5975": 50, "6": [3, 4, 5, 6, 9, 48, 49, 50, 56], "6029": 50, "6032": 50, "6045e": [], "6082": [], "6149": 50, "6153e": [], "6171875": 53, "6199": 5, "62109375": 53, "6231": 50, "6237": [], "6247": [], "625": 53, "6253": 50, "6254": 50, "6262e": [], "6280": [], "6287": 50, "6295": 48, "6302": [], "632": 44, "6324": 47, "6339": [], "6343": 50, "635": 48, "6354": 5, "6394": 50, "64": 5, "6401": 50, "64453125": 53, "6446": [], "6467": 50, "647": 5, "6484375": [], "6489": 50, "6497": [], "6516": 50, "65234375": 53, "6549": [], "65625": [], "6581": [], "66015625": [], "6617e": [], "6618": [], "6632": [], "6640625": 53, "6653": [], "6664": [], "6667": 47, "667": 5, "6683": 47, "6699": [], "6773": 50, "6773e": [], "6776": [], "6778": [], "6787744760513306": 48, "680": 44, "6807": 50, "6819": [], "6827": [47, 50], "684": 5, "6845": 46, "6856": 50, "6861": 50, "6883": [], "689": [46, 47], "6891": 50, "6899": [], "6965": 50, "6984": [], "6994": [], "6998": 47, "7": [0, 2, 3, 4, 5, 6, 48, 50, 56], "700": 46, "7003": 50, "7011": 50, "7021": 50, "703": 48, "706": 5, "707": 44, "7079": [], "7086": 50, "7138619422912598": 48, "7150": 50, "7163": [], "7164": [], "7170": [], "7180": [], "7190": 50, "7202": 47, "72218656539917": 48, "7245": [], "7246": [], "7269": 50, "73046875": [], "7333": [], "7349": [], "7354": 50, "7361484169960022": 54, "7398": [], "7421875": 53, "7457": 50, "7458": 48, "74609375": [], "7472": 47, "7480": [], "7489": [], "75": 53, "7509": [], "751": 5, "7512": 50, "7515": 50, "7541": 50, "756": 47, "76171875": 53, "7620e": [], "7621": 50, "7646": 50, "7648e": [], "7661": 50, "7704": 50, "7704185843467712": 48, "7706": 50, "771": 44, "7724": 50, "7757": [], "7766": 50, "7767": [], "777": 48, "7773": 50, "7790": 50, "78": [46, 47, 48, 49, 50, 51], "7805": 50, "7807": [], "78125": [], "7813": [], "7816": [], "7820": 50, "7845": 50, "7865": [], "7878": 50, "79": [5, 48, 49], "7901": 50, "7915": 50, "7949": [], "7979": 50, "798": 44, "8": [0, 3, 4, 48, 50, 56], "80": [48, 49], "8016": [], "802999759092927e": 5, "8045": [], "8046875": [], "806": 47, "8063": 50, "80859375": [], "8092": 50, "81": [48, 49, 50], "8105": 50, "813": 47, "8131": [], "8146": [], "815": [], "8150": 50, "8152": 50, "8179": 50, "8181": 50, "8192": [48, 49], "8197526931762695": 48, "82": 5, "821": 44, "8212": [], "8252": [], "8272": [], "8287": [], "8291": 50, "830": 48, "8303": 50, "8305": 50, "8306": [], "8310": 50, "8361": 50, "838": 47, "8385": 50, "8390": 50, "8396": 50, "83984375": 53, "8408": 50, "841": 47, "8468": 50, "84765625": 53, "85": 5, "853": 5, "855": 51, "856": 48, "8575": [], "8579": [], "8602": [], "8618": [], "8671875": 53, "8693e": [], "870": [48, 49], "8712": 50, "8715": [], "8731": 50, "8739": 50, "875": 47, "877": 5, "87890625": [], "88": 5, "8815": [], "8822": 50, "8828": [], "8828125": [], "8838638663291931": 54, "888": 47, "8880": 50, "8892": 50, "8948": [], "8963": 50, "8977": 50, "8982": [], "8993": 50, "9": [0, 5, 9, 47, 48, 52, 53, 54, 55, 58], "90": [5, 47], "901": 48, "9013671875": 6, "903": 47, "9031": [], "9076": [], "91015625": 53, "9140625": [], "9148": [], "9153": 50, "9160": 50, "9188": [], "9193": 50, "92": 44, "921": 47, "9215": 50, "9223372036854775807": [48, 49, 51], "9227": [], "9242": [], "9245": 5, "9256": 50, "927": 47, "9272": 50, "9296875": [], "9297e": [], "9314": 50, "9340": [], "9343": [], "9386": 50, "9396e": [], "94140625": [], "9420": [], "9428": [], "9450": [], "95": 48, "9502": 50, "951980033889413e": 5, "9528": 50, "9530": 50, "9570": [], "958": 44, "9580078125": 6, "96": [44, 48, 49], "9641": 50, "9659": [], "966535095777092e": 5, "9680": [], "9742": 50, "98": 5, "9803": 50, "98046875": 53, "982": 48, "984375": 53, "9858": 50, "987462043762207": 48, "989": 5, "9931": 50, "9933": 50, "99755859375": 6, "999": [52, 53, 54], "A": [41, 48, 57], "AND": 57, "AS": 57, "And": [48, 49, 50], "As": [46, 50], "BE": 57, "BUT": 57, "FOR": 57, "For": [46, 47, 48, 49, 51, 52, 54], "IN": 57, "If": [3, 4, 45, 47, 48, 49, 50, 51, 55, 56, 58], "In": [5, 41], "It": [6, 9, 11, 38, 47, 48, 49, 52, 53, 54, 56], "NO": 57, "NOT": 57, "No": [41, 48, 49], "Not": [47, 48, 49, 51], "OF": 57, "OR": 57, "One": [47, 50], "THE": 57, "TO": 57, "That": [6, 47, 48, 51], "The": [5, 8, 9, 11, 38, 41, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56, 57], "Then": [48, 49, 51, 52], "There": 50, "These": 50, "To": [48, 49], "WITH": 57, "With": [6, 51, 56], "__call__": 47, "__file__": 5, "__init__": [5, 46, 47, 48, 49, 50, 51], "__main__": [46, 51], "__torch_dispatch__": 47, "__torch_function__": [46, 47], "_allow_tf32": [46, 47, 48, 49, 50, 51], "_aot_autograd": 47, "_aot_export_non_strict": 47, "_assert_scalar": 51, "_assert_scalar_default": 51, "_broadcast_shap": 40, "_c": [46, 47, 48, 49, 50, 51], "_cache_dependant_input_prepar": 49, "_cache_dependant_input_preparation_export": 49, "_cached_dispatch_impl": 47, "_call_impl": 47, "_catch_produce_guards_and_solve_constraint": 48, "_compil": 47, "_def": 48, "_dimhint": [3, 4, 48, 49, 50], "_dimhinttyp": [3, 4, 48, 49, 50], "_dispatch_impl": 47, "_doc": [46, 47, 50, 51], "_dynamo": [38, 47, 49, 51], "_enter_autocast": 48, "_evaluate_expr": 47, "_exit_autocast": 48, "_export": [46, 47], "_export_for_train": 47, "_export_to_aten_ir_make_fx": 47, "_f": 48, "_fn": 47, "_forward_": 48, "_functorch": 47, "_index": 6, "_is_torch_jit_trac": 48, "_librari": 47, "_make_causal_mask": [38, 41, 49], "_make_fx_help": 47, "_maybe_guard_rel": 47, "_nestedsequ": [6, 9], "_non_strict_export": 47, "_op": 47, "_orig_module_cal": 47, "_parent": 48, "_ref": 40, "_refine_rang": 47, "_register_cache_seri": [47, 49], "_seen_token": 38, "_set_grad_en": 48, "_set_grad_enabled_1": 48, "_set_onednn_allow_tf32": [46, 47, 48, 49, 50, 51], "_set_replac": 47, "_shape": 40, "_stat": 47, "_subclass": [38, 40, 47, 48], "_supportsarrai": [6, 9], "_symbolic_trac": 47, "_to_aten_func": 47, "_trace": 47, "_trace_inn": 47, "_unregister_cache_seri": [47, 49], "_update_causal_mask": [48, 49], "_wrapped_call_impl": 47, "a0": [6, 48], "a10": 48, "a11": 48, "a12": 48, "a1283": 48, "a13": 48, "a14": 48, "a15": 48, "a15649": 48, "a16": 48, "a1639": 48, "a16r2": 53, "a17": 48, "a1724": 48, "a18": 48, "a19": 48, "a1914": 48, "a1925": 48, "a20": 48, "a2020": 48, "a21": 48, "a2107": 48, "a22": 48, "a2253": 48, "a23": 48, "a2355": 48, "a24": 48, "a25": 48, "a26": 48, "a263": 48, "a27": 48, "a28": 48, "a29": 48, "a29889": 48, "a29892": 48, "a29908": 48, "a29915": 48, "a29956": 48, "a29973": 48, "a3": 48, "a30": 48, "a304": 48, "a306": 48, "a31": 48, "a310": 48, "a32": 48, "a33": 48, "a34": 48, "a35": 48, "a36": 48, "a367": 48, "a3699": 48, "a37": 48, "a38": 48, "a39": 48, "a40": 48, "a41": 48, "a42": 48, "a43": 48, "a44": 48, "a448": 48, "a45": 48, "a46": 48, "a47": 48, "a48": 48, "a505": 48, "a510": 48, "a5376": 48, "a591": 48, "a596": 48, "a6295": 48, "a6305": 48, "a635": 48, "a7458": 48, "a777": 48, "a8": 48, "a830": 48, "a856": 48, "a9": 48, "a901": 48, "a982": 48, "ab": 6, "abl": [3, 4, 51], "about": [5, 6, 49], "abov": [41, 57], "absolut": [5, 6], "acceler": [46, 47, 48, 49, 50, 51], "accept": 6, "accessor": 37, "act_fn": [48, 49], "action": 57, "activ": [48, 49], "ad": 9, "add": [0, 5, 9, 11, 46, 48, 49, 50, 51, 52, 53, 54], "add_1": [50, 51], "add_10": [48, 49], "add_2": [48, 49, 50, 51], "add_3": [48, 49, 50], "add_4": [48, 49], "add_5": [48, 49], "add_7": [48, 49], "add_8": [48, 49], "add_9": [48, 49], "addadd": [11, 13], "addit": [1, 11, 41, 50], "addmul": [11, 13], "addsharedinput": [11, 13], "after": [5, 48, 49], "again": 49, "aggreg": 5, "ai": 52, "algorithm": 52, "all": [1, 5, 6, 9, 11, 38, 45, 47, 48, 49, 51, 57, 58], "allow": [6, 11], "allow_unique_tensor_with_list_of_one_el": 6, "alreadi": 49, "also": [41, 46, 51], "alwai": [48, 51, 53, 54], "amp": 48, "an": [0, 2, 5, 6, 9, 11, 38, 43, 44, 45, 46, 48, 49, 51, 53, 54, 55, 56, 57, 58], "ani": [3, 4, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 44, 48, 49, 50, 57], "anoth": [3, 4], "answer": [47, 48], "aot_export": 47, "api": [5, 9, 11, 56], "appear": [38, 49], "appli": [38, 41], "apply_rotary_pos_emb": [48, 49], "approxim": 5, "ar": [3, 4, 5, 6, 9, 41, 47, 48, 49, 50, 51, 56], "arang": [48, 49], "arange_1": [48, 49], "architectur": [48, 49], "arg": [3, 4, 5, 6, 7, 11, 46, 47, 48, 49, 51], "arg0_1": [46, 48], "arg10_1": 48, "arg11_1": 48, "arg12_1": 48, "arg13_1": 48, "arg14_1": 48, "arg15_1": 48, "arg16_1": 48, "arg17_1": 48, "arg1_1": [46, 48], "arg2_1": [46, 48], "arg3_1": [46, 48], "arg4_1": [46, 48], "arg5_1": 48, "arg6_1": 48, "arg7_1": 48, "arg8_1": 48, "arg9_1": 48, "argument": [1, 3, 4, 5, 41, 50], "aris": 57, "arnir0": [43, 48, 49], "around": 49, "arr": 6, "arrai": [5, 6, 11, 52, 54], "ask": 52, "assert": [47, 48, 49, 51], "assert_onnx_disc": 5, "assertalmostequ": 5, "assertempti": 5, "assertequ": 5, "assertequalarrai": 5, "assertexist": 5, "assertgreaterorequ": 5, "assertin": 5, "assertionerror": [38, 46, 47, 51], "assertnotempti": 5, "assertrais": 5, "assertsetcontain": 5, "assertstartswith": 5, "asserttru": 5, "assist": 41, "associ": [48, 49, 57], "assum": [6, 8, 52, 54], "astyp": [9, 54], "aten": [46, 47, 48, 49, 50, 51], "aten_export_artifact": 47, "atol": 5, "att": 6, "attempt": 51, "attent": [11, 41, 44], "attention_interfac": [48, 49], "attention_mask": [41, 48, 49], "attention_sc": [48, 49], "attentionblock": 44, "attentionmaskconvert": [38, 41], "attn_output": [48, 49], "attn_weight": [48, 49], "attribut": [6, 38, 52, 53, 54], "author": 57, "auto": [45, 46, 55, 56, 58], "auto_exampl": 55, "auto_examples_jupyt": 45, "auto_examples_python": 45, "autocast_mod": 48, "autom": 9, "automodelforcausallm": [48, 49], "autotoken": [48, 49], "avail": [1, 5, 38, 46, 47, 48, 49, 50, 51], "averag": 5, "averagepoolgrad": [11, 14], "avoi": 5, "avoid": [6, 38, 46, 48, 49], "ax": 5, "axi": [47, 51], "azur": 5, "b": [5, 40, 52, 53, 54], "b3": 47, "b8": [46, 48, 49], "b_model_rotary_emb_inv_freq": [48, 49], "backend": [11, 46, 47, 48, 49, 50, 51], "ban_prefix": 6, "base": [3, 4, 48, 49, 50, 53], "batch": [43, 48, 49, 51], "batch_siz": 43, "batch_split": 41, "beam": 41, "beam_idx": 41, "becaus": [47, 48, 49, 51], "becom": [0, 9, 47], "befor": [5, 6, 48, 49, 50], "begin": 6, "better": [5, 6, 47, 48, 49], "between": 6, "beyond": 5, "bfloat16": [6, 48, 49, 53, 56], "bia": [44, 46, 48, 49], "biassoftmax": 11, "big": [8, 47], "block": 47, "bool": [2, 5, 6, 9, 11, 38, 43, 44, 48], "both": [3, 4, 50], "bound": 11, "break": 46, "brought": 48, "bsize": [2, 50], "buffer": [6, 9, 48, 49], "bui": 48, "build": [6, 52], "bypass": 38, "bypass_export_some_error": [38, 47, 49, 50], "byte": [6, 9, 53], "c": [46, 52, 53, 54, 57], "cach": [38, 41, 48, 49, 50], "cache2": 50, "cache_help": [5, 7, 49, 50], "cache_key_cache_0": 50, "cache_key_cache_1": 50, "cache_kwarg": [41, 48, 49], "cache_length": [48, 49], "cache_posit": [41, 48, 49], "cache_util": [2, 48, 49, 50], "cache_value_cache_0": 50, "cache_value_cache_1": 50, "call": [1, 5, 6, 9, 38, 46, 47], "call_funct": [46, 51], "call_modul": 47, "callabl": [3, 4, 5, 6, 9, 38, 40], "can": [2, 6, 8, 38, 41, 46, 48, 49, 50, 51, 53, 54], "cannot": [38, 46, 49, 51, 52], "capi": [52, 53, 54], "captur": 5, "care": 49, "case": 50, "cast": [52, 53, 54], "castlik": [52, 53, 54], "castlike_15": [11, 15], "castlike_19": [11, 15], "cat": [47, 48, 49, 51], "cat_1": [48, 49], "cat_2": [48, 49], "cat_3": [48, 49], "cat_4": [48, 49], "catch": [5, 38], "catch_constraint": 38, "cati": 47, "caught": 52, "caus": [46, 49], "causal_mask": [48, 49], "causallmoutputwithpast": 48, "cd": 56, "chang": [46, 48, 56], "char": [5, 56], "charg": 57, "check": [1, 3, 4, 5, 46, 49, 50, 52, 53, 54], "check_cuda_avail": 1, "check_model": 9, "check_model_ort": 44, "checker": 9, "cl": [9, 52], "claim": 57, "class": [2, 3, 4, 5, 6, 7, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 40, 41, 46, 47, 48, 49, 50, 51, 52, 53, 54], "classmethod": [5, 41], "clone": [48, 49, 56], "cloned_input": [48, 49], "cls_name": 44, "co": [5, 48, 49], "code": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "coeffici": 51, "com": [46, 48, 56], "come": [47, 52], "comma": 1, "common": [6, 47], "comparison": 6, "compil": 48, "complex": [6, 9, 44], "complexmodul": [11, 16], "comprison": 5, "comput": [5, 41, 50], "concat": [11, 17], "concrete_arg": 47, "cond": 46, "condit": 57, "config": 48, "configur": 43, "connect": 57, "consid": [1, 6], "constant": [6, 47, 48, 49], "constantofshap": [11, 18], "constraint": [6, 38, 45, 46, 47, 48, 49, 50, 55, 56, 58], "consum": 8, "contain": [1, 5, 41, 46, 52], "context": [5, 46, 47, 48, 49, 50, 51], "context_s": 5, "contigu": [48, 49], "contiguous_1": [48, 49], "contiguous_2": [48, 49], "contiguous_3": [48, 49], "continu": [48, 49], "contract": 57, "contrast": 41, "contrib": 11, "control": [45, 47, 50, 51, 55, 56, 58], "convert": [6, 44, 49, 52, 53, 54], "convert_endian": 6, "cope": 50, "copi": [48, 49, 57], "copy_": [48, 49], "copy_input": 5, "copyright": 57, "correspond": [3, 4, 5, 6], "could": [3, 4, 11, 46, 51, 52, 53], "coupl": [3, 4], "cpp": [46, 47, 48, 49, 50, 51], "cpu": [9, 11, 44, 48, 49, 52, 53], "cpu_sess": 9, "cpuexecutionprovid": [9, 52, 53, 54], "crash": [9, 52, 54], "creat": [2, 8, 44, 46, 48, 49], "create_arg": 47, "crop": [41, 49], "cu126": 56, "cuda": [1, 5, 9, 11, 44, 53], "curr_mod": 47, "current": [46, 47, 48, 49, 50, 51], "custom": [11, 50, 52], "d": [3, 4, 46, 50, 53], "damag": 57, "data": [6, 46, 48], "data_typ": 6, "deal": [48, 57], "debug": [3, 4, 6, 11, 46, 48, 53, 54], "debug_info": 6, "decod": [41, 44, 48], "decoderlay": 44, "deconstruct": 5, "deep": [6, 47], "deepcopi": [48, 49], "def": [3, 4, 6, 46, 47, 48, 49, 50, 51], "default": [1, 3, 4, 5, 6, 11, 46, 48, 49, 51], "default_op": 11, "defin": [3, 4, 6, 46, 47, 50, 53, 54], "definit": 11, "demonstr": 53, "depend": [46, 49], "derived_equ": 48, "descript": 1, "deseri": [2, 49], "despit": 48, "detect": 38, "determin": 50, "dev0": 56, "dev20250301": 56, "dev20250324": 56, "deviat": 5, "devic": [6, 9, 48, 49], "device_count": 5, "devop": 5, "diagnost": [46, 47, 50, 51], "dict": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 48, 49, 50, 53, 54], "dictionari": [5, 6, 8, 9, 11, 43], "diff": 6, "differ": [6, 41, 50, 51], "difficult": 47, "dig": 7, "dim": [2, 47, 48, 49, 50, 51], "dimens": [0, 3, 4, 6, 38, 48, 50, 51], "dir": [5, 56], "dirnam": 5, "disabl": [5, 38], "disable_aot_function_inlin": [9, 11], "disable_fn": 47, "discov": 53, "discrep": [5, 6, 53], "dispatch": 47, "dispatch_trac": 47, "displai": [5, 6], "distribut": 57, "div_by_numb": 5, "divid": 5, "dnan": 6, "do": [5, 11, 50, 52, 54, 57], "do_sampl": 48, "doc": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54], "document": [41, 46, 56, 57], "doe": [3, 4, 38, 46, 47, 48, 49, 50, 51, 52, 53, 54], "domain": [52, 53], "done": [9, 47, 49], "down_proj": [48, 49], "download": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "drop": 6, "drop_kei": 6, "dt": 6, "dtype": [6, 9, 48, 49, 52, 53, 54, 56], "dtype_layout": [48, 49], "dtype_to_tensor_dtyp": 6, "due": [38, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 58], "dummi": [9, 44, 48], "dummy_llm": 44, "dump": [5, 9, 44], "dump_fil": 44, "dump_filenam": 9, "dump_onnx": 5, "durat": 5, "dure": [38, 53], "dyn": [6, 47], "dyn_shap": 47, "dynam": [0, 3, 4, 6, 38, 43, 44, 45, 46, 49, 52, 53, 54, 55, 56, 58], "dynami": 50, "dynamic_rop": 43, "dynamic_shap": [4, 5, 44, 47, 48, 49, 50, 51], "dynamiccach": [2, 38, 41, 45, 46, 48, 49, 55, 56, 58], "dz": 51, "e": [41, 46, 47, 48, 51, 52, 53, 54, 56], "easi": 51, "edit": 46, "either": 52, "element": [6, 47], "elementwise_affin": 44, "els": 50, "emb": [48, 49], "embed": [6, 44, 48, 49], "embed_token": [48, 49], "empti": [1, 5, 44], "enabl": [5, 9, 11], "enable_profil": [9, 11], "encod": 48, "end": [1, 6, 46, 47, 48, 49, 50, 51, 52, 53, 54], "endian": 6, "enough": [5, 9], "ensur": 48, "environ": [5, 38], "ep": [38, 44, 46, 47, 48, 49, 50, 51], "epilog": 1, "eq": [46, 48, 49, 51], "eq_2": 51, "eq_7": 48, "eq_9": 49, "equal": [5, 6, 9, 47], "equalities_input": 48, "equalityconstraint": 48, "error": [5, 6, 38, 44, 46, 47, 48, 52, 53, 54], "errorproduce_guards_and_solve_constraint": 48, "eval_fram": 47, "evalu": [5, 11, 47], "evaluate_expr": 47, "evaluate_sym_nod": 47, "even": [9, 48], "event": [9, 11, 57], "everi": [9, 50, 52, 53, 54], "everyth": 51, "exact": [38, 47], "exampl": [1, 2, 3, 4, 9, 38, 43, 46, 47, 48, 49, 51, 52, 53, 54, 55, 58], "exc": [47, 48, 49, 51], "exc_typ": 5, "except": [0, 5, 9, 38, 46, 47, 48, 51, 52, 53, 54], "execut": [3, 4, 5, 11, 48, 49, 53, 55, 58], "exhaust": 6, "exist": [5, 41, 52, 53, 54], "expand": [48, 49], "expand_1": [48, 49], "expand_2": [48, 49], "expand_3": [48, 49], "expect": [5, 6, 41, 46, 49, 50, 51, 53], "expected_output": 48, "experi": [5, 48, 49], "experiment": 47, "explicit": 5, "export": [0, 2, 5, 6, 7, 38, 43, 44, 45, 48, 52, 53, 54, 55, 56, 58], "export_artifact": 47, "export_func": 47, "exportdb": 49, "exported_program": 47, "exportedprogram": [49, 50, 51], "expos": 1, "expr": 47, "express": [6, 46, 51, 57], "ext": [5, 56], "ext_test_cas": [7, 50, 53], "extend": [46, 53, 54], "extendedreferenceevalu": 0, "extendedreferenceevalutor": 54, "extract": 52, "exttestcas": 5, "f": [5, 6, 46, 47, 48, 49, 51], "f32": [46, 48, 49, 50, 51], "fail": [5, 9, 45, 46, 47, 48, 49, 51, 55, 56, 58], "failur": 49, "fake_impl": [38, 40, 47], "fake_mod": 48, "fake_tensor": [47, 48], "faketensormod": 48, "fals": [5, 6, 9, 11, 38, 43, 44, 48, 49, 50], "false_graph_0": 46, "far": 51, "fast_binary_impl": 47, "fast_impl": 47, "fct": 5, "feed": [9, 53, 54], "feed_forward": 44, "feed_input": 11, "feedforward": 44, "few": 51, "figur": 5, "file": [5, 8, 44, 46, 47, 48, 49, 50, 51, 55, 57, 58], "filenam": [5, 8, 11], "final": [9, 47, 48, 50], "final_shap": 47, "find": [38, 45, 46, 48, 49, 51, 53, 54, 55, 56, 58], "fine": 51, "first": [0, 5, 6, 47, 48, 50, 52, 54], "fit": 57, "fix": [8, 38, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 58], "fixtur": 5, "flag": [5, 47], "flat_args_with_path": 40, "flat_fn": 47, "flatten": 6, "flatten_object": 6, "float": [1, 5, 6, 8, 9, 48, 49, 52, 54], "float16": [6, 56], "float32": [9, 48, 49, 52, 53, 54], "float64": 5, "floattensor": [41, 48], "floordiv": 51, "flow": [45, 47, 50, 51, 55, 56, 58], "fn": 47, "focu": [48, 49], "folder": 5, "follow": [11, 38, 46, 47, 48, 49, 50, 56, 57], "form": 50, "format": 8, "format_exc": 47, "former": 9, "forward": [3, 4, 41, 43, 45, 46, 47, 49, 50, 51, 55, 56, 58], "forward_cal": 47, "forwardwithcontrolflowtest": 46, "found": [5, 9, 48, 49, 52], "four": 6, "free": 57, "freq": [48, 49], "from": [2, 3, 4, 5, 6, 9, 11, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58], "from_array_extend": [6, 52, 53, 54], "from_array_ml_dtyp": 6, "from_batch_split": [41, 49], "from_pretrain": [48, 49], "full": [5, 9, 46, 47, 48, 49, 50, 51, 52, 53, 54], "full_nam": [3, 4], "func": [47, 48, 49], "function": [0, 5, 6, 7, 8, 9, 38, 41, 46, 47, 48, 49, 50], "functional_cal": 47, "functionproto": [6, 11], "fur": 44, "furnish": 57, "fusedmatmul": [11, 19], "fx": [38, 46, 47], "g": [41, 47], "galleri": [46, 47, 48, 49, 50, 51, 52, 53, 54, 56, 58], "gate_proj": [48, 49], "gather": 11, "gatherel": 11, "gathergrad": [11, 20], "gb": 5, "gener": [41, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "generated_text": 48, "generationmixin": 48, "get": [5, 43, 47, 48, 49, 53, 54], "get_attr": 46, "get_dump_fil": 5, "get_figur": 5, "get_onnx_signatur": 6, "get_parsed_arg": 1, "get_phi2": 43, "get_seq_length": [41, 49], "get_tiny_llm": [43, 48, 49], "getitem": 46, "getitemsourc": 48, "gggg": 9, "git": 56, "github": [46, 47, 48, 49, 50, 51, 56], "given": [3, 4, 6, 41], "gm": [47, 48], "go": [46, 47, 48, 49, 50, 51, 52, 53, 54], "goe": 5, "googl": 46, "got": [6, 48], "gpu": [46, 47, 48, 49, 50, 51], "grad_fn": 46, "grant": 57, "graph": [38, 46, 47, 48, 49, 50, 51], "graph_modul": 48, "graph_optimization_level": [9, 11], "graph_signatur": 47, "graphmodul": [48, 49, 50, 51], "graphoptimizationlevel": [9, 11], "graphproto": [6, 11], "great": 48, "green": 49, "grow": 50, "gt": [46, 48, 49], "guard": [46, 51], "guard_size_oblivi": 47, "guess": [0, 3, 4, 43, 45, 49, 50, 52, 55, 56, 58], "guess_dynamic_dimens": [3, 4], "guess_dynamic_shap": [3, 4, 50], "guess_dynamic_shape_object": [3, 4], "ha": [38, 45, 46, 52, 55, 56, 58], "handle_dispatch_mod": 47, "handler": 47, "happen": [38, 44, 47], "happi": 50, "has_cuda": [5, 53], "has_onnxruntime_train": [5, 56], "has_onnxscript": 5, "has_torch": 5, "has_transform": [5, 50], "hasattr": 48, "hash": 6, "have": [41, 46, 47, 48, 49, 50, 51, 52], "help": [46, 56], "helper": [2, 3, 4, 5, 7, 9, 44, 48, 49, 50, 52, 53, 54, 56], "here": [47, 49, 51, 52, 53, 54], "herebi": 57, "hidden_shap": [48, 49], "hidden_st": [48, 49], "hide": 5, "hide_stdout": 5, "higher": 5, "higher_ord": [46, 48, 49], "highlight": 6, "holder": 57, "home": [46, 47, 48, 49, 50, 51], "hook": 5, "hous": 48, "how": [47, 49, 50, 53], "howev": 49, "html": 49, "http": [46, 48, 49, 56], "huggingfac": 48, "i": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 38, 41, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56, 57, 58], "i64": [48, 49], "id": 6, "identity2": 46, "idx": 48, "ignor": [5, 6, 47], "ignore_warn": 5, "implement": [0, 9, 11, 38, 41, 47, 49, 50, 56], "impli": [47, 57], "import": [2, 3, 4, 5, 6, 9, 11, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "improv": [0, 53, 54], "in_featur": 44, "includ": [6, 41, 52, 57], "increas": 51, "independ": 53, "index": [41, 48, 49], "index_is_slic": 48, "indic": [38, 41, 47], "infer": [3, 4, 6, 9, 38, 47, 48, 49, 50, 53], "infer_s": [38, 40, 47], "infer_shap": [9, 52], "inferenceerror": 52, "inferencesess": [9, 44, 52, 53, 54], "inferencesessionfornumpi": [9, 52, 53], "inferencesessionfortorch": [5, 9, 53], "info": 48, "inform": [3, 4, 6, 46, 47, 48, 49, 51, 53, 54], "inherit": 5, "initi": [8, 43], "inner": 47, "inplac": [3, 4, 5, 8, 48, 49], "input": [3, 4, 5, 6, 9, 11, 38, 41, 46, 47, 48, 49, 50, 51, 52, 53, 56], "input_dtyp": [48, 49], "input_id": [41, 48, 49], "input_layernorm": [48, 49], "input_nam": 11, "input_placehold": 40, "input_shap": [48, 49], "input_typ": 11, "inputs_emb": [41, 48, 49], "insert": [47, 53, 54], "insid": 47, "instal": [5, 56], "instanc": [2, 49], "instead": 11, "int": [1, 3, 4, 5, 6, 8, 9, 11, 38, 40, 41, 43, 48, 49, 51, 52], "int64": [6, 48, 49, 56], "int_oo": [50, 51], "integ": 51, "integerconst": 38, "intel": [46, 47, 48, 49, 50, 51], "interest": 48, "intermedi": [11, 45, 47, 52, 55, 56, 58], "intern": [46, 47, 48, 49, 50, 51], "interpret": [53, 54], "introduc": 46, "inv_freq": [48, 49], "inv_freq_expand": [48, 49], "investig": [5, 7], "investigate_onnxruntime_issu": [0, 9, 52], "invgestig": 9, "involv": 11, "ipynb": [46, 47, 48, 49, 50, 51, 52, 53, 54], "ir": 11, "ir_vers": [9, 11, 52, 53, 54], "is_azur": 5, "is_cache_dynamic_regist": [2, 49], "is_derefed_cell_cont": 48, "is_export": 48, "is_input": 48, "is_torchdynamo_export": 44, "isinst": [38, 46, 47, 49], "issu": [38, 45, 46, 48, 49, 51, 53, 54, 55, 56, 58], "item": 46, "iter": 5, "its": 48, "ityp": [6, 56], "jit": [38, 47, 49], "job": 5, "json": [8, 48], "jupyt": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "just": [5, 6, 9], "k_proj": [48, 49], "keep": [1, 6], "keep_model_forward": 48, "keepdim": [48, 49], "kei": [2, 6, 41, 44], "kernel": [49, 53], "key_cach": [2, 48, 49, 50], "key_stat": [41, 48, 49], "key_value_pair": 2, "keyerror": 54, "kind": 57, "know": 5, "known": 52, "kw": [3, 4], "kwarg": [1, 3, 4, 5, 6, 11, 41, 43, 46, 47, 48, 49, 51], "kwargsforcausallm": 48, "l": [47, 48, 49, 51], "label": 48, "lambda": [5, 9, 47, 48], "last": [6, 9, 11, 47], "last_issu": 9, "layer": [41, 48, 49], "layer_idx": [41, 48, 49], "layernorm": 44, "layout": [48, 49], "learn": [5, 6], "least": 48, "leav": 49, "length": [41, 43], "less": [53, 54], "let": [46, 47, 48, 49, 52, 53, 54], "letter": 6, "level": [3, 4, 6, 9], "liabil": 57, "liabl": 57, "lib": [46, 47, 48, 49, 50, 51], "licens": 56, "lightgrei": [52, 53, 54], "like": [3, 4, 5, 6, 41, 46, 50, 52], "limit": [6, 57], "line": [5, 46, 47, 56], "linear": [44, 46, 48, 49, 51], "linear_1": [44, 46, 48, 49], "linear_2": [44, 48, 49], "linear_3": [48, 49], "linear_4": [48, 49], "linear_5": [48, 49], "linear_6": [48, 49], "linear_7": [48, 49], "linux": 5, "list": [1, 2, 3, 4, 5, 6, 8, 9, 11, 38, 40, 41, 44, 46, 47, 48], "llama": [48, 49], "llamaconfig": 43, "llm": [5, 41, 42, 44, 45, 47, 50, 51, 55, 56, 58], "llm_phi2": 5, "llm_tiny_llm": [5, 48, 49], "lm_head": [48, 49], "load": [8, 9, 11, 44], "local": 11, "local_funct": 11, "local_nam": 48, "localsourc": 48, "locat": [38, 47, 52, 54], "log": [46, 56], "log_severity_level": [9, 11], "log_verbosity_level": [9, 11], "logit": [48, 49], "logits_to_keep": 48, "long": [5, 47], "long_test": 5, "longer": 48, "longtensor": [41, 48], "look": [8, 46, 47, 48, 50], "m": 47, "mai": [5, 6, 38, 49, 53], "main": [3, 4, 5, 49, 52], "make": [3, 4, 6, 48, 50, 51], "make_dynamic_cach": [2, 50], "make_fx": 47, "make_fx_trac": 47, "make_graph": [9, 52, 53, 54], "make_hash": 6, "make_model": [9, 52, 53, 54], "make_nod": [9, 52, 53, 54], "make_opsetid": [9, 52, 53, 54], "make_tensor_value_info": [9, 52, 53, 54], "mambacach": [38, 47, 49], "mandatori": 49, "mani": [6, 48, 49], "map": 49, "mark_static_address": [38, 47, 49], "mask": [41, 48], "masked_fil": [48, 49], "maskedscatterndofshap": [11, 30], "math": 5, "matmul": [48, 49], "matplotlib": 5, "max": 6, "max_diff": [6, 56], "max_exec": 5, "max_length": [41, 48], "max_tim": 5, "maximum": 6, "maybe_propagate_real_tensor": 47, "mb": [55, 58], "mean": [48, 49, 52], "mean_1": [48, 49], "mean_2": [48, 49], "meant": 11, "measur": 5, "measure_tim": 5, "mechan": [49, 50], "mem": [55, 58], "memcpyfromhost": [11, 21], "memcpytohost": [11, 21], "memori": 5, "mention": 47, "merchant": 57, "merg": 57, "messag": [5, 38, 47, 53, 54], "meth": 48, "method": [3, 4, 5, 9, 38, 41, 43, 45, 49, 50, 52, 55, 56, 58], "method_nam": [3, 4], "methodnam": 5, "mi": [3, 4, 50], "microsoft": 43, "might": 41, "min": 6, "min_exec": 5, "minimum": [5, 6], "minut": [46, 47, 48, 49, 50, 51, 52, 53, 54], "miss": 38, "mkldnn": [46, 47, 48, 49, 50, 51], "ml_dtype": [6, 56], "mlp": [46, 48, 49], "mod": [46, 47], "model": [0, 2, 3, 4, 5, 6, 7, 8, 9, 11, 38, 41, 43, 44, 45, 50, 51, 55, 58], "model_nam": [48, 49], "modeling_attn_mask_util": 41, "modeling_llama": [48, 49], "modeling_output": 48, "modelinput": [0, 3, 50], "modelproto": [5, 6, 8, 9, 11, 44, 52], "modelwithcontrolflow": 46, "modelwithissu": 47, "modif": [38, 41, 49, 50], "modifi": [3, 4, 5, 8, 47, 48, 49, 50, 57], "modul": [3, 5, 38, 44, 46, 47, 48, 49, 50, 51], "module_call_wrapp": 47, "module_name_typ": [3, 4], "modulelist": 44, "more": [5, 44, 46, 47, 48, 49, 51, 53, 54], "most": [9, 41, 47, 48, 50], "mostli": [3, 4, 11], "move": [3, 4, 50], "move_to_kwarg": [3, 4, 50], "msg": [3, 4, 5, 47], "much": [53, 54], "mul": [48, 49, 52, 53, 54], "mul_": [48, 49], "mul_1": [48, 49], "mul_10": [48, 49], "mul_11": [48, 49], "mul_12": [48, 49], "mul_2": [48, 49], "mul_3": [48, 49], "mul_4": [48, 49], "mul_5": [48, 49], "mul_6": [48, 49], "mul_7": [48, 49], "mul_8": [48, 49], "mul_9": [48, 49], "muladd": [11, 13], "mulbackward0": 46, "mulmul": [11, 13], "mulsharedinput": [11, 13], "mulsigmoid": [11, 22], "mulsub": [11, 13], "multiattentionblock": 44, "multipl": [3, 4], "must": [3, 4, 5, 47, 49, 50], "mutat": 38, "n": [6, 52], "n0": [52, 53, 54], "n1": [52, 53, 54], "n2": [52, 53, 54], "n4": [52, 53, 54], "n_layer": [2, 50], "n_tree": 1, "name": [1, 3, 4, 5, 6, 8, 11, 38, 46, 50, 52, 53, 54], "named_modul": 46, "namespac": 1, "nan": 6, "nd": [3, 4, 52, 53, 54], "ndarrai": [5, 9], "ne": 46, "necessari": 38, "need": [38, 47, 48, 50, 53, 54], "neg": [41, 46, 48, 49], "neg_1": [48, 49], "negxplus1": [11, 23], "never_test": 5, "new": [6, 8, 41, 43, 47], "new_arg": [1, 50], "new_d": 50, "new_forward": 46, "new_kwarg": 50, "new_op": 11, "nfor": [50, 54], "nhead": [2, 50], "nicer": 5, "ninfer": 51, "nn": [3, 4, 5, 46, 47, 48, 49, 50, 51], "node": [6, 8, 9, 11, 40, 47, 48, 49, 51, 53, 54], "nodeproto": [8, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35], "non": [43, 49, 52, 53, 54], "non_strict_util": [46, 47], "none": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 40, 41, 44, 46, 48, 49, 50, 51, 53, 54], "none_if": 5, "nonetyp": [48, 53], "noninfring": 57, "norm": [48, 49], "norm_1": 44, "norm_2": 44, "notebook": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "notensor": 53, "noth": [53, 54], "notic": 57, "notimplementederror": 51, "now": [9, 46, 50, 51], "np": [5, 9, 52, 54], "np_dtype_to_tensor_dtyp": 6, "nrun": 53, "nstep": 53, "nto": 47, "num_hidden_lay": 43, "num_us": [46, 51], "number": [1, 5, 6, 47], "numer": [53, 54], "numi": 44, "numpi": [5, 6, 9, 11, 52, 54, 56], "nuntil": 52, "nvidia": [1, 9, 11], "nvtx": [9, 11], "nwa": 47, "o": [5, 53], "o_proj": [48, 49], "obj": [3, 4, 6], "object": [6, 48, 50, 53], "obtain": [51, 57], "obviou": [47, 53, 54], "off": 48, "offici": 11, "oh": [9, 52, 53, 54], "one": [3, 4, 5, 6, 7, 9, 11, 38, 47, 49, 50, 51, 52, 53, 54], "onednn": [46, 47, 48, 49, 50, 51], "ones": [9, 11, 38, 47], "onli": [1, 2, 3, 4, 6, 11, 38, 48, 51, 52, 53], "onnx": [5, 6, 7, 9, 11, 38, 45, 46, 47, 50, 51, 52, 53, 55, 58], "onnx_cpp2py_export": 52, "onnx_diagnost": [46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "onnx_dtype_nam": [6, 56], "onnx_dtype_to_np_dtyp": 6, "onnx_dtype_to_torch_dtyp": 6, "onnx_export_error": 5, "onnx_export_seri": 5, "onnx_find": 8, "onnx_lighten": 8, "onnx_nod": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "onnx_to_sess": 9, "onnx_tool": [5, 7], "onnx_unlighten": 8, "onnxruntim": [1, 5, 9, 11, 44, 45, 52, 54, 55, 56, 58], "onnxruntime_pybind11_st": [52, 53, 54], "onnxruntime_train": 5, "onnxruntimeerror": [52, 53, 54], "onnxruntimeevalu": 0, "onnxscript": [5, 56], "onx": [6, 8, 38, 44], "op": [5, 11, 46, 48, 49, 50, 51, 52, 53, 54], "op_add_add_mul_mul": [5, 11, 12], "op_attent": [5, 11], "op_average_pool_grad": [5, 11, 12], "op_bias_softmax": [5, 11], "op_cast_lik": [5, 11, 12], "op_complex": [5, 11, 12], "op_concat": [5, 11, 12], "op_constant_of_shap": [5, 11, 12], "op_fused_matmul": [5, 11, 12], "op_gath": [5, 11], "op_gather_el": [5, 11], "op_gather_grad": [5, 11, 12], "op_memcpy_host": [5, 11, 12], "op_mul_sigmoid": [5, 11, 12], "op_negxplus1": [5, 11, 12], "op_overload": 47, "op_qlinear_average_pool": [5, 11, 12], "op_qlinear_conv": [5, 11, 12], "op_quick_gelu": [5, 11, 12], "op_replace_zero": [5, 11, 12], "op_rotari": [5, 11, 12], "op_scatter_el": [5, 11, 12], "op_scatternd_of_shap": [5, 11, 12], "op_simplified_layer_norm": [5, 11, 12], "op_skip_layer_norm": [5, 11, 12], "op_slic": [5, 11, 12], "op_transpose_cast": [5, 11, 12], "op_tri_matrix": [5, 11, 12], "op_typ": 52, "oper": [11, 41, 46, 47, 51, 52, 53, 54], "opposit": 41, "oprun": 11, "opset": [11, 53], "opset_import": [9, 52, 53, 54], "optim": 11, "optimized_model_filepath": [9, 11], "option": [6, 9, 11, 41, 48], "or_older_than": 5, "order": [5, 6], "org": 49, "origin": [6, 37], "original_signatur": 48, "ort_evalu": [5, 11], "ort_sess": [5, 7, 52], "ortmodul": 5, "other": [5, 50, 57], "otherwis": [1, 49, 50, 52, 57], "out": [46, 47, 57], "out_featur": 44, "output": [5, 6, 9, 11, 38, 47, 48, 49, 50, 51, 52, 53], "output_attent": 48, "output_hidden_st": 48, "output_nam": [9, 11], "output_typ": 11, "outsid": [11, 53, 54], "over": 5, "overload": [9, 11], "overload_typ": 47, "overwrit": [5, 43], "own": 48, "p_lm_head_weight": [48, 49], "p_mlp_0_bia": 46, "p_mlp_0_weight": 46, "p_mlp_1_bia": 46, "p_mlp_1_weight": 46, "p_model_embed_tokens_weight": [48, 49], "p_model_layers_0_input_layernorm_weight": [48, 49], "p_model_layers_0_mlp_down_proj_weight": [48, 49], "p_model_layers_0_mlp_gate_proj_weight": [48, 49], "p_model_layers_0_mlp_up_proj_weight": [48, 49], "p_model_layers_0_post_attention_layernorm_weight": [48, 49], "p_model_layers_0_self_attn_k_proj_weight": [48, 49], "p_model_layers_0_self_attn_o_proj_weight": [48, 49], "p_model_layers_0_self_attn_q_proj_weight": [48, 49], "p_model_layers_0_self_attn_v_proj_weight": [48, 49], "p_model_norm_weight": [48, 49], "packag": [1, 46, 47, 48, 49, 50, 51, 56], "page": 48, "pair": 2, "paramet": [1, 2, 3, 4, 5, 6, 8, 9, 11, 37, 38, 41, 43, 44, 48, 49, 50], "params_len": 47, "pars": 1, "parser": 1, "part": [48, 49], "particular": 57, "pass": 41, "past": 41, "past_key_valu": [2, 41, 48, 49], "past_key_values_key_cache_0": [48, 49], "past_key_values_value_cache_0": [48, 49], "past_seen_token": [48, 49], "patch": [0, 5, 38, 43, 45, 47, 48, 50, 51, 55, 56, 58], "patch__check_input_constraints_for_graph": 40, "patch_modul": 49, "patch_sympi": 38, "patch_torch": [5, 38, 39, 47], "patch_transform": [5, 38, 39, 49, 50], "patched__broadcast_shap": 40, "patched_attentionmaskconvert": [41, 49], "patched_dynamiccach": [41, 49], "patched_generationmixin": [41, 49], "patched_infer_s": [40, 47], "patched_shapeenv": 40, "path": 5, "pathlik": 53, "pattern": [5, 11], "pe": 44, "permiss": 57, "permit": 57, "persist": [48, 49], "person": 57, "phantom_symbol": 48, "phi": 43, "phi2": 0, "piec": 44, "pin_memori": [48, 49], "pip": 56, "pipelin": 5, "placehold": [46, 51], "plai": 50, "pleas": [48, 51], "plot_export_cond": [46, 55, 58], "plot_export_locate_issu": [47, 55, 58], "plot_export_tiny_llm": [48, 55, 58], "plot_export_tiny_llm_patch": [49, 55, 58], "plot_export_with_dynamic_cach": [50, 55, 58], "plot_export_with_dynamic_shapes_auto": [51, 55, 58], "plot_failing_model_extract": [52, 55, 58], "plot_failing_onnxruntime_evalu": [53, 55, 58], "plot_failing_reference_evalu": [54, 55, 58], "plot_legend": [46, 47, 48, 49, 50, 51, 52, 53, 54], "point": 47, "portion": 57, "posit": [3, 4, 50], "position_id": [48, 49], "position_ids_expand": [48, 49], "possibl": [6, 53, 54], "post_attention_layernorm": [48, 49], "pow": [48, 49], "pow_1": [48, 49], "pow_2": [48, 49], "pow_3": [48, 49], "pprint": [3, 4, 5, 11, 48, 49, 50], "pr": [41, 48], "pre_dispatch": 47, "prefix": [5, 6], "prepar": 41, "prepare_inputs_for_gener": [41, 49], "pretty_onnx": 6, "previou": [47, 48], "previous_funct": 40, "print": [2, 3, 4, 5, 6, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "print_model": 5, "print_onnx": 5, "print_read": 48, "process": [3, 4, 52], "process_input": [3, 4], "produc": [6, 8, 52], "program": 38, "project": 5, "prompt": 48, "prop": 48, "properti": [3, 4, 11, 37], "prot": 6, "proto": [5, 6, 9, 11], "proto_from_tensor": 6, "provid": [6, 9, 11, 44, 48, 50, 52, 53, 54, 57], "proxy_cal": 47, "proxy_tensor": 47, "pt": 48, "publish": [1, 57], "pull": 48, "purpos": [3, 4, 44, 57], "purppos": 6, "push_back_batch": 5, "put": [38, 48], "py": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 58], "python": [11, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "python3": [46, 47, 48, 49, 50, 51], "pytorch": [1, 5, 6, 46, 47, 48, 49, 50, 51], "q_proj": [48, 49], "qlinearaveragepool": [11, 24], "qlinearconv": [11, 25], "qtensor": 37, "quantiz": 37, "quantized_tensor": [5, 11], "quantizedtensor": 37, "queri": 44, "query_st": [48, 49], "question": 47, "quickgelu": [11, 26], "quiet": [9, 52], "quit": 47, "r": [6, 47], "rain": 48, "rais": [0, 9, 46, 47, 51, 52], "rand": [6, 9, 47, 53, 54, 56], "randn": [2, 3, 4, 46, 50, 51], "random": [9, 48, 49, 54], "rang": [2, 37, 48, 49, 50, 51], "range_constraint": 40, "range_refined_to_singleton": 47, "raw": 6, "re": [5, 47, 48], "reach": [53, 54], "real": 5, "realli": [47, 48], "reason": [53, 54], "recent": [5, 47], "record": 47, "reduc": 38, "redund": 6, "ref": [11, 53, 54], "refactor": 0, "refer": [5, 7, 47, 53, 54, 56], "referenceevalu": [11, 45, 47, 52, 53, 55, 56, 58], "regist": [47, 49, 50], "register_additional_serialization_funct": 38, "registr": 38, "rel": [5, 6], "relat": [38, 46, 47, 48, 49, 50, 51, 52, 53, 54], "relaxed_sourc": 48, "relaxedunspecconstraint": 47, "reli": [50, 53], "relu": 44, "remov": [41, 47, 49], "renam": 6, "rename_dynamic_dimens": 6, "rename_dynamic_express": 6, "render": 6, "reorder": 41, "reorder_cach": [41, 49], "repeat": [1, 5], "replac": [6, 11, 46, 47, 49], "replacezero": [11, 27], "request": [6, 9], "requir": [11, 41, 48, 52], "requires_cuda": 5, "requires_diffus": 5, "requires_numpi": 5, "requires_onnx": 5, "requires_onnx_array_api": 5, "requires_onnxruntim": 5, "requires_onnxruntime_train": 5, "requires_onnxscript": 5, "requires_sklearn": 5, "requires_torch": 5, "requires_transform": 5, "requires_zoo": 5, "reshap": [48, 49], "reshape_1": [48, 49], "reshape_2": [48, 49], "reshape_3": [48, 49], "residu": [48, 49], "restart": 49, "restor": [38, 47, 48, 49], "restrict": 57, "result": [5, 8, 38, 45, 47, 48, 50, 51, 52, 55, 56, 58], "ret_val": 47, "retlog": 47, "retriev": 47, "return": [1, 2, 3, 4, 5, 6, 8, 9, 11, 41, 43, 44, 46, 47, 48, 49, 50, 51], "return_al": 11, "return_dict": 48, "return_tensor": 48, "revers": 8, "rewrit": [6, 48], "right": [7, 57], "root": 47, "rope": 43, "rotari": [11, 28], "rotary_emb": [48, 49], "row": 5, "rsqrt": [48, 49], "rsqrt_1": [48, 49], "rsqrt_2": [48, 49], "rst": 5, "rtol": 5, "run": [5, 6, 9, 11, 38, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56, 58], "run_dlpack": 9, "run_param": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "run_training_api": 9, "runtest": 5, "runtim": [51, 53, 54], "runtimeerror": 53, "s0": [47, 49, 50, 51], "s1": [48, 49, 50, 51], "s11": 50, "s15": 6, "s3": 51, "s5": 51, "s7": [48, 49], "same": [9, 48, 49, 50, 51], "satisfi": 51, "scalar": [46, 48, 49], "scale": [37, 48, 49], "scaled_dot_product_attent": [48, 49], "scatterel": [11, 29], "scatterndofshap": [11, 30], "scenario": [1, 11], "schema": [13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35], "scikit": 5, "script": [1, 5, 46, 47, 48, 49, 50, 51, 52, 53, 54], "sdpython": 56, "search": [8, 41], "second": [46, 47, 48, 49, 50, 51, 52, 53, 54], "section": 47, "see": [5, 9, 11, 38, 41, 43, 46, 48, 49, 53, 54], "select": 41, "self": [3, 4, 5, 46, 47, 48, 49, 50, 51], "self_attn": [48, 49], "sell": 57, "sent": 5, "separ": 1, "seq_length": [6, 48, 49], "sequenc": [5, 41, 43], "sequence_length": 43, "sequence_length2": 43, "sequenti": 46, "serial": [2, 38, 49, 50], "serializetostr": [9, 52, 53, 54], "sess": 9, "session": [9, 53], "session_opt": [9, 11], "sessionopt": [9, 11], "set": [3, 4, 5, 6, 8, 38, 50, 51], "set1": 5, "set2": 5, "setupclass": 5, "shall": 57, "shape": [0, 3, 4, 6, 9, 37, 38, 43, 44, 45, 46, 49, 53, 54, 55, 56, 58], "shape_env": 47, "shape_infer": [6, 52], "shaped_model": 52, "shapeenv": 47, "shapeinferenceerror": 52, "share": 46, "should": [41, 46, 49], "show": [5, 38, 47, 48, 49, 50, 53], "sig": [6, 47], "sigmoid": [52, 53, 54], "signatur": [3, 4, 6, 48, 49, 50, 51], "silu": [48, 49], "similar": 43, "simpl": [6, 9], "simplifiedlayernorm": [11, 31], "sin": [48, 49], "singl": 6, "site": [46, 47, 48, 49, 50, 51], "situat": 38, "size": [6, 43, 46, 47, 48, 49, 50, 51, 53, 56], "size_oblivi": 47, "size_typ": 6, "sizea": 47, "sizeb": 47, "skip": [5, 48, 49], "skip_solve_constraint": [38, 48], "skip_special_token": 48, "skipif_ci_appl": 5, "skipif_ci_linux": 5, "skipif_ci_window": 5, "skiplayernorm": [11, 32], "sklearn": 56, "sleep": 1, "slen": [2, 50], "slice": [41, 48, 49, 51], "slice_1": [11, 33, 48, 49, 51], "slice_10": [11, 33, 48, 49], "slice_11": [48, 49], "slice_12": [48, 49], "slice_13": [48, 49], "slice_14": [48, 49], "slice_15": [48, 49], "slice_16": [48, 49], "slice_17": [48, 49], "slice_18": [48, 49], "slice_19": [48, 49], "slice_2": [48, 49, 51], "slice_20": [48, 49], "slice_21": [48, 49], "slice_22": [48, 49], "slice_23": [48, 49], "slice_24": [48, 49], "slice_25": [48, 49], "slice_26": [48, 49], "slice_27": [48, 49], "slice_28": [48, 49], "slice_29": [48, 49], "slice_3": [48, 49], "slice_30": [48, 49], "slice_31": [48, 49], "slice_32": [48, 49], "slice_33": [48, 49], "slice_34": [48, 49], "slice_4": [48, 49], "slice_5": [48, 49], "slice_6": [48, 49], "slice_7": [48, 49], "slice_8": [48, 49], "slice_9": [48, 49], "slice_indic": [48, 49], "slow": [7, 53], "smi": 1, "so": [48, 50, 51, 57], "softwar": 57, "some": [6, 8, 38, 48, 52, 53, 56], "someth": 6, "sometim": 53, "soon": 38, "sooner": 52, "sort": 6, "sourc": [1, 2, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 40, 41, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 56], "source_pair": 48, "spars": [48, 49], "specif": [5, 6, 48], "specifi": [48, 49, 51, 52, 53, 54], "sphinx": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "split": [41, 53], "src": [46, 47, 48, 49, 50, 51], "stack": [38, 46, 47], "stack_model_output": 41, "stacktrac": [48, 49], "stage": 38, "standard": [5, 52, 53, 54], "start": [5, 6, 48, 49, 52], "stat": 8, "state": [41, 49], "statement": 5, "static": [0, 3, 4, 38], "statist": [5, 8], "statistics_on_fil": 5, "statistics_on_fold": 5, "stdout": 5, "steel": [43, 45, 49, 50, 55, 56, 58], "step": [48, 53], "stmt": 5, "stop": [9, 38, 52, 53, 54], "stop_if_stat": [38, 47], "store": 8, "str": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 44, 53], "strict": [38, 48, 49, 50], "strict_mod": 52, "stride": [48, 49], "string": [5, 6, 47], "string_diff": 6, "string_sig": 6, "string_signatur": 6, "string_typ": [2, 3, 4, 6, 48, 49, 50, 56], "subclass": 41, "subfold": 5, "subject": 57, "sublicens": 57, "submod_1": [48, 49], "submod_3": [48, 49], "submodel": [45, 53, 54, 55, 56, 58], "submodul": [3, 4, 46], "submul": [11, 13], "substanti": 57, "substr": 5, "succe": 53, "suggest": [48, 49], "sum": [6, 46], "sum_1": 46, "super": [46, 47], "support": [9, 38, 46, 47, 48, 49, 50, 51, 53], "suspect": 46, "sy": [1, 52, 53, 54], "sym": [46, 48, 49, 51], "sym_nod": 47, "sym_siz": [48, 49, 51], "sym_size_int": 48, "sym_size_int_1": 48, "sym_size_int_13": 48, "sym_size_int_16": 48, "sym_size_int_17": 48, "sym_size_int_19": 48, "sym_size_int_2": 48, "sym_size_int_20": 48, "sym_size_int_21": 49, "sym_size_int_22": 49, "sym_size_int_23": 49, "sym_size_int_3": 51, "sym_size_int_4": 51, "sym_size_int_5": [48, 51], "symbol": 46, "symbolic_shap": 47, "sympi": [38, 47, 49], "t": 47, "t10s3x4": [6, 56], "t10s5x6": [6, 56], "t10s5x6x7": [6, 56], "t1s1x1x10x96": 48, "t1s1x1x11x96": 48, "t1s1x1x12x96": 48, "t1s1x1x13x96": 48, "t1s1x1x14x96": 48, "t1s1x1x15x96": 48, "t1s1x1x16x96": 48, "t1s1x1x17x96": 48, "t1s1x1x18x96": 48, "t1s1x1x19x96": 48, "t1s1x1x1x7": 50, "t1s1x1x20x96": 48, "t1s1x1x21x96": 48, "t1s1x1x22x96": 48, "t1s1x1x23x96": 48, "t1s1x1x24x96": 48, "t1s1x1x25x96": 48, "t1s1x1x26x96": 48, "t1s1x1x27x96": 48, "t1s1x1x28x96": 48, "t1s1x1x29x96": 48, "t1s1x1x30x96": 48, "t1s1x1x31x96": 48, "t1s1x1x32x96": 48, "t1s1x1x33x96": 48, "t1s1x1x34x96": 48, "t1s1x1x35x96": 48, "t1s1x1x36x96": 48, "t1s1x1x37x96": 48, "t1s1x1x38x96": 48, "t1s1x1x39x96": 48, "t1s1x1x40x96": 48, "t1s1x1x41x96": 48, "t1s1x1x42x96": 48, "t1s1x1x43x96": 48, "t1s1x1x44x96": 48, "t1s1x1x45x96": 48, "t1s1x1x46x96": 48, "t1s1x1x47x96": 48, "t1s1x1x48x96": 48, "t1s1x1x49x96": 48, "t1s1x1x8x96": 48, "t1s1x1x9x96": 48, "t1s1x6": [3, 4], "t1s2x1x30x96": [48, 49], "t1s2x1x33x96": 48, "t1s2x3x32000": 48, "t1s2x4x3x7": [2, 50], "t1s5x6": [3, 4], "t7s1": 48, "t7s1x1": 48, "t7s1x8": 48, "t7s2x3": [48, 49], "t7s2x33": [48, 49], "t7s8": 48, "take": [1, 38, 49], "target": [46, 48, 49, 51], "tbfloat16": 53, "teardownclass": 5, "tell": [2, 5, 44, 47, 52, 53, 54], "temperatur": 48, "tensor": [2, 3, 4, 6, 9, 37, 41, 44, 46, 47, 48, 49, 50, 51, 53], "tensor_dtyp": 6, "tensor_dtype_to_np_dtyp": 6, "tensor_scalar": [48, 49], "tensorproperti": 48, "tensorpropertysourc": 48, "tensorproto": [6, 8, 9, 52, 53, 54, 56], "term": 41, "test": [5, 11, 44, 48], "test_investigate_onnxruntime_issue_cal": 9, "test_nam": 5, "testcas": 5, "text": [1, 5, 6], "tf32": [46, 47, 48, 49, 50, 51], "tfloat": [9, 52, 54], "tgt": 47, "tgt_bound": 47, "thei": 49, "them": [5, 6, 50, 53], "thi": [1, 2, 3, 4, 5, 6, 7, 9, 11, 41, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 57], "thing": [52, 54], "this312": [46, 47, 48, 49, 50, 51], "though": 48, "through": [38, 48], "time": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54], "timer": 5, "timm": 56, "tini": [43, 45, 47, 50, 51, 55, 56, 58], "to_1": [48, 49], "to_10": [48, 49], "to_11": [48, 49], "to_12": [48, 49], "to_13": [48, 49], "to_2": [48, 49], "to_3": [48, 49], "to_4": [48, 49], "to_5": [48, 49], "to_6": [48, 49], "to_7": [48, 49], "to_8": [48, 49], "to_9": [48, 49], "to_array_extend": 6, "to_numpi": 44, "to_onnx": 38, "tocomplex": [11, 16], "todo": 5, "tofind": 5, "token": [41, 48, 49], "toler": 5, "tomato": [46, 47, 48, 50, 51], "tool": [50, 56], "top": [46, 47, 48, 49, 50, 51], "top_k": 48, "top_p": 48, "torch": [2, 3, 4, 5, 6, 9, 38, 40, 41, 44, 46, 47, 48, 49, 50, 51, 53, 56], "torch_dtype_to_onnx_dtyp": 6, "torch_export_patch": [5, 7, 47, 49, 50, 56], "torch_log": [46, 47, 48, 49, 51], "torch_model": [5, 7, 48, 49, 56], "torch_test_help": [5, 7], "torchdynamo_extended_debug_cpp": 46, "torchdynamo_extended_debug_create_symbol": 46, "torchruntimeerror": 47, "tort": 57, "total": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 58], "trace": [38, 46, 47], "traceback": 47, "traced_function_transform": 47, "tracer": 47, "train": [1, 9], "trane": [9, 11], "transform": [2, 3, 4, 5, 38, 41, 43, 47, 48, 49, 50, 56], "transpos": [48, 49], "transpose2dcastfp16": [11, 34], "transpose2dcastfp32": [11, 34], "transpose_1": [48, 49], "transpose_2": [48, 49], "transpose_3": [48, 49], "transpose_4": [48, 49], "tree": 1, "tree_out": 47, "tri": [1, 9, 38], "trick": 51, "tricki": 47, "trigger": [46, 47, 48, 49, 50, 51], "trimatrix": [11, 35], "triu": [48, 49], "troubl": 48, "true": [2, 3, 4, 5, 6, 9, 11, 38, 44, 47, 48, 49, 50, 52, 56], "true_graph_0": 46, "true_model_nam": [3, 4], "try": [46, 47, 48, 51, 52, 53, 54], "trycal": 5, "ttime": 5, "tupl": [1, 2, 3, 4, 5, 6, 8, 9, 11, 41, 44, 47, 48, 50], "ture": 47, "turn": 38, "tutori": 51, "tweak": [0, 47], "two": [3, 4, 50], "type": [3, 4, 5, 6, 11, 38, 46, 47, 48, 49, 50, 51, 52, 53, 54], "type_info": 6, "typeerror": 53, "typeinferenceerror": [52, 53, 54], "typeproto": 11, "u0": 46, "unabl": [51, 53], "understand": [5, 50, 56], "unhid": 5, "unhint": 46, "union": 48, "unit": [5, 44, 48], "unit_test_go": 5, "unittest": 5, "unknown": [6, 11], "unless": 46, "unpack": 48, "unpatch_modul": 49, "unregist": [47, 49], "unsqueez": [47, 48, 49], "unsqueeze_1": [48, 49], "unsqueeze_10": [48, 49], "unsqueeze_2": [48, 49], "unsqueeze_3": [48, 49], "unsqueeze_4": [48, 49], "unsqueeze_5": [48, 49], "unsqueeze_6": [48, 49], "unsqueeze_7": [48, 49], "unsqueeze_8": [48, 49], "unsqueeze_9": [48, 49], "unstabl": 49, "until": [5, 9, 47, 53, 54], "untrain": [5, 49], "untrained_model": [48, 49], "up": [5, 41], "up_proj": [48, 49], "updat": [41, 48, 49, 51, 56], "us": [3, 4, 6, 9, 11, 38, 41, 43, 44, 45, 46, 47, 48, 49, 50, 53, 54, 55, 56, 57, 58], "use_cach": 48, "use_training_api": [9, 11], "user": [6, 47], "user_input": [48, 49, 50, 51], "user_output": [48, 49, 50, 51], "usererror": [49, 51], "userwarn": [46, 47, 48, 49, 50, 51], "usp": 46, "util": [41, 47], "v_proj": [48, 49], "valid": [2, 3, 4, 47, 48, 49, 50, 52, 53, 54], "valu": [1, 2, 5, 6, 41, 44, 47, 48, 49, 50, 51, 53, 54], "value_cach": [2, 48, 49, 50], "value_st": [41, 48, 49], "valueinfoproto": 6, "variabl": [5, 6, 38], "varianc": [48, 49], "variance_epsilon": [48, 49], "ve": 48, "vector": 37, "verbos": [5, 6, 8, 9, 11, 38, 40, 47, 49, 52, 53, 54], "veri": [5, 47, 53], "version": [0, 2, 5, 11, 46, 47, 48, 49, 50, 51, 53], "view": [48, 49], "view_1": [48, 49], "view_2": [48, 49], "violat": [47, 48, 49, 51], "vr": [47, 48, 49, 50, 51], "vv": [46, 47, 48, 49, 50, 51], "wa": [46, 47, 48, 49, 51, 56], "wai": [6, 9, 47, 48, 52], "want": 48, "warmup": [1, 5], "warmup_tim": 5, "warn": 5, "warn_onli": 48, "warranti": 57, "watch": 8, "we": [46, 47, 48, 49, 50, 51, 52, 53, 54], "weight": [46, 48, 49], "well": [6, 9, 38, 44], "what": [5, 11, 46, 48], "when": [0, 5, 6, 7, 11, 38, 45, 46, 48, 53, 54, 55, 56, 58], "where": [45, 47, 51, 53, 54, 55, 56, 58], "whether": 57, "which": [5, 38, 50, 54], "while": [5, 6], "whole": 44, "whom": 57, "why": [48, 52, 54], "window": 5, "winter": 48, "with_attribut": 6, "with_devic": 6, "with_min_max": [6, 48], "with_shap": [2, 3, 4, 6, 48, 49, 50, 56], "without": [1, 8, 52, 54, 57], "work": [3, 4, 11, 41, 48, 49, 50, 51, 52], "would": [3, 4, 49], "wrap": [3, 4, 9, 47], "wrap_with_autocast": [48, 49], "wrap_with_set_grad_en": [48, 49], "wrapped_fn": 47, "wrapped_mod": 47, "wrapper": 47, "write": [48, 49], "wrong": 7, "x": [3, 4, 6, 9, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54], "x999": [52, 53, 54], "xadupr": [46, 47, 48, 49, 50, 51], "xy": [52, 53, 54], "y": [3, 4, 9, 47, 50, 51, 52, 53, 54], "you": [6, 46, 48, 49], "your": 48, "ys_0": [], "ys_1": [], "z": [9, 47, 50, 51, 52, 53, 54], "zero_point": 37, "zip": [45, 46, 47, 48, 49, 50, 51, 52, 53, 54], "zoo": 5}, "titles": ["Change Logs", "onnx_diagnostic.args", "onnx_diagnostic.cache_helpers", "onnx_diagnostic.export.dynamic_shapes", "onnx_diagnostic.export", "onnx_diagnostic.ext_test_case", "onnx_diagnostic.helpers", "API of onnx_diagnostic", "onnx_diagnostic.onnx_tools", "onnx_diagnostic.ort_session", "onnx_diagnostic.reference.evaluator", "onnx_diagnostic.reference", "onnx_diagnostic.reference.ops", "onnx_diagnostic.reference.ops.op_add_add_mul_mul", "onnx_diagnostic.reference.ops.op_average_pool_grad", "onnx_diagnostic.reference.ops.op_cast_like", "onnx_diagnostic.reference.ops.op_complex", "onnx_diagnostic.reference.ops.op_concat", "onnx_diagnostic.reference.ops.op_constant_of_shape", "onnx_diagnostic.reference.ops.op_fused_matmul", "onnx_diagnostic.reference.ops.op_gather_grad", "onnx_diagnostic.reference.ops.op_memcpy_host", "onnx_diagnostic.reference.ops.op_mul_sigmoid", "onnx_diagnostic.reference.ops.op_negxplus1", "onnx_diagnostic.reference.ops.op_qlinear_average_pool", "onnx_diagnostic.reference.ops.op_qlinear_conv", "onnx_diagnostic.reference.ops.op_quick_gelu", "onnx_diagnostic.reference.ops.op_replace_zero", "onnx_diagnostic.reference.ops.op_rotary", "onnx_diagnostic.reference.ops.op_scatter_elements", "onnx_diagnostic.reference.ops.op_scatternd_of_shape", "onnx_diagnostic.reference.ops.op_simplified_layer_normalization", "onnx_diagnostic.reference.ops.op_skip_layer_normalization", "onnx_diagnostic.reference.ops.op_slice", "onnx_diagnostic.reference.ops.op_transpose_cast", "onnx_diagnostic.reference.ops.op_tri_matrix", "onnx_diagnostic.reference.ort_evaluator", "onnx_diagnostic.reference.quantized_tensor", "onnx_diagnostic.torch_export_patches", "onnx_diagnostic.torch_export_patches.patches", "onnx_diagnostic.torch_export_patches.patches.patch_torch", "onnx_diagnostic.torch_export_patches.patches.patch_transformers", "onnx_diagnostic.torch_models", "onnx_diagnostic.torch_models.llms", "onnx_diagnostic.torch_test_helper", "Examples Gallery", "Export a model with a control flow (If)", "Find and fix an export issue due to dynamic shapes", "Steel method forward to guess the dynamic shapes (with Tiny-LLM)", "Export Tiny-LLM with patches", "Export with DynamicCache and dynamic shapes", "Use DYNAMIC or AUTO when exporting if dynamic shapes has constraints", "Find where a model is failing by running submodels", "Intermediate results with onnxruntime", "Intermediate results with (ONNX) ReferenceEvaluator", "Computation times", "onnx-diagnostic: investigate onnx models", "License", "Computation times"], "titleterms": {"0": 0, "1": 0, "2": 0, "A": [46, 47, 52, 53, 54], "If": 46, "With": 49, "allow": 51, "an": [47, 52], "api": 7, "arg": [1, 50], "auto": 51, "back": 48, "cache_help": 2, "chang": 0, "comput": [55, 58], "constraint": 51, "content": 56, "control": 46, "detect": 52, "diagnost": 56, "dimens": 47, "due": 47, "dx": 51, "dy": 51, "dynam": [47, 48, 50, 51], "dynamic_shap": 3, "dynamiccach": 50, "enlighten": 56, "error": 49, "evalu": 10, "exampl": [45, 50, 56], "export": [3, 4, 46, 47, 49, 50, 51], "exportedprogram": 48, "ext_test_cas": 5, "extendedreferenceevalu": [11, 54], "fail": [52, 53, 54], "find": [47, 52], "fix": 47, "flow": 46, "forward": 48, "function": [4, 11], "galleri": 45, "get": 56, "guess": 48, "ha": 51, "helper": 6, "i": 52, "infer": 52, "intermedi": [53, 54], "investig": 56, "issu": [47, 52], "kwarg": 50, "licens": 57, "llm": [43, 48, 49], "log": 0, "loop": 52, "method": 48, "model": [46, 47, 48, 49, 52, 53, 54, 56], "modelinput": 4, "modul": [4, 7, 11, 12, 39], "more": 56, "node": 52, "older": 56, "onnx": [54, 56], "onnx_diagnost": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44], "onnx_tool": 8, "onnxruntim": 53, "onnxruntimeevalu": [11, 53], "op": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "op_add_add_mul_mul": 13, "op_average_pool_grad": 14, "op_cast_lik": 15, "op_complex": 16, "op_concat": 17, "op_constant_of_shap": 18, "op_fused_matmul": 19, "op_gather_grad": 20, "op_memcpy_host": 21, "op_mul_sigmoid": 22, "op_negxplus1": 23, "op_qlinear_average_pool": 24, "op_qlinear_conv": 25, "op_quick_gelu": 26, "op_replace_zero": 27, "op_rotari": 28, "op_scatter_el": 29, "op_scatternd_of_shap": 30, "op_simplified_layer_norm": 31, "op_skip_layer_norm": 32, "op_slic": 33, "op_transpose_cast": 34, "op_tri_matrix": 35, "origin": [48, 49], "ort_evalu": 36, "ort_sess": 9, "other": [4, 11], "over": 52, "patch": [39, 40, 41, 46, 49], "patch_torch": 40, "patch_transform": 41, "quantized_tensor": 37, "refer": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "referenceevalu": 54, "result": [53, 54], "run": 52, "shape": [47, 48, 50, 51, 52], "simpl": 50, "start": 56, "static": 47, "steel": 48, "stop": 47, "submodel": 52, "submodul": [7, 11, 38, 42], "suggest": 46, "test": 46, "time": [55, 58], "tini": [48, 49], "torch_export_patch": [38, 39, 40, 41], "torch_model": [42, 43], "torch_test_help": 44, "turn": 47, "untrain": 48, "us": 51, "version": 56, "when": [47, 51], "where": 52}})