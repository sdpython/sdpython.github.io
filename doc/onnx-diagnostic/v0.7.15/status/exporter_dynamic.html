<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Coverage of the Patches" href="patches_coverage.html"><link rel="prev" title="Exported Programs with Dynamic Shapes" href="exported_program_dynamic.html">
        <link rel="prefetch" href="../_static/logo.png" as="image">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Exported ONNX with Dynamic Shapes - onnx-diagnostic 0.7.15 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a7360d90" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">onnx-diagnostic 0.7.15 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">onnx-diagnostic 0.7.15 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../patches.html">Patches Explained</a><input aria-label="Toggle navigation of Patches Explained" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Exporter Status</a><input aria-label="Toggle navigation of Exporter Status" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exported_program_dynamic.html">Exported Programs with Dynamic Shapes</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Exported ONNX with Dynamic Shapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="patches_coverage.html">Coverage of the Patches</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API of onnx_diagnostic</a><input aria-label="Toggle navigation of API of onnx_diagnostic" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/export/index.html">onnx_diagnostic.export</a><input aria-label="Toggle navigation of onnx_diagnostic.export" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/export/dynamic_shapes.html">onnx_diagnostic.export.dynamic_shapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/export/shape_helper.html">onnx_diagnostic.export.shape_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/export/validate.html">onnx_diagnostic.export.validate</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/helpers/index.html">onnx_diagnostic.helpers</a><input aria-label="Toggle navigation of onnx_diagnostic.helpers" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/args_helper.html">onnx_diagnostic.helpers.args_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/bench_run.html">onnx_diagnostic.helpers.bench_run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/cache_helper.html">onnx_diagnostic.helpers.cache_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/config_helper.html">onnx_diagnostic.helpers.config_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/doc_helper.html">onnx_diagnostic.helpers.doc_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/graph_helper.html">onnx_diagnostic.helpers.graph_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/helper.html">onnx_diagnostic.helpers.helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/_log_helper.html">onnx_diagnostic.helpers._log_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/log_helper.html">onnx_diagnostic.helpers.log_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/memory_peak.html">onnx_diagnostic.helpers.memory_peak</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/mini_onnx_builder.html">onnx_diagnostic.helpers.mini_onnx_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/model_builder_helper.html">onnx_diagnostic.helpers.model_builder_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/onnx_helper.html">onnx_diagnostic.helpers.onnx_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/ort_session.html">onnx_diagnostic.helpers.ort_session</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/rt_helper.html">onnx_diagnostic.helpers.rt_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/helpers/torch_helper.html">onnx_diagnostic.helpers.torch_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/reference/index.html">onnx_diagnostic.reference</a><input aria-label="Toggle navigation of onnx_diagnostic.reference" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/reference/ops/index.html">onnx_diagnostic.reference.ops</a><input aria-label="Toggle navigation of onnx_diagnostic.reference.ops" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_add_add_mul_mul.html">onnx_diagnostic.reference.ops.op_add_add_mul_mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_average_pool_grad.html">onnx_diagnostic.reference.ops.op_average_pool_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_cast_like.html">onnx_diagnostic.reference.ops.op_cast_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_complex.html">onnx_diagnostic.reference.ops.op_complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_concat.html">onnx_diagnostic.reference.ops.op_concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_constant_of_shape.html">onnx_diagnostic.reference.ops.op_constant_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_fused_matmul.html">onnx_diagnostic.reference.ops.op_fused_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_gather_grad.html">onnx_diagnostic.reference.ops.op_gather_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_memcpy_host.html">onnx_diagnostic.reference.ops.op_memcpy_host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_mul_sigmoid.html">onnx_diagnostic.reference.ops.op_mul_sigmoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_negxplus1.html">onnx_diagnostic.reference.ops.op_negxplus1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_quick_gelu.html">onnx_diagnostic.reference.ops.op_quick_gelu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_replace_zero.html">onnx_diagnostic.reference.ops.op_replace_zero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_rotary.html">onnx_diagnostic.reference.ops.op_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_average_pool.html">onnx_diagnostic.reference.ops.op_qlinear_average_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_conv.html">onnx_diagnostic.reference.ops.op_qlinear_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatter_elements.html">onnx_diagnostic.reference.ops.op_scatter_elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatternd_of_shape.html">onnx_diagnostic.reference.ops.op_scatternd_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_simplified_layer_normalization.html">onnx_diagnostic.reference.ops.op_simplified_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_skip_layer_normalization.html">onnx_diagnostic.reference.ops.op_skip_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_slice.html">onnx_diagnostic.reference.ops.op_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_transpose_cast.html">onnx_diagnostic.reference.ops.op_transpose_cast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_tri_matrix.html">onnx_diagnostic.reference.ops.op_tri_matrix</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/reference/torch_ops/index.html">onnx_diagnostic.reference.torch_ops</a><input aria-label="Toggle navigation of onnx_diagnostic.reference.torch_ops" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/access_ops.html">onnx_diagnostic.reference.torch_ops.access_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/binary_ops.html">onnx_diagnostic.reference.torch_ops.binary_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/controlflow_ops.html">onnx_diagnostic.reference.torch_ops.controlflow_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/generator_ops.html">onnx_diagnostic.reference.torch_ops.generator_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/nn_ops.html">onnx_diagnostic.reference.torch_ops.nn_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/other_ops.html">onnx_diagnostic.reference.torch_ops.other_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/reduce_ops.html">onnx_diagnostic.reference.torch_ops.reduce_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/sequence_ops.html">onnx_diagnostic.reference.torch_ops.sequence_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/shape_ops.html">onnx_diagnostic.reference.torch_ops.shape_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/torch_ops/unary_ops.html">onnx_diagnostic.reference.torch_ops.unary_ops</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/evaluator.html">onnx_diagnostic.reference.evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/quantized_tensor.html">onnx_diagnostic.reference.quantized_tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/ort_evaluator.html">onnx_diagnostic.reference.ort_evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/report_results_comparison.html">onnx_diagnostic.reference.report_results_comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/torch_evaluator.html">onnx_diagnostic.reference.torch_evaluator</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/tasks/index.html">onnx_diagnostic.tasks</a><input aria-label="Toggle navigation of onnx_diagnostic.tasks" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/automatic_speech_recognition.html">onnx_diagnostic.tasks.automatic_speech_recognition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/fill_mask.html">onnx_diagnostic.tasks.fill_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/feature_extraction.html">onnx_diagnostic.tasks.feature_extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/image_classification.html">onnx_diagnostic.tasks.image_classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/image_text_to_text.html">onnx_diagnostic.export.image_text_to_text</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/mixture_of_expert.html">onnx_diagnostic.tasks.mixture_of_expert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/object_detection.html">onnx_diagnostic.tasks.object_detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/sentence_similarity.html">onnx_diagnostic.tasks.sentence_similarity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/summarization.html">onnx_diagnostic.tasks.summarization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/text_classification.html">onnx_diagnostic.tasks.text_classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/text_generation.html">onnx_diagnostic.tasks.text_generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/text_to_image.html">onnx_diagnostic.tasks.text_to_image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/text2text_generation.html">onnx_diagnostic.tasks.text2text_generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tasks/zero_shot_image_classification.html">onnx_diagnostic.tasks.zero_shot_image_classification</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_export_patches/index.html">onnx_diagnostic.torch_export_patches</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_export_patches" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_export_patches/eval/index.html">onnx_diagnostic.torch_export_patches.eval</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_export_patches.eval" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_export_patches/eval/model_cases.html">onnx_diagnostic.torch_export_patches.eval.model_cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/onnx_export_errors.html">onnx_diagnostic.torch_export_patches.onnx_export_errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/onnx_export_serialization.html">onnx_diagnostic.torch_export_patches.onnx_export_serialization</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_export_patches/patches/index.html">onnx_diagnostic.torch_export_patches.patches</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_export_patches.patches" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_export_patches/patches/patch_torch.html">onnx_diagnostic.torch_export_patches.patches.patch_torch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_export_patches/patches/patch_transformers.html">onnx_diagnostic.torch_export_patches.patches.patch_transformers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/patch_expressions.html">onnx_diagnostic.torch_export_patches.patch_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/patch_inputs.html">onnx_diagnostic.torch_export_patches.patch_inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/patch_module.html">onnx_diagnostic.torch_export_patches.patch_module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_export_patches/patch_module_helper.html">onnx_diagnostic.torch_export_patches.patch_module_helper</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_export_patches/serialization/index.html">onnx_diagnostic.torch_export_patches.serialization</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_export_patches.serialization" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_export_patches/serialization/diffusers_impl.html">onnx_diagnostic.torch_export_patches.serialization.diffusers_impl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_export_patches/serialization/transformers_impl.html">onnx_diagnostic.torch_export_patches.serialization.transformers_impl</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_models/index.html">onnx_diagnostic.torch_models</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_models" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_models/hghub/index.html">onnx_diagnostic.torch_models.hghub</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_models.hghub" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_models/hghub/hub_api.html">onnx_diagnostic.torch_models.hghub.hub_api</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_models/hghub/hub_data.html">onnx_diagnostic.torch_models.hghub.hub_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_models/hghub/model_inputs.html">onnx_diagnostic.torch_models.hghub.model_inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llms.html">onnx_diagnostic.torch_models.llms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/validate.html">onnx_diagnostic.torch_models.validate</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_onnx/index.html">onnx_diagnostic.torch_onnx</a><input aria-label="Toggle navigation of onnx_diagnostic.torch_onnx" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_onnx/runtime_info.html">onnx_diagnostic.torch_onnx.runtime_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_onnx/sbs.html">onnx_diagnostic.torch_onnx.sbs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/api.html">onnx_diagnostic.api</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ext_test_case.html">onnx_diagnostic.ext_test_case</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cmds/index.html">Command Lines</a><input aria-label="Toggle navigation of Command Lines" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cmds/config.html">-m onnx_diagnostic config … prints the config for a model id</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmds/validate.html">-m onnx_diagnostic validate … validate a model id</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a><input aria-label="Toggle navigation of Examples Gallery" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_dump_intermediate_results.html">Dumps intermediate results of a torch model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_with_args_kwargs.html">Dynamic Shapes for <code class="docutils literal notranslate"><span class="pre">*args</span></code>, <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_llm_patched.html">Export Tiny-LLM with patches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_phi2.html">Export microsoft/phi-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_with_dynamic_cache.html">Export with DynamicCache and guessed dynamic shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_llm_dim01.html">Export with dynamic dimensions in <code class="docutils literal notranslate"><span class="pre">{0,1}</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_llm_dim01_onnx.html">Export with dynamic dimensions in <code class="docutils literal notranslate"><span class="pre">{0,1}</span></code> into ONNX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_llm_dim01_onnx_custom.html">Export with dynamic dimensions in <code class="docutils literal notranslate"><span class="pre">{0,1}</span></code> into ONNX (custom)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_locate_issue.html">Find and fix an export issue due to dynamic shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_failing_model_extract.html">Find where a model is failing by running submodels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_failing_reference_evaluator.html">Intermediate results with (ONNX) ReferenceEvaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_failing_onnxruntime_evaluator.html">Intermediate results with onnxruntime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_tiny_llm.html">Steel method forward to guess inputs and dynamic shapes (with Tiny-LLM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_export_hub_codellama.html">Test the export on untrained models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_recipes/index.html">Common Export Issues</a><input aria-label="Toggle navigation of Common Export Issues" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_export_dim1.html">0, 1, 2 for a Dynamic Dimension in the dummy example to export a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_dynamic_shapes_what.html">Builds dynamic shapes from any input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_dynamic_shapes_max.html">Cannot export <code class="docutils literal notranslate"><span class="pre">torch.sym_max(x.shape[0],</span> <span class="pre">y.shape[0])</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_dynamic_shapes_python_int.html">Do not use python int with dynamic shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_export_cond.html">Export a model with a control flow (If)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_dynamic_shapes_nonzero.html">Half certain nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_dynamic_shapes_json.html">JSON returns list when the original dynamic shapes are list or tuple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_recipes/plot_export_with_dynamic.html">Use DYNAMIC or AUTO when exporting if dynamic shapes has constraints</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_technical/index.html">Technical Details</a><input aria-label="Toggle navigation of Technical Details" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_technical/plot_layer_norm_discrepancies.html">LayerNormalization implementation cannot be exchanged</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_technical/plot_parallelized_reduction.html">Reproducible Parallelized Reduction is difficult</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/status/exporter_dynamic.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="exported-onnx-with-dynamic-shapes">
<h1>Exported ONNX with Dynamic Shapes<a class="headerlink" href="#exported-onnx-with-dynamic-shapes" title="Link to this heading">¶</a></h1>
<p>The following script shows the exported program for many short cases
and various l-plot-export-with-dynamic-shape to retrieve an ONNX model equivalent
to the original model.</p>
<div class="admonition">
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">onnx_diagnostic.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">string_type</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">onnx_diagnostic.helpers.onnx_helper</span><span class="w"> </span><span class="kn">import</span> <span class="n">pretty_onnx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">onnx_diagnostic.torch_export_patches.eval</span><span class="w"> </span><span class="kn">import</span> <span class="n">discover</span><span class="p">,</span> <span class="n">run_exporter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">onnx_diagnostic.ext_test_case</span><span class="w"> </span><span class="kn">import</span> <span class="n">unit_test_going</span>

<span class="n">cases</span> <span class="o">=</span> <span class="n">discover</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;:ref:`Summary &lt;ledx-summary-exported-program&gt;`&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">sorted_cases</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cases</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="k">if</span> <span class="n">unit_test_going</span><span class="p">():</span>
    <span class="n">sorted_cases</span> <span class="o">=</span> <span class="n">sorted_cases</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls_model</span> <span class="ow">in</span> <span class="n">sorted_cases</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;* :ref:`</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &lt;ledx-model-case-export-</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;`&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">obs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls_model</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cases</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.. _ledx-model-case-export-</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+++++++&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.. code-block:: python&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">cls_model</span><span class="o">.</span><span class="n">forward</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">src</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="s2">&quot;    &quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    # code is missing&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">exporter</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;custom&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamo-ir&quot;</span><span class="p">):</span>
        <span class="n">expname</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;export-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">expname</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">expname</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">run_exporter</span><span class="p">(</span><span class="n">exporter</span><span class="p">,</span> <span class="n">cls_model</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">case_ref</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;:ref:`</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &lt;ledx-model-case-export-</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;`&quot;</span>
        <span class="n">expo</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;* **inputs:** ``</span><span class="si">{</span><span class="n">string_type</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;dynamic_shapes&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;* **shapes:** ``</span><span class="si">{</span><span class="n">string_type</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;dynamic_shapes&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">``&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;onx&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.. code-block:: text&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">pretty_onnx</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;onx&quot;</span><span class="p">]),</span> <span class="s2">&quot;    &quot;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                <span class="n">obs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case_ref</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">exporter</span><span class="o">=</span><span class="n">expo</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;**FAILED**&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.. code-block:: text&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="n">err</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="s2">&quot;    &quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    # no error found for the failure&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case_ref</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;FAIL&quot;</span><span class="p">,</span> <span class="n">exporter</span><span class="o">=</span><span class="n">expo</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.. _ledx-summary-exported-program:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summary&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+++++++&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="n">piv</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;case&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;exporter&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">piv</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;rst&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>&gt;&gt;&gt;</p>
<p><a class="reference internal" href="#ledx-summary-exported-program"><span class="std std-ref">Summary</span></a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#ledx-model-case-export-atenasstrided"><span class="std std-ref">AtenAsStrided</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-ateninterpolate"><span class="std std-ref">AtenInterpolate</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-atennonzero"><span class="std std-ref">AtenNonZero</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-atennonzerotuple"><span class="std std-ref">AtenNonZeroTuple</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-atenrollpos"><span class="std std-ref">AtenRollPos</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-atenrollrelu"><span class="std std-ref">AtenRollRelu</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-buildinisinstance"><span class="std std-ref">BuildInIsInstance</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-buildinlen"><span class="std std-ref">BuildInLen</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-complexpolar"><span class="std std-ref">ComplexPolar</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond"><span class="std std-ref">ControlFlowCond</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond2inputs"><span class="std std-ref">ControlFlowCond2Inputs</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond2outputs"><span class="std std-ref">ControlFlowCond2Outputs</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondconstant"><span class="std std-ref">ControlFlowCondConstant</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondidentity-153832"><span class="std std-ref">ControlFlowCondIdentity_153832</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondnestedmodule"><span class="std std-ref">ControlFlowCondNestedModule</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondnonzero"><span class="std std-ref">ControlFlowCondNonZero</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflownestcond"><span class="std std-ref">ControlFlowNestCond</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscan"><span class="std std-ref">ControlFlowScan</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscan2carried"><span class="std std-ref">ControlFlowScan2Carried</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdist"><span class="std std-ref">ControlFlowScanCDist</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdist2"><span class="std std-ref">ControlFlowScanCDist2</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdistxy"><span class="std std-ref">ControlFlowScanCDistXY</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscandecomposition-151564"><span class="std std-ref">ControlFlowScanDecomposition_151564</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-controlflowscaninplace-153705"><span class="std std-ref">ControlFlowScanInplace_153705</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-createfromshape"><span class="std std-ref">CreateFromShape</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-createfromshapethroughfunction"><span class="std std-ref">CreateFromShapeThroughFunction</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-croplastdimensionwithtensorcontent"><span class="std std-ref">CropLastDimensionWithTensorContent</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-croplastdimensionwithtensorshape"><span class="std std-ref">CropLastDimensionWithTensorShape</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-exportwithdimension0"><span class="std std-ref">ExportWithDimension0</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-exportwithdimension1"><span class="std std-ref">ExportWithDimension1</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd"><span class="std std-ref">InplaceAdd</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd2"><span class="std std-ref">InplaceAdd2</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd-mul"><span class="std std-ref">InplaceAdd_Mul</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacecloneadd"><span class="std std-ref">InplaceCloneAdd_</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemellipsis-1"><span class="std std-ref">InplaceSetItemEllipsis_1</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemellipsis-2"><span class="std std-ref">InplaceSetItemEllipsis_2</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemmask"><span class="std std-ref">InplaceSetItemMask</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquare"><span class="std std-ref">InplaceSetItemSquare</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquareadd"><span class="std std-ref">InplaceSetItemSquareAdd</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquareadd2"><span class="std std-ref">InplaceSetItemSquareAdd2</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signaturefloat1"><span class="std std-ref">SignatureFloat1</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signatureint1"><span class="std std-ref">SignatureInt1</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signatureint2"><span class="std std-ref">SignatureInt2</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signaturelistfixedlength"><span class="std std-ref">SignatureListFixedLength</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signaturelistfixedwithnone"><span class="std std-ref">SignatureListFixedWithNone</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signaturelistvariablelength"><span class="std std-ref">SignatureListVariableLength</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-signatureshapeasindex"><span class="std std-ref">SignatureShapeAsIndex</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-typebfloat16"><span class="std std-ref">TypeBFloat16</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-vmap"><span class="std std-ref">Vmap</span></a></p></li>
<li><p><a class="reference internal" href="#ledx-model-case-export-vmappython"><span class="std std-ref">VmapPython</span></a></p></li>
</ul>
<section id="atenasstrided">
<span id="ledx-model-case-export-atenasstrided"></span><h2>AtenAsStrided<a class="headerlink" href="#atenasstrided" title="Link to this heading">¶</a></h2>
<section id="forward">
<h3>forward<a class="headerlink" href="#forward" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="custom">
<h3>custom<a class="headerlink" href="#custom" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>The implementation is still incorrect, x=&#39;x&#39;, shape=(&#39;batch&#39;, 2, 8, 8), size=[2, 2, 8, 4], stride=[128, 8, 16, 1], storage_offset=None
--DEBUG--
[GraphBuilder-FXW] Message starts, there are 0 initializers, 0 nodes, 1 inputs, 1 outputs.
--CONSTRAINTS--
    batch = {&#39;s77&#39;}
    s77 = {&#39;batch&#39;}
--SHAPE--
_dynamic_examples=
dynamic_objects=
   batch = &#39;batch&#39;
   s77 = &#39;s77&#39;
dynamic_objects_rev=
   &#39;batch&#39; = &lt;class &#39;list&#39;&gt;
     tuple
       &#39;batch&#39;
       ERR**: &lt;class &#39;torch.SymInt&#39;&gt;:&#39;batch&#39;
dynamic_dimensions_source={&#39;batch&#39;: [{&#39;axis&#39;: 0, &#39;input_name&#39;: &#39;x&#39;}]}
dynamic_dimensions_source_flat=[&#39;x&#39;]
output_dynamic_dimensions_source_flat=None
dynamic_alias={&#39;s77&#39;: &#39;batch&#39;}
dynamic_shapes={&#39;x&#39;: {0: Dim(&#39;batch&#39;, min=0)}}
_known_shapes={&#39;x&#39;: (&#39;batch&#39;, 2, 8, 8)}
_known_types={&#39;x&#39;: 1}
_known_value_shape={}
_known_constants=[]
_known_ranks (with no shape)={}
--PARAMETERS--
_parameter_renaming=
--TORCH-USERS--
    as_strided -&gt; {output}
    x -&gt; {as_strided}
--TORCH-SHAPES--
    x: (&#39;run_node&#39;, (&#39;&#39;, (&#39;val&#39;, torch.float32, torch.Size([s77, 2, 8, 8])))) --- 1:4:(&#39;batch&#39;, 2, 8, 8):
    as_strided: (&#39;run_node&#39;, (&#39;&#39;, (&#39;val&#39;, torch.float32, torch.Size([2, 2, 8, 4])))) --- :::
--ONNX--
-- EXEPATH --
export-export_options=ExportOptions(aten_as_function=(&#39;aten.index_copy.default&#39;, &#39;aten.index_put.default&#39;, &#39;aten.setitem&#39;, &lt;built-in function setitem&gt;))
-- process.graph_module --
ExportedProgram:
    class GraphModule(torch.nn.Module):
        def forward(self, x: &quot;f32[s77, 2, 8, 8]&quot;):
             # File: ~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py:186 in forward, code: y = torch.as_strided(x, (2, 2, 8, 4), (128, 8, 16, 1))
            as_strided: &quot;f32[2, 2, 8, 4]&quot; = torch.ops.aten.as_strided.default(x, [2, 2, 8, 4], [128, 8, 16, 1]);  x = None
            return (as_strided,)
        
Graph signature: 
    # inputs
    x: USER_INPUT

    # outputs
    as_strided: USER_OUTPUT

Range constraints: {s77: VR[0, int_oo]}

-- process.graph_module.graph --
graph():
    %x : [num_users=1] = placeholder[target=x]
    %as_strided : [num_users=1] = call_function[target=torch.ops.aten.as_strided.default](args = (%x, [2, 2, 8, 4], [128, 8, 16, 1]), kwargs = {})
    return (as_strided,)
-- process.inputs_to_remove --
set()
-- process.progress --
node 1/3 target=aten.as_strided.default
-- 1 INPUTS
[GraphBuilder-FXW.make_tensor_input] x[1:batchx2x8x8]
-- 0 INITIALIZERS
-- 0 OUTPUTS
[GraphBuilder-FXW] Message completed, there are 0 initializers, 0 nodes, 1 inputs, 1 outputs.
</pre></div>
</div>
</section>
<section id="dynamo-ir">
<h3>dynamo-ir<a class="headerlink" href="#dynamo-ir" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x2x8x8,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2, 8, 8]
init: name=&#39;val_0&#39; type=int64 shape=(4,) -- array([2, 2, 8, 4])
init: name=&#39;val_1&#39; type=int64 shape=(4,) -- array([128,   8,  16,   1])
init: name=&#39;neg_1&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;rank_tensor&#39; type=int64 shape=(1,) -- array([4])
init: name=&#39;indices&#39; type=int64 shape=() -- array([0])
init: name=&#39;rank_0&#39; type=int64 shape=() -- array([4])
init: name=&#39;int64_1_cast&#39; type=int64 shape=() -- array([1])
init: name=&#39;tmp_14&#39; type=float32 shape=(1,) -- array([1.], dtype=float32)
Reshape(x, neg_1) -&gt; self_flatten
SequenceEmpty() -&gt; one_seq
Loop(rank_0, , one_seq, indices, body=G1) -&gt; one_seq_16, indices_17
  CastLike(indices, indices_17) -&gt; storage_offset_cast
  Add(indices_17, storage_offset_cast) -&gt; indices_19
  Gather(self_flatten, indices_19) -&gt; as_strided
output: name=&#39;as_strided&#39; type=dtype(&#39;float32&#39;) shape=[2, 2, 8, 4]
----- subgraph ---- Loop - n6_2 - att.body=G1 -- level=1 -- i,cond_in,one_seq_1,indices_2 -&gt; cond_out,one_seq_15,indices_13
input: name=&#39;i&#39; type=dtype(&#39;int64&#39;) shape=None
input: name=&#39;cond_in&#39; type=dtype(&#39;bool&#39;) shape=None
input: name=&#39;one_seq_1&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;indices_2&#39; type=&#39;NOTENSOR&#39; shape=None
Equal(i, indices) -&gt; cond
Sub(rank_0, i) -&gt; tmp
Sub(tmp, int64_1_cast) -&gt; j
Reshape(j, neg_1) -&gt; j_tensor
Gather(val_0, j_tensor, axis=0) -&gt; size_dim_j
Range(indices, size_dim_j, int64_1_cast) -&gt; tmp_6
Slice(val_0, j_tensor, rank_tensor) -&gt; size_after_j
  Expand(indices_2, size_after_j) -&gt; indices_4
Gather(val_1, j_tensor, axis=0) -&gt; stride_dim_j
  Mul(tmp_6, stride_dim_j) -&gt; add_value
If(cond, then_branch=G2, else_branch=G3) -&gt; shape_11
  Reshape(add_value, shape_11) -&gt; add_value_12
    Add(indices_4, add_value_12) -&gt; indices_13
SequenceInsert(one_seq_1, tmp_14) -&gt; one_seq_15
Identity(cond_in) -&gt; cond_out
output: name=&#39;cond_out&#39; type=dtype(&#39;bool&#39;) shape=None
output: name=&#39;one_seq_15&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;indices_13&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - n20 - att.then_branch=G2 -- level=2 --  -&gt; shape
Identity(size_dim_j) -&gt; shape
output: name=&#39;shape&#39; type=dtype(&#39;int64&#39;) shape=[1]
----- subgraph ---- If - n20 - att.else_branch=G3 -- level=2 --  -&gt; shape_10
Cast(size_dim_j, to=1) -&gt; tmp_8
ConcatFromSequence(one_seq_1, axis=0) -&gt; ones
  Concat(tmp_8, ones, axis=0) -&gt; shape_9
    Cast(shape_9, to=7) -&gt; shape_10
output: name=&#39;shape_10&#39; type=dtype(&#39;int64&#39;) shape=None
----- subgraph ---- If - n20 - att.then_branch=G2 -- level=1 --  -&gt; shape
Identity(size_dim_j) -&gt; shape
output: name=&#39;shape&#39; type=dtype(&#39;int64&#39;) shape=[1]
----- subgraph ---- If - n20 - att.else_branch=G3 -- level=1 --  -&gt; shape_10
Cast(size_dim_j, to=1) -&gt; tmp_8
ConcatFromSequence(one_seq_1, axis=0) -&gt; ones
  Concat(tmp_8, ones, axis=0) -&gt; shape_9
    Cast(shape_9, to=7) -&gt; shape_10
output: name=&#39;shape_10&#39; type=dtype(&#39;int64&#39;) shape=None
</pre></div>
</div>
</section>
</section>
<section id="ateninterpolate">
<span id="ledx-model-case-export-ateninterpolate"></span><h2>AtenInterpolate<a class="headerlink" href="#ateninterpolate" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>forward<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
        <span class="n">recompute_scale_factor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>custom<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x2x3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2, 3, 4]
init: name=&#39;init7_s2_6_8&#39; type=int64 shape=(2,) -- array([6, 8])      -- _aten_upsample_output_size.rsize
Shape(x, end=2, start=0) -&gt; x::Shape:2
  Concat(x::Shape:2, init7_s2_6_8, axis=0) -&gt; _onx_concat_x::Shape:2
Resize(x, , , _onx_concat_x::Shape:2, coordinate_transformation_mode=b&#39;pytorch_half_pixel&#39;, mode=b&#39;linear&#39;, nearest_mode=b&#39;floor&#39;) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2, 6, 8]
</pre></div>
</div>
</section>
<section id="id3">
<h3>dynamo-ir<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x2x3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2, 3, 4]
init: name=&#39;val_0&#39; type=float32 shape=(4,) -- array([1., 1., 2., 2.], dtype=float32)
Resize(x, , val_0, keep_aspect_ratio_policy=b&#39;stretch&#39;, antialias=0, extrapolation_value=0.00, exclude_outside=0, nearest_mode=b&#39;floor&#39;, coordinate_transformation_mode=b&#39;pytorch_half_pixel&#39;, cubic_coeff_a=-0.75, mode=b&#39;linear&#39;) -&gt; upsample_bilinear2d
output: name=&#39;upsample_bilinear2d&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2, 6, 8]
</pre></div>
</div>
</section>
</section>
<section id="atennonzero">
<span id="ledx-model-case-export-atennonzero"></span><h2>AtenNonZero<a class="headerlink" href="#atennonzero" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3>forward<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>custom<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
NonZero(x) -&gt; _onx_nonzero_x
  Transpose(_onx_nonzero_x, perm=[1,0]) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;int64&#39;) shape=[&#39;NEWDIM_nonzero&#39;, 2]
</pre></div>
</div>
</section>
<section id="id6">
<h3>dynamo-ir<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
NonZero(x) -&gt; val_0
  Transpose(val_0, perm=[1,0]) -&gt; nonzero
output: name=&#39;nonzero&#39; type=dtype(&#39;int64&#39;) shape=[&#39;u0&#39;, 2]
</pre></div>
</div>
</section>
</section>
<section id="atennonzerotuple">
<span id="ledx-model-case-export-atennonzerotuple"></span><h2>AtenNonZeroTuple<a class="headerlink" href="#atennonzerotuple" title="Link to this heading">¶</a></h2>
<section id="id7">
<h3>forward<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>custom<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;init7_s1_0&#39; type=int64 shape=(1,) -- array([0])           -- ReshapeIsSqueezePattern.m1##ReshapeIsSqueezePattern.m1
NonZero(x) -&gt; _onx_nonzero_x
  Split(_onx_nonzero_x, num_outputs=2) -&gt; _onx_split_nonzero_x_0, _onx_split_nonzero_x_1
    Squeeze(_onx_split_nonzero_x_0, init7_s1_0) -&gt; output_0
Squeeze(_onx_split_nonzero_x_1, init7_s1_0) -&gt; output_1
output: name=&#39;output_0&#39; type=dtype(&#39;int64&#39;) shape=[&#39;u0&#39;]
output: name=&#39;output_1&#39; type=dtype(&#39;int64&#39;) shape=[&#39;u0&#39;]
</pre></div>
</div>
</section>
<section id="id9">
<h3>dynamo-ir<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;val_5&#39; type=int64 shape=(1,) -- array([1])
NonZero(x) -&gt; val_0
  Transpose(val_0, perm=[1,0]) -&gt; nonzero
    Split(nonzero, num_outputs=2, axis=1) -&gt; val_3, val_4
      Squeeze(val_3, val_5) -&gt; getitem
Squeeze(val_4, val_5) -&gt; getitem_1
output: name=&#39;getitem&#39; type=dtype(&#39;int64&#39;) shape=[&#39;u0&#39;]
output: name=&#39;getitem_1&#39; type=dtype(&#39;int64&#39;) shape=[&#39;u0&#39;]
</pre></div>
</div>
</section>
</section>
<section id="atenrollpos">
<span id="ledx-model-case-export-atenrollpos"></span><h2>AtenRollPos<a class="headerlink" href="#atenrollpos" title="Link to this heading">¶</a></h2>
<section id="id10">
<h3>forward<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>custom<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
init: name=&#39;init7_s1_-1&#39; type=int64 shape=(1,) -- array([-1])         -- Opset.make_node.1/Shape##Opset.make_node.1/Shape##Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_4&#39; type=int64 shape=(1,) -- array([4])           -- Opset.make_node.1/Shape
init: name=&#39;init7_s1_0&#39; type=int64 shape=(1,) -- array([0])           -- Opset.make_node.1/Shape
Slice(x, init7_s1_-1, init7_s1_4, init7_s1_-1) -&gt; _onx_slice_x
Slice(x, init7_s1_0, init7_s1_-1, init7_s1_-1) -&gt; _onx_slice_x2
  Concat(_onx_slice_x, _onx_slice_x2, axis=-1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
</pre></div>
</div>
</section>
<section id="id12">
<h3>dynamo-ir<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>An error occurred when running the &#39;&lt;onnx_ir.passes.PassManager object at 0x77e018398b60&gt;&#39; pass after the following passes: [&#39;&lt;onnx_ir.passes.common.inliner.InlinePass object at 0x77e00fc5bdd0&gt;&#39;]
</pre></div>
</div>
</section>
</section>
<section id="atenrollrelu">
<span id="ledx-model-case-export-atenrollrelu"></span><h2>AtenRollRelu<a class="headerlink" href="#atenrollrelu" title="Link to this heading">¶</a></h2>
<section id="id13">
<h3>forward<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>custom<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_4&#39; type=int64 shape=(1,) -- array([4])           -- Opset.make_node.1/Shape
init: name=&#39;init7_s1_-1&#39; type=int64 shape=(1,) -- array([-1])         -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_0&#39; type=int64 shape=(1,) -- array([0])           -- Opset.make_node.1/Shape
Slice(x, init7_s1_1, init7_s1_4, init7_s1_-1) -&gt; _onx_slice_x
Slice(x, init7_s1_0, init7_s1_1, init7_s1_-1) -&gt; _onx_slice_x2
  Concat(_onx_slice_x, _onx_slice_x2, axis=-1) -&gt; _onx_concat_slice_x
    Relu(_onx_concat_slice_x) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
</pre></div>
</div>
</section>
<section id="id15">
<h3>dynamo-ir<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s2x3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
init: name=&#39;val_0&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_2&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([0])
Size(x) -&gt; val_5
  Reshape(val_5, val_0, allowzero=0) -&gt; val_6
    Slice(x, val_2, val_6, val_0) -&gt; val_7
Slice(x, val_3, val_2, val_0) -&gt; val_4
  Concat(val_7, val_4, axis=-1) -&gt; roll
    Relu(roll) -&gt; relu
output: name=&#39;relu&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 4]
</pre></div>
</div>
</section>
</section>
<section id="buildinisinstance">
<span id="ledx-model-case-export-buildinisinstance"></span><h2>BuildInIsInstance<a class="headerlink" href="#buildinisinstance" title="Link to this heading">¶</a></h2>
<section id="id16">
<h3>forward<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">t</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">lx</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3>custom<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#2[T1s8x1,T1s8x2])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([-0.021,  0.148,  0.347], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.369], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
ReduceSum(lx_1, init7_s1_1, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul
    Add(sub, mul) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
<section id="id18">
<h3>dynamo-ir<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#2[T1s8x1,T1s8x2])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([ 0.154,  0.017, -0.265], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.272], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1])
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_4
ReduceSum(lx_1, val_3, noop_with_empty_axes=0, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul_1
    Add(sub_4, mul_1) -&gt; add_15
output: name=&#39;add_15&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
</section>
<section id="buildinlen">
<span id="ledx-model-case-export-buildinlen"></span><h2>BuildInLen<a class="headerlink" href="#buildinlen" title="Link to this heading">¶</a></h2>
<section id="id19">
<h3>forward<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">lx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">t</span>
</pre></div>
</div>
</section>
<section id="id20">
<h3>custom<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#3[T1s8x1,T1s8x2,T1s8x3])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([-0.018, -0.515,  0.252], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.089], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
ReduceSum(lx_1, init7_s1_1, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul
    Add(sub, mul) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diff.1
</pre></div>
</div>
</section>
<section id="id21">
<h3>dynamo-ir<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#3[T1s8x1,T1s8x2,T1s8x3])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([ 0.323, -0.147, -0.086], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.167], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1])
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_4
ReduceSum(lx_1, val_3, noop_with_empty_axes=0, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul_1
    Add(sub_4, mul_1) -&gt; add_15
output: name=&#39;add_15&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diff.1
</pre></div>
</div>
</section>
</section>
<section id="complexpolar">
<span id="ledx-model-case-export-complexpolar"></span><h2>ComplexPolar<a class="headerlink" href="#complexpolar" title="Link to this heading">¶</a></h2>
<section id="id22">
<h3>forward<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id23">
<h3>custom<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,T1s4x4)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},angle:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
input: name=&#39;angle&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;init14_s1_&#39; type=complex64 shape=(1,) -- array([0.+1.j], dtype=complex64)-- Opset.make_node.1/Small
Cast(x, to=14) -&gt; x::C14
Cos(angle) -&gt; _onx_cos_angle
  Cast(_onx_cos_angle, to=14) -&gt; _onx_cos_angle::C14
Sin(angle) -&gt; _onx_sin_angle
  Cast(_onx_sin_angle, to=14) -&gt; _onx_sin_angle::C14
    Mul(_onx_sin_angle::C14, init14_s1_) -&gt; _onx_mul_sin_angle::C14
    Add(_onx_cos_angle::C14, _onx_mul_sin_angle::C14) -&gt; _onx_add_cos_angle::C14
  Mul(x::C14, _onx_add_cos_angle::C14) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;complex64&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[ONNXRuntimeError] : 10 : INVALID_GRAPH : This is an invalid model. Type Error: Type &#39;tensor(complex64)&#39; of input parameter (_onx_sin_angle::C14) of operator (Mul) in node (polar5) is invalid.
</pre></div>
</div>
</section>
<section id="id24">
<h3>dynamo-ir<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,T1s4x4)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},angle:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
input: name=&#39;angle&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;int64_m1_1d&#39; type=int64 shape=(1,) -- array([-1])
Cos(angle) -&gt; tmp
  Mul(x, tmp) -&gt; tmp_0
    Unsqueeze(tmp_0, int64_m1_1d) -&gt; real
Sin(angle) -&gt; tmp_1
  Mul(x, tmp_1) -&gt; tmp_2
    Unsqueeze(tmp_2, int64_m1_1d) -&gt; imag
      Concat(real, imag, axis=-1) -&gt; polar
output: name=&#39;polar&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4, 2]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diff.0
</pre></div>
</div>
</section>
</section>
<section id="controlflowcond">
<span id="ledx-model-case-export-controlflowcond"></span><h2>ControlFlowCond<a class="headerlink" href="#controlflowcond" title="Link to this heading">¶</a></h2>
<section id="id25">
<h3>forward<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn</span><span class="p">,</span> <span class="n">false_fn</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id26">
<h3>custom<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- shape_type_compute._cast_inputs.1(gt_Scalar)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init1_s_) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0
Cos(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0
Sin(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id27">
<h3>dynamo-ir<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([0.], dtype=float32)
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, scalar_tensor_default) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0 - att.then_branch=G1 -- level=1 --  -&gt; sin_true_graph_0
Sin(x) -&gt; sin_true_graph_0
output: name=&#39;sin_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0 - att.else_branch=G2 -- level=1 --  -&gt; cos_false_graph_0
Cos(x) -&gt; cos_false_graph_0
output: name=&#39;cos_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
</pre></div>
</div>
</section>
</section>
<section id="controlflowcond2inputs">
<span id="ledx-model-case-export-controlflowcond2inputs"></span><h2>ControlFlowCond2Inputs<a class="headerlink" href="#controlflowcond2inputs" title="Link to this heading">¶</a></h2>
<section id="id28">
<h3>forward<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn</span><span class="p">,</span> <span class="n">false_fn</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>custom<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,T1s5x3)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- shape_type_compute._cast_inputs.1(gt_Scalar)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init1_s_) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0, output_1
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;output_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0,cond#1
Cos(x) -&gt; cond#0
Sin(x) -&gt; sin2
Add(sin2, y) -&gt; cond#1
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;cond#1&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0,cond#1
Cos(x) -&gt; cos2
Add(cos2, y) -&gt; cond#1
Sin(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;cond#1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id30">
<h3>dynamo-ir<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,T1s5x3)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([0.], dtype=float32)
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, scalar_tensor_default) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem, getitem_1
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;getitem_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__1 - att.then_branch=G1 -- level=1 --  -&gt; sin_true_graph_0,add_12_true_graph_0
Cos(x) -&gt; cos
Add(cos, y) -&gt; add_12_true_graph_0
Sin(x) -&gt; sin_true_graph_0
output: name=&#39;sin_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;add_12_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__1 - att.else_branch=G2 -- level=1 --  -&gt; cos_false_graph_0,add_12_false_graph_0
Cos(x) -&gt; cos_false_graph_0
Sin(x) -&gt; sin_2
Add(sin_2, y) -&gt; add_12_false_graph_0
output: name=&#39;cos_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;add_12_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
</pre></div>
</div>
</section>
</section>
<section id="controlflowcond2outputs">
<span id="ledx-model-case-export-controlflowcond2outputs"></span><h2>ControlFlowCond2Outputs<a class="headerlink" href="#controlflowcond2outputs" title="Link to this heading">¶</a></h2>
<section id="id31">
<h3>forward<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn</span><span class="p">,</span> <span class="n">false_fn</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id32">
<h3>custom<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- shape_type_compute._cast_inputs.1(gt_Scalar)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init1_s_) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0, output_1
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;output_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0,cond#1
Cos(x) -&gt; cond#0
Sin(x) -&gt; cond#1
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;cond#1&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0,cond#1
Cos(x) -&gt; cond#1
Sin(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;cond#1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id33">
<h3>dynamo-ir<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([0.], dtype=float32)
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, scalar_tensor_default) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem, getitem_1
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;getitem_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__1 - att.then_branch=G1 -- level=1 --  -&gt; sin_true_graph_0,cos_true_graph_0
Cos(x) -&gt; cos_true_graph_0
Sin(x) -&gt; sin_true_graph_0
output: name=&#39;sin_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;cos_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__1 - att.else_branch=G2 -- level=1 --  -&gt; cos_false_graph_0,sin_false_graph_0
Cos(x) -&gt; cos_false_graph_0
Sin(x) -&gt; sin_false_graph_0
output: name=&#39;cos_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
output: name=&#39;sin_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
</pre></div>
</div>
</section>
</section>
<section id="controlflowcondconstant">
<span id="ledx-model-case-export-controlflowcondconstant"></span><h2>ControlFlowCondConstant<a class="headerlink" href="#controlflowcondconstant" title="Link to this heading">¶</a></h2>
<section id="id34">
<h3>forward<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn</span><span class="p">,</span> <span class="n">false_fn</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id35">
<h3>custom<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s1024x1024,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1024]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- shape_type_compute._cast_inputs.1(gt_Scalar)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init1_s_) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1024]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0
Constant(value=[1, 1024]) -&gt; init7_s2_1_10242
  ConstantOfShape(init7_s2_1_10242, value=[1.0]) -&gt; ones2
Cos(x) -&gt; cos2
  Add(cos2, ones2) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0
Constant(value=[1024]) -&gt; init7_s1_10242
Shape(x, end=1, start=0) -&gt; x::Shape:12
  Concat(x::Shape:12, init7_s1_10242, axis=0) -&gt; _onx_concat_sym_size_int_1::UnSq02
    ConstantOfShape(_onx_concat_sym_size_int_1::UnSq02, value=[1.0]) -&gt; ones32
Sin(x) -&gt; sin2
  Sub(sin2, ones32) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id36">
<h3>dynamo-ir<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s1024x1024,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1024]
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([0.], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1024])
init: name=&#39;val_7&#39; type=float32 shape=() -- array([1.], dtype=float32)
init: name=&#39;ones_2&#39; type=float32 shape=(1, 1024)
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, scalar_tensor_default) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1024]
----- subgraph ---- If - node_cond__0 - att.then_branch=G1 -- level=1 --  -&gt; sub_3_true_graph_0
Shape(x, end=1, start=0) -&gt; val_0_2
Concat(val_0_2, val_3, axis=0) -&gt; val_4
Expand(val_7, val_4) -&gt; ones
Sin(x) -&gt; sin
  Sub(sin, ones) -&gt; sub_3_true_graph_0
output: name=&#39;sub_3_true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;&#39;, 1024]
----- subgraph ---- If - node_cond__0 - att.else_branch=G2 -- level=1 --  -&gt; add_6_false_graph_0
Cos(x) -&gt; cos
Add(cos, ones_2) -&gt; add_6_false_graph_0
output: name=&#39;add_6_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1024]
</pre></div>
</div>
</section>
</section>
<section id="controlflowcondidentity-153832">
<span id="ledx-model-case-export-controlflowcondidentity-153832"></span><h2>ControlFlowCondIdentity_153832<a class="headerlink" href="#controlflowcondidentity-153832" title="Link to this heading">¶</a></h2>
<section id="id37">
<h3>forward<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">branch_cond_then_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">branch_cond_else_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span>  <span class="c1"># fails but succeeds with x.clone()</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">branch_cond_then_1</span><span class="p">,</span> <span class="n">branch_cond_else_1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id38">
<h3>custom<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Cond doesn&#39;t work unless it is captured completely with torch.compile. Got Encountered aliasing during higher order op tracing
  Explanation: Higher order ops do not support aliasing. Found in cond
  Hint: Replace `return input` with `return input.clone()` to avoid aliasing.
  Hint: Consider using the debug context to change user code to avoid aliasing.
  Hint: Please open an issue.

  Developer debug context: Input-to-output aliasing detected at nodes l_args_3_0_ and l_args_3_0_ in
     graph():
        %l_args_3_0_ : torch._subclasses.fake_tensor.FakeTensor [num_users=1] = placeholder[target=l_args_3_0_]
        return (l_args_3_0_,)

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0040.html

from user code:
   File &quot;~/vv/this312/lib/python3.12/site-packages/torch/_higher_order_ops/cond.py&quot;, line 215, in _cond_op_wrapper
    return cond_op(*args, **kwargs)
  File &quot;~/vv/this312/lib/python3.12/site-packages/torch/_export/non_strict_utils.py&quot;, line 1103, in __torch_function__
    return func(*args, **kwargs)

Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you&#39;re reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=&quot;+dynamo&quot;
</pre></div>
</div>
</section>
<section id="id39">
<h3>dynamo-ir<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;torch._dynamo.exc.UncapturedHigherOrderOpError&#39;&gt;: Cond doesn&#39;t work unless it is captured completely with torch.compile. Got Encountered aliasing during higher order op tracing
  Explanation: Higher order ops do not support aliasing. Found in cond
  Hint: Replace `return input` with `return input.clone()` to avoid aliasing.
  Hint: Consider using the debug context to change user code to avoid aliasing.
  Hint: Please open an issue.

  Developer debug context: Input-to-output aliasing detected at nodes l_args_3_0_ and l_args_3_0_ in
     graph():
        %l_args_3_0_ : torch._subclasses.fake_tensor.FakeTensor [num_users=1] = placeholder[target=l_args_3_0_]
        return (l_args_3_0_,)

 For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0040.html

from user code:
   File &quot;~/vv/this312/lib/python3.12/site-packages/torch/_higher_order_ops/cond.py&quot;, line 215, in _cond_op_wrapper
    return cond_op(*args, **kwargs)
  File &quot;~/vv/this312/lib/python3.12/site-packages/torch/_export/non_strict_utils.py&quot;, line 1103, in __torch_function__
    return func(*args, **kwargs)

Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you&#39;re reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=&quot;+dynamo&quot;


(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="controlflowcondnestedmodule">
<span id="ledx-model-case-export-controlflowcondnestedmodule"></span><h2>ControlFlowCondNestedModule<a class="headerlink" href="#controlflowcondnestedmodule" title="Link to this heading">¶</a></h2>
<section id="id40">
<h3>forward<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodule</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn</span><span class="p">,</span> <span class="n">false_fn</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id41">
<h3>custom<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T7s2,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions.0&#39; version=1
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;int64&#39;) shape=[&#39;batch&#39;]
init: name=&#39;init7_s_0&#39; type=int64 shape=() -- array([0])              -- shape_type_compute._cast_inputs.1(gt_Scalar)
init: name=&#39;weight&#39; type=float32 shape=(1,) -- array([42.], dtype=float32)-- DynamoInterpret.placeholder.1/P(weight)
init: name=&#39;submodule.weight&#39; type=float32 shape=(1,) -- array([100.], dtype=float32)-- DynamoInterpret.placeholder.1/P(submodule.weight)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init7_s_0) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;d_output_0_0&#39;]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0
Cast(x, to=1) -&gt; x::C12
Sub(x::C12, weight) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0
Abs(x) -&gt; abs_12
  ReduceSum(abs_12, keepdims=0) -&gt; sum_122
Constant(value=100) -&gt; init7_s_1002
  Greater(sum_122, init7_s_1002) -&gt; gt22
    If(gt22, else_branch=G3, then_branch=G4) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.else_branch=G3 -- level=2 --  -&gt; cond#0
Cast(x, to=1) -&gt; x::C132
Div(x::C132, submodule.weight) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.then_branch=G4 -- level=2 --  -&gt; cond#0
Cast(x, to=1) -&gt; x::C142
Mul(x::C142, submodule.weight) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.else_branch=G3 -- level=1 --  -&gt; cond#0
Cast(x, to=1) -&gt; x::C132
Div(x::C132, submodule.weight) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.then_branch=G4 -- level=1 --  -&gt; cond#0
Cast(x, to=1) -&gt; x::C142
Mul(x::C142, submodule.weight) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id42">
<h3>dynamo-ir<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T7s2,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;int64&#39;) shape=[&#39;batch&#39;]
init: name=&#39;weight&#39; type=float32 shape=(1,) -- array([42.], dtype=float32)
init: name=&#39;submodule.weight&#39; type=float32 shape=(1,) -- array([100.], dtype=float32)
init: name=&#39;val_0&#39; type=int64 shape=() -- array([0])
init: name=&#39;val_0_2&#39; type=int64 shape=() -- array([100])
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, val_0) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
----- subgraph ---- If - node_cond__0 - att.then_branch=G1 -- level=1 --  -&gt; getitem_true_graph_0
Abs(x) -&gt; abs_1
  ReduceSum(abs_1, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1_2
Greater(sum_1_2, val_0_2) -&gt; gt_2
  If(gt_2, then_branch=G3, else_branch=G4) -&gt; getitem_true_graph_0
output: name=&#39;getitem_true_graph_0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - node_cond__0_2 - att.then_branch=G3 -- level=2 --  -&gt; mul_1_true_graph_0__true_graph_0
Cast(x, to=1) -&gt; convert_element_type_default
Mul(convert_element_type_default, submodule.weight) -&gt; mul_1_true_graph_0__true_graph_0
output: name=&#39;mul_1_true_graph_0__true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
----- subgraph ---- If - node_cond__0_2 - att.else_branch=G4 -- level=2 --  -&gt; div_true_graph_0__false_graph_0
Cast(x, to=1) -&gt; convert_element_type_default_2
Div(convert_element_type_default_2, submodule.weight) -&gt; div_true_graph_0__false_graph_0
output: name=&#39;div_true_graph_0__false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
----- subgraph ---- If - node_cond__0_2 - att.then_branch=G3 -- level=1 --  -&gt; mul_1_true_graph_0__true_graph_0
Cast(x, to=1) -&gt; convert_element_type_default
Mul(convert_element_type_default, submodule.weight) -&gt; mul_1_true_graph_0__true_graph_0
output: name=&#39;mul_1_true_graph_0__true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
----- subgraph ---- If - node_cond__0_2 - att.else_branch=G4 -- level=1 --  -&gt; div_true_graph_0__false_graph_0
Cast(x, to=1) -&gt; convert_element_type_default_2
Div(convert_element_type_default_2, submodule.weight) -&gt; div_true_graph_0__false_graph_0
output: name=&#39;div_true_graph_0__false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
----- subgraph ---- If - node_cond__0 - att.else_branch=G2 -- level=1 --  -&gt; sub_1_false_graph_0
Cast(x, to=1) -&gt; convert_element_type_default_3
Sub(convert_element_type_default_3, weight) -&gt; sub_1_false_graph_0
output: name=&#39;sub_1_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
</pre></div>
</div>
</section>
</section>
<section id="controlflowcondnonzero">
<span id="ledx-model-case-export-controlflowcondnonzero"></span><h2>ControlFlowCondNonZero<a class="headerlink" href="#controlflowcondnonzero" title="Link to this heading">¶</a></h2>
<section id="id43">
<h3>forward<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_ids</span><span class="p">,</span> <span class="n">image_features</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">then_branch</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">image_features</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">):</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_ids</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">input_ids</span> <span class="o">&gt;</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">))</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">clamp_min</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">clamp_max</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">else_branch</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">image_features</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
        <span class="n">image_features</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">then_branch</span><span class="p">,</span>
        <span class="n">else_branch</span><span class="p">,</span>
        <span class="p">[</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">image_features</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>custom<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Expect operands to be a tuple of possibly nested dict/list/tuple that only consists of tensor leaves, but got [FakeTensor(..., size=(s72, 12), dtype=torch.int64), FakeTensor(..., size=(s28, s11)), 1025].
</pre></div>
</div>
</section>
<section id="id45">
<h3>dynamo-ir<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;RuntimeError&#39;&gt;: Expect operands to be a tuple of possibly nested dict/list/tuple that only consists of tensor leaves, but got [FakeTensor(..., size=(s72, 12), dtype=torch.int64), FakeTensor(..., size=(s28, s11)), 1025].

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="controlflownestcond">
<span id="ledx-model-case-export-controlflownestcond"></span><h2>ControlFlowNestCond<a class="headerlink" href="#controlflownestcond" title="Link to this heading">¶</a></h2>
<section id="id46">
<h3>forward<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">true_fn2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">true_fn1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">false_fn1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn1</span><span class="p">,</span> <span class="n">false_fn1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">false_fn2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true_fn2</span><span class="p">,</span> <span class="n">false_fn2</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id47">
<h3>custom<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions.0&#39; version=1
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- shape_type_compute._cast_inputs.1(gt_Scalar)
ReduceSum(x, keepdims=0) -&gt; sum_1
  Greater(sum_1, init1_s_) -&gt; gt
    If(gt, else_branch=G1, then_branch=G2) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - cond - att.else_branch=G1 -- level=1 --  -&gt; cond#0
Neg(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond - att.then_branch=G2 -- level=1 --  -&gt; cond#0
Constant(value=0.0) -&gt; init1_s_22
ReduceSum(x, keepdims=0) -&gt; sum_122
  Less(sum_122, init1_s_22) -&gt; lt2
    If(lt2, else_branch=G3, then_branch=G4) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.else_branch=G3 -- level=2 --  -&gt; cond#0
Cos(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.then_branch=G4 -- level=2 --  -&gt; cond#0
Sin(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.else_branch=G3 -- level=1 --  -&gt; cond#0
Cos(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - cond22 - att.then_branch=G4 -- level=1 --  -&gt; cond#0
Sin(x) -&gt; cond#0
output: name=&#39;cond#0&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id48">
<h3>dynamo-ir<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([0.], dtype=float32)
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Greater(sum_1, scalar_tensor_default) -&gt; gt
    If(gt, then_branch=G1, else_branch=G2) -&gt; getitem
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0 - att.then_branch=G1 -- level=1 --  -&gt; getitem_true_graph_0
ReduceSum(x, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1_2
Less(sum_1_2, scalar_tensor_default) -&gt; lt
  If(lt, then_branch=G3, else_branch=G4) -&gt; getitem_true_graph_0
output: name=&#39;getitem_true_graph_0&#39; type=&#39;NOTENSOR&#39; shape=None
----- subgraph ---- If - node_cond__0_2 - att.then_branch=G3 -- level=2 --  -&gt; sin_true_graph_0__true_graph_0
Sin(x) -&gt; sin_true_graph_0__true_graph_0
output: name=&#39;sin_true_graph_0__true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0_2 - att.else_branch=G4 -- level=2 --  -&gt; cos_true_graph_0__false_graph_0
Cos(x) -&gt; cos_true_graph_0__false_graph_0
output: name=&#39;cos_true_graph_0__false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0_2 - att.then_branch=G3 -- level=1 --  -&gt; sin_true_graph_0__true_graph_0
Sin(x) -&gt; sin_true_graph_0__true_graph_0
output: name=&#39;sin_true_graph_0__true_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0_2 - att.else_branch=G4 -- level=1 --  -&gt; cos_true_graph_0__false_graph_0
Cos(x) -&gt; cos_true_graph_0__false_graph_0
output: name=&#39;cos_true_graph_0__false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
----- subgraph ---- If - node_cond__0 - att.else_branch=G2 -- level=1 --  -&gt; neg_false_graph_0
Neg(x) -&gt; neg_false_graph_0
output: name=&#39;neg_false_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
</pre></div>
</div>
</section>
</section>
<section id="controlflowscan">
<span id="ledx-model-case-export-controlflowscan"></span><h2>ControlFlowScan<a class="headerlink" href="#controlflowscan" title="Link to this heading">¶</a></h2>
<section id="id49">
<h3>forward<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">init</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">carry</span><span class="p">,</span> <span class="n">_out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">ControlFlowScan</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">init</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">additional_inputs</span><span class="o">=</span><span class="p">[]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">carry</span>
</pre></div>
</div>
</section>
<section id="id50">
<h3>custom<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;init7_s1_3&#39; type=int64 shape=(1,) -- array([3])           -- Opset.make_node.1/Shape
ConstantOfShape(init7_s1_3, value=[0.0]) -&gt; zeros_like
  Scan(zeros_like, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_axes=[0], scan_output_directions=[0]) -&gt; output_0, scan#1
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[3]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- init_0_zeros_like,scan_0_x -&gt; output_0,output_1
input: name=&#39;init_0_zeros_like&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
Add(init_0_zeros_like, scan_0_x) -&gt; output_0
  Identity(output_0) -&gt; output_1
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id51">
<h3>dynamo-ir<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to decompose the FX graph for ONNX compatibility. [96mThis is step 2/3[0m of exporting the model to ONNX. Next steps:
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.
- Create an error report with `torch.onnx.export(..., report=True)`, and save the ExportedProgram as a pt2 file. Create an issue in the PyTorch GitHub repository against the [96m*onnx*[0m component. Attach the error report and the pt2 model.

## Exception summary

&lt;class &#39;RuntimeError&#39;&gt;: scan might be aliasing the input or the output!

While executing %scan : [num_users=2] = call_function[target=torch.ops.higher_order.scan](args = (%scan_combine_graph_0, [%zeros_like], [%x], ()), kwargs = {})
Original traceback:
File &quot;~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py&quot;, line 384, in forward
    carry, _out = torch.ops.higher_order.scan(
Use tlparse to see full graph. (https://github.com/pytorch/tlparse?tab=readme-ov-file#tlparse-parse-structured-pt2-logs)

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="controlflowscan2carried">
<span id="ledx-model-case-export-controlflowscan2carried"></span><h2>ControlFlowScan2Carried<a class="headerlink" href="#controlflowscan2carried" title="Link to this heading">¶</a></h2>
<section id="id52">
<h3>forward<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">init1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">init2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">carry1</span><span class="p">,</span> <span class="n">carry2</span><span class="p">,</span> <span class="n">out1</span><span class="p">,</span> <span class="n">out2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">ControlFlowScan2Carried</span><span class="o">.</span><span class="n">add</span><span class="p">,</span>
        <span class="p">[</span><span class="n">init1</span><span class="p">,</span> <span class="n">init2</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">],</span>
        <span class="c1"># dim=0,  # 01/31/2025, not supported anymore</span>
        <span class="n">additional_inputs</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">carry1</span><span class="p">,</span> <span class="n">carry2</span><span class="p">,</span> <span class="n">out1</span><span class="p">,</span> <span class="n">out2</span>
</pre></div>
</div>
</section>
<section id="id53">
<h3>custom<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;init7_s1_4&#39; type=int64 shape=(1,) -- array([4])           -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init1_s_::RSh1&#39; type=float32 shape=(1,) -- array([2.], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init1_s_,init7_s1_1)##init1_s_/shape_type_compute._cast_inputs.1(mul_Tensor)##init7_s1_1/Opset.make_node.1/Shape
ConstantOfShape(init7_s1_4, value=[1.0]) -&gt; ones_like
ConstantOfShape(init7_s1_4, value=[0.0]) -&gt; zeros_like
Mul(x, init1_s_::RSh1) -&gt; _onx_mul_x
  Scan(zeros_like, ones_like, x, _onx_mul_x, body=G1, num_scan_inputs=2, scan_input_directions=[0,0], scan_output_axes=[0,0], scan_output_directions=[0,0]) -&gt; output_0, output_1, output_2, output_3
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[4]
output: name=&#39;output_1&#39; type=dtype(&#39;float32&#39;) shape=[4]
output: name=&#39;output_2&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
output: name=&#39;output_3&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- init_0_zeros_like,init_1_ones_like,scan_0_x,scan_1_mul -&gt; output_0,output_1,output_2,output_3
input: name=&#39;init_0_zeros_like&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;init_1_ones_like&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_1_mul&#39; type=&#39;NOTENSOR&#39; shape=None
Add(init_0_zeros_like, scan_0_x) -&gt; output_0
  Identity(output_0) -&gt; output_2
Mul(init_1_ones_like, scan_1_mul) -&gt; output_1
  Identity(output_1) -&gt; output_3
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_1&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_2&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_3&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id54">
<h3>dynamo-ir<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to decompose the FX graph for ONNX compatibility. [96mThis is step 2/3[0m of exporting the model to ONNX. Next steps:
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.
- Create an error report with `torch.onnx.export(..., report=True)`, and save the ExportedProgram as a pt2 file. Create an issue in the PyTorch GitHub repository against the [96m*onnx*[0m component. Attach the error report and the pt2 model.

## Exception summary

&lt;class &#39;RuntimeError&#39;&gt;: scan might be aliasing the input or the output!

While executing %scan : [num_users=4] = call_function[target=torch.ops.higher_order.scan](args = (%scan_combine_graph_0, [%zeros_like, %ones_like], [%x, %mul], ()), kwargs = {})
Original traceback:
File &quot;~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py&quot;, line 403, in forward
    carry1, carry2, out1, out2 = torch.ops.higher_order.scan(
Use tlparse to see full graph. (https://github.com/pytorch/tlparse?tab=readme-ov-file#tlparse-parse-structured-pt2-logs)

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="controlflowscancdist">
<span id="ledx-model-case-export-controlflowscancdist"></span><h2>ControlFlowScanCDist<a class="headerlink" href="#controlflowscancdist" title="Link to this heading">¶</a></h2>
<section id="id55">
<h3>forward<a class="headerlink" href="#id55" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">_carry</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">ControlFlowScanCDist</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span>
        <span class="p">[</span><span class="n">x</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x</span><span class="p">],</span>
        <span class="c1"># dim=0,  # 01/31/2025, not supported anymore</span>
        <span class="n">additional_inputs</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</section>
<section id="id56">
<h3>custom<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
Scan(x, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_axes=[0], scan_output_directions=[0]) -&gt; scan#0, output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;batch&#39;]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- init_0_x,scan_0_x -&gt; output_0,output_1
input: name=&#39;init_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
Constant(value=0.5) -&gt; init1_s_2
Constant(value=[1]) -&gt; init7_s1_12
Constant(value=[0]) -&gt; init7_s1_02
  Unsqueeze(scan_0_x, init7_s1_02) -&gt; reshape2
    Sub(init_0_x, reshape2) -&gt; sub2
      Mul(sub2, sub2) -&gt; mul2
  ReduceSum(mul2, init7_s1_12, keepdims=0) -&gt; sum_12
  Pow(sum_12, init1_s_2) -&gt; output_1
Identity(init_0_x) -&gt; output_0
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id57">
<h3>dynamo-ir<a class="headerlink" href="#id57" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;val_3&#39; type=int64 shape=(2,) -- array([ 1, -1])
init: name=&#39;val_7&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_8&#39; type=float32 shape=() -- array([0.5], dtype=float32)
Scan(x, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_directions=[0]) -&gt; scan__0, getitem_1
output: name=&#39;getitem_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;batch&#39;]
----- subgraph ---- Scan - node_scan__1 - att.body=G1 -- level=1 -- x_scan_combine_graph_0__subgraph_in,x_scan_combine_graph_0__subgraph_in -&gt; clone_scan_combine_graph_0,pow_1_scan_combine_graph_0
input: name=&#39;x_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 4]
input: name=&#39;x_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[4]
Identity(x_scan_combine_graph_0__subgraph_in) -&gt; clone_scan_combine_graph_0
Reshape(x_scan_combine_graph_0__subgraph_in, val_3, allowzero=1) -&gt; view
  Sub(x_scan_combine_graph_0__subgraph_in, view) -&gt; sub_1
    Mul(sub_1, sub_1) -&gt; mul_4
ReduceSum(mul_4, val_7, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
Pow(sum_1, val_8) -&gt; pow_1_scan_combine_graph_0
output: name=&#39;clone_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 4]
output: name=&#39;pow_1_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[ONNXRuntimeError] : 1 : FAIL : Error: Duplicate definition-site for (x_scan_combine_graph_0__subgraph_in).
</pre></div>
</div>
</section>
</section>
<section id="controlflowscancdist2">
<span id="ledx-model-case-export-controlflowscancdist2"></span><h2>ControlFlowScanCDist2<a class="headerlink" href="#controlflowscancdist2" title="Link to this heading">¶</a></h2>
<section id="id58">
<h3>forward<a class="headerlink" href="#id58" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">ControlFlowScanCDist2</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span>
        <span class="p">[</span><span class="n">z</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x</span><span class="p">],</span>
        <span class="c1"># dim=0,  # 01/31/2025, not supported anymore</span>
        <span class="n">additional_inputs</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id59">
<h3>custom<a class="headerlink" href="#id59" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;c_lifted_tensor_0&#39; type=float32 shape=(1,) -- array([0.], dtype=float32)-- DynamoInterpret.placeholder.0
Identity(x) -&gt; hidden_input_scan_0_clone
Scan(c_lifted_tensor_0, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_axes=[0], scan_output_directions=[0]) -&gt; scan#0, output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;batch&#39;]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- init_0_detach_,scan_0_x -&gt; output_0,output_1
input: name=&#39;init_0_detach_&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
Constant(value=[0]) -&gt; init7_s1_02
  Unsqueeze(scan_0_x, init7_s1_02) -&gt; reshape2
Sub(hidden_input_scan_0_clone, reshape2) -&gt; sub2
  Mul(sub2, sub2) -&gt; mul2
Constant(value=[1]) -&gt; init7_s1_12
  ReduceSum(mul2, init7_s1_12, keepdims=0) -&gt; sum_12
    Sqrt(sum_12) -&gt; output_1
Identity(init_0_detach_) -&gt; output_0
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id60">
<h3>dynamo-ir<a class="headerlink" href="#id60" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;clone&#39; type=float32 shape=(1,) -- array([0.], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(2,) -- array([ 1, -1])
init: name=&#39;val_7&#39; type=int64 shape=(1,) -- array([1])
Scan(clone, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_directions=[0]) -&gt; scan__0, getitem_1
output: name=&#39;getitem_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;batch&#39;]
----- subgraph ---- Scan - node_scan__1 - att.body=G1 -- level=1 -- clone_scan_combine_graph_0__subgraph_in,x_scan_combine_graph_0__subgraph_in -&gt; clone_scan_combine_graph_0,sqrt_scan_combine_graph_0
input: name=&#39;clone_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[1]
input: name=&#39;x_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[4]
Identity(clone_scan_combine_graph_0__subgraph_in) -&gt; clone_scan_combine_graph_0
Reshape(x_scan_combine_graph_0__subgraph_in, val_3, allowzero=1) -&gt; view
Sub(x, view) -&gt; sub_1
  Mul(sub_1, sub_1) -&gt; mul_4
ReduceSum(mul_4, val_7, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Sqrt(sum_1) -&gt; sqrt_scan_combine_graph_0
output: name=&#39;clone_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[1]
output: name=&#39;sqrt_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;]
</pre></div>
</div>
</section>
</section>
<section id="controlflowscancdistxy">
<span id="ledx-model-case-export-controlflowscancdistxy"></span><h2>ControlFlowScanCDistXY<a class="headerlink" href="#controlflowscancdistxy" title="Link to this heading">¶</a></h2>
<section id="id61">
<h3>forward<a class="headerlink" href="#id61" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">_carry</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">ControlFlowScanCDistXY</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span>
        <span class="p">[</span><span class="n">y</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x</span><span class="p">],</span>
        <span class="c1"># dim=0,  # 01/31/2025, not supported anymore</span>
        <span class="n">additional_inputs</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</section>
<section id="id62">
<h3>custom<a class="headerlink" href="#id62" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,T1s5x4),(T1s13x14,T1s15x14)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(x_rows),1:Dim(dim)},y:{0:Dim(y_rows),1:Dim(dim)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;x_rows&#39;, &#39;dim&#39;]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;y_rows&#39;, &#39;dim&#39;]
Scan(y, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_axes=[0], scan_output_directions=[0]) -&gt; scan#0, output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;x_rows&#39;, &#39;y_rows&#39;]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- init_0_y,scan_0_x -&gt; output_0,output_1
input: name=&#39;init_0_y&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_0_x&#39; type=&#39;NOTENSOR&#39; shape=None
Constant(value=[0]) -&gt; init7_s1_02
  Unsqueeze(scan_0_x, init7_s1_02) -&gt; reshape2
    Sub(init_0_y, reshape2) -&gt; sub2
      Mul(sub2, sub2) -&gt; mul2
Constant(value=[1]) -&gt; init7_s1_12
  ReduceSum(mul2, init7_s1_12, keepdims=0) -&gt; sum_12
    Sqrt(sum_12) -&gt; output_1
Identity(init_0_y) -&gt; output_0
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
output: name=&#39;output_1&#39; type=&#39;NOTENSOR&#39; shape=None
</pre></div>
</div>
</section>
<section id="id63">
<h3>dynamo-ir<a class="headerlink" href="#id63" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,T1s5x4),(T1s13x14,T1s15x14)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(x_rows),1:Dim(dim)},y:{0:Dim(y_rows),1:Dim(dim)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;x_rows&#39;, &#39;dim&#39;]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;y_rows&#39;, &#39;dim&#39;]
init: name=&#39;val_3&#39; type=int64 shape=(2,) -- array([ 1, -1])
init: name=&#39;val_7&#39; type=int64 shape=(1,) -- array([1])
Scan(y, x, body=G1, num_scan_inputs=1, scan_input_directions=[0], scan_output_directions=[0]) -&gt; scan__0, getitem_1
output: name=&#39;getitem_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;x_rows&#39;, &#39;y_rows&#39;]
----- subgraph ---- Scan - node_scan__1 - att.body=G1 -- level=1 -- y_scan_combine_graph_0__subgraph_in,x_scan_combine_graph_0__subgraph_in -&gt; clone_scan_combine_graph_0,sqrt_scan_combine_graph_0
input: name=&#39;y_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;, &#39;s27&#39;]
input: name=&#39;x_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s27&#39;]
Identity(y_scan_combine_graph_0__subgraph_in) -&gt; clone_scan_combine_graph_0
Reshape(x_scan_combine_graph_0__subgraph_in, val_3, allowzero=1) -&gt; view
  Sub(y_scan_combine_graph_0__subgraph_in, view) -&gt; sub_4
    Mul(sub_4, sub_4) -&gt; mul_7
ReduceSum(mul_7, val_7, noop_with_empty_axes=0, keepdims=0) -&gt; sum_1
  Sqrt(sum_1) -&gt; sqrt_scan_combine_graph_0
output: name=&#39;clone_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;, &#39;s27&#39;]
output: name=&#39;sqrt_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;]
</pre></div>
</div>
</section>
</section>
<section id="controlflowscandecomposition-151564">
<span id="ledx-model-case-export-controlflowscandecomposition-151564"></span><h2>ControlFlowScanDecomposition_151564<a class="headerlink" href="#controlflowscandecomposition-151564" title="Link to this heading">¶</a></h2>
<section id="id64">
<h3>forward<a class="headerlink" href="#id64" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">images</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_when_exporting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dummy_loop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dummy_loop_with_scan</span><span class="p">)(</span>
        <span class="n">images</span><span class="p">,</span> <span class="n">position</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id65">
<h3>custom<a class="headerlink" href="#id65" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x6,T7s5)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(images:{0:DYNAMIC,1:DYNAMIC},position:{0:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
opset: domain=&#39;aten&#39; version=1
opset: domain=&#39;local_functions&#39; version=1
input: name=&#39;images&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;channel&#39;]
input: name=&#39;position&#39; type=dtype(&#39;int64&#39;) shape=[&#39;batch_1&#39;]
Scan(images, position, body=G1, num_scan_inputs=2, scan_input_directions=[0,0], scan_output_axes=[0], scan_output_directions=[0]) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;channel&#39;]
----- subgraph ---- Scan - scan - att.body=G1 -- level=1 -- scan_0_images,scan_1_position -&gt; output_0
input: name=&#39;scan_0_images&#39; type=&#39;NOTENSOR&#39; shape=None
input: name=&#39;scan_1_position&#39; type=&#39;NOTENSOR&#39; shape=None
Constant(value=[0]) -&gt; init7_s1_02
  Unsqueeze(scan_1_position, init7_s1_02) -&gt; item::UnSq02
  Slice(scan_0_images, init7_s1_02, item::UnSq02, init7_s1_02) -&gt; slice_12
Shape(scan_0_images, end=1, start=0) -&gt; padded_1::Shape:12
  ConstantOfShape(padded_1::Shape:12, value=[0.0]) -&gt; zeros2
    aten_setitem[aten](zeros2, scan_1_position, slice_12) -&gt; output_0
output: name=&#39;output_0&#39; type=&#39;NOTENSOR&#39; shape=None
----- function name=aten_setitem domain=aten
----- doc_string: -- function_options=FunctionOptions(export_as_function=...
opset: domain=&#39;&#39; version=18
input: &#39;zeros&#39;
input: &#39;item&#39;
input: &#39;slice_1&#39;
Constant(value=[0]) -&gt; init7_s1_0
  Unsqueeze(item, init7_s1_0) -&gt; item::UnSq0
Shape(zeros) -&gt; zeros::Shape:
  Slice(zeros, item::UnSq0, zeros::Shape:, init7_s1_0) -&gt; _onx_slice_zeros
    Concat(slice_1, _onx_slice_zeros, axis=0) -&gt; setitem
output: name=&#39;setitem&#39; type=? shape=?
</pre></div>
</div>
</section>
<section id="id66">
<h3>dynamo-ir<a class="headerlink" href="#id66" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s5x6,T7s5)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(images:{0:DYNAMIC,1:DYNAMIC},position:{0:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;images&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s34&#39;, &#39;s90&#39;]
input: name=&#39;position&#39; type=dtype(&#39;int64&#39;) shape=[&#39;s71&#39;]
init: name=&#39;val_1&#39; type=float32 shape=() -- array([0.], dtype=float32)
init: name=&#39;val_5&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_7&#39; type=int64 shape=() -- array([0])
init: name=&#39;val_10&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_13&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_20&#39; type=int64 shape=(1,) -- array([1])
Scan(images, position, body=G1, num_scan_inputs=2, scan_input_directions=[0,0], scan_output_directions=[0]) -&gt; getitem
output: name=&#39;getitem&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s34&#39;, &#39;s90&#39;]
----- subgraph ---- Scan - node_scan__0 - att.body=G1 -- level=1 -- images_scan_combine_graph_0__subgraph_in,position_scan_combine_graph_0__subgraph_in -&gt; slice_scatter_scan_combine_graph_0
input: name=&#39;images_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s90&#39;]
input: name=&#39;position_scan_combine_graph_0__subgraph_in&#39; type=dtype(&#39;int64&#39;) shape=None
Reshape(position_scan_combine_graph_0__subgraph_in, val_5, allowzero=0) -&gt; val_6
Gather(val_6, val_7, axis=0) -&gt; val_8
Reshape(val_8, val_5, allowzero=0) -&gt; val_16
Slice(images_scan_combine_graph_0__subgraph_in, val_13, val_16, val_13, val_20) -&gt; copy
Shape(images_scan_combine_graph_0__subgraph_in, end=1, start=0) -&gt; val_0
Expand(val_1, val_0) -&gt; zeros
  Shape(zeros, start=0) -&gt; val_32
Gather(val_32, val_7, axis=0) -&gt; val_33
Range(val_7, val_33, val_10) -&gt; val_34
Unsqueeze(val_8, val_13) -&gt; val_36
Slice(val_34, val_13, val_36, val_13, val_20) -&gt; val_38
Unsqueeze(val_38, val_5) -&gt; val_39
  ScatterND(zeros, val_39, copy, reduction=b&#39;none&#39;) -&gt; slice_scatter_scan_combine_graph_0
output: name=&#39;slice_scatter_scan_combine_graph_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;&#39;]
</pre></div>
</div>
</section>
</section>
<section id="controlflowscaninplace-153705">
<span id="ledx-model-case-export-controlflowscaninplace-153705"></span><h2>ControlFlowScanInplace_153705<a class="headerlink" href="#controlflowscaninplace-153705" title="Link to this heading">¶</a></h2>
<section id="id67">
<h3>forward<a class="headerlink" href="#id67" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loop_body_1</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">iv</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="n">iv</span><span class="p">]</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">higher_order</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="n">loop_body_1</span><span class="p">,</span> <span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id68">
<h3>custom<a class="headerlink" href="#id68" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>only integers, slices (`:`), ellipsis (`...`), None and long or byte Variables are valid indices (got SymInt)
</pre></div>
</div>
</section>
<section id="id69">
<h3>dynamo-ir<a class="headerlink" href="#id69" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;IndexError&#39;&gt;: only integers, slices (`:`), ellipsis (`...`), None and long or byte Variables are valid indices (got SymInt)

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="createfromshape">
<span id="ledx-model-case-export-createfromshape"></span><h2>CreateFromShape<a class="headerlink" href="#createfromshape" title="Link to this heading">¶</a></h2>
<section id="id70">
<h3>forward<a class="headerlink" href="#id70" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id71">
<h3>custom<a class="headerlink" href="#id71" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x4,),(T1s5x5,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(dx),1:Dim(dy)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy&#39;]
init: name=&#39;SqueezeBinaryUnsqueezePattern_init7_s_1&#39; type=int64 shape=(1,) -- array([1])-- GraphBuilder.constant_folding.from/fold(init7_s1_0,init7_s_1)##init7_s_1/shape_type_compute._cast_inputs.1(add)##init7_s1_0/Opset.make_node.1/Shape##Opset.make_node.1/Shape
Shape(x, end=1, start=0) -&gt; x::Shape:1
Shape(x, end=2, start=1) -&gt; x::Shape1:2
  Add(x::Shape1:2, SqueezeBinaryUnsqueezePattern_init7_s_1) -&gt; add::UnSq0
  Concat(x::Shape:1, add::UnSq0, axis=0) -&gt; _onx_concat_sym_size_int_2::UnSq0
    ConstantOfShape(_onx_concat_sym_size_int_2::UnSq0, value=[1.0]) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;add&#39;]
</pre></div>
</div>
</section>
<section id="id72">
<h3>dynamo-ir<a class="headerlink" href="#id72" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x4,),(T1s5x5,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(dx),1:Dim(dy)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy&#39;]
init: name=&#39;val_2&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_5&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_10&#39; type=float32 shape=() -- array([1.], dtype=float32)
Shape(x, end=1, start=0) -&gt; val_0
Shape(x, end=2, start=1) -&gt; val_1
  Squeeze(val_1) -&gt; sym_size_int_3
    Add(sym_size_int_3, val_2) -&gt; add
      Reshape(add, val_5, allowzero=0) -&gt; val_6
  Concat(val_0, val_6, axis=0) -&gt; val_7
    Expand(val_10, val_7) -&gt; ones
output: name=&#39;ones&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy + 1&#39;]
</pre></div>
</div>
</section>
</section>
<section id="createfromshapethroughfunction">
<span id="ledx-model-case-export-createfromshapethroughfunction"></span><h2>CreateFromShapeThroughFunction<a class="headerlink" href="#createfromshapethroughfunction" title="Link to this heading">¶</a></h2>
<section id="id73">
<h3>forward<a class="headerlink" href="#id73" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">dy1</span> <span class="o">=</span> <span class="n">CreateFromShapeThroughFunction</span><span class="o">.</span><span class="n">add_one</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dy1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="id74">
<h3>custom<a class="headerlink" href="#id74" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(dx),1:Dim(dy)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy&#39;]
init: name=&#39;SqueezeBinaryUnsqueezePattern_init7_s_1&#39; type=int64 shape=(1,) -- array([1])-- GraphBuilder.constant_folding.from/fold(init7_s1_0,init7_s_1)##init7_s_1/shape_type_compute._cast_inputs.1(add)##init7_s1_0/Opset.make_node.1/Shape##Opset.make_node.1/Shape
Shape(x, end=1, start=0) -&gt; x::Shape:1
Shape(x, end=2, start=1) -&gt; x::Shape1:2
  Add(x::Shape1:2, SqueezeBinaryUnsqueezePattern_init7_s_1) -&gt; add::UnSq0
  Concat(x::Shape:1, add::UnSq0, axis=0) -&gt; _onx_concat_sym_size_int_2::UnSq0
    ConstantOfShape(_onx_concat_sym_size_int_2::UnSq0, value=[1.0]) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;add&#39;]
</pre></div>
</div>
</section>
<section id="id75">
<h3>dynamo-ir<a class="headerlink" href="#id75" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(dx),1:Dim(dy)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy&#39;]
init: name=&#39;val_2&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_5&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_10&#39; type=float32 shape=() -- array([1.], dtype=float32)
Shape(x, end=1, start=0) -&gt; val_0
Shape(x, end=2, start=1) -&gt; val_1
  Squeeze(val_1) -&gt; sym_size_int_3
    Add(sym_size_int_3, val_2) -&gt; add
      Reshape(add, val_5, allowzero=0) -&gt; val_6
  Concat(val_0, val_6, axis=0) -&gt; val_7
    Expand(val_10, val_7) -&gt; ones
output: name=&#39;ones&#39; type=dtype(&#39;float32&#39;) shape=[&#39;dx&#39;, &#39;dy + 1&#39;]
</pre></div>
</div>
</section>
</section>
<section id="croplastdimensionwithtensorcontent">
<span id="ledx-model-case-export-croplastdimensionwithtensorcontent"></span><h2>CropLastDimensionWithTensorContent<a class="headerlink" href="#croplastdimensionwithtensorcontent" title="Link to this heading">¶</a></h2>
<section id="id76">
<h3>forward<a class="headerlink" href="#id76" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="id77">
<h3>custom<a class="headerlink" href="#id77" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Could not extract specialized integer from data-dependent expression u0 (unhinted: u0).  (Size-like symbols: none)

Caused by: (_export/non_strict_utils.py:1118 in __torch_function__)
For more information, run with TORCH_LOGS=&quot;dynamic&quot;
For extended logs when we create symbols, also add TORCHDYNAMO_EXTENDED_DEBUG_CREATE_SYMBOL=&quot;u0&quot;
If you suspect the guard was triggered from C++, add TORCHDYNAMO_EXTENDED_DEBUG_CPP=1
For more debugging help, see https://docs.google.com/document/d/1HSuTTVvYH1pTew89Rtpeu84Ht3nQEFTYhAX3Ypa_xJs/edit?usp=sharing

For C++ stack trace, run with TORCHDYNAMO_EXTENDED_DEBUG_CPP=1

The following call raised this error:
  File &quot;~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py&quot;, line 815, in forward
    return x[..., : shape[0]]


The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.
</pre></div>
</div>
</section>
<section id="id78">
<h3>dynamo-ir<a class="headerlink" href="#id78" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;torch.fx.experimental.symbolic_shapes.GuardOnDataDependentSymNode&#39;&gt;: Could not extract specialized integer from data-dependent expression u0 (unhinted: u0).  (Size-like symbols: none)

Caused by: (_export/non_strict_utils.py:1118 in __torch_function__)
For more information, run with TORCH_LOGS=&quot;dynamic&quot;
For extended logs when we create symbols, also add TORCHDYNAMO_EXTENDED_DEBUG_CREATE_SYMBOL=&quot;u0&quot;
If you suspect the guard was triggered from C++, add TORCHDYNAMO_EXTENDED_DEBUG_CPP=1
For more debugging help, see https://docs.google.com/document/d/1HSuTTVvYH1pTew89Rtpeu84Ht3nQEFTYhAX3Ypa_xJs/edit?usp=sharing

For C++ stack trace, run with TORCHDYNAMO_EXTENDED_DEBUG_CPP=1

The following call raised this error:
  File &quot;~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py&quot;, line 815, in forward
    return x[..., : shape[0]]


The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="croplastdimensionwithtensorshape">
<span id="ledx-model-case-export-croplastdimensionwithtensorshape"></span><h2>CropLastDimensionWithTensorShape<a class="headerlink" href="#croplastdimensionwithtensorshape" title="Link to this heading">¶</a></h2>
<section id="id79">
<h3>forward<a class="headerlink" href="#id79" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="id80">
<h3>custom<a class="headerlink" href="#id80" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4x4,T1s2),(T1s6x4x4,T1s3)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(crop)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4, 4]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;crop&#39;]
init: name=&#39;init7_s1_0&#39; type=int64 shape=(1,) -- array([0])           -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_2&#39; type=int64 shape=(1,) -- array([2])           -- Opset.make_node.1/Shape
Shape(y, end=1, start=0) -&gt; y::Shape:1
  Slice(x, init7_s1_0, y::Shape:1, init7_s1_2) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4, &#39;crop&#39;]
</pre></div>
</div>
</section>
<section id="id81">
<h3>dynamo-ir<a class="headerlink" href="#id81" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4x4,T1s2),(T1s6x4x4,T1s3)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(crop)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4, 4]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;crop&#39;]
init: name=&#39;val_1&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_8&#39; type=int64 shape=(1,) -- array([2])
init: name=&#39;val_9&#39; type=int64 shape=(1,) -- array([1])
Shape(y, end=1, start=0) -&gt; val_0
  Slice(x, val_1, val_0, val_8, val_9) -&gt; slice_1
output: name=&#39;slice_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4, &#39;crop&#39;]
</pre></div>
</div>
</section>
</section>
<section id="exportwithdimension0">
<span id="ledx-model-case-export-exportwithdimension0"></span><h2>ExportWithDimension0<a class="headerlink" href="#exportwithdimension0" title="Link to this heading">¶</a></h2>
<section id="id82">
<h3>forward<a class="headerlink" href="#id82" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id83">
<h3>custom<a class="headerlink" href="#id83" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s0x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:DYNAMIC,1:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;channel&#39;]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- Opset.make_node.1/Small
init: name=&#39;init1_s_2&#39; type=float32 shape=() -- array([1.], dtype=float32)-- Opset.make_node.1/Small
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- ReshapeIsSqueezePattern.m1
Shape(x, end=2, start=1) -&gt; x::Shape1:2
  Squeeze(x::Shape1:2) -&gt; sym_size_int_2
    Cast(sym_size_int_2, to=1) -&gt; sym_size_int_2::C1
      Range(init1_s_, sym_size_int_2::C1, init1_s_2) -&gt; arange
        Unsqueeze(arange, init7_s1_1) -&gt; reshape
          MatMul(x, reshape) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
<section id="id84">
<h3>dynamo-ir<a class="headerlink" href="#id84" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s0x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:DYNAMIC,1:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, &#39;s27&#39;]
init: name=&#39;val_3&#39; type=float32 shape=() -- array([0.], dtype=float32)
init: name=&#39;val_5&#39; type=float32 shape=() -- array([1.], dtype=float32)
init: name=&#39;val_9&#39; type=int64 shape=(2,) -- array([-1,  1])
Shape(x, end=2, start=1) -&gt; val_0
  Squeeze(val_0) -&gt; sym_size_int_5
    Cast(sym_size_int_5, to=1) -&gt; val_1
      Range(val_3, val_1, val_5) -&gt; arange
        Reshape(arange, val_9, allowzero=1) -&gt; view
          MatMul(x, view) -&gt; matmul
output: name=&#39;matmul&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 1]
</pre></div>
</div>
</section>
</section>
<section id="exportwithdimension1">
<span id="ledx-model-case-export-exportwithdimension1"></span><h2>ExportWithDimension1<a class="headerlink" href="#exportwithdimension1" title="Link to this heading">¶</a></h2>
<section id="id85">
<h3>forward<a class="headerlink" href="#id85" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id86">
<h3>custom<a class="headerlink" href="#id86" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s1x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:DYNAMIC,1:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;channel&#39;]
init: name=&#39;init1_s_&#39; type=float32 shape=() -- array([0.], dtype=float32)-- Opset.make_node.1/Small
init: name=&#39;init1_s_2&#39; type=float32 shape=() -- array([1.], dtype=float32)-- Opset.make_node.1/Small
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- ReshapeIsSqueezePattern.m1
Shape(x, end=2, start=1) -&gt; x::Shape1:2
  Squeeze(x::Shape1:2) -&gt; sym_size_int_2
    Cast(sym_size_int_2, to=1) -&gt; sym_size_int_2::C1
      Range(init1_s_, sym_size_int_2::C1, init1_s_2) -&gt; arange
        Unsqueeze(arange, init7_s1_1) -&gt; reshape
          MatMul(x, reshape) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
<section id="id87">
<h3>dynamo-ir<a class="headerlink" href="#id87" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s1x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:DYNAMIC,1:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, &#39;s27&#39;]
init: name=&#39;val_3&#39; type=float32 shape=() -- array([0.], dtype=float32)
init: name=&#39;val_5&#39; type=float32 shape=() -- array([1.], dtype=float32)
init: name=&#39;val_9&#39; type=int64 shape=(2,) -- array([-1,  1])
Shape(x, end=2, start=1) -&gt; val_0
  Squeeze(val_0) -&gt; sym_size_int_5
    Cast(sym_size_int_5, to=1) -&gt; val_1
      Range(val_3, val_1, val_5) -&gt; arange
        Reshape(arange, val_9, allowzero=1) -&gt; view
          MatMul(x, view) -&gt; matmul
output: name=&#39;matmul&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 1]
</pre></div>
</div>
</section>
</section>
<section id="inplaceadd">
<span id="ledx-model-case-export-inplaceadd"></span><h2>InplaceAdd<a class="headerlink" href="#inplaceadd" title="Link to this heading">¶</a></h2>
<section id="id88">
<h3>forward<a class="headerlink" href="#id88" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id89">
<h3>custom<a class="headerlink" href="#id89" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;c_bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)-- DynamoInterpret.placeholder.0
Add(x, c_bias) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
<section id="id90">
<h3>dynamo-ir<a class="headerlink" href="#id90" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)
Add(x, bias) -&gt; add_3
output: name=&#39;add_3&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
</section>
<section id="inplaceadd2">
<span id="ledx-model-case-export-inplaceadd2"></span><h2>InplaceAdd2<a class="headerlink" href="#inplaceadd2" title="Link to this heading">¶</a></h2>
<section id="id91">
<h3>forward<a class="headerlink" href="#id91" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id92">
<h3>custom<a class="headerlink" href="#id92" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;c_bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)-- DynamoInterpret.placeholder.0
Add(x, c_bias) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
<section id="id93">
<h3>dynamo-ir<a class="headerlink" href="#id93" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)
Add(x, bias) -&gt; add_3
output: name=&#39;add_3&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
</section>
<section id="inplaceadd-mul">
<span id="ledx-model-case-export-inplaceadd-mul"></span><h2>InplaceAdd_Mul<a class="headerlink" href="#inplaceadd-mul" title="Link to this heading">¶</a></h2>
<section id="id94">
<h3>forward<a class="headerlink" href="#id94" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="id95">
<h3>custom<a class="headerlink" href="#id95" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;c_bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init1_s_::RSh1&#39; type=float32 shape=(1,) -- array([2.], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init1_s_,init7_s1_1)##init1_s_/shape_type_compute._cast_inputs.1(mul_Tensor)##init7_s1_1/Opset.make_node.1/Shape
Add(x, c_bias) -&gt; add_
  Mul(add_, init1_s_::RSh1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
<section id="id96">
<h3>dynamo-ir<a class="headerlink" href="#id96" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([2.], dtype=float32)
Add(x, bias) -&gt; add_3
  Mul(add_3, scalar_tensor_default) -&gt; mul_4
output: name=&#39;mul_4&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
</section>
<section id="inplacecloneadd">
<span id="ledx-model-case-export-inplacecloneadd"></span><h2><a class="reference internal" href="#inplacecloneadd">InplaceCloneAdd</a><a class="headerlink" href="#inplacecloneadd" title="Link to this heading">¶</a></h2>
<section id="id97">
<h3>forward<a class="headerlink" href="#id97" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id98">
<h3>custom<a class="headerlink" href="#id98" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;c_bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)-- DynamoInterpret.placeholder.0
Add(x, c_bias) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
<section id="id99">
<h3>dynamo-ir<a class="headerlink" href="#id99" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s3x4,),(T1s5x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
init: name=&#39;bias&#39; type=float32 shape=(1, 4) -- array([1., 1., 1., 1.], dtype=float32)
Add(x, bias) -&gt; add_6
output: name=&#39;add_6&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemellipsis-1">
<span id="ledx-model-case-export-inplacesetitemellipsis-1"></span><h2>InplaceSetItemEllipsis_1<a class="headerlink" href="#inplacesetitemellipsis-1" title="Link to this heading">¶</a></h2>
<section id="id100">
<h3>forward<a class="headerlink" href="#id100" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
    <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">copy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">update</span>
    <span class="k">return</span> <span class="n">copy</span>
</pre></div>
</div>
</section>
<section id="id101">
<h3>custom<a class="headerlink" href="#id101" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>L[&#39;update&#39;].size()[0] = 8192 is not equal to L[&#39;index&#39;].size()[0] = 4

The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.
</pre></div>
</div>
</section>
<section id="id102">
<h3>dynamo-ir<a class="headerlink" href="#id102" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;torch._dynamo.exc.UserError&#39;&gt;: L[&#39;update&#39;].size()[0] = 8192 is not equal to L[&#39;index&#39;].size()[0] = 4

The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemellipsis-2">
<span id="ledx-model-case-export-inplacesetitemellipsis-2"></span><h2>InplaceSetItemEllipsis_2<a class="headerlink" href="#inplacesetitemellipsis-2" title="Link to this heading">¶</a></h2>
<section id="id103">
<h3>forward<a class="headerlink" href="#id103" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
    <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">copy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">update</span>
    <span class="k">return</span> <span class="n">copy</span>
</pre></div>
</div>
</section>
<section id="id104">
<h3>custom<a class="headerlink" href="#id104" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>L[&#39;update&#39;].size()[0] = 8192 is not equal to L[&#39;index&#39;].size()[0] = 4

The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.
</pre></div>
</div>
</section>
<section id="id105">
<h3>dynamo-ir<a class="headerlink" href="#id105" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;torch._dynamo.exc.UserError&#39;&gt;: L[&#39;update&#39;].size()[0] = 8192 is not equal to L[&#39;index&#39;].size()[0] = 4

The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemmask">
<span id="ledx-model-case-export-inplacesetitemmask"></span><h2>InplaceSetItemMask<a class="headerlink" href="#inplacesetitemmask" title="Link to this heading">¶</a></h2>
<section id="id106">
<h3>forward<a class="headerlink" href="#id106" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id107">
<h3>custom<a class="headerlink" href="#id107" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s2x3x3,),(T1s3x3x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 3]
init: name=&#39;c_lifted_tensor_0&#39; type=float32 shape=() -- array([2.], dtype=float32)-- DynamoInterpret.placeholder.0
Cast(x, to=9) -&gt; to
  Where(to, c_lifted_tensor_0, x) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 3]
</pre></div>
</div>
</section>
<section id="id108">
<h3>dynamo-ir<a class="headerlink" href="#id108" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s2x3x3,),(T1s3x3x3,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 3]
init: name=&#39;clone&#39; type=float32 shape=() -- array([2.], dtype=float32)
Cast(x, to=9) -&gt; _to_copy
  Where(_to_copy, clone, x) -&gt; index_put
output: name=&#39;index_put&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3, 3]
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemsquare">
<span id="ledx-model-case-export-inplacesetitemsquare"></span><h2>InplaceSetItemSquare<a class="headerlink" href="#inplacesetitemsquare" title="Link to this heading">¶</a></h2>
<section id="id109">
<h3>forward<a class="headerlink" href="#id109" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id110">
<h3>custom<a class="headerlink" href="#id110" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 0 is not equal to len(dims) = 2
</pre></div>
</div>
</section>
<section id="id111">
<h3>dynamo-ir<a class="headerlink" href="#id111" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s5x5,),(T1s7x5,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
init: name=&#39;val_1&#39; type=int64 shape=() -- array([0])
init: name=&#39;val_20&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_27&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_30&#39; type=int64 shape=(1,) -- array([2])
init: name=&#39;val_34&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_43&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_44&#39; type=int64 shape=(3, 1) -- array([0, 1, 2])
init: name=&#39;val_45&#39; type=float32 shape=(3, 2)
Shape(x, start=0) -&gt; val_49
  Gather(val_49, val_1, axis=0) -&gt; val_50
    Range(val_1, val_50, val_20) -&gt; val_51
      Slice(val_51, val_27, val_30, val_27, val_34) -&gt; val_55
        Unsqueeze(val_55, val_43) -&gt; val_56
Slice(x, val_27, val_30, val_27, val_34) -&gt; slice_3
  Transpose(slice_3, perm=[1,0]) -&gt; val_46
    ScatterND(val_46, val_44, val_45, reduction=b&#39;none&#39;) -&gt; val_47
      Transpose(val_47, perm=[1,0]) -&gt; slice_scatter
        ScatterND(x, val_56, slice_scatter, reduction=b&#39;none&#39;) -&gt; slice_scatter_1
output: name=&#39;slice_scatter_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemsquareadd">
<span id="ledx-model-case-export-inplacesetitemsquareadd"></span><h2>InplaceSetItemSquareAdd<a class="headerlink" href="#inplacesetitemsquareadd" title="Link to this heading">¶</a></h2>
<section id="id112">
<h3>forward<a class="headerlink" href="#id112" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="id113">
<h3>custom<a class="headerlink" href="#id113" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 0 is not equal to len(dims) = 2
</pre></div>
</div>
</section>
<section id="id114">
<h3>dynamo-ir<a class="headerlink" href="#id114" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s5x5,),(T1s7x5,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
init: name=&#39;val_1&#39; type=int64 shape=() -- array([0])
init: name=&#39;val_20&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_27&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_30&#39; type=int64 shape=(1,) -- array([2])
init: name=&#39;val_34&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_43&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_44&#39; type=int64 shape=(3, 1) -- array([0, 1, 2])
init: name=&#39;val_45&#39; type=float32 shape=(3, 2)
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([2.], dtype=float32)
Shape(x, start=0) -&gt; val_49
  Gather(val_49, val_1, axis=0) -&gt; val_50
    Range(val_1, val_50, val_20) -&gt; val_51
      Slice(val_51, val_27, val_30, val_27, val_34) -&gt; val_55
        Unsqueeze(val_55, val_43) -&gt; val_56
Slice(x, val_27, val_30, val_27, val_34) -&gt; slice_3
  Transpose(slice_3, perm=[1,0]) -&gt; val_46
    ScatterND(val_46, val_44, val_45, reduction=b&#39;none&#39;) -&gt; val_47
      Transpose(val_47, perm=[1,0]) -&gt; slice_scatter
        ScatterND(x, val_56, slice_scatter, reduction=b&#39;none&#39;) -&gt; slice_scatter_1
          Add(slice_scatter_1, scalar_tensor_default) -&gt; add
output: name=&#39;add&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
</pre></div>
</div>
</section>
</section>
<section id="inplacesetitemsquareadd2">
<span id="ledx-model-case-export-inplacesetitemsquareadd2"></span><h2>InplaceSetItemSquareAdd2<a class="headerlink" href="#inplacesetitemsquareadd2" title="Link to this heading">¶</a></h2>
<section id="id115">
<h3>forward<a class="headerlink" href="#id115" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="id116">
<h3>custom<a class="headerlink" href="#id116" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 0 is not equal to len(dims) = 2
</pre></div>
</div>
</section>
<section id="id117">
<h3>dynamo-ir<a class="headerlink" href="#id117" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s5x5,),(T1s7x5,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
init: name=&#39;val_1&#39; type=int64 shape=() -- array([0])
init: name=&#39;val_20&#39; type=int64 shape=() -- array([1])
init: name=&#39;val_27&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_30&#39; type=int64 shape=(1,) -- array([2])
init: name=&#39;val_34&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_43&#39; type=int64 shape=(1,) -- array([-1])
init: name=&#39;val_44&#39; type=int64 shape=(3, 1) -- array([0, 1, 2])
init: name=&#39;val_45&#39; type=float32 shape=(3, 2)
init: name=&#39;scalar_tensor_default&#39; type=float32 shape=() -- array([2.], dtype=float32)
init: name=&#39;scalar_tensor_default_1&#39; type=float32 shape=() -- array([3.], dtype=float32)
Shape(x, start=0) -&gt; val_49
  Gather(val_49, val_1, axis=0) -&gt; val_50
    Range(val_1, val_50, val_20) -&gt; val_51
      Slice(val_51, val_27, val_30, val_27, val_34) -&gt; val_55
        Unsqueeze(val_55, val_43) -&gt; val_56
Slice(x, val_27, val_30, val_27, val_34) -&gt; slice_3
  Transpose(slice_3, perm=[1,0]) -&gt; val_46
    ScatterND(val_46, val_44, val_45, reduction=b&#39;none&#39;) -&gt; val_47
      Transpose(val_47, perm=[1,0]) -&gt; slice_scatter
        ScatterND(x, val_56, slice_scatter, reduction=b&#39;none&#39;) -&gt; slice_scatter_1
          Add(slice_scatter_1, scalar_tensor_default) -&gt; add
Add(slice_scatter_1, scalar_tensor_default_1) -&gt; add_4
output: name=&#39;add&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
output: name=&#39;add_4&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 5]
</pre></div>
</div>
</section>
</section>
<section id="signaturefloat1">
<span id="ledx-model-case-export-signaturefloat1"></span><h2>SignatureFloat1<a class="headerlink" href="#signaturefloat1" title="Link to this heading">¶</a></h2>
<section id="id118">
<h3>forward<a class="headerlink" href="#id118" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">*</span> <span class="n">alpha</span>
</pre></div>
</div>
</section>
<section id="id119">
<h3>custom<a class="headerlink" href="#id119" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,float),(T1s8x3,float)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">({0:Dim(batch)},None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;mul&#39; type=float32 shape=(1,) -- array([0.75], dtype=float32)-- GraphBuilder.constant_folding.from/fold(_onx_mul_b_buff)##_onx_mul_b_buff/GraphBuilder.constant_folding.from/fold(b_buff,init1_s_::RSh1)##b_buff/DynamoInterpret.placeholder.0##init1_s_::RSh1/GraphBuilder.constant_folding.from/fold(init1_s_,init7_s1_1)##init1_s_/shape_type_compute._cast_inputs.1(mul_Tensor)##init7_s1_1/Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([-0.211, -0.325,  0.066], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.352], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, mul) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,float) but names=[&#39;x&#39;], model=SignatureFloat1, export=&#39;custom&#39;
</pre></div>
</div>
</section>
<section id="id120">
<h3>dynamo-ir<a class="headerlink" href="#id120" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,float),(T1s8x3,float)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">({0:Dim(batch)},None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 3]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([ 0.319, -0.218, -0.555], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.546], dtype=float32)
init: name=&#39;mul_2&#39; type=float32 shape=(1,) -- array([0.75], dtype=float32)
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, mul_2) -&gt; sub_2
output: name=&#39;sub_2&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,float) but names=[&#39;x&#39;], model=SignatureFloat1, export=&#39;dynamo-ir&#39;
</pre></div>
</div>
</section>
</section>
<section id="signatureint1">
<span id="ledx-model-case-export-signatureint1"></span><h2>SignatureInt1<a class="headerlink" href="#signatureint1" title="Link to this heading">¶</a></h2>
<section id="id121">
<h3>forward<a class="headerlink" href="#id121" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id122">
<h3>custom<a class="headerlink" href="#id122" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,int),(T1s8x3,int)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">({0:Dim(batch)},None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_2&#39; type=int64 shape=(1,) -- array([2])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([ 0.249, -0.134, -0.2  ], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([0.071], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
Slice(x, init7_s1_1, init7_s1_2, init7_s1_1) -&gt; slice_1
  Add(sub, slice_1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,int) but names=[&#39;x&#39;], model=SignatureInt1, export=&#39;custom&#39;
</pre></div>
</div>
</section>
<section id="id123">
<h3>dynamo-ir<a class="headerlink" href="#id123" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,int),(T1s8x3,int)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">({0:Dim(batch)},None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 3]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([-0.108, -0.554,  0.287], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([0.214], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1])
init: name=&#39;val_7&#39; type=int64 shape=(1,) -- array([2])
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_2
Slice(x, val_3, val_7, val_3, val_3) -&gt; slice_1
  Add(sub_2, slice_1) -&gt; add_12
output: name=&#39;add_12&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,int) but names=[&#39;x&#39;], model=SignatureInt1, export=&#39;dynamo-ir&#39;
</pre></div>
</div>
</section>
</section>
<section id="signatureint2">
<span id="ledx-model-case-export-signatureint2"></span><h2>SignatureInt2<a class="headerlink" href="#signatureint2" title="Link to this heading">¶</a></h2>
<section id="id124">
<h3>forward<a class="headerlink" href="#id124" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id125">
<h3>custom<a class="headerlink" href="#id125" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x3,int)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},i:None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s_1&#39; type=int64 shape=() -- array([1])              -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([-0.392, -0.047, -0.242], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.501], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gather(x, init7_s_1, axis=1) -&gt; select
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
  Add(sub, select) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;batch&#39;]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,int) but names=[&#39;x&#39;], model=SignatureInt2, export=&#39;custom&#39;
</pre></div>
</div>
</section>
<section id="id126">
<h3>dynamo-ir<a class="headerlink" href="#id126" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x3,int)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},i:None)</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, 3]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([-0.149, -0.501,  0.455], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([0.368], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_12&#39; type=int64 shape=() -- array([1])
Gather(x, val_12, axis=1) -&gt; select
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_2
  Add(sub_2, select) -&gt; add_14
output: name=&#39;add_14&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s77&#39;, &#39;s77&#39;]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Input mismatch, inputs[0]=(T1r2,int) but names=[&#39;x&#39;], model=SignatureInt2, export=&#39;dynamo-ir&#39;
</pre></div>
</div>
</section>
</section>
<section id="signaturelistfixedlength">
<span id="ledx-model-case-export-signaturelistfixedlength"></span><h2>SignatureListFixedLength<a class="headerlink" href="#signaturelistfixedlength" title="Link to this heading">¶</a></h2>
<section id="id127">
<h3>forward<a class="headerlink" href="#id127" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">lx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id128">
<h3>custom<a class="headerlink" href="#id128" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#2[T1s8x1,T1s8x2])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([-0.044, -0.011,  0.032], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([0.222], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
ReduceSum(lx_1, init7_s1_1, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul
    Add(sub, mul) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
<section id="id129">
<h3>dynamo-ir<a class="headerlink" href="#id129" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#2[T1s8x1,T1s8x2])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([ 0.415,  0.191, -0.085], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([0.311], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1])
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_2
ReduceSum(lx_1, val_3, noop_with_empty_axes=0, keepdims=1) -&gt; sum_1
  Mul(lx_0, sum_1) -&gt; mul_4
    Add(sub_2, mul_4) -&gt; add_15
output: name=&#39;add_15&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
</section>
</section>
<section id="signaturelistfixedwithnone">
<span id="ledx-model-case-export-signaturelistfixedwithnone"></span><h2>SignatureListFixedWithNone<a class="headerlink" href="#signaturelistfixedwithnone" title="Link to this heading">¶</a></h2>
<section id="id130">
<h3>forward<a class="headerlink" href="#id130" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lx</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="id131">
<h3>custom<a class="headerlink" href="#id131" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Unable to guess backed_size_oblivious with args=(#3[T1s4x4,T1s4x4,None],), kwargs=None, dynamic_shapes=dict(lx:#2[{0:Dim(batch)},{0:Dim(batch)}])
</pre></div>
</div>
</section>
<section id="id132">
<h3>dynamo-ir<a class="headerlink" href="#id132" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;torch._dynamo.exc.UserError&#39;&gt;: Detected mismatch between the structure of `inputs` and `dynamic_shapes`: `inputs[&#39;lx&#39;]` has 3 elements, but `dynamic_shapes[&#39;lx&#39;]` has 2 elements
For more information about this error, see: https://pytorch.org/docs/main/generated/exportdb/index.html#dynamic-shapes-validation

The error above occurred when calling torch.export.export. If you would like to view some more information about this error, and get a list of all other errors that may occur in your export call, you can replace your `export()` call with `draft_export()`.

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
</section>
<section id="signaturelistvariablelength">
<span id="ledx-model-case-export-signaturelistvariablelength"></span><h2>SignatureListVariableLength<a class="headerlink" href="#signaturelistvariablelength" title="Link to this heading">¶</a></h2>
<section id="id133">
<h3>forward<a class="headerlink" href="#id133" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lx</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">+</span> <span class="n">t</span>
</pre></div>
</div>
</section>
<section id="id134">
<h3>custom<a class="headerlink" href="#id134" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#3[T1s8x1,T1s8x2,T1s8x3])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;b_buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)-- DynamoInterpret.placeholder.0
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([0.083, 0.017, 0.049], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.029], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Concat(lx_0, lx_1, axis=1) -&gt; cat
  ReduceSum(cat, init7_s1_1, keepdims=1) -&gt; sum_1
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, b_buff) -&gt; sub
    Add(sub, sum_1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diff.1
</pre></div>
</div>
</section>
<section id="id135">
<h3>dynamo-ir<a class="headerlink" href="#id135" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#2[(T1s4x3,#2[T1s4x1,T1s4x2]),(T1s8x3,#3[T1s8x1,T1s8x2,T1s8x3])]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},lx:#2[{0:Dim(batch)},{0:Dim(batch)}])</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;lx_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
input: name=&#39;lx_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 2]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([-0.023,  0.555, -0.543], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.019], dtype=float32)
init: name=&#39;buff&#39; type=float32 shape=(1,) -- array([0.5], dtype=float32)
init: name=&#39;val_3&#39; type=int64 shape=(1,) -- array([1])
Concat(lx_0, lx_1, axis=1) -&gt; cat
  ReduceSum(cat, val_3, noop_with_empty_axes=0, keepdims=1) -&gt; sum_1
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Sub(sigmoid, buff) -&gt; sub_4
    Add(sub_4, sum_1) -&gt; add_15
output: name=&#39;add_15&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 1]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>diff.1
</pre></div>
</div>
</section>
</section>
<section id="signatureshapeasindex">
<span id="ledx-model-case-export-signatureshapeasindex"></span><h2>SignatureShapeAsIndex<a class="headerlink" href="#signatureshapeasindex" title="Link to this heading">¶</a></h2>
<section id="id136">
<h3>forward<a class="headerlink" href="#id136" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="id137">
<h3>custom<a class="headerlink" href="#id137" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x3,T1s4x2)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(batch),1:Dim(length)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;length&#39;]
init: name=&#39;init7_s1_0&#39; type=int64 shape=(1,) -- array([0])           -- Opset.make_node.1/Shape##Opset.make_node.1/Shape
init: name=&#39;init7_s1_1&#39; type=int64 shape=(1,) -- array([1])           -- Opset.make_node.1/Shape
init: name=&#39;GemmTransposePattern--p_linear_weight::T10&#39; type=float32 shape=(1, 3) -- array([ 0.23 , -0.504,  0.129], dtype=float32)-- GraphBuilder.constant_folding.from/fold(init7_s2_1_-1,p_linear_weight::T10)##p_linear_weight::T10/GraphBuilder.constant_folding.from/fold(p_linear_weight)##p_linear_weight/DynamoInterpret.placeholder.1/P(linear.weight)##init7_s2_1_-1/TransposeEqualReshapePattern.apply.new_shape
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.27], dtype=float32)-- DynamoInterpret.placeholder.1/P(linear.bias)
Gemm(x, GemmTransposePattern--p_linear_weight::T10, linear.bias, transB=1) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Add(sigmoid, x) -&gt; add
Shape(y, end=2, start=1) -&gt; y::Shape1:2
  Slice(add, init7_s1_0, y::Shape1:2, init7_s1_1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;length&#39;]
</pre></div>
</div>
</section>
<section id="id138">
<h3>dynamo-ir<a class="headerlink" href="#id138" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x3,T1s4x2)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)},y:{0:Dim(batch),1:Dim(length)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 3]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;length&#39;]
init: name=&#39;linear.weight&#39; type=float32 shape=(1, 3) -- array([ 0.113, -0.334,  0.323], dtype=float32)
init: name=&#39;linear.bias&#39; type=float32 shape=(1,) -- array([-0.363], dtype=float32)
init: name=&#39;val_1&#39; type=int64 shape=(1,) -- array([0])
init: name=&#39;val_8&#39; type=int64 shape=(1,) -- array([1])
Gemm(x, linear.weight, linear.bias, beta=1.00, transB=1, alpha=1.00, transA=0) -&gt; linear
  Sigmoid(linear) -&gt; sigmoid
    Add(sigmoid, x) -&gt; add_6
Shape(y, end=2, start=1) -&gt; val_0
  Slice(add_6, val_1, val_0, val_8, val_8) -&gt; slice_1
output: name=&#39;slice_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, &#39;length&#39;]
</pre></div>
</div>
</section>
</section>
<section id="typebfloat16">
<span id="ledx-model-case-export-typebfloat16"></span><h2>TypeBFloat16<a class="headerlink" href="#typebfloat16" title="Link to this heading">¶</a></h2>
<section id="id139">
<h3>forward<a class="headerlink" href="#id139" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">xb</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xb</span> <span class="o">+</span> <span class="n">xb</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id140">
<h3>custom<a class="headerlink" href="#id140" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=18
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
Add(x, x) -&gt; add-x
  Cast(add-x, to=16) -&gt; add
    Cast(add, to=1) -&gt; output_0
output: name=&#39;output_0&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
</section>
<section id="id141">
<h3>dynamo-ir<a class="headerlink" href="#id141" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s4x4,)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:Dim(batch)})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
Cast(x, to=16) -&gt; _to_copy
  Add(_to_copy, _to_copy) -&gt; add_3
    Cast(add_3, to=1) -&gt; _to_copy_1
output: name=&#39;_to_copy_1&#39; type=dtype(&#39;float32&#39;) shape=[&#39;batch&#39;, 4]
</pre></div>
</div>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[ONNXRuntimeError] : 9 : NOT_IMPLEMENTED : Could not find an implementation for Add(14) node with name &#39;node_add_3&#39;
</pre></div>
</div>
</section>
</section>
<section id="vmap">
<span id="ledx-model-case-export-vmap"></span><h2>Vmap<a class="headerlink" href="#vmap" title="Link to this heading">¶</a></h2>
<section id="id142">
<h3>forward<a class="headerlink" href="#id142" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># noqa: E731</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id143">
<h3>custom<a class="headerlink" href="#id143" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Unable to interpret function &lt;class &#39;str&#39;&gt;: &#39;aten__add_batch_dim&#39;, searched for [&#39;aten__add_batch_dim&#39;] and attributes [], args=(x, 0, 1), kwargs={}, dispatcher=None
--DEBUG--
[GraphBuilder-LQE] Message starts, there are 0 initializers, 2 nodes, 2 inputs, 2 outputs.
--CONSTRAINTS--
    DYN0 = {&#39;s77&#39;}
    DYN1 = {&#39;s17&#39;}
    s17 = {&#39;DYN1&#39;}
    s77 = {&#39;DYN0&#39;}
--SHAPE--
_dynamic_examples=
dynamic_objects=
   DYN0 = &#39;DYN0&#39;
   DYN1 = &#39;DYN1&#39;
   s17 = &#39;s17&#39;
   s77 = &#39;s77&#39;
   sym_size_int_3 = WrapSym(s17)
dynamic_objects_rev=
   &#39;DYN0&#39; = &lt;class &#39;list&#39;&gt;
     tuple
       &#39;DYN0&#39;
       ERR**: &lt;class &#39;torch.SymInt&#39;&gt;:&#39;DYN0&#39;
   &#39;DYN1&#39; = &lt;class &#39;list&#39;&gt;
     tuple
       &#39;DYN1&#39;
       ERR**: &lt;class &#39;torch.SymInt&#39;&gt;:&#39;DYN1&#39;
   &#39;s17&#39; = &lt;class &#39;list&#39;&gt;
     tuple
       &#39;sym_size_int_3&#39;
       s17
dynamic_dimensions_source={&#39;DYN0&#39;: [{&#39;axis&#39;: 0, &#39;input_name&#39;: &#39;x&#39;}],
 &#39;DYN1&#39;: [{&#39;axis&#39;: 0, &#39;input_name&#39;: &#39;y&#39;}]}
dynamic_dimensions_source_flat=[&#39;x&#39;, &#39;y&#39;]
output_dynamic_dimensions_source_flat=None
dynamic_alias={&#39;s17&#39;: &#39;DYN1&#39;, &#39;s77&#39;: &#39;DYN0&#39;}
dynamic_shapes={&#39;x&#39;: {0: Dim(&#39;DYN0&#39;, min=0)}, &#39;y&#39;: {0: Dim(&#39;DYN1&#39;, min=0)}}
_known_shapes={&#39;sym_size_int_3&#39;: (), &#39;x&#39;: (&#39;DYN0&#39;,), &#39;y&#39;: (&#39;DYN1&#39;,), &#39;y::Shape:1&#39;: (1,)}
_known_types={&#39;sym_size_int_3&#39;: 7, &#39;x&#39;: 1, &#39;y&#39;: 1, &#39;y::Shape:1&#39;: 7}
_known_value_shape={&#39;sym_size_int_3&#39;: &#39;str&#39;, &#39;y::Shape:1&#39;: (&#39;DYN1&#39;,)}
_known_constants=[]
_known_ranks (with no shape)={}
--PARAMETERS--
_parameter_renaming=
--TORCH-USERS--
    _add_batch_dim -&gt; {mul}
    sym_size_int_3 -&gt; {_remove_batch_dim}
    x -&gt; {_add_batch_dim}
    y -&gt; {_add_batch_dim_1, sym_size_int_3}
--TORCH-SHAPES--
    x: (&#39;run_node&#39;, (&#39;&#39;, (&#39;val&#39;, torch.float32, torch.Size([s17])))) --- 1:1:(&#39;DYN0&#39;,):
    y: (&#39;run_node&#39;, (&#39;&#39;, (&#39;val&#39;, torch.float32, torch.Size([s17])))) --- 1:1:(&#39;DYN1&#39;,):
    sym_size_int_3: (&#39;run_node&#39;, (&#39;&#39;, &#39;&#39;)) --- 7:0:():
    _add_batch_dim: (&#39;run_node&#39;, (&#39;&#39;, (&#39;val&#39;, torch.float32, torch.Size([])))) --- :::
--ONNX--
-- EXEPATH --
export-export_options=ExportOptions(aten_as_function=(&#39;aten.index_copy.default&#39;, &#39;aten.index_put.default&#39;, &#39;aten.setitem&#39;, &lt;built-in function setitem&gt;))
-- process.graph_module --
ExportedProgram:
    class GraphModule(torch.nn.Module):
        def forward(self, x: &quot;f32[s17]&quot;, y: &quot;f32[s17]&quot;):
             # 
            sym_size_int_3: &quot;Sym(s17)&quot; = torch.ops.aten.sym_size.int(y, 0)
        
             # File: ~/github/onnx-diagnostic/onnx_diagnostic/torch_export_patches/eval/model_cases.py:868 in forward, code: return torch.vmap(f)(x, y)
            _add_batch_dim: &quot;f32[]&quot; = torch._functorch.predispatch._add_batch_dim(x, 0, 1);  x = None
            _add_batch_dim_1: &quot;f32[]&quot; = torch._functorch.predispatch._add_batch_dim(y, 0, 1);  y = None
            mul: &quot;f32[]&quot; = torch.ops.aten.mul.Tensor(_add_batch_dim, _add_batch_dim_1);  _add_batch_dim = _add_batch_dim_1 = None
            add: &quot;f32[]&quot; = torch.ops.aten.add.Tensor(mul, 1);  mul = None
            _remove_batch_dim: &quot;f32[s17]&quot; = torch._functorch.predispatch._remove_batch_dim(add, 1, sym_size_int_3, 0);  add = sym_size_int_3 = None
            return (_remove_batch_dim,)
        
Graph signature: 
    # inputs
    x: USER_INPUT
    y: USER_INPUT

    # outputs
    _remove_batch_dim: USER_OUTPUT

Range constraints: {s17: VR[2, int_oo]}

-- process.graph_module.graph --
graph():
    %x : [num_users=1] = placeholder[target=x]
    %y : [num_users=2] = placeholder[target=y]
    %sym_size_int_3 : [num_users=1] = call_function[target=torch.ops.aten.sym_size.int](args = (%y, 0), kwargs = {})
    %_add_batch_dim : [num_users=1] = call_function[target=torch._functorch.predispatch._add_batch_dim](args = (%x, 0, 1), kwargs = {})
    %_add_batch_dim_1 : [num_users=1] = call_function[target=torch._functorch.predispatch._add_batch_dim](args = (%y, 0, 1), kwargs = {})
    %mul : [num_users=1] = call_function[target=torch.ops.aten.mul.Tensor](args = (%_add_batch_dim, %_add_batch_dim_1), kwargs = {})
    %add : [num_users=1] = call_function[target=torch.ops.aten.add.Tensor](args = (%mul, 1), kwargs = {})
    %_remove_batch_dim : [num_users=1] = call_function[target=torch._functorch.predispatch._remove_batch_dim](args = (%add, 1, %sym_size_int_3, 0), kwargs = {})
    return (_remove_batch_dim,)
-- process.inputs_to_remove --
set()
-- process.progress --
node 3/9 target=&lt;function _add_batch_dim at 0x77e10af80360&gt;
-- 2 INPUTS
[GraphBuilder-LQE.make_tensor_input] x[1:DYN0]
[GraphBuilder-LQE.make_tensor_input] y[1:DYN1]
-- 0 INITIALIZERS
[GraphBuilder-LQE.make_node] sym_size_int    [#:#   ] Shape:[&#39;y&#39;]-&gt;[&#39;y::Shape:1&#39;]
[GraphBuilder-LQE.make_node] sym_size_int2   [#:#   ] Squeeze:[&#39;y::Shape:1&#39;]-&gt;[&#39;sym_size_int_3&#39;]
-- 0 OUTPUTS
[GraphBuilder-LQE] Message completed, there are 0 initializers, 2 nodes, 2 inputs, 2 outputs., 
</pre></div>
</div>
</section>
<section id="id144">
<h3>dynamo-ir<a class="headerlink" href="#id144" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>inputs:</strong> <code class="docutils literal notranslate"><span class="pre">#1[(T1s3,T1s3)]</span></code></p></li>
<li><p><strong>shapes:</strong> <code class="docutils literal notranslate"><span class="pre">dict(x:{0:DYNAMIC},y:{0:DYNAMIC})</span></code></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=20
input: name=&#39;x&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;]
input: name=&#39;y&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;]
init: name=&#39;_to_copy&#39; type=float32 shape=() -- array([1.], dtype=float32)
Mul(x, y) -&gt; mul
  Add(mul, _to_copy) -&gt; add_2
output: name=&#39;add_2&#39; type=dtype(&#39;float32&#39;) shape=[&#39;s17&#39;]
</pre></div>
</div>
</section>
</section>
<section id="vmappython">
<span id="ledx-model-case-export-vmappython"></span><h2>VmapPython<a class="headerlink" href="#vmappython" title="Link to this heading">¶</a></h2>
<section id="id145">
<h3>forward<a class="headerlink" href="#id145" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># noqa: E731</span>
    <span class="k">return</span> <span class="n">patched_vmap</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id146">
<h3>custom<a class="headerlink" href="#id146" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>object of type &#39;Node&#39; has no len()
</pre></div>
</div>
</section>
<section id="id147">
<h3>dynamo-ir<a class="headerlink" href="#id147" title="Link to this heading">¶</a></h3>
<p><strong>FAILED</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

&lt;class &#39;TypeError&#39;&gt;: object of type &#39;Node&#39; has no len()

(Refer to the full stack trace above for more information.)
</pre></div>
</div>
</section>
<section id="summary">
<span id="ledx-summary-exported-program"></span><h3>Summary<a class="headerlink" href="#summary" title="Link to this heading">¶</a></h3>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>case</p></th>
<th class="head"><p>custom</p></th>
<th class="head"><p>ir</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-atenasstrided"><span class="std std-ref">AtenAsStrided</span></a></p></td>
<td><p>FAIL</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-ateninterpolate"><span class="std std-ref">AtenInterpolate</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-atennonzero"><span class="std std-ref">AtenNonZero</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-atennonzerotuple"><span class="std std-ref">AtenNonZeroTuple</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-atenrollpos"><span class="std std-ref">AtenRollPos</span></a></p></td>
<td></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-atenrollrelu"><span class="std std-ref">AtenRollRelu</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-buildinisinstance"><span class="std std-ref">BuildInIsInstance</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-buildinlen"><span class="std std-ref">BuildInLen</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-complexpolar"><span class="std std-ref">ComplexPolar</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond"><span class="std std-ref">ControlFlowCond</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond2inputs"><span class="std std-ref">ControlFlowCond2Inputs</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcond2outputs"><span class="std std-ref">ControlFlowCond2Outputs</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondconstant"><span class="std std-ref">ControlFlowCondConstant</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondidentity-153832"><span class="std std-ref">ControlFlowCondIdentity_153832</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondnestedmodule"><span class="std std-ref">ControlFlowCondNestedModule</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowcondnonzero"><span class="std std-ref">ControlFlowCondNonZero</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflownestcond"><span class="std std-ref">ControlFlowNestCond</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscan"><span class="std std-ref">ControlFlowScan</span></a></p></td>
<td></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscan2carried"><span class="std std-ref">ControlFlowScan2Carried</span></a></p></td>
<td></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdist"><span class="std std-ref">ControlFlowScanCDist</span></a></p></td>
<td></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdist2"><span class="std std-ref">ControlFlowScanCDist2</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscancdistxy"><span class="std std-ref">ControlFlowScanCDistXY</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscandecomposition-151564"><span class="std std-ref">ControlFlowScanDecomposition_151564</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-controlflowscaninplace-153705"><span class="std std-ref">ControlFlowScanInplace_153705</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-createfromshape"><span class="std std-ref">CreateFromShape</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-createfromshapethroughfunction"><span class="std std-ref">CreateFromShapeThroughFunction</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-croplastdimensionwithtensorcontent"><span class="std std-ref">CropLastDimensionWithTensorContent</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-croplastdimensionwithtensorshape"><span class="std std-ref">CropLastDimensionWithTensorShape</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-exportwithdimension0"><span class="std std-ref">ExportWithDimension0</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-exportwithdimension1"><span class="std std-ref">ExportWithDimension1</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd"><span class="std std-ref">InplaceAdd</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd2"><span class="std std-ref">InplaceAdd2</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-inplaceadd-mul"><span class="std std-ref">InplaceAdd_Mul</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacecloneadd"><span class="std std-ref">InplaceCloneAdd_</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemellipsis-1"><span class="std std-ref">InplaceSetItemEllipsis_1</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemellipsis-2"><span class="std std-ref">InplaceSetItemEllipsis_2</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemmask"><span class="std std-ref">InplaceSetItemMask</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquare"><span class="std std-ref">InplaceSetItemSquare</span></a></p></td>
<td><p>FAIL</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquareadd"><span class="std std-ref">InplaceSetItemSquareAdd</span></a></p></td>
<td><p>FAIL</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-inplacesetitemsquareadd2"><span class="std std-ref">InplaceSetItemSquareAdd2</span></a></p></td>
<td><p>FAIL</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-signaturefloat1"><span class="std std-ref">SignatureFloat1</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-signatureint1"><span class="std std-ref">SignatureInt1</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-signatureint2"><span class="std std-ref">SignatureInt2</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-signaturelistfixedlength"><span class="std std-ref">SignatureListFixedLength</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-signaturelistfixedwithnone"><span class="std std-ref">SignatureListFixedWithNone</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-signaturelistvariablelength"><span class="std std-ref">SignatureListVariableLength</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-signatureshapeasindex"><span class="std std-ref">SignatureShapeAsIndex</span></a></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-typebfloat16"><span class="std std-ref">TypeBFloat16</span></a></p></td>
<td></td>
<td><p>FAIL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ledx-model-case-export-vmap"><span class="std std-ref">Vmap</span></a></p></td>
<td><p>FAIL</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ledx-model-case-export-vmappython"><span class="std std-ref">VmapPython</span></a></p></td>
<td><p>FAIL</p></td>
<td><p>FAIL</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="patches_coverage.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Coverage of the Patches</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="exported_program_dynamic.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Exported Programs with Dynamic Shapes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=45fbed3c"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>