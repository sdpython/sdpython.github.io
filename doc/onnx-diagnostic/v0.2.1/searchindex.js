Search.setIndex({"alltitles": {"0.1.0": [[0, "id3"]], "0.2.0": [[0, "id2"]], "0.2.1": [[0, "id1"]], "A failing model": [[51, "a-failing-model"], [52, "a-failing-model"], [53, "a-failing-model"]], "A model with a test": [[46, "a-model-with-a-test"]], "API of onnx_diagnostic": [[7, null]], "Back to the original model": [[47, "back-to-the-original-model"]], "Change Logs": [[0, null]], "Computation times": [[54, null], [57, null]], "Contents": [[55, null]], "Detect an issue with shape Inference": [[51, "detect-an-issue-with-shape-inference"]], "DynamicCache": [[49, "dynamiccache"]], "Enlightening Examples": [[55, "enlightening-examples"]], "Errors": [[48, "errors"]], "Examples Gallery": [[45, null]], "Export Tiny-LLM with patches": [[48, null]], "Export a model with a control flow (If)": [[46, null]], "Export with DynamicCache and dynamic shapes": [[49, null]], "ExportedProgram": [[47, "exportedprogram"]], "ExtendedReferenceEvaluator": [[11, "extendedreferenceevaluator"], [53, "extendedreferenceevaluator"]], "Find where a model is failing by running submodels": [[51, null]], "Getting started": [[55, "getting-started"]], "Intermediate results with (ONNX) ReferenceEvaluator": [[53, null]], "Intermediate results with onnxruntime": [[52, null]], "License": [[56, null]], "Looping over the nodes": [[51, "looping-over-the-nodes"]], "ModelInputs": [[4, "modelinputs"]], "More": [[55, null]], "Older versions": [[55, "older-versions"]], "OnnxruntimeEvaluator": [[11, "onnxruntimeevaluator"], [52, "onnxruntimeevaluator"]], "Other functions": [[4, "module-onnx_diagnostic.export"], [11, "module-onnx_diagnostic.reference"]], "Shape Inference": [[51, "shape-inference"]], "Simple Examples": [[49, "simple-examples"]], "Steel method forward to guess the dynamic shapes (with Tiny-LLM)": [[47, null]], "Steel the forward method": [[47, "steel-the-forward-method"]], "Suggested Patch": [[46, "suggested-patch"]], "Untrained model": [[47, "untrained-model"]], "Use DYNAMIC or AUTO when exporting if dynamic shapes has constraints": [[50, null]], "With the original model": [[48, "with-the-original-model"]], "args": [[49, "args"]], "args and kwargs": [[49, "args-and-kwargs"]], "dx + dy not allowed?": [[50, "dx-dy-not-allowed"]], "kwargs": [[49, "kwargs"]], "modules": [[4, null], [7, null], [11, null], [12, null], [39, null]], "onnx-diagnostic: investigate onnx models": [[55, null]], "onnx_diagnostic.args": [[1, null]], "onnx_diagnostic.cache_helpers": [[2, null]], "onnx_diagnostic.export": [[4, null]], "onnx_diagnostic.export.dynamic_shapes": [[3, null]], "onnx_diagnostic.ext_test_case": [[5, null]], "onnx_diagnostic.helpers": [[6, null]], "onnx_diagnostic.onnx_tools": [[8, null]], "onnx_diagnostic.ort_session": [[9, null]], "onnx_diagnostic.reference": [[11, null]], "onnx_diagnostic.reference.evaluator": [[10, null]], "onnx_diagnostic.reference.ops": [[12, null]], "onnx_diagnostic.reference.ops.op_add_add_mul_mul": [[13, null]], "onnx_diagnostic.reference.ops.op_average_pool_grad": [[14, null]], "onnx_diagnostic.reference.ops.op_cast_like": [[15, null]], "onnx_diagnostic.reference.ops.op_complex": [[16, null]], "onnx_diagnostic.reference.ops.op_concat": [[17, null]], "onnx_diagnostic.reference.ops.op_constant_of_shape": [[18, null]], "onnx_diagnostic.reference.ops.op_fused_matmul": [[19, null]], "onnx_diagnostic.reference.ops.op_gather_grad": [[20, null]], "onnx_diagnostic.reference.ops.op_memcpy_host": [[21, null]], "onnx_diagnostic.reference.ops.op_mul_sigmoid": [[22, null]], "onnx_diagnostic.reference.ops.op_negxplus1": [[23, null]], "onnx_diagnostic.reference.ops.op_qlinear_average_pool": [[24, null]], "onnx_diagnostic.reference.ops.op_qlinear_conv": [[25, null]], "onnx_diagnostic.reference.ops.op_quick_gelu": [[26, null]], "onnx_diagnostic.reference.ops.op_replace_zero": [[27, null]], "onnx_diagnostic.reference.ops.op_rotary": [[28, null]], "onnx_diagnostic.reference.ops.op_scatter_elements": [[29, null]], "onnx_diagnostic.reference.ops.op_scatternd_of_shape": [[30, null]], "onnx_diagnostic.reference.ops.op_simplified_layer_normalization": [[31, null]], "onnx_diagnostic.reference.ops.op_skip_layer_normalization": [[32, null]], "onnx_diagnostic.reference.ops.op_slice": [[33, null]], "onnx_diagnostic.reference.ops.op_transpose_cast": [[34, null]], "onnx_diagnostic.reference.ops.op_tri_matrix": [[35, null]], "onnx_diagnostic.reference.ort_evaluator": [[36, null]], "onnx_diagnostic.reference.quantized_tensor": [[37, null]], "onnx_diagnostic.torch_export_patches": [[38, null]], "onnx_diagnostic.torch_export_patches.patches": [[39, null]], "onnx_diagnostic.torch_export_patches.patches.patch_torch": [[40, null]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers": [[41, null]], "onnx_diagnostic.torch_models": [[42, null]], "onnx_diagnostic.torch_models.llms": [[43, null]], "onnx_diagnostic.torch_test_helper": [[44, null]], "submodules": [[7, null], [11, null], [38, null], [42, null]]}, "docnames": ["CHANGELOGS", "api/args", "api/cache_helpers", "api/export/dynamic_shapes", "api/export/index", "api/ext_test_case", "api/helpers", "api/index", "api/onnx_tools", "api/ort_session", "api/reference/evaluator", "api/reference/index", "api/reference/ops/index", "api/reference/ops/op_add_add_mul_mul", "api/reference/ops/op_average_pool_grad", "api/reference/ops/op_cast_like", "api/reference/ops/op_complex", "api/reference/ops/op_concat", "api/reference/ops/op_constant_of_shape", "api/reference/ops/op_fused_matmul", "api/reference/ops/op_gather_grad", "api/reference/ops/op_memcpy_host", "api/reference/ops/op_mul_sigmoid", "api/reference/ops/op_negxplus1", "api/reference/ops/op_qlinear_average_pool", "api/reference/ops/op_qlinear_conv", "api/reference/ops/op_quick_gelu", "api/reference/ops/op_replace_zero", "api/reference/ops/op_rotary", "api/reference/ops/op_scatter_elements", "api/reference/ops/op_scatternd_of_shape", "api/reference/ops/op_simplified_layer_normalization", "api/reference/ops/op_skip_layer_normalization", "api/reference/ops/op_slice", "api/reference/ops/op_transpose_cast", "api/reference/ops/op_tri_matrix", "api/reference/ort_evaluator", "api/reference/quantized_tensor", "api/torch_export_patches/index", "api/torch_export_patches/patches/index", "api/torch_export_patches/patches/patch_torch", "api/torch_export_patches/patches/patch_transformers", "api/torch_models/index", "api/torch_models/llms", "api/torch_test_helper", "auto_examples/index", "auto_examples/plot_export_cond", "auto_examples/plot_export_tiny_llm", "auto_examples/plot_export_tiny_llm_patched", "auto_examples/plot_export_with_dynamic_cache", "auto_examples/plot_export_with_dynamic_shapes_auto", "auto_examples/plot_failing_model_extract", "auto_examples/plot_failing_onnxruntime_evaluator", "auto_examples/plot_failing_reference_evaluator", "auto_examples/sg_execution_times", "index", "license", "sg_execution_times"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1}, "filenames": ["CHANGELOGS.rst", "api/args.rst", "api/cache_helpers.rst", "api/export/dynamic_shapes.rst", "api/export/index.rst", "api/ext_test_case.rst", "api/helpers.rst", "api/index.rst", "api/onnx_tools.rst", "api/ort_session.rst", "api/reference/evaluator.rst", "api/reference/index.rst", "api/reference/ops/index.rst", "api/reference/ops/op_add_add_mul_mul.rst", "api/reference/ops/op_average_pool_grad.rst", "api/reference/ops/op_cast_like.rst", "api/reference/ops/op_complex.rst", "api/reference/ops/op_concat.rst", "api/reference/ops/op_constant_of_shape.rst", "api/reference/ops/op_fused_matmul.rst", "api/reference/ops/op_gather_grad.rst", "api/reference/ops/op_memcpy_host.rst", "api/reference/ops/op_mul_sigmoid.rst", "api/reference/ops/op_negxplus1.rst", "api/reference/ops/op_qlinear_average_pool.rst", "api/reference/ops/op_qlinear_conv.rst", "api/reference/ops/op_quick_gelu.rst", "api/reference/ops/op_replace_zero.rst", "api/reference/ops/op_rotary.rst", "api/reference/ops/op_scatter_elements.rst", "api/reference/ops/op_scatternd_of_shape.rst", "api/reference/ops/op_simplified_layer_normalization.rst", "api/reference/ops/op_skip_layer_normalization.rst", "api/reference/ops/op_slice.rst", "api/reference/ops/op_transpose_cast.rst", "api/reference/ops/op_tri_matrix.rst", "api/reference/ort_evaluator.rst", "api/reference/quantized_tensor.rst", "api/torch_export_patches/index.rst", "api/torch_export_patches/patches/index.rst", "api/torch_export_patches/patches/patch_torch.rst", "api/torch_export_patches/patches/patch_transformers.rst", "api/torch_models/index.rst", "api/torch_models/llms.rst", "api/torch_test_helper.rst", "auto_examples/index.rst", "auto_examples/plot_export_cond.rst", "auto_examples/plot_export_tiny_llm.rst", "auto_examples/plot_export_tiny_llm_patched.rst", "auto_examples/plot_export_with_dynamic_cache.rst", "auto_examples/plot_export_with_dynamic_shapes_auto.rst", "auto_examples/plot_failing_model_extract.rst", "auto_examples/plot_failing_onnxruntime_evaluator.rst", "auto_examples/plot_failing_reference_evaluator.rst", "auto_examples/sg_execution_times.rst", "index.rst", "license.rst", "sg_execution_times.rst"], "indexentries": {}, "objects": {"": [[7, 0, 0, "-", "onnx_diagnostic"]], "onnx_diagnostic": [[1, 0, 0, "-", "args"], [2, 0, 0, "-", "cache_helpers"], [4, 0, 0, "-", "export"], [5, 0, 0, "-", "ext_test_case"], [6, 0, 0, "-", "helpers"], [8, 0, 0, "-", "onnx_tools"], [9, 0, 0, "-", "ort_session"], [11, 0, 0, "-", "reference"], [38, 0, 0, "-", "torch_export_patches"], [42, 0, 0, "-", "torch_models"], [44, 0, 0, "-", "torch_test_helper"]], "onnx_diagnostic.args": [[1, 1, 1, "", "check_cuda_availability"], [1, 1, 1, "", "get_parsed_args"]], "onnx_diagnostic.cache_helpers": [[2, 1, 1, "", "make_dynamic_cache"]], "onnx_diagnostic.export": [[4, 2, 1, "", "ModelInputs"], [3, 0, 0, "-", "dynamic_shapes"]], "onnx_diagnostic.export.ModelInputs": [[4, 3, 1, "", "full_name"], [4, 4, 1, "", "guess_dynamic_dimensions"], [4, 4, 1, "", "guess_dynamic_shape_object"], [4, 4, 1, "", "guess_dynamic_shapes"], [4, 3, 1, "", "module_name_type"], [4, 4, 1, "", "move_to_kwargs"], [4, 4, 1, "", "process_inputs"], [4, 3, 1, "", "true_model_name"]], "onnx_diagnostic.export.dynamic_shapes": [[3, 2, 1, "", "ModelInputs"]], "onnx_diagnostic.export.dynamic_shapes.ModelInputs": [[3, 3, 1, "", "full_name"], [3, 4, 1, "", "guess_dynamic_dimensions"], [3, 4, 1, "", "guess_dynamic_shape_object"], [3, 4, 1, "", "guess_dynamic_shapes"], [3, 3, 1, "", "module_name_type"], [3, 4, 1, "", "move_to_kwargs"], [3, 4, 1, "", "process_inputs"], [3, 3, 1, "", "true_model_name"]], "onnx_diagnostic.ext_test_case": [[5, 2, 1, "", "ExtTestCase"], [5, 1, 1, "", "get_figure"], [5, 1, 1, "", "has_cuda"], [5, 1, 1, "", "has_onnxruntime_training"], [5, 1, 1, "", "has_onnxscript"], [5, 1, 1, "", "has_torch"], [5, 1, 1, "", "has_transformers"], [5, 1, 1, "", "hide_stdout"], [5, 1, 1, "", "ignore_warnings"], [5, 1, 1, "", "is_azure"], [5, 1, 1, "", "long_test"], [5, 1, 1, "", "measure_time"], [5, 1, 1, "", "never_test"], [5, 1, 1, "", "requires_cuda"], [5, 1, 1, "", "requires_diffusers"], [5, 1, 1, "", "requires_numpy"], [5, 1, 1, "", "requires_onnx"], [5, 1, 1, "", "requires_onnx_array_api"], [5, 1, 1, "", "requires_onnxruntime"], [5, 1, 1, "", "requires_onnxruntime_training"], [5, 1, 1, "", "requires_onnxscript"], [5, 1, 1, "", "requires_sklearn"], [5, 1, 1, "", "requires_torch"], [5, 1, 1, "", "requires_transformers"], [5, 1, 1, "", "requires_zoo"], [5, 1, 1, "", "skipif_ci_apple"], [5, 1, 1, "", "skipif_ci_linux"], [5, 1, 1, "", "skipif_ci_windows"], [5, 1, 1, "", "statistics_on_file"], [5, 1, 1, "", "statistics_on_folder"], [5, 1, 1, "", "unit_test_going"]], "onnx_diagnostic.ext_test_case.ExtTestCase": [[5, 4, 1, "", "assertAlmostEqual"], [5, 4, 1, "", "assertEmpty"], [5, 4, 1, "", "assertEqual"], [5, 4, 1, "", "assertEqualArray"], [5, 4, 1, "", "assertEqualArrays"], [5, 4, 1, "", "assertExists"], [5, 4, 1, "", "assertGreaterOrEqual"], [5, 4, 1, "", "assertIn"], [5, 4, 1, "", "assertNotEmpty"], [5, 4, 1, "", "assertRaise"], [5, 4, 1, "", "assertSetContained"], [5, 4, 1, "", "assertStartsWith"], [5, 4, 1, "", "assert_onnx_disc"], [5, 4, 1, "", "capture"], [5, 4, 1, "", "dump_onnx"], [5, 4, 1, "", "get_dump_file"], [5, 4, 1, "", "print_model"], [5, 4, 1, "", "print_onnx"], [5, 4, 1, "", "setUpClass"], [5, 4, 1, "", "tearDownClass"], [5, 4, 1, "", "todo"], [5, 4, 1, "", "tryCall"]], "onnx_diagnostic.helpers": [[6, 1, 1, "", "convert_endian"], [6, 1, 1, "", "dtype_to_tensor_dtype"], [6, 1, 1, "", "flatten_object"], [6, 1, 1, "", "from_array_extended"], [6, 1, 1, "", "from_array_ml_dtypes"], [6, 1, 1, "", "get_onnx_signature"], [6, 1, 1, "", "make_hash"], [6, 1, 1, "", "max_diff"], [6, 1, 1, "", "np_dtype_to_tensor_dtype"], [6, 1, 1, "", "onnx_dtype_name"], [6, 1, 1, "", "onnx_dtype_to_np_dtype"], [6, 1, 1, "", "onnx_dtype_to_torch_dtype"], [6, 1, 1, "", "pretty_onnx"], [6, 1, 1, "", "proto_from_tensor"], [6, 1, 1, "", "rename_dynamic_dimensions"], [6, 1, 1, "", "rename_dynamic_expression"], [6, 1, 1, "", "size_type"], [6, 1, 1, "", "string_diff"], [6, 1, 1, "", "string_sig"], [6, 1, 1, "", "string_signature"], [6, 1, 1, "", "string_type"], [6, 1, 1, "", "tensor_dtype_to_np_dtype"], [6, 1, 1, "", "to_array_extended"], [6, 1, 1, "", "torch_dtype_to_onnx_dtype"], [6, 1, 1, "", "type_info"]], "onnx_diagnostic.onnx_tools": [[8, 1, 1, "", "onnx_find"], [8, 1, 1, "", "onnx_lighten"], [8, 1, 1, "", "onnx_unlighten"]], "onnx_diagnostic.ort_session": [[9, 2, 1, "", "InferenceSessionForNumpy"], [9, 2, 1, "", "InferenceSessionForTorch"], [9, 1, 1, "", "investigate_onnxruntime_issue"]], "onnx_diagnostic.ort_session.InferenceSessionForNumpy": [[9, 4, 1, "", "run"], [9, 4, 1, "", "run_dlpack"]], "onnx_diagnostic.ort_session.InferenceSessionForTorch": [[9, 4, 1, "", "run"], [9, 4, 1, "", "run_dlpack"], [9, 4, 1, "", "run_training_api"]], "onnx_diagnostic.reference": [[11, 2, 1, "", "ExtendedReferenceEvaluator"], [11, 2, 1, "", "OnnxruntimeEvaluator"], [10, 0, 0, "-", "evaluator"], [12, 0, 0, "-", "ops"], [36, 0, 0, "-", "ort_evaluator"], [37, 0, 0, "-", "quantized_tensor"]], "onnx_diagnostic.reference.ExtendedReferenceEvaluator": [[11, 4, 1, "", "run"]], "onnx_diagnostic.reference.OnnxruntimeEvaluator": [[11, 3, 1, "", "input_names"], [11, 3, 1, "", "input_types"], [11, 3, 1, "", "output_names"], [11, 3, 1, "", "output_types"], [11, 4, 1, "", "run"]], "onnx_diagnostic.reference.ops": [[13, 0, 0, "-", "op_add_add_mul_mul"], [14, 0, 0, "-", "op_average_pool_grad"], [15, 0, 0, "-", "op_cast_like"], [16, 0, 0, "-", "op_complex"], [17, 0, 0, "-", "op_concat"], [18, 0, 0, "-", "op_constant_of_shape"], [19, 0, 0, "-", "op_fused_matmul"], [20, 0, 0, "-", "op_gather_grad"], [21, 0, 0, "-", "op_memcpy_host"], [22, 0, 0, "-", "op_mul_sigmoid"], [23, 0, 0, "-", "op_negxplus1"], [24, 0, 0, "-", "op_qlinear_average_pool"], [25, 0, 0, "-", "op_qlinear_conv"], [26, 0, 0, "-", "op_quick_gelu"], [27, 0, 0, "-", "op_replace_zero"], [28, 0, 0, "-", "op_rotary"], [29, 0, 0, "-", "op_scatter_elements"], [30, 0, 0, "-", "op_scatternd_of_shape"], [31, 0, 0, "-", "op_simplified_layer_normalization"], [32, 0, 0, "-", "op_skip_layer_normalization"], [33, 0, 0, "-", "op_slice"], [34, 0, 0, "-", "op_transpose_cast"], [35, 0, 0, "-", "op_tri_matrix"]], "onnx_diagnostic.reference.ops.op_add_add_mul_mul": [[13, 2, 1, "", "AddAdd"], [13, 2, 1, "", "AddMul"], [13, 2, 1, "", "AddSharedInput"], [13, 2, 1, "", "MulAdd"], [13, 2, 1, "", "MulMul"], [13, 2, 1, "", "MulSharedInput"], [13, 2, 1, "", "MulSub"], [13, 2, 1, "", "SubMul"]], "onnx_diagnostic.reference.ops.op_average_pool_grad": [[14, 2, 1, "", "AveragePoolGrad"]], "onnx_diagnostic.reference.ops.op_cast_like": [[15, 2, 1, "", "CastLike_15"], [15, 2, 1, "", "CastLike_19"]], "onnx_diagnostic.reference.ops.op_complex": [[16, 2, 1, "", "ComplexModule"], [16, 2, 1, "", "ToComplex"]], "onnx_diagnostic.reference.ops.op_concat": [[17, 2, 1, "", "Concat"]], "onnx_diagnostic.reference.ops.op_constant_of_shape": [[18, 2, 1, "", "ConstantOfShape"]], "onnx_diagnostic.reference.ops.op_fused_matmul": [[19, 2, 1, "", "FusedMatMul"]], "onnx_diagnostic.reference.ops.op_gather_grad": [[20, 2, 1, "", "GatherGrad"]], "onnx_diagnostic.reference.ops.op_memcpy_host": [[21, 2, 1, "", "MemcpyFromHost"], [21, 2, 1, "", "MemcpyToHost"]], "onnx_diagnostic.reference.ops.op_mul_sigmoid": [[22, 2, 1, "", "MulSigmoid"]], "onnx_diagnostic.reference.ops.op_negxplus1": [[23, 2, 1, "", "NegXplus1"]], "onnx_diagnostic.reference.ops.op_qlinear_average_pool": [[24, 2, 1, "", "QLinearAveragePool"]], "onnx_diagnostic.reference.ops.op_qlinear_conv": [[25, 2, 1, "", "QLinearConv"]], "onnx_diagnostic.reference.ops.op_quick_gelu": [[26, 2, 1, "", "QuickGelu"]], "onnx_diagnostic.reference.ops.op_replace_zero": [[27, 2, 1, "", "ReplaceZero"]], "onnx_diagnostic.reference.ops.op_rotary": [[28, 2, 1, "", "Rotary"]], "onnx_diagnostic.reference.ops.op_scatter_elements": [[29, 2, 1, "", "ScatterElements"]], "onnx_diagnostic.reference.ops.op_scatternd_of_shape": [[30, 2, 1, "", "MaskedScatterNDOfShape"], [30, 2, 1, "", "ScatterNDOfShape"]], "onnx_diagnostic.reference.ops.op_simplified_layer_normalization": [[31, 2, 1, "", "SimplifiedLayerNormalization"]], "onnx_diagnostic.reference.ops.op_skip_layer_normalization": [[32, 2, 1, "", "SkipLayerNormalization"]], "onnx_diagnostic.reference.ops.op_slice": [[33, 2, 1, "", "Slice_1"], [33, 2, 1, "", "Slice_10"]], "onnx_diagnostic.reference.ops.op_transpose_cast": [[34, 2, 1, "", "Transpose2DCastFP16"], [34, 2, 1, "", "Transpose2DCastFP32"]], "onnx_diagnostic.reference.ops.op_tri_matrix": [[35, 2, 1, "", "TriMatrix"]], "onnx_diagnostic.reference.quantized_tensor": [[37, 2, 1, "", "QuantizedTensor"]], "onnx_diagnostic.reference.quantized_tensor.QuantizedTensor": [[37, 3, 1, "", "qtensor"], [37, 3, 1, "", "scale"], [37, 3, 1, "", "shape"], [37, 3, 1, "", "zero_point"]], "onnx_diagnostic.torch_export_patches": [[38, 1, 1, "", "bypass_export_some_errors"], [39, 0, 0, "-", "patches"], [38, 1, 1, "", "register_additional_serialization_functions"]], "onnx_diagnostic.torch_export_patches.patches": [[40, 0, 0, "-", "patch_torch"], [41, 0, 0, "-", "patch_transformers"]], "onnx_diagnostic.torch_export_patches.patches.patch_torch": [[40, 1, 1, "", "patch__check_input_constraints_for_graph"], [40, 1, 1, "", "patched__broadcast_shapes"], [40, 1, 1, "", "patched_infer_size"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers": [[41, 2, 1, "", "patched_AttentionMaskConverter"], [41, 2, 1, "", "patched_DynamicCache"], [41, 2, 1, "", "patched_GenerationMixin"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_DynamicCache": [[41, 4, 1, "", "crop"], [41, 4, 1, "", "from_batch_splits"], [41, 4, 1, "", "reorder_cache"], [41, 4, 1, "", "update"]], "onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_GenerationMixin": [[41, 4, 1, "", "prepare_inputs_for_generation"]], "onnx_diagnostic.torch_models": [[43, 0, 0, "-", "llms"]], "onnx_diagnostic.torch_models.llms": [[43, 1, 1, "", "get_tiny_llm"]], "onnx_diagnostic.torch_test_helper": [[44, 1, 1, "", "check_model_ort"], [44, 1, 1, "", "dummy_llm"], [44, 1, 1, "", "is_torchdynamo_exporting"], [44, 1, 1, "", "to_numpy"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "property", "Python property"], "4": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:property", "4": "py:method"}, "terms": {"": [6, 38, 46, 47, 48, 51, 52, 53], "0": [1, 3, 4, 5, 6, 8, 9, 11, 37, 38, 40, 44, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 57], "00": [54, 57], "000": [54, 57], "00012126699584769085": 5, "00019166296821519305": 47, "0002665653005288328": 47, "0002932086185690143": 47, "0004028779209511413": 47, "0005142958496882842": 47, "0005228725962415806": 47, "000639468807050211": 47, "0006579360752063869": 47, "0009283175923894218": 47, "0009805012328279288": 47, "0009807385009616542": 47, "0009929958164868232": 47, "001": 5, "001031141834913682": 47, "0010709463851916164": 47, "0011150861308654688": 47, "0011257512724540675": 47, "001135663967625078": 47, "001301998217794629": 47, "0013026445556996598": 47, "0014222463435031292": 47, "001447903283440155": 47, "0016129579268470645": 47, "0017472276702803703": 47, "0018374898756427888": 47, "0018794620234844413": 47, "0022311601861381347": 47, "0023525682480929526": 47, "002423784210109722": 47, "00244140625": 6, "0024895443630743048": 47, "002592936991006701": 47, "002710155984980626": 47, "003021743850801632": 47, "003054067980044945": 47, "0031065577381670867": 47, "0033459275750115634": 47, "003594788506464713": 47, "0038646262574266255": [], "003912074692562492": 47, "004478166235032173": [], "004664762183172873": 47, "004895640138005491": [], "004990132970497275": [], "005033685374407165": [], "005139074817722295": [], "005208111457244367": [], "005220446706979837": [], "005302528625094283": [], "005359395481055647": [], "005639792969082876": [], "005827561276376514": [], "005909156238999458": [], "005912637528783509": [], "006003893970561573": [], "006025017590693995": [], "006031264033491526": [], "006133597556605329": [], "006173653169677588": [], "006378929029470883": [], "00650761682404342": [], "0065101834544015625": [], "006554521042639512": [], "006611512381607554": [], "006708622637360931": [], "006733533424015591": [], "006804593346660546": [], "006842302019608555": [], "006852545743103047": [], "006873245279036964": [], "006891621833757885": [], "00690154868351776": [], "0069193957345719615": [], "007029933960177701": [], "007220302310243178": [], "007227749521139988": 47, "0072992617647411": [], "0074666360159095675": 47, "007744434695858352": [], "008274012527216166": [], "008736979494627425": [], "008840549362609333": 47, "0094": 49, "009432555446222877": [], "009565710057611594": 47, "0102": 49, "010512653572332607": [], "0112": 49, "0126": 49, "0158": 49, "02": [], "0284": 49, "029963316395878792": 53, "03": 55, "0314": 49, "0327": 49, "033203125": 6, "03515625": 6, "0373": 49, "0382": 49, "0401": 49, "044943": 55, "05": [5, 44, 47, 48], "05020175874233246": 53, "05078125": 52, "052580870321664135": 47, "0535": 49, "0546875": 52, "0561": 49, "0568": 49, "058163763849734096": [], "059280068831438056": 47, "06206018149024809": [], "06333628150504739": 47, "0634765625": 52, "0642527300979377": [], "06427637729769534": [], "0643018856441712": 47, "06440772164582534": [], "0646": 49, "06460943323451131": 47, "06574350595474243": 53, "06626828152275266": [], "06649070831085983": [], "0669": 49, "06717952463140771": 47, "06943007048226549": 47, "07": 5, "07039659920894972": 47, "07077148016599365": [], "07107110321521759": 53, "0715": 49, "0721": 49, "07256199621500249": [], "07261089197138387": [], "07412560502697436": 47, "07412605687130007": [], "07459828545612861": 47, "07556963965823972": 47, "07805353056063356": [], "08": 5, "08006763568082861": 47, "0803620342234864": 47, "08037212376478459": [], "08112694247793789": [], "08203125": 52, "08328512574270938": [], "08466983469834641": 47, "08490044519149866": [], "0880": 49, "08836910338284339": [], "08994168272332727": 47, "09091612886503771": 47, "0913": 49, "09250457578457372": [], "0931227015974244": 47, "0936": 49, "09418156412375313": 47, "09427809284954947": 47, "09437757264714448": 47, "09503482210962946": [], "09526128568181892": 47, "09752262341322832": 47, "0978": 49, "09975320222976734": 47, "1": [1, 3, 4, 5, 6, 9, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 55], "10": [1, 5, 6, 9, 11, 47, 52, 53], "1001": 44, "10044192979757068": 47, "1008890561620016": 47, "101": 5, "101302": 55, "10145969977630657": [], "10191964627743541": [], "10206207261596575": [47, 48], "1024": [44, 47, 48], "10284": 5, "10292407112396948": 47, "10314717110749269": [], "10320": 55, "10435021521242425": [], "10530435208628271": 47, "1054302327631073": 47, "10624958687614187": [], "1065": 49, "10820075002965705": [], "10841098753969293": 47, "10860389472080796": 47, "10894532636455656": 47, "1091": 5, "10928675123912758": [], "11": [0, 5, 47, 54, 57], "110": 49, "1108": [], "11153310718261006": 47, "11281747881949765": [], "11282": 5, "1130096024425681": [], "11321351693110653": 47, "1139": 5, "11416076807010238": [], "115": 5, "1154754161834717": 47, "1161": 5, "11656930652210629": [], "11707575167415678": [], "11754078669127921": [], "11764068789554398": 47, "11772188584526543": [], "11793838053637484": 47, "11841": 5, "11874174137437876": [], "119": 48, "1190": 49, "11920011620989526": [], "12": [46, 47, 48, 49, 50], "12001407365287857": 47, "12008010045509662": [], "12051025669964421": 47, "1207": [], "12107010920746168": [], "12109375": 52, "1214": 49, "12195695057461206": 47, "1221": 49, "1228": 49, "1249": 49, "125": [46, 47, 48], "12530124338438023": 47, "1259765625": 52, "12632286643959864": 47, "1263863019698369": [], "127": 5, "128": 44, "1281": 49, "13": [5, 47], "1302779765439347": [], "1311": 49, "133": [47, 48], "1333": 55, "1336": 49, "134": [47, 48], "1346": [], "1348": 49, "1353976684111937": [], "136": 5, "1379": 49, "139": [47, 48], "14": [5, 47, 52, 55], "140": [5, 47, 48], "14007978519778894": 47, "1405": 5, "141": [47, 48], "1411": 49, "14122593572844352": [], "14142566897147238": 47, "14150": [], "1419": 5, "142": [47, 48], "14258": 5, "145": [47, 48], "146": [47, 48], "1463": 49, "147": 5, "148": [46, 47, 48, 49, 50], "1483": 5, "1487": 49, "1491": 49, "1492": [], "15": [5, 47], "15064": [], "154": 49, "1554": 49, "1576": 47, "159": [], "16": [0, 5, 44, 47, 50, 55], "1615": 49, "164": 44, "1650390625": 52, "1690": 49, "17": [5, 47], "1722": 49, "1760": 49, "178000820800662e": 5, "1784": 5, "18": [9, 47, 51, 52, 53, 55], "1805": 46, "1810": 49, "18265": 5, "1838": 49, "1854": [], "19": [47, 50], "190": [47, 48], "1900": [], "19140625": 52, "192": [47, 48], "197": [47, 48], "1981": 49, "1e": [5, 44, 47, 48], "1hsuttvvyh1ptew89rtpeu84ht3nqeftyhax3ypa_xj": 46, "2": [1, 2, 5, 6, 9, 43, 44, 46, 47, 48, 49, 50, 51, 55], "20": [5, 47], "2008": 47, "2025": [55, 56], "2043": 49, "2059": 49, "21": [47, 55], "2100": 49, "2109375": 52, "2116881984439036e": 5, "2128": 49, "213": 5, "2149": 49, "2155": 49, "219": [5, 52], "2191": [5, 55], "22": 47, "220": 5, "2201": 49, "2202": 5, "2209": 49, "224": 5, "2240": 49, "225": 53, "226": 44, "226877689361572": 47, "2281": 49, "23": 47, "23046875": 52, "2331": 49, "2345": 49, "238402369897813e": 5, "238402369897814e": 5, "24": [5, 44, 46, 47], "2466": 49, "2497": 49, "25": [47, 55], "2507": 49, "2546": 49, "255": 37, "255859375": 52, "2582": 5, "25901": 5, "26": 47, "263": [], "27": [5, 47], "2715": 49, "275": [44, 49], "277": [47, 48], "278": [47, 48], "279": [47, 48], "28": 47, "28125": 52, "282": [47, 48], "2831": [], "283203125": 52, "2851": 49, "2855": 49, "2862": 49, "2866": [], "287": [47, 48], "2875": 49, "2878": 5, "2883": 49, "2890625": 52, "29": 47, "2909": 49, "292": 47, "2926": 49, "2947": 49, "295": 5, "297": 47, "29871": 47, "29879": 47, "29892": 47, "29896": 47, "29897": 47, "29899": 47, "299": [47, 48], "29900": 47, "29901": 47, "29902": [], "29906": 47, "29914": [], "29915": 47, "29945": [], "29947": 47, "29953": 47, "29955": 47, "3": [2, 3, 4, 5, 6, 9, 46, 47, 48, 49, 50, 51, 52, 53, 55], "30": 47, "30024": [], "3025": 49, "3082": 49, "31": [5, 47], "310": [47, 48], "313": 47, "317": 5, "3173": 5, "318": 5, "32": [44, 47], "32000": [47, 48], "3203125": 52, "322": 44, "323276519775391": [], "33": [5, 47], "33203125": 52, "33510": 55, "3374943733215332": 53, "33984375": 52, "34": [5, 47, 55], "3406": 49, "34375": 52, "3467": 49, "3475": 49, "348220348358154": 47, "3487": 49, "35": [5, 47], "350": 5, "3503": 55, "354": [5, 47, 48], "355": 55, "3558": 49, "356": 5, "36": [5, 47], "360": [47, 48], "36311": 47, "365": 47, "366": [], "36652": [41, 47], "367": [], "37": 47, "3730": 49, "375": [47, 52], "3762": 49, "3770": 49, "38": [47, 48], "380": 5, "3812": 49, "383": 5, "38318": 55, "3833": 49, "384": 5, "3853": 49, "388": 5, "39": [47, 49], "3921": 49, "3924": 49, "393": 44, "3983": 49, "4": [2, 5, 6, 47, 48, 49, 52, 53, 55], "40": [47, 48], "401": 44, "40139588713645935": 53, "4028234663852886e": [47, 48], "40421": 5, "4063": 49, "4064": 49, "4096": [47, 48], "41": 47, "4119": 49, "4137": 5, "4138": 49, "416": 44, "4189": 49, "4195": 49, "42": 47, "4204": 49, "422232151031494": 47, "4251": 49, "4259": [47, 49], "4268": 49, "43": 47, "432": [47, 48], "434": 5, "4342": 49, "4370": 49, "439": 5, "44": [5, 47], "4400": 49, "4408": 49, "4445": 49, "4455": 49, "4472": 49, "448": 47, "4481": 49, "44921875": 52, "45": 47, "4505": 49, "451": [], "4533": 49, "4543": 49, "455": 5, "45591384172439575": 53, "458": 5, "46": 47, "4621": 49, "4654": 47, "4658": [], "4672": 49, "47": 47, "471": 44, "47265625": 52, "474": 44, "47444263100624084": 53, "475555419921875": 47, "4762776692708333": 6, "4773": 49, "4784": 49, "48": [47, 48], "4801": 49, "4846": 49, "4855": 49, "4906": 49, "490959167480469": 47, "4935": 49, "49568021297454834": 47, "4d": 41, "5": [1, 3, 4, 5, 6, 9, 46, 47, 49, 50, 51, 52, 55], "50": [2, 5, 47, 48, 49], "5074902772903442": 53, "509540557861328": 47, "51": [5, 55], "510405540466309": [], "5109": 49, "51171875": 52, "5126": 49, "5127813430059524": 6, "515625": 52, "5164299011230469": 53, "5164299607276917": 53, "5169": 49, "5183": 49, "51953125": 52, "52": 5, "5224": 49, "5227": 49, "525": 44, "5255": 49, "526": [], "52734375": 52, "5304": 49, "531": 5, "5310": 49, "53125": 52, "5313": 49, "5369": 49, "5387": 49, "54296875": 52, "5431": 49, "5452": 49, "546875": 52, "549": 5, "5492": 49, "550": 47, "5557": 49, "5564": 49, "5612": 49, "56224250793457": [], "5625": 52, "564": [47, 48], "565": [47, 48], "5650": 49, "5664": 5, "569": [47, 48], "570": 50, "5703125": 52, "571": [47, 48], "574560546875": 6, "5769": 49, "5804": 49, "5835816860198975": 53, "5835817456245422": 53, "5839": 49, "5859375": 52, "5884": 49, "58984375": 52, "59": 5, "5945": 49, "5968579053878784": 53, "5984": 49, "599": [], "5990229845046997": 53, "6": [3, 4, 5, 6, 9, 47, 49, 55], "6020": 49, "6031697988510132": 53, "6040": 49, "606009603478015e": 5, "6071": 49, "6105": 49, "6112": 49, "6177": 49, "6199": 5, "6222": 49, "625": 52, "6253": 5, "626": 44, "62890625": 52, "6328125": 52, "6367": 49, "64": 5, "640625": 52, "642": 44, "646381139755249": 53, "6463811993598938": 53, "647": 5, "6470": 49, "6503": 49, "6517": 49, "6526": 49, "65625": 52, "6580": 49, "663": 44, "6632": 49, "6640625": 52, "667": [5, 44], "671875": 52, "6749": 49, "677": 44, "6787744760513306": 47, "6793": 49, "6796875": 52, "6797": 49, "683": 46, "684": 5, "6850621700286865": 53, "6853": 49, "6891": 49, "6894": 49, "6897": 49, "6953125": 52, "6973": 49, "6989": 49, "7": [0, 2, 3, 4, 5, 6, 47, 49, 55], "703125": 52, "7058": 49, "706": 44, "7107": 49, "7153": 49, "716": 44, "7172": 49, "72": [5, 55], "7201": 49, "7343": 49, "734375": 52, "7348": [], "7368": 49, "7388": 49, "7402591109275818": 53, "7421875": 52, "7457": 49, "7473": 49, "7478": 49, "751": 5, "7537": 49, "7591": 49, "7624": 49, "7635": 49, "764": [], "7654": 49, "7668": 49, "768": 44, "769": [47, 54, 57], "7704185843467712": 47, "7742": 49, "7756": 49, "7796": 49, "78": [46, 47, 48, 49, 50], "7816": 49, "7826": 49, "7890625": 52, "79": [47, 48], "7911": 49, "7935": 49, "7969": 49, "8": [0, 3, 4, 5, 47, 49, 52, 54, 55, 57], "80": [47, 48, 49], "804": 44, "80775785446167": [], "8082": 49, "81": [47, 48], "815705299377441": 47, "8189": 49, "8191": 49, "8192": [47, 48], "82": 5, "8222": 49, "83203125": 52, "835": 51, "8355": 49, "83984375": 52, "8460367321968079": 53, "8463": 49, "853": 5, "8546": 49, "8590": 49, "859375": 52, "861": 44, "8677": 49, "870": [47, 48], "87109375": 52, "874": 5, "8761": 49, "87913703918457": [], "88": 5, "8804599046707153": 53, "881": [], "8828": 49, "8829": 49, "8847": 49, "8848": 49, "8865": 49, "8948": 49, "8961": 49, "9": [0, 5, 9, 44, 47, 51, 52, 53], "90": [5, 44], "901": 44, "9025": 49, "9113": 49, "9135": 49, "919": 46, "9223372036854775807": [47, 48, 50], "9250385165214539": 53, "926": 44, "9278": 49, "9314": 49, "9321": 49, "9325": 49, "934": 55, "9350": 49, "937": 44, "9370": 49, "94140625": 52, "9476": 49, "948": 44, "9491": 49, "95": 47, "95703125": 52, "96": [47, 48], "9626": 49, "968": 44, "9724": 49, "9757": 49, "97705078125": 6, "98": 5, "9801": 49, "98046875": 52, "9855": 49, "986328125": 6, "987": 44, "988457679748535": 47, "989": 5, "9897": 49, "9924": 49, "9935": 49, "9970703125": 6, "9976": 49, "999": [51, 52, 53], "A": [41, 47, 56], "AND": 56, "AS": 56, "And": [47, 48, 49], "As": [46, 47, 49], "BE": 56, "BUT": 56, "FOR": 56, "For": [46, 48, 50, 51, 53], "IN": 56, "If": [3, 4, 45, 47, 48, 49, 50, 54, 55, 57], "In": [5, 41], "It": [6, 9, 11, 38, 47, 48, 51, 52, 53, 55], "NO": 56, "NOT": 56, "No": [41, 47, 48], "Not": [48, 50], "OF": 56, "OR": 56, "One": 49, "THE": 56, "TO": 56, "That": [6, 47, 50], "The": [5, 8, 9, 11, 38, 41, 46, 47, 48, 49, 50, 51, 52, 53, 55, 56], "Then": [47, 50, 51], "There": 49, "These": 49, "To": [47, 48], "WITH": 56, "With": [6, 50, 55], "__file__": 5, "__init__": [5, 46, 47, 48, 49, 50], "__main__": [46, 50], "__torch_function__": 46, "_allow_tf32": [46, 47, 48, 49, 50], "_assert_scalar": 50, "_assert_scalar_default": 50, "_broadcast_shap": 40, "_c": [46, 47, 48, 49, 50], "_dimhint": [3, 4, 47, 48, 49], "_dimhinttyp": [3, 4, 47, 48, 49], "_doc": [46, 49, 50], "_dynamo": [38, 48, 50], "_export": 46, "_f": 47, "_forward_": 47, "_index": 6, "_make_causal_mask": [38, 41], "_nestedsequ": [6, 9], "_ref": 40, "_seen_token": 38, "_set_onednn_allow_tf32": [46, 47, 48, 49, 50], "_shape": 40, "_subclass": [38, 40], "_supportsarrai": [6, 9], "_update_causal_mask": [47, 48], "a0": [6, 47], "a10": 47, "a11": 47, "a1108": [], "a12": 47, "a1207": [], "a13": 47, "a1346": [], "a14": 47, "a14150": [], "a1492": [], "a15": 47, "a15064": [], "a1576": 47, "a16": 47, "a16r2": 52, "a17": 47, "a18": 47, "a1854": [], "a19": 47, "a1900": [], "a20": 47, "a21": 47, "a22": 47, "a23": 47, "a24": 47, "a25": 47, "a26": 47, "a263": [], "a27": 47, "a278": [], "a28": 47, "a2831": [], "a2866": [], "a29": 47, "a292": 47, "a297": 47, "a29871": 47, "a29879": 47, "a29892": 47, "a29896": 47, "a29897": 47, "a29899": 47, "a29900": 47, "a29902": [], "a29906": 47, "a29914": [], "a29915": 47, "a29945": [], "a29947": 47, "a29953": 47, "a29955": 47, "a3": 47, "a30": 47, "a30024": [], "a31": 47, "a313": 47, "a32": 47, "a33": 47, "a34": 47, "a35": 47, "a36": 47, "a365": 47, "a366": [], "a367": [], "a37": 47, "a38": 47, "a39": 47, "a393": [], "a40": 47, "a41": 47, "a42": 47, "a4259": 47, "a43": 47, "a44": 47, "a448": 47, "a45": 47, "a451": [], "a46": 47, "a4654": 47, "a4658": [], "a47": 47, "a48": 47, "a526": [], "a550": 47, "a599": [], "a6305": 47, "a7348": [], "a8": 47, "a881": [], "a9": 47, "ab": 6, "abl": [3, 4, 50], "about": [5, 6, 48], "abov": [41, 56], "absolut": [5, 6], "acceler": [46, 47, 48, 49, 50], "accept": 6, "accessor": 37, "act_fn": [47, 48], "action": 56, "activ": [47, 48], "ad": 9, "add": [0, 5, 9, 11, 46, 47, 48, 49, 50, 51, 52, 53], "add_1": [49, 50], "add_10": [47, 48], "add_2": [47, 48, 49, 50], "add_3": [47, 48, 49], "add_4": [47, 48], "add_5": [47, 48], "add_7": [47, 48], "add_8": [47, 48], "add_9": [47, 48], "addadd": [11, 13], "addit": [1, 11, 41, 49], "addmul": [11, 13], "addsharedinput": [11, 13], "after": [5, 47, 48], "again": 48, "aggreg": 5, "ai": 51, "algorithm": 51, "all": [1, 5, 6, 9, 11, 38, 45, 48, 50, 56, 57], "allerg": [], "allow": [6, 11], "allow_unique_tensor_with_list_of_one_el": 6, "also": [41, 46, 50], "alwai": [47, 50, 52, 53], "an": [2, 5, 6, 9, 11, 43, 44, 47, 48, 50, 52, 53, 56], "ani": [3, 4, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 44, 47, 48, 49, 56], "anoth": [3, 4], "api": [5, 9, 11, 55], "appear": [38, 48], "appli": 41, "apply_rotary_pos_emb": [47, 48], "approxim": 5, "ar": [3, 4, 5, 6, 9, 41, 47, 48, 49, 50, 55], "arang": [47, 48], "arange_1": [47, 48], "architectur": [47, 48], "arg": [3, 4, 5, 6, 7, 11, 46, 47, 48, 50], "arg0_1": 46, "arg1_1": 46, "arg2_1": 46, "arg3_1": 46, "arg4_1": 46, "argument": [1, 3, 4, 5, 41, 49], "aris": 56, "arnir0": [47, 48], "around": 48, "arr": 6, "arrai": [5, 6, 11, 51, 53], "ask": 51, "assert": [47, 50], "assert_onnx_disc": 5, "assertalmostequ": 5, "assertempti": 5, "assertequ": 5, "assertequalarrai": 5, "assertexist": 5, "assertgreaterorequ": 5, "assertin": 5, "assertionerror": [38, 46, 50], "assertnotempti": 5, "assertrais": 5, "assertsetcontain": 5, "assertstartswith": 5, "asserttru": 5, "assist": 41, "associ": [47, 48, 56], "assum": [6, 8, 51, 53], "astyp": [9, 53], "aten": [46, 47, 48, 49, 50], "atol": 5, "att": 6, "attempt": 50, "attent": [11, 41, 44, 47], "attention_interfac": [47, 48], "attention_mask": [41, 47, 48], "attention_sc": [47, 48], "attentionblock": 44, "attentionmaskconvert": [38, 41], "attn_output": [47, 48], "attn_weight": [47, 48], "attribut": [6, 38, 51, 52, 53], "author": 56, "auto": [45, 46, 48, 54, 55, 57], "auto_exampl": 54, "auto_examples_jupyt": 45, "auto_examples_python": 45, "autom": 9, "automodelforcausallm": [47, 48], "autotoken": [47, 48], "avail": [1, 5, 38, 46, 47, 48, 49, 50], "averag": 5, "averagepoolgrad": [11, 14], "avoi": 5, "avoid": [6, 38, 46, 47, 48], "ax": 5, "axi": 50, "azur": 5, "b": [5, 40, 51, 52, 53], "b8": [46, 47, 48], "b_model_rotary_emb_inv_freq": [47, 48], "backend": [11, 46, 47, 48, 49, 50], "ban_prefix": 6, "base": [3, 4, 47, 48, 49, 52], "batch": [43, 47, 48, 50], "batch_siz": 43, "batch_split": 41, "beam": 41, "beam_idx": 41, "becaus": [47, 48, 50], "becom": 9, "befor": [5, 6, 47, 49], "begin": 6, "behavior": 47, "believ": [], "best": [], "better": [5, 6, 48], "between": 6, "beyond": 5, "bfloat16": [6, 47, 48, 52, 55], "bia": [44, 46, 47, 48], "biassoftmax": 11, "big": 8, "bool": [5, 6, 9, 11, 38, 43, 44, 47], "both": [3, 4, 49], "bound": 11, "break": 46, "brought": 47, "bsize": [2, 49], "buffer": [6, 9, 47, 48], "build": [6, 51], "bypass": 38, "bypass_export_some_error": [38, 48, 49], "byte": [6, 9], "c": [46, 51, 52, 53, 56], "cach": [38, 41, 43, 47, 48, 49], "cache2": 49, "cache_help": [5, 7, 49], "cache_key_cache_0": 49, "cache_key_cache_1": 49, "cache_kwarg": [41, 47, 48], "cache_length": [47, 48], "cache_posit": [41, 47, 48], "cache_util": [2, 48, 49], "cache_value_cache_0": 49, "cache_value_cache_1": 49, "call": [1, 5, 6, 9, 38, 46], "call_funct": [46, 50], "callabl": [3, 4, 5, 6, 9, 38, 40], "can": [6, 8, 38, 41, 46, 47, 49, 50, 52, 53], "cannot": [38, 46, 47, 48, 50, 51], "capi": [51, 52, 53], "captur": 5, "case": 49, "cast": [51, 52, 53], "castlik": [51, 52, 53], "castlike_15": [11, 15], "castlike_19": [11, 15], "cat": [47, 48, 50], "cat_1": [47, 48], "cat_2": [47, 48], "cat_3": [47, 48], "cat_4": [47, 48], "catch": [5, 38], "catch_constraint": 38, "caught": 51, "caus": [46, 48], "causal_mask": [47, 48], "cd": 55, "chang": [46, 47, 55], "char": [5, 55], "charg": 56, "check": [1, 3, 4, 5, 46, 49, 51, 52, 53], "check_cuda_avail": 1, "check_model": 9, "check_model_ort": 44, "checker": 9, "choic": [], "cl": [9, 51], "claim": 56, "class": [3, 4, 5, 6, 7, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 41, 46, 47, 48, 49, 50, 51, 52, 53], "classmethod": [5, 41], "clone": [47, 48, 55], "cloned_input": [47, 48], "cls_name": 44, "co": [5, 47, 48], "code": [45, 46, 47, 48, 49, 50, 51, 52, 53], "coeffici": 50, "com": [46, 47, 55], "come": 51, "comma": 1, "common": 6, "comparison": 6, "compil": 47, "complex": [6, 9, 44], "complexmodul": [11, 16], "comprison": 5, "comput": [5, 41, 49], "concat": [11, 17], "cond": 46, "condit": 56, "config": 47, "configur": 43, "connect": 56, "consequ": 47, "consid": [1, 6], "constant": [6, 48], "constantofshap": [11, 18], "constraint": [6, 38, 45, 46, 47, 48, 49, 54, 55, 57], "consum": 8, "contain": [1, 5, 41, 46, 51], "context": [5, 46, 47, 48, 49, 50], "context_s": 5, "contigu": [47, 48], "contiguous_1": [47, 48], "contiguous_2": [47, 48], "contiguous_3": [47, 48], "continu": [47, 48], "contract": 56, "contrast": 41, "contrib": 11, "control": [45, 49, 50, 54, 55, 57], "convert": [6, 44, 48, 51, 52, 53], "convert_endian": 6, "cope": 49, "copi": [47, 48, 56], "copy_": [47, 48], "copy_input": 5, "copyright": 56, "correspond": [3, 4, 5, 6], "could": [3, 4, 11, 46, 50, 51, 52], "coupl": [3, 4], "cpp": [46, 47, 48, 49, 50], "cpu": [9, 11, 44, 47, 48, 51, 52], "cpu_sess": 9, "cpuexecutionprovid": [9, 51, 52, 53], "crash": [9, 51, 53], "creat": [2, 8, 44, 46, 47, 48], "crop": 41, "cu126": 55, "cuda": [1, 5, 9, 11, 44, 52], "current": [46, 47, 48, 49, 50], "custom": [11, 49, 51], "d": [3, 4, 46, 49, 52], "damag": 56, "data": [6, 43, 46, 47], "data_typ": 6, "deal": 56, "debug": [3, 4, 6, 11, 46, 52, 53], "debug_info": 6, "decod": [41, 44, 47], "decoderlay": 44, "deconstruct": 5, "deep": 6, "deepcopi": [47, 48], "def": [3, 4, 6, 46, 47, 48, 49, 50], "default": [1, 3, 4, 5, 6, 11, 46, 47, 48, 50], "default_op": 11, "defin": [3, 4, 6, 46, 49, 52, 53], "definit": 11, "demonstr": 52, "depend": [46, 48], "descript": 1, "despit": 47, "determin": 49, "dev0": 55, "dev20250301": 55, "dev20250324": 55, "deviat": 5, "devic": [6, 9, 47, 48], "device_count": 5, "devop": 5, "diagnost": [46, 49, 50], "dict": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 47, 48, 49, 52, 53], "dictionari": [5, 6, 8, 9, 11, 43], "diff": 6, "differ": [6, 41, 49, 50], "dig": 7, "dim": [2, 47, 48, 49, 50], "dimens": [3, 4, 6, 38, 47, 49, 50], "dir": [5, 55], "dirnam": 5, "disabl": [5, 38], "disable_aot_function_inlin": [9, 11], "discov": 52, "discrep": [5, 6, 52], "displai": [5, 6], "distribut": 56, "div_by_numb": 5, "divid": 5, "dnan": 6, "do": [5, 11, 49, 51, 53, 56], "do_sampl": 47, "doc": [46, 48], "document": [41, 46, 55, 56], "doe": [3, 4, 38, 46, 47, 48, 49, 50, 51, 52, 53], "domain": [51, 52], "done": 9, "down_proj": [47, 48], "download": [45, 46, 47, 48, 49, 50, 51, 52, 53], "drop": 6, "drop_kei": 6, "dt": 6, "dtype": [6, 9, 47, 48, 51, 52, 53, 55], "dtype_layout": [47, 48], "dtype_to_tensor_dtyp": 6, "due": [38, 51, 52], "dummi": [9, 44, 47], "dummy_llm": 44, "dump": [5, 9, 44], "dump_fil": 44, "dump_filenam": 9, "dump_onnx": 5, "durat": 5, "dure": [38, 52], "dyn": 6, "dynam": [0, 3, 4, 6, 38, 43, 44, 45, 46, 48, 51, 54, 55, 57], "dynami": 49, "dynamic_rop": 43, "dynamic_shap": [4, 5, 44, 47, 48, 49, 50], "dynamiccach": [2, 38, 41, 45, 46, 47, 48, 50, 54, 55, 57], "dz": 50, "e": [41, 46, 47, 50, 51, 52, 53, 55], "easi": 50, "edit": 46, "either": 51, "element": 6, "elementwise_affin": 44, "els": 49, "emb": [47, 48], "embed": [6, 44, 47, 48], "embed_token": [47, 48], "empti": [1, 5, 44], "enabl": [5, 9, 11], "enable_profil": [9, 11], "encod": 47, "end": [1, 6, 46, 47, 48, 49, 50, 51, 52, 53], "endian": 6, "enough": [5, 9], "ensur": 47, "environ": [5, 38], "eo": 47, "eos_token_id": 47, "ep": [38, 44, 46, 47, 48, 49, 50], "epilog": 1, "eq": [46, 47, 48, 50], "eq_2": 50, "eq_7": [47, 48], "equal": [5, 6, 9], "error": [5, 6, 38, 44, 46, 47, 51, 52, 53], "evalu": [5, 11], "even": [9, 47], "event": [9, 11, 56], "everi": [9, 49, 51, 52, 53], "everyth": 50, "exampl": [1, 2, 3, 4, 9, 38, 43, 46, 47, 48, 50, 51, 52, 53, 54, 57], "exc": [48, 50], "exc_typ": 5, "except": [5, 9, 38, 46, 47, 50, 51, 52, 53], "execut": [3, 4, 5, 11, 47, 48, 52, 54, 57], "exhaust": 6, "exist": [5, 41, 51, 52, 53], "expand": [47, 48], "expand_1": [47, 48], "expand_2": [47, 48], "expand_3": [47, 48], "expect": [5, 6, 41, 46, 48, 49, 50], "expected_output": 47, "experi": [5, 47, 48], "explicit": 5, "export": [5, 6, 7, 38, 44, 45, 47, 52, 53, 54, 55, 57], "exportdb": 48, "exportedprogram": [48, 49, 50], "exportgraphsignatur": 50, "expos": 1, "express": [6, 46, 50, 56], "ext": [5, 55], "ext_test_cas": [7, 49, 52], "extend": [46, 52, 53], "extendedreferenceevalu": 0, "extract": 51, "exttestcas": 5, "f": [5, 6, 46, 47, 48, 50], "f32": [46, 47, 48, 49, 50], "fail": [5, 9, 45, 46, 47, 48, 50, 54, 55, 57], "failur": 48, "fake_impl": [38, 40], "fals": [5, 6, 9, 11, 38, 43, 44, 47, 48, 49], "false_graph_0": 46, "far": 50, "fct": 5, "feed": [9, 52, 53], "feed_forward": 44, "feed_input": 11, "feedforward": 44, "few": 50, "figur": 5, "file": [5, 8, 44, 46, 47, 48, 49, 50, 54, 56, 57], "filenam": [5, 8, 11], "final": [9, 47, 49], "find": [45, 47, 52, 53, 54, 55, 57], "fine": 50, "first": [0, 5, 6, 47, 49, 51, 53], "fit": 56, "fix": [8, 38, 48], "fixtur": 5, "flag": 5, "flat_args_with_path": 40, "flatten": 6, "flatten_object": 6, "float": [1, 5, 6, 8, 9, 47, 48, 51, 53], "float16": [6, 55], "float32": [9, 47, 48, 51, 52, 53], "float64": 5, "floattensor": 41, "floordiv": 50, "flow": [45, 49, 50, 54, 55, 57], "focu": [47, 48], "folder": 5, "follow": [11, 38, 46, 47, 48, 49, 55, 56], "form": 49, "format": 8, "former": 9, "forward": [3, 4, 41, 43, 45, 46, 48, 49, 50, 51, 54, 55, 57], "forwardwithcontrolflowtest": 46, "found": [5, 9, 47, 48, 51], "four": 6, "free": 56, "freq": [47, 48], "from": [2, 3, 4, 5, 6, 9, 11, 44, 46, 47, 48, 49, 51, 52, 53, 54, 55, 56, 57], "from_array_extend": [6, 51, 52, 53], "from_array_ml_dtyp": 6, "from_batch_split": 41, "from_pretrain": [47, 48], "full": [5, 9, 46, 47, 48, 49, 50, 51, 52, 53], "full_nam": [3, 4], "func": 47, "function": [0, 5, 6, 7, 8, 9, 38, 41, 46, 47, 48, 49], "functionproto": [6, 11], "fur": 44, "furnish": 56, "fusedmatmul": [11, 19], "fx": [38, 46], "g": 41, "galleri": [46, 47, 48, 49, 50, 51, 52, 53, 55, 57], "gate_proj": [47, 48], "gather": 11, "gatherel": 11, "gathergrad": [11, 20], "gb": 5, "gener": [41, 43, 45, 46, 47, 48, 49, 50, 51, 52, 53], "generated_text": 47, "generationmixin": 47, "get": [5, 43, 47, 48, 52, 53], "get_attr": 46, "get_dump_fil": 5, "get_figur": 5, "get_onnx_signatur": 6, "get_parsed_arg": 1, "get_tiny_llm": [43, 47, 48], "getitem": 46, "gggg": 9, "git": 55, "github": [46, 47, 48, 49, 50, 55], "given": [3, 4, 6, 41], "go": [46, 47, 48, 49, 50, 51, 52, 53], "goe": 5, "googl": 46, "got": 6, "gpu": [46, 47, 48, 49, 50], "grad_fn": 46, "grant": 56, "graph": [38, 46, 47, 48, 49, 50], "graph_optimization_level": [9, 11], "graphmodul": [47, 48, 49, 50], "graphoptimizationlevel": [9, 11], "graphproto": [6, 11], "grow": 49, "gt": [46, 47, 48], "guard": [46, 50], "guess": [0, 3, 4, 43, 45, 46, 48, 49, 51, 54, 55, 57], "guess_dynamic_dimens": [3, 4], "guess_dynamic_shap": [3, 4, 49], "guess_dynamic_shape_object": [3, 4], "ha": [38, 45, 46, 48, 51, 54, 55, 57], "happen": [38, 44], "happi": 49, "has_cuda": [5, 52], "has_onnxruntime_train": [5, 55], "has_onnxscript": 5, "has_torch": 5, "has_transform": [5, 49], "hash": 6, "have": [41, 46, 47, 48, 49, 50, 51], "help": [46, 55], "helper": [2, 3, 4, 5, 7, 9, 44, 47, 48, 49, 51, 52, 53, 55], "here": [50, 51, 52, 53], "herebi": 56, "hidden_shap": [47, 48], "hidden_st": [47, 48], "hide": 5, "hide_stdout": 5, "higher": 5, "higher_ord": [46, 47, 48], "highlight": 6, "holder": 56, "home": [46, 47, 48, 49, 50], "hook": 5, "how": [48, 49, 52], "howev": 48, "html": 48, "http": [46, 47, 48, 55], "huggingfac": 47, "i": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 41, 44, 45, 46, 47, 48, 49, 50, 52, 53, 54, 55, 56, 57], "i64": [47, 48], "id": [6, 47], "identity2": 46, "ignor": [5, 6], "ignore_warn": 5, "implement": [9, 11, 38, 41, 48, 49, 52, 55], "impli": 56, "import": [2, 3, 4, 5, 6, 9, 11, 44, 46, 47, 48, 49, 50, 51, 52, 53, 55], "improv": [0, 52, 53], "in_featur": 44, "includ": [6, 41, 51, 56], "increas": 50, "independ": 52, "index": [41, 48], "indic": 41, "infer": [3, 4, 6, 9, 38, 47, 48, 49, 52], "infer_s": [38, 40], "infer_shap": [9, 51], "inferenceerror": 51, "inferencesess": [9, 44, 51, 52, 53], "inferencesessionfornumpi": [9, 51, 52], "inferencesessionfortorch": [5, 9, 52], "inform": [3, 4, 6, 46, 48, 50, 52, 53], "inherit": 5, "initi": [8, 43], "inplac": [3, 4, 5, 8, 47, 48], "input": [3, 4, 5, 6, 9, 11, 38, 41, 46, 47, 48, 49, 51, 52, 55], "input_cach": 43, "input_dtyp": [47, 48], "input_id": [41, 47, 48], "input_layernorm": [47, 48], "input_nam": 11, "input_placehold": 40, "input_shap": [47, 48], "input_spec": 50, "input_typ": 11, "inputkind": 50, "inputs_emb": [41, 47, 48], "inputspec": 50, "insert": [52, 53], "instal": [5, 55], "instanc": [2, 48], "instead": 11, "int": [1, 3, 4, 5, 6, 8, 9, 11, 38, 40, 41, 43, 47, 48, 50, 51], "int64": [6, 47, 48, 55], "int_oo": [49, 50], "integ": 50, "integerconst": 38, "intel": [46, 47, 48, 49, 50], "interest": 47, "intermedi": [11, 45, 51, 54, 55, 57], "intern": [46, 47, 48, 49, 50], "interpret": [52, 53], "introduc": 46, "inv_freq": [47, 48], "inv_freq_expand": [47, 48], "investig": [5, 7], "investigate_onnxruntime_issu": [0, 9, 51], "invgestig": 9, "involv": 11, "ipynb": [46, 47, 48, 49, 50, 51, 52, 53], "ir": 11, "ir_vers": [9, 11, 51, 52, 53], "is_azur": 5, "is_export": 47, "is_torchdynamo_export": 44, "isinst": [38, 46], "issu": [38, 48, 52, 53, 55], "item": 46, "iter": [5, 43], "its": 47, "ityp": [6, 55], "jit": 38, "job": 5, "json": [8, 47], "jupyt": [45, 46, 47, 48, 49, 50, 51, 52, 53], "just": [5, 6, 9], "k_proj": [47, 48], "keep": [1, 6], "keep_model_forward": 47, "keepdim": [47, 48], "kei": [2, 6, 41, 44], "kernel": [48, 52], "key_cach": [2, 47, 48, 49], "key_stat": [41, 47, 48], "key_value_pair": 2, "keyerror": 53, "kind": [50, 56], "know": 5, "known": 51, "kw": [3, 4], "kwarg": [1, 3, 4, 5, 6, 11, 41, 43, 46, 47, 48, 50], "l": [48, 50], "lambda": [5, 9, 47], "lans": 47, "last": [6, 9, 11], "last_issu": 9, "layer": [41, 47, 48], "layer_idx": [41, 47, 48], "layernorm": 44, "layout": [47, 48], "learn": [5, 6], "least": 47, "leav": 48, "less": [52, 53], "let": [46, 47, 48, 51, 52, 53], "letter": 6, "level": [3, 4, 6, 9], "liabil": 56, "liabl": 56, "lib": [46, 47, 48, 49, 50], "licens": 55, "like": [3, 4, 5, 6, 41, 46, 49, 51], "limit": [6, 56], "line": [5, 46, 55], "linear": [44, 46, 47, 48, 50], "linear_1": [44, 46, 47, 48], "linear_2": [44, 47, 48], "linear_3": [47, 48], "linear_4": [47, 48], "linear_5": [47, 48], "linear_6": [47, 48], "linear_7": [47, 48], "linux": 5, "list": [1, 2, 3, 4, 5, 6, 8, 9, 11, 38, 40, 41, 44, 46], "llama": [47, 48], "llamaconfig": 43, "llm": [5, 41, 42, 44, 45, 46, 49, 50, 51, 52, 53, 54, 55, 57], "lm_head": [47, 48], "load": [8, 9, 11, 44], "local": 11, "local_funct": 11, "locat": [51, 53], "log": [46, 55], "log_severity_level": [9, 11], "log_verbosity_level": [9, 11], "logit": [47, 48], "long": 5, "long_test": 5, "longer": 47, "longtensor": 41, "look": [8, 46, 47, 49], "mai": [5, 6, 38, 47, 48, 52], "main": [3, 4, 5, 48, 51], "make": [3, 4, 6, 47, 49, 50], "make_dynamic_cach": [2, 49], "make_graph": [9, 51, 52, 53], "make_hash": 6, "make_model": [9, 51, 52, 53], "make_nod": [9, 51, 52, 53], "make_opsetid": [9, 51, 52, 53], "make_tensor_value_info": [9, 51, 52, 53], "mambacach": 38, "mani": [6, 47, 48], "map": 48, "mark_static_address": 38, "mask": [41, 47], "masked_fil": [47, 48], "maskedscatterndofshap": [11, 30], "math": 5, "matmul": [47, 48], "matplotlib": 5, "max": 6, "max_diff": [6, 55], "max_exec": 5, "max_length": [41, 47], "max_tim": 5, "maximum": 6, "mb": [54, 57], "mean": [47, 48, 51], "mean_1": [47, 48], "mean_2": [47, 48], "meant": 11, "measur": 5, "measure_tim": 5, "mechan": [48, 49], "mem": [54, 57], "memcpyfromhost": [11, 21], "memcpytohost": [11, 21], "memori": 5, "merchant": 56, "merg": 56, "messag": [5, 38, 52, 53], "meth": 47, "method": [3, 4, 5, 9, 38, 41, 43, 45, 46, 48, 49, 51, 54, 55, 57], "method_nam": [3, 4], "methodnam": 5, "mi": [3, 4, 49], "might": 41, "min": 6, "min_exec": 5, "minimum": [5, 6], "minut": [46, 47, 48, 49, 50, 51, 52, 53], "miss": 38, "mkldnn": [46, 47, 48, 49, 50], "ml_dtype": [6, 55], "mlp": [46, 47, 48], "mod": 46, "model": [3, 4, 5, 6, 7, 8, 9, 11, 38, 41, 43, 44, 45, 49, 50, 54, 57], "model_nam": [47, 48], "modeling_attn_mask_util": 41, "modeling_llama": [47, 48], "modelinput": [0, 3, 49], "modelproto": [5, 6, 8, 9, 11, 44, 51], "modelwithcontrolflow": 46, "modif": [38, 41, 48, 49], "modifi": [3, 4, 5, 8, 47, 49, 56], "modul": [3, 5, 38, 44, 46, 47, 48, 49, 50], "module_name_typ": [3, 4], "modulelist": 44, "moel": 50, "more": [5, 44, 46, 48, 50, 52, 53], "most": [9, 41, 47, 49], "mostli": [3, 4, 11], "move": [3, 4, 49], "move_to_kwarg": [3, 4, 49], "msg": [3, 4, 5], "much": [52, 53], "mul": [47, 48, 51, 52, 53], "mul_": [47, 48], "mul_1": [47, 48], "mul_10": [47, 48], "mul_11": [47, 48], "mul_12": [47, 48], "mul_2": [47, 48], "mul_3": [47, 48], "mul_4": [47, 48], "mul_5": [47, 48], "mul_6": [47, 48], "mul_7": [47, 48], "mul_8": [47, 48], "mul_9": [47, 48], "muladd": [11, 13], "mulbackward0": 46, "mulmul": [11, 13], "mulsharedinput": [11, 13], "mulsigmoid": [11, 22], "mulsub": [11, 13], "multiattentionblock": 44, "multipl": [3, 4], "must": [3, 4, 5, 49], "mutat": 38, "n": [6, 51], "n0": [51, 52, 53], "n1": [51, 52, 53], "n2": [51, 52, 53], "n4": [51, 52, 53], "n_layer": [2, 49], "n_tree": 1, "name": [1, 3, 4, 5, 6, 8, 11, 38, 46, 49, 50, 51, 52, 53], "named_modul": 46, "namespac": 1, "nan": 6, "nd": [3, 4, 51, 52, 53], "ndarrai": [5, 9], "ne": 46, "necessari": 38, "need": [38, 47, 49, 52, 53], "neg": [41, 46, 47, 48], "neg_1": [47, 48], "negxplus1": [11, 23], "never_test": 5, "new": [6, 8, 41], "new_arg": [1, 49], "new_d": 49, "new_forward": 46, "new_kwarg": 49, "new_op": 11, "nhead": [2, 49], "nicer": 5, "nn": [3, 4, 5, 46, 47, 48, 49, 50], "node": [6, 8, 9, 11, 40, 47, 48, 50, 52, 53], "nodeproto": [8, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35], "non": [43, 48, 51, 52, 53], "non_strict_util": 46, "none": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 40, 41, 44, 46, 47, 48, 49, 50, 52, 53], "none_if": 5, "noninfring": 56, "norm": [47, 48], "norm_1": 44, "norm_2": 44, "not_impl": 52, "notebook": [45, 46, 47, 48, 49, 50, 51, 52, 53], "notensor": 52, "noth": [52, 53], "notic": 56, "notimpl": 52, "notimplementederror": 50, "now": [9, 46, 49, 50], "np": [5, 9, 51, 53], "np_dtype_to_tensor_dtyp": 6, "num_hidden_lay": 43, "num_us": [46, 50], "number": [1, 5, 6], "numer": [52, 53], "numi": 44, "numpi": [5, 6, 9, 11, 51, 53, 55], "nvidia": [1, 9, 11], "nvtx": [9, 11], "o": 5, "o_proj": [47, 48], "obj": [3, 4, 6], "object": [6, 49], "observ": 47, "obtain": [47, 50, 56], "obviou": [52, 53], "offici": 11, "oh": [9, 51, 52, 53], "one": [3, 4, 5, 6, 7, 9, 11, 38, 48, 49, 50, 51, 52, 53], "onednn": [46, 47, 48, 49, 50], "ones": [9, 11, 38], "onli": [1, 3, 4, 6, 11, 38, 47, 50, 51, 52], "onnx": [5, 6, 7, 9, 11, 38, 45, 46, 49, 50, 51, 52, 54, 57], "onnx_cpp2py_export": 51, "onnx_diagnost": [47, 48, 49, 51, 52, 53, 55], "onnx_dtype_nam": [6, 55], "onnx_dtype_to_np_dtyp": 6, "onnx_dtype_to_torch_dtyp": 6, "onnx_export_error": [5, 48], "onnx_export_seri": 5, "onnx_find": 8, "onnx_lighten": 8, "onnx_nod": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "onnx_to_sess": 9, "onnx_tool": [5, 7], "onnx_unlighten": 8, "onnxruntim": [1, 5, 9, 11, 44, 45, 51, 53, 54, 55, 57], "onnxruntime_pybind11_st": [51, 52, 53], "onnxruntime_train": 5, "onnxruntimeerror": [51, 52, 53], "onnxruntimeevalu": 0, "onnxscript": [5, 55], "onx": [6, 8, 38, 44], "op": [5, 11, 46, 47, 48, 49, 50, 51, 52, 53], "op_add_add_mul_mul": [5, 11, 12], "op_attent": [5, 11], "op_average_pool_grad": [5, 11, 12], "op_bias_softmax": [5, 11], "op_cast_lik": [5, 11, 12], "op_complex": [5, 11, 12], "op_concat": [5, 11, 12], "op_constant_of_shap": [5, 11, 12], "op_fused_matmul": [5, 11, 12], "op_gath": [5, 11], "op_gather_el": [5, 11], "op_gather_grad": [5, 11, 12], "op_memcpy_host": [5, 11, 12], "op_mul_sigmoid": [5, 11, 12], "op_negxplus1": [5, 11, 12], "op_qlinear_average_pool": [5, 11, 12], "op_qlinear_conv": [5, 11, 12], "op_quick_gelu": [5, 11, 12], "op_replace_zero": [5, 11, 12], "op_rotari": [5, 11, 12], "op_scatter_el": [5, 11, 12], "op_scatternd_of_shap": [5, 11, 12], "op_simplified_layer_norm": [5, 11, 12], "op_skip_layer_norm": [5, 11, 12], "op_slic": [5, 11, 12], "op_transpose_cast": [5, 11, 12], "op_tri_matrix": [5, 11, 12], "op_typ": 51, "open": 47, "oper": [11, 41, 46, 50, 51, 52, 53], "opposit": 41, "oprun": 11, "opset": [11, 52], "opset_import": [9, 51, 52, 53], "optim": 11, "optimized_model_filepath": [9, 11], "option": [6, 9, 11, 41], "or_older_than": 5, "order": [5, 6], "org": 48, "origin": [6, 37], "ort_evalu": [5, 11], "ort_sess": [5, 7, 51], "ortmodul": 5, "other": [5, 49, 56], "otherwis": [1, 49, 51, 56], "out": [46, 56], "out_featur": 44, "output": [5, 6, 9, 11, 38, 47, 48, 49, 51, 52], "output_nam": [9, 11], "output_spec": 50, "output_typ": 11, "outputkind": 50, "outputspec": 50, "outsid": [11, 52, 53], "over": 5, "overload": [9, 11], "overwrit": [5, 43], "p_lm_head_weight": [47, 48], "p_mlp_0_bia": 46, "p_mlp_0_weight": 46, "p_mlp_1_bia": 46, "p_mlp_1_weight": 46, "p_model_embed_tokens_weight": [47, 48], "p_model_layers_0_input_layernorm_weight": [47, 48], "p_model_layers_0_mlp_down_proj_weight": [47, 48], "p_model_layers_0_mlp_gate_proj_weight": [47, 48], "p_model_layers_0_mlp_up_proj_weight": [47, 48], "p_model_layers_0_post_attention_layernorm_weight": [47, 48], "p_model_layers_0_self_attn_k_proj_weight": [47, 48], "p_model_layers_0_self_attn_o_proj_weight": [47, 48], "p_model_layers_0_self_attn_q_proj_weight": [47, 48], "p_model_layers_0_self_attn_v_proj_weight": [47, 48], "p_model_norm_weight": [47, 48], "packag": [1, 46, 47, 48, 49, 50, 55], "pad": 47, "pad_token_id": 47, "page": 47, "pair": 2, "paramet": [1, 2, 3, 4, 5, 6, 8, 9, 11, 37, 38, 41, 43, 44, 47, 48, 49], "pars": 1, "parser": 1, "part": [47, 48], "particular": 56, "pass": [41, 47], "past": 41, "past_key_valu": [2, 41, 47, 48], "past_key_values_key_cache_0": [47, 48], "past_key_values_value_cache_0": [47, 48], "past_seen_token": [47, 48], "patch": [0, 5, 38, 45, 47, 49, 50, 52, 53, 54, 55, 57], "patch__check_input_constraints_for_graph": 40, "patch_sympi": 38, "patch_torch": [5, 38, 39], "patch_transform": [5, 38, 39, 48, 49], "patched__broadcast_shap": 40, "patched_attentionmaskconvert": 41, "patched_dynamiccach": 41, "patched_generationmixin": 41, "patched_infer_s": 40, "path": 5, "pattern": [5, 11], "pe": 44, "permiss": 56, "permit": 56, "persist": [47, 48, 50], "person": 56, "piec": 44, "pin_memori": [47, 48], "pip": 55, "pipelin": 5, "placehold": [46, 50], "plai": 49, "pleas": [47, 50], "plot_export_cond": [46, 54, 57], "plot_export_tiny_llm": [47, 54, 57], "plot_export_tiny_llm_patch": [48, 54, 57], "plot_export_with_dynamic_cach": [49, 54, 57], "plot_export_with_dynamic_shapes_auto": [50, 54, 57], "plot_failing_model_extract": [51, 54, 57], "plot_failing_onnxruntime_evalu": [52, 54, 57], "plot_failing_reference_evalu": [53, 54, 57], "portion": 56, "posit": [3, 4, 49], "position_id": [47, 48], "position_ids_expand": [47, 48], "possibl": [6, 52, 53], "post_attention_layernorm": [47, 48], "pow": [47, 48], "pow_1": [47, 48], "pow_2": [47, 48], "pow_3": [47, 48], "pprint": [3, 4, 5, 11, 47, 48, 49], "pr": [41, 47], "prefix": [5, 6], "prepar": 41, "prepare_inputs_for_gener": 41, "pretty_onnx": 6, "previou": 47, "previous_funct": 40, "print": [2, 3, 4, 5, 6, 44, 46, 47, 48, 49, 50, 51, 52, 53, 55], "print_model": 5, "print_onnx": 5, "problem": [], "process": [3, 4, 51], "process_input": [3, 4], "produc": [6, 8, 51], "program": 38, "project": 5, "prompt": 47, "properti": [3, 4, 11, 37], "prot": 6, "proto": [5, 6, 9, 11], "proto_from_tensor": 6, "provid": [6, 9, 11, 44, 47, 49, 51, 52, 53, 56], "pt": 47, "publish": [1, 56], "pull": 47, "purpos": [3, 4, 44, 56], "purppos": 6, "push_back_batch": 5, "put": 38, "py": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 57], "python": [11, 45, 46, 47, 48, 49, 50, 51, 52, 53], "python3": [46, 47, 48, 49, 50], "pytorch": [1, 5, 6, 46, 47, 48, 49, 50], "q_proj": [47, 48], "qlinearaveragepool": [11, 24], "qlinearconv": [11, 25], "qtensor": 37, "quantiz": 37, "quantized_tensor": [5, 11], "quantizedtensor": 37, "queri": 44, "query_st": [47, 48], "quickgelu": [11, 26], "quiet": [9, 51], "r": 6, "rain": 47, "rais": [9, 46, 50, 51], "rand": [6, 9, 52, 53, 55], "randn": [2, 3, 4, 46, 49, 50], "random": [9, 47, 48, 53], "rang": [2, 37, 47, 48, 49, 50], "range_constraint": 40, "raw": 6, "re": [5, 47], "reach": [52, 53], "readi": 48, "real": 5, "reason": [52, 53], "recent": 5, "reduc": 38, "redund": 6, "ref": [11, 52, 53], "refactor": 0, "refer": [5, 7, 52, 53, 55], "referenceevalu": [11, 45, 51, 52, 54, 55, 57], "regist": 49, "register_additional_serialization_funct": 38, "registr": 38, "rel": [5, 6], "relat": [38, 46, 47, 48, 49, 50, 51, 52, 53], "reli": [49, 52], "reliabl": 47, "relu": 44, "remov": 41, "renam": 6, "rename_dynamic_dimens": 6, "rename_dynamic_express": 6, "render": 6, "reorder": 41, "reorder_cach": 41, "repeat": [1, 5], "replac": [6, 11, 46, 48], "replacezero": [11, 27], "request": [6, 9], "requir": [11, 41, 51], "requires_cuda": 5, "requires_diffus": 5, "requires_numpi": 5, "requires_onnx": 5, "requires_onnx_array_api": 5, "requires_onnxruntim": 5, "requires_onnxruntime_train": 5, "requires_onnxscript": 5, "requires_sklearn": 5, "requires_torch": 5, "requires_transform": 5, "requires_zoo": 5, "reshap": [47, 48], "reshape_1": [47, 48], "reshape_2": [47, 48], "reshape_3": [47, 48], "residu": [47, 48], "restart": 48, "restor": [38, 47], "restrict": 56, "result": [5, 8, 38, 45, 47, 49, 50, 51, 54, 55, 57], "return": [1, 2, 3, 4, 5, 6, 8, 9, 11, 41, 43, 44, 46, 47, 48, 49, 50], "return_al": 11, "return_dict": 47, "return_tensor": 47, "revers": 8, "rewrit": [6, 47], "right": [7, 56], "rope": 43, "rotari": [11, 28], "rotary_emb": [47, 48], "row": 5, "rsqrt": [47, 48], "rsqrt_1": [47, 48], "rsqrt_2": [47, 48], "rst": 5, "rtol": 5, "run": [5, 6, 9, 11, 38, 45, 46, 47, 48, 49, 50, 52, 53, 54, 55, 57], "run_dlpack": 9, "run_param": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "run_training_api": 9, "runtest": 5, "runtim": [50, 52, 53], "runtimeerror": 52, "s0": [47, 48, 49, 50], "s1": [47, 48, 49, 50], "s11": 49, "s15": 6, "s3": 50, "s5": [47, 48, 50], "same": [9, 47, 48, 49, 50], "satisfi": 50, "scalar": [46, 47, 48], "scale": [37, 47, 48], "scaled_dot_product_attent": [47, 48], "scatterel": [11, 29], "scatterndofshap": [11, 30], "scenario": [1, 11], "schema": [13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35], "scikit": 5, "script": [1, 5, 46, 47, 48, 49, 50, 51, 52, 53], "sdpython": 55, "search": [8, 41], "season": 47, "second": [46, 47, 48, 49, 50, 51, 52, 53], "see": [5, 9, 11, 38, 41, 43, 46, 48, 52, 53], "select": 41, "self": [3, 4, 5, 46, 47, 48, 49, 50], "self_attn": [47, 48], "sell": 56, "sent": 5, "separ": 1, "seq_length": [6, 47, 48], "sequenc": 5, "sequenti": 46, "serial": [38, 48, 49], "serializetostr": [9, 51, 52, 53], "sess": 9, "session": [9, 52], "session_opt": [9, 11], "sessionopt": [9, 11], "set": [3, 4, 5, 6, 8, 38, 47, 49, 50], "set1": 5, "set2": 5, "setupclass": 5, "shall": 56, "shape": [0, 3, 4, 6, 9, 37, 38, 43, 44, 45, 46, 48, 52, 54, 55, 57], "shape_infer": [6, 51], "shaped_model": 51, "shapeinferenceerror": 51, "share": 46, "should": [41, 46], "show": [5, 47, 48, 49, 52], "sig": 6, "sigmoid": [51, 52, 53], "signatur": [3, 4, 6, 47, 48, 49, 50], "silu": [47, 48], "simpl": [6, 9], "simplifiedlayernorm": [11, 31], "sin": [47, 48], "singl": 6, "site": [46, 47, 48, 49, 50], "situat": 38, "size": [6, 43, 46, 48, 49, 50, 52, 55], "size_typ": 6, "skip": [5, 47], "skip_solve_constraint": 38, "skip_special_token": 47, "skipif_ci_appl": 5, "skipif_ci_linux": 5, "skipif_ci_window": 5, "skiplayernorm": [11, 32], "sklearn": 55, "sleep": 1, "slen": [2, 49], "slice": [41, 47, 48, 50], "slice_1": [11, 33, 47, 48, 50], "slice_10": [11, 33, 47, 48], "slice_11": [47, 48], "slice_12": [47, 48], "slice_13": [47, 48], "slice_14": [47, 48], "slice_15": [47, 48], "slice_16": [47, 48], "slice_17": [47, 48], "slice_18": [47, 48], "slice_19": [47, 48], "slice_2": [47, 48, 50], "slice_20": [47, 48], "slice_21": [47, 48], "slice_22": [47, 48], "slice_23": [47, 48], "slice_24": [47, 48], "slice_25": [47, 48], "slice_26": [47, 48], "slice_27": [47, 48], "slice_28": [47, 48], "slice_29": [47, 48], "slice_3": [47, 48], "slice_30": [47, 48], "slice_31": [47, 48], "slice_32": [47, 48], "slice_33": [47, 48], "slice_34": [47, 48], "slice_4": [47, 48], "slice_5": [47, 48], "slice_6": [47, 48], "slice_7": [47, 48], "slice_8": [47, 48], "slice_9": [47, 48], "slice_indic": [47, 48], "slow": [7, 52], "smi": 1, "so": [49, 50, 56], "softwar": 56, "some": [6, 8, 38, 51, 52, 55], "someth": 6, "sometim": 52, "sooner": 51, "sort": 6, "sourc": [1, 2, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 40, 41, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 55], "spars": [47, 48], "specif": [5, 6, 47], "specifi": [47, 48, 50, 51, 52, 53], "sphinx": [45, 46, 47, 48, 49, 50, 51, 52, 53], "split": [41, 52], "src": [46, 47, 48, 49, 50], "stack": 46, "stack_model_output": 41, "stacktrac": [47, 48], "stage": 38, "standard": [5, 51, 52, 53], "start": [5, 6, 47, 48, 51], "stat": 8, "state": [41, 48], "statement": 5, "static": [3, 4, 38], "statist": [5, 8], "statistics_on_fil": 5, "statistics_on_fold": 5, "stdout": 5, "steel": [43, 45, 46, 48, 49, 51, 54, 55, 57], "step": 47, "stmt": 5, "stop": [9, 38, 51, 52, 53], "store": 8, "str": [1, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 41, 43, 44], "strict": [38, 49], "strict_mod": 51, "stride": [47, 48], "string": [5, 6], "string_diff": 6, "string_sig": 6, "string_signatur": 6, "string_typ": [2, 3, 4, 6, 47, 48, 49, 55], "subclass": 41, "subfold": 5, "subject": 56, "sublicens": 56, "submod_1": [47, 48], "submod_3": [47, 48], "submodel": [45, 47, 52, 53, 54, 55, 57], "submodul": [3, 4, 46], "submul": [11, 13], "substanti": 56, "substr": 5, "succe": 52, "suggest": 48, "sum": [6, 46], "sum_1": 46, "super": 46, "support": [9, 38, 46, 47, 48, 49, 50, 52], "sure": [], "suspect": 46, "sy": [1, 51, 52, 53], "sym": [46, 47, 48, 50], "sym_siz": [47, 48, 50], "sym_size_int_20": [47, 48], "sym_size_int_21": [47, 48], "sym_size_int_22": [47, 48], "sym_size_int_3": 50, "sym_size_int_4": 50, "sym_size_int_5": 50, "symbol": 46, "sympi": 38, "t10s3x4": [6, 55], "t10s5x6": [6, 55], "t10s5x6x7": [6, 55], "t1s1x1x10x96": 47, "t1s1x1x11x96": 47, "t1s1x1x12x96": 47, "t1s1x1x13x96": 47, "t1s1x1x14x96": 47, "t1s1x1x15x96": 47, "t1s1x1x16x96": 47, "t1s1x1x17x96": 47, "t1s1x1x18x96": 47, "t1s1x1x19x96": 47, "t1s1x1x1x7": 49, "t1s1x1x20x96": 47, "t1s1x1x21x96": 47, "t1s1x1x22x96": 47, "t1s1x1x23x96": 47, "t1s1x1x24x96": 47, "t1s1x1x25x96": 47, "t1s1x1x26x96": 47, "t1s1x1x27x96": 47, "t1s1x1x28x96": 47, "t1s1x1x29x96": 47, "t1s1x1x30x96": 47, "t1s1x1x31x96": 47, "t1s1x1x32x96": 47, "t1s1x1x33x96": 47, "t1s1x1x34x96": 47, "t1s1x1x35x96": 47, "t1s1x1x36x96": 47, "t1s1x1x37x96": 47, "t1s1x1x38x96": 47, "t1s1x1x39x96": 47, "t1s1x1x40x96": 47, "t1s1x1x41x96": 47, "t1s1x1x42x96": 47, "t1s1x1x43x96": 47, "t1s1x1x44x96": 47, "t1s1x1x45x96": 47, "t1s1x1x46x96": 47, "t1s1x1x47x96": 47, "t1s1x1x48x96": 47, "t1s1x1x49x96": 47, "t1s1x1x8x96": 47, "t1s1x1x9x96": 47, "t1s1x6": [3, 4], "t1s2x1x30x96": [47, 48], "t1s2x1x33x96": 47, "t1s2x3x32000": 47, "t1s2x4x3x7": [2, 49], "t1s5x6": [3, 4], "t7s1": 47, "t7s1x1": 47, "t7s1x8": 47, "t7s2x3": [47, 48], "t7s2x33": [47, 48], "t7s8": 47, "take": [1, 38], "target": [46, 47, 48, 50], "tbfloat16": 52, "teardownclass": 5, "tell": [5, 44, 51, 52, 53], "temperatur": 47, "tensor": [2, 3, 4, 6, 9, 37, 41, 44, 46, 47, 48, 49, 50, 52], "tensor_dtyp": 6, "tensor_dtype_to_np_dtyp": 6, "tensor_scalar": [47, 48], "tensorargu": 50, "tensorproto": [6, 8, 9, 51, 52, 53, 55], "term": 41, "test": [5, 11, 44, 47], "test_investigate_onnxruntime_issue_cal": 9, "test_nam": 5, "testcas": 5, "text": [1, 5, 6], "tf32": [46, 47, 48, 49, 50], "tfloat": [9, 51, 53], "thei": 48, "them": [5, 6, 49, 52], "thi": [1, 2, 3, 4, 5, 6, 7, 9, 11, 41, 43, 44, 46, 47, 48, 49, 50, 51, 52, 53, 56], "thing": [51, 53], "third": 47, "this312": [46, 47, 48, 49, 50], "though": 47, "through": [38, 47], "time": [5, 46, 47, 48, 49, 50, 51, 52, 53], "timer": 5, "timm": 55, "tini": [43, 45, 46, 49, 50, 51, 52, 53, 54, 55, 57], "to_1": [47, 48], "to_10": [47, 48], "to_11": [47, 48], "to_12": [47, 48], "to_13": [47, 48], "to_2": [47, 48], "to_3": [47, 48], "to_4": [47, 48], "to_5": [47, 48], "to_6": [47, 48], "to_7": [47, 48], "to_8": [47, 48], "to_9": [47, 48], "to_array_extend": 6, "to_numpi": 44, "to_onnx": 38, "tocomplex": [11, 16], "todo": 5, "tofind": 5, "token": [41, 47, 48], "toler": 5, "tool": [49, 55], "top": [46, 47, 48, 49, 50], "top_k": 47, "top_p": 47, "torch": [2, 3, 4, 5, 6, 9, 38, 40, 41, 44, 46, 47, 48, 49, 50, 52, 55], "torch_dtype_to_onnx_dtyp": 6, "torch_export_patch": [5, 7, 48, 49, 55], "torch_log": [46, 48, 50], "torch_model": [5, 7, 47, 48, 55], "torch_test_help": [5, 7], "torchdynamo_extended_debug_cpp": 46, "torchdynamo_extended_debug_create_symbol": 46, "tort": 56, "total": [5, 46, 47, 48, 49, 50, 51, 52, 53, 54, 57], "trace": 46, "train": [1, 9], "trane": [9, 11], "transform": [2, 3, 4, 5, 38, 41, 43, 47, 48, 49, 55], "transpos": [47, 48], "transpose2dcastfp16": [11, 34], "transpose2dcastfp32": [11, 34], "transpose_1": [47, 48], "transpose_2": [47, 48], "transpose_3": [47, 48], "transpose_4": [47, 48], "tree": 1, "tri": [1, 9, 38], "trick": 50, "trigger": [46, 47, 48, 49, 50], "trimatrix": [11, 35], "triu": [47, 48], "true": [2, 3, 4, 5, 6, 9, 11, 38, 43, 44, 47, 48, 49, 51, 55], "true_graph_0": 46, "true_model_nam": [3, 4], "try": [46, 47, 50, 51, 52, 53], "trycal": 5, "ttime": 5, "tupl": [1, 2, 3, 4, 5, 6, 8, 9, 11, 41, 44, 49], "turn": 38, "tutori": 50, "two": [3, 4, 49], "type": [3, 4, 5, 6, 11, 38, 46, 47, 48, 49, 50, 51, 52, 53], "type_info": 6, "typeinferenceerror": [51, 52, 53], "typeproto": 11, "u0": 46, "unabl": [50, 52], "understand": [5, 49, 55], "unexpect": 47, "unhid": 5, "unhint": 46, "unit": [5, 44, 47], "unit_test_go": 5, "unittest": 5, "unknown": [6, 11], "unless": 46, "unsqueez": [47, 48], "unsqueeze_1": [47, 48], "unsqueeze_10": [47, 48], "unsqueeze_11": [47, 48], "unsqueeze_2": [47, 48], "unsqueeze_3": [47, 48], "unsqueeze_4": [47, 48], "unsqueeze_5": [47, 48], "unsqueeze_6": [47, 48], "unsqueeze_7": [47, 48], "unsqueeze_8": [47, 48], "unsqueeze_9": [47, 48], "unstabl": 48, "until": [5, 9, 52, 53], "untrained_model": [47, 48], "up": [5, 41], "up_proj": [47, 48], "updat": [41, 47, 48, 50, 55], "us": [3, 4, 6, 9, 11, 38, 41, 43, 44, 45, 46, 47, 48, 49, 52, 53, 54, 55, 56, 57], "use_cach": 47, "use_training_api": [9, 11], "user": 6, "user_input": [47, 48, 49, 50], "user_output": [47, 48, 49, 50], "usererror": [48, 50], "userwarn": [46, 47, 48, 49, 50], "usp": 46, "util": 41, "v_proj": [47, 48], "valid": [2, 3, 4, 47, 48, 49, 51, 52, 53], "valu": [1, 2, 5, 6, 41, 44, 48, 49, 50, 52, 53], "value_cach": [2, 47, 48, 49], "value_st": [41, 47, 48], "valueinfoproto": 6, "variabl": [5, 6, 38], "varianc": [47, 48], "variance_epsilon": [47, 48], "vector": 37, "verbos": [5, 6, 8, 9, 11, 38, 40, 51, 52, 53], "veri": [5, 52], "version": [0, 2, 5, 11, 46, 47, 48, 49, 50, 52], "view": [47, 48], "view_1": [47, 48], "view_2": [47, 48], "violat": [48, 50], "vr": [47, 48, 49, 50], "vv": [46, 47, 48, 49, 50], "wa": [46, 47, 48, 50, 55], "wai": [6, 9, 51], "want": 47, "warmup": [1, 5], "warmup_tim": 5, "warn": 5, "warranti": 56, "watch": 8, "we": [46, 47, 48, 49, 50, 51, 52, 53], "weight": [46, 47, 48], "well": [6, 9, 38, 44], "were": 47, "what": [5, 11, 46], "when": [5, 6, 7, 11, 38, 45, 46, 47, 48, 52, 53, 54, 55, 57], "where": [45, 47, 50, 52, 53, 54, 55, 57], "whether": 56, "which": [5, 49, 53], "while": [5, 6], "whole": 44, "whom": 56, "why": [47, 51, 53], "window": 5, "with_attribut": 6, "with_devic": 6, "with_min_max": [6, 47], "with_shap": [2, 3, 4, 6, 47, 48, 49, 55], "without": [1, 8, 43, 51, 53, 56], "work": [3, 4, 11, 41, 47, 48, 49, 50, 51], "would": [3, 4, 48], "wrap": [3, 4, 9], "wrap_with_autocast": [47, 48], "wrap_with_set_grad_en": [47, 48], "write": [47, 48], "wrong": 7, "x": [3, 4, 6, 9, 44, 46, 47, 48, 49, 50, 51, 52, 53], "x999": [51, 52, 53], "xadupr": [46, 47, 48, 49, 50], "xy": [51, 52, 53], "y": [3, 4, 9, 49, 50, 51, 52, 53], "you": [6, 46, 47, 48], "your": 47, "z": [9, 49, 50, 51, 52, 53], "zero_point": 37, "zip": [45, 46, 47, 48, 49, 50, 51, 52, 53], "zoo": 5}, "titles": ["Change Logs", "onnx_diagnostic.args", "onnx_diagnostic.cache_helpers", "onnx_diagnostic.export.dynamic_shapes", "onnx_diagnostic.export", "onnx_diagnostic.ext_test_case", "onnx_diagnostic.helpers", "API of onnx_diagnostic", "onnx_diagnostic.onnx_tools", "onnx_diagnostic.ort_session", "onnx_diagnostic.reference.evaluator", "onnx_diagnostic.reference", "onnx_diagnostic.reference.ops", "onnx_diagnostic.reference.ops.op_add_add_mul_mul", "onnx_diagnostic.reference.ops.op_average_pool_grad", "onnx_diagnostic.reference.ops.op_cast_like", "onnx_diagnostic.reference.ops.op_complex", "onnx_diagnostic.reference.ops.op_concat", "onnx_diagnostic.reference.ops.op_constant_of_shape", "onnx_diagnostic.reference.ops.op_fused_matmul", "onnx_diagnostic.reference.ops.op_gather_grad", "onnx_diagnostic.reference.ops.op_memcpy_host", "onnx_diagnostic.reference.ops.op_mul_sigmoid", "onnx_diagnostic.reference.ops.op_negxplus1", "onnx_diagnostic.reference.ops.op_qlinear_average_pool", "onnx_diagnostic.reference.ops.op_qlinear_conv", "onnx_diagnostic.reference.ops.op_quick_gelu", "onnx_diagnostic.reference.ops.op_replace_zero", "onnx_diagnostic.reference.ops.op_rotary", "onnx_diagnostic.reference.ops.op_scatter_elements", "onnx_diagnostic.reference.ops.op_scatternd_of_shape", "onnx_diagnostic.reference.ops.op_simplified_layer_normalization", "onnx_diagnostic.reference.ops.op_skip_layer_normalization", "onnx_diagnostic.reference.ops.op_slice", "onnx_diagnostic.reference.ops.op_transpose_cast", "onnx_diagnostic.reference.ops.op_tri_matrix", "onnx_diagnostic.reference.ort_evaluator", "onnx_diagnostic.reference.quantized_tensor", "onnx_diagnostic.torch_export_patches", "onnx_diagnostic.torch_export_patches.patches", "onnx_diagnostic.torch_export_patches.patches.patch_torch", "onnx_diagnostic.torch_export_patches.patches.patch_transformers", "onnx_diagnostic.torch_models", "onnx_diagnostic.torch_models.llms", "onnx_diagnostic.torch_test_helper", "Examples Gallery", "Export a model with a control flow (If)", "Steel method forward to guess the dynamic shapes (with Tiny-LLM)", "Export Tiny-LLM with patches", "Export with DynamicCache and dynamic shapes", "Use DYNAMIC or AUTO when exporting if dynamic shapes has constraints", "Find where a model is failing by running submodels", "Intermediate results with onnxruntime", "Intermediate results with (ONNX) ReferenceEvaluator", "Computation times", "onnx-diagnostic: investigate onnx models", "License", "Computation times"], "titleterms": {"0": 0, "1": 0, "2": 0, "A": [46, 51, 52, 53], "If": 46, "With": 48, "allow": 50, "an": 51, "api": 7, "arg": [1, 49], "auto": 50, "back": 47, "cache_help": 2, "chang": 0, "comput": [54, 57], "constraint": 50, "content": 55, "control": 46, "detect": 51, "diagnost": 55, "dx": 50, "dy": 50, "dynam": [47, 49, 50], "dynamic_shap": 3, "dynamiccach": 49, "enlighten": 55, "error": 48, "evalu": 10, "exampl": [45, 49, 55], "export": [3, 4, 46, 48, 49, 50], "exportedprogram": 47, "ext_test_cas": 5, "extendedreferenceevalu": [11, 53], "fail": [51, 52, 53], "find": 51, "flow": 46, "forward": 47, "function": [4, 11], "galleri": 45, "get": 55, "guess": 47, "ha": 50, "helper": 6, "i": 51, "infer": 51, "intermedi": [52, 53], "investig": 55, "issu": 51, "kwarg": 49, "licens": 56, "llm": [43, 47, 48], "log": 0, "loop": 51, "method": 47, "model": [46, 47, 48, 51, 52, 53, 55], "modelinput": 4, "modul": [4, 7, 11, 12, 39], "more": 55, "node": 51, "older": 55, "onnx": [53, 55], "onnx_diagnost": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44], "onnx_tool": 8, "onnxruntim": 52, "onnxruntimeevalu": [11, 52], "op": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "op_add_add_mul_mul": 13, "op_average_pool_grad": 14, "op_cast_lik": 15, "op_complex": 16, "op_concat": 17, "op_constant_of_shap": 18, "op_fused_matmul": 19, "op_gather_grad": 20, "op_memcpy_host": 21, "op_mul_sigmoid": 22, "op_negxplus1": 23, "op_qlinear_average_pool": 24, "op_qlinear_conv": 25, "op_quick_gelu": 26, "op_replace_zero": 27, "op_rotari": 28, "op_scatter_el": 29, "op_scatternd_of_shap": 30, "op_simplified_layer_norm": 31, "op_skip_layer_norm": 32, "op_slic": 33, "op_transpose_cast": 34, "op_tri_matrix": 35, "origin": [47, 48], "ort_evalu": 36, "ort_sess": 9, "other": [4, 11], "over": 51, "patch": [39, 40, 41, 46, 48], "patch_torch": 40, "patch_transform": 41, "quantized_tensor": 37, "refer": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "referenceevalu": 53, "result": [52, 53], "run": 51, "shape": [47, 49, 50, 51], "simpl": 49, "start": 55, "steel": 47, "submodel": 51, "submodul": [7, 11, 38, 42], "suggest": 46, "test": 46, "time": [54, 57], "tini": [47, 48], "torch_export_patch": [38, 39, 40, 41], "torch_model": [42, 43], "torch_test_help": 44, "untrain": 47, "us": 50, "version": 55, "when": 50, "where": 51}})