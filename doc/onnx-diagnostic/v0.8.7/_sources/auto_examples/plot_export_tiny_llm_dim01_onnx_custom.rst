
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_export_tiny_llm_dim01_onnx_custom.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_export_tiny_llm_dim01_onnx_custom.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_export_tiny_llm_dim01_onnx_custom.py:


.. _l-plot-tiny-llm-export-dim01-onnx-custom:

Export with dynamic dimensions in ``{0,1}`` into ONNX (custom)
==============================================================

This duplicates the example :ref:`l-plot-tiny-llm-export-dim01` but for
:func:`experimental_experiment.torch_interpreter.to_onnx`.
It checks what inputs can be used to export and with which inputs it can work.

Available input sets
++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 15-36

.. code-block:: Python


    import itertools
    from tqdm import tqdm
    import numpy as np
    import pandas
    import onnxruntime
    from onnx_diagnostic import doc
    from onnx_diagnostic.helpers import max_diff, string_type, flatten_object
    from onnx_diagnostic.helpers.torch_helper import torch_deepcopy
    from onnx_diagnostic.helpers.rt_helper import make_feeds
    from onnx_diagnostic.torch_models.hghub.model_inputs import get_untrained_model_with_inputs
    from onnx_diagnostic.torch_export_patches import (
        torch_export_patches,
        register_additional_serialization_functions,
    )
    from experimental_experiment.torch_interpreter import to_onnx, ExportOptions


    data = get_untrained_model_with_inputs("arnir0/Tiny-LLM", add_second_input=True)
    model, dynamic_shapes = data["model"], data["dynamic_shapes"]








.. GENERATED FROM PYTHON SOURCE LINES 37-44

The trained model can be obtained with:

.. code-block:: python

  MODEL_NAME = "arnir0/Tiny-LLM"
  tokenizer = transformers.AutoTokenizer.from_pretrained(MODEL_NAME)
  model = transformers.AutoModelForCausalLM.from_pretrained(MODEL_NAME)

.. GENERATED FROM PYTHON SOURCE LINES 44-50

.. code-block:: Python


    input_sets = {k: v for k, v in data.items() if k.startswith("inputs")}

    for k, v in input_sets.items():
        print(f"{k:20}: {string_type(v, with_shape=True)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    inputs              : dict(input_ids:T7s2x3,attention_mask:T7s2x33,position_ids:T7s2x3,past_key_values:DynamicCache(key_cache=#1[T1s2x1x30x96], value_cache=#1[T1s2x1x30x96]))
    inputs_prompt       : dict(input_ids:T7s1x11)
    inputs2             : dict(input_ids:T7s3x4,attention_mask:T7s3x35,position_ids:T7s3x4,past_key_values:DynamicCache(key_cache=#1[T1s3x1x31x96], value_cache=#1[T1s3x1x31x96]))
    inputs_empty_cache  : dict(input_ids:T7s2x3,attention_mask:T7s2x3,position_ids:T7s2x3,past_key_values:DynamicCache(key_cache=#1[T1s2x1x0x96], value_cache=#1[T1s2x1x0x96]))
    inputs_batch1       : dict(input_ids:T7s1x3,attention_mask:T7s1x33,position_ids:T7s1x3,past_key_values:DynamicCache(key_cache=#1[T1s1x1x30x96], value_cache=#1[T1s1x1x30x96]))




.. GENERATED FROM PYTHON SOURCE LINES 51-52

The dynamic shapes are:

.. GENERATED FROM PYTHON SOURCE LINES 52-55

.. code-block:: Python


    print(f"dynamic_shapes: {string_type(dynamic_shapes)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    dynamic_shapes: dict(input_ids:{0:DYN(batch),1:DYN(seq_length)},attention_mask:{0:DYN(batch),1:DYN(cache+seq)},position_ids:{0:DYN(batch),1:DYN(seq_length)},past_key_values:#2[{0:DYN(batch),2:DYN(cache_length)},{0:DYN(batch),2:DYN(cache_length)}])




.. GENERATED FROM PYTHON SOURCE LINES 56-58

Let's check they all work and compute the expected values.
We use deepcopy because caches are usually modified inplace.

.. GENERATED FROM PYTHON SOURCE LINES 58-64

.. code-block:: Python


    expected = {}
    for k, v in input_sets.items():
        expected[k] = model(**torch_deepcopy(v))
        print(f"{k:20}: {string_type(expected[k], with_shape=True)}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    inputs              : CausalLMOutputWithPast(logits:T1s2x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s2x1x33x96], value_cache=#1[T1s2x1x33x96]))
    inputs_prompt       : CausalLMOutputWithPast(logits:T1s1x11x32000,past_key_values:DynamicCache(key_cache=#1[T1s1x1x11x96], value_cache=#1[T1s1x1x11x96]))
    inputs2             : CausalLMOutputWithPast(logits:T1s3x4x32000,past_key_values:DynamicCache(key_cache=#1[T1s3x1x35x96], value_cache=#1[T1s3x1x35x96]))
    inputs_empty_cache  : CausalLMOutputWithPast(logits:T1s2x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s2x1x3x96], value_cache=#1[T1s2x1x3x96]))
    inputs_batch1       : CausalLMOutputWithPast(logits:T1s1x3x32000,past_key_values:DynamicCache(key_cache=#1[T1s1x1x33x96], value_cache=#1[T1s1x1x33x96]))




.. GENERATED FROM PYTHON SOURCE LINES 65-81

Export with options
+++++++++++++++++++

We try to export with the following options:

- cache registration: register cache serialization with
  :func:`onnx_diagnostic.torch_export_patches.register_additional_serialization_functions`

- oblivious: an option to remove some the exception raises by the exporter

- rt: see ``prefer_deferred_runtime_asserts_over_guards`` in :func:`torch.export.export`

- cache_patch: patches the model before exporting with
  :func:`onnx_diagnostic.torch_export_patches.torch_export_patches`

Some function first.

.. GENERATED FROM PYTHON SOURCE LINES 81-166

.. code-block:: Python



    def export_model(
        model,
        dynamic_shapes,
        inputs,
        cache=False,
        oblivious=False,
        rt=False,
        cache_patch=False,
        strict=False,
    ):
        if cache and not cache_patch:
            with register_additional_serialization_functions(patch_transformers=True):
                return export_model(
                    model, dynamic_shapes, inputs, oblivious=oblivious, rt=rt, strict=strict
                )
        if cache_patch:
            with torch_export_patches(
                patch_torch=cache_patch in ("all", "torch", True, 1),
                patch_transformers=cache_patch in ("all", "transformers", True, 1),
            ):
                return export_model(
                    model, dynamic_shapes, inputs, oblivious=oblivious, rt=rt, strict=strict
                )
        return to_onnx(
            model,
            (),
            kwargs=inputs,
            dynamic_shapes=dynamic_shapes,
            export_options=ExportOptions(
                prefer_deferred_runtime_asserts_over_guards=rt,
                backed_size_oblivious=oblivious,
                strict=strict,
            ),
        )


    def try_export_model(
        model,
        dynamic_shapes,
        inputs,
        cache=False,
        oblivious=False,
        rt=False,
        cache_patch=False,
        strict=False,
    ):
        try:
            return export_model(
                model,
                dynamic_shapes,
                inputs,
                cache=cache,
                oblivious=oblivious,
                rt=rt,
                cache_patch=cache_patch,
                strict=strict,
            )
        except Exception as e:
            return e


    def validation(onx, input_sets, expected, catch_exception=True):
        sess = onnxruntime.InferenceSession(
            onx.SerializeToString(), providers=["CPUExecutionProvider"]
        )
        for k, v in input_sets.items():
            try:
                feeds = make_feeds(sess, torch_deepcopy(v), use_numpy=True)
            except Exception as e:
                if not catch_exception:
                    raise
                yield k, e
                continue
            try:
                got = sess.run(None, feeds)
            except Exception as e:
                if not catch_exception:
                    raise
                yield k, e
                continue
            yield k, max_diff(flatten_object(expected[k], drop_keys=True), got)









.. GENERATED FROM PYTHON SOURCE LINES 167-168

Verification an example known to be working is.

.. GENERATED FROM PYTHON SOURCE LINES 168-179

.. code-block:: Python


    ep = export_model(
        model,
        dynamic_shapes,
        torch_deepcopy(input_sets["inputs"]),
        cache_patch=True,
    )
    res = list(validation(ep, dict(inputs=input_sets["inputs"]), expected, catch_exception=False))
    assert res[0][1]["abs"] < 1e-5, f"Unexpected issue with res={res}"









.. GENERATED FROM PYTHON SOURCE LINES 180-182

The main loop
+++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 182-239

.. code-block:: Python


    results = []

    possibilities = [
        [0, 1],
        [0, "all", "torch", "transformers"],
        [0, 1],
        [0, 1, "auto", "half"],
        [0, 1],
        list(input_sets),
    ]
    with tqdm(list(itertools.product(*possibilities))) as pbar:
        for cache, cache_patch, strict, oblivious, rt, inputs in pbar:
            if cache_patch and not cache:
                # patches include caches.
                continue
            kwargs = dict(
                cache=cache, cache_patch=cache_patch, oblivious=oblivious, rt=rt, strict=strict
            )
            legend = "-".join(
                (k if isinstance(v, int) else f"{k}:{v}") for k, v in kwargs.items() if v
            )
            legend = f"{legend}/{inputs}"
            pbar.set_description(f"{legend} EXPORT")

            # export
            ep = try_export_model(
                model, dynamic_shapes, torch_deepcopy(input_sets[inputs]), **kwargs
            )
            if isinstance(ep, Exception):
                obs = {
                    **kwargs,
                    "export_with": inputs,
                    "EXPORT": 0,
                    "ERR-EXPORT": str(ep).split("\n")[0],
                }
                results.append(obs)
                continue

            pbar.set_description(f"{legend} VALIDATE")
            common = {**kwargs, "export_with": inputs, "EXPORT": 1}
            for inp, res in validation(ep, input_sets, expected):
                if isinstance(res, Exception):
                    obs = {
                        **common,
                        "run_with": inp,
                        "ERR-RUN": str(res).split("\n")[0],
                        "WORKS": 0,
                    }
                else:
                    obs = {
                        **common,
                        "run_with": inp,
                        "WORKS": int(~np.isnan(res["abs"]) and res["abs"] < 1e-3),
                    }
                results.append(obs)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/640 [00:00<?, ?it/s]    /inputs EXPORT:   0%|          | 0/640 [00:00<?, ?it/s]    /inputs VALIDATE:   0%|          | 0/640 [00:01<?, ?it/s]    /inputs VALIDATE:   0%|          | 1/640 [00:01<13:02,  1.23s/it]    /inputs_prompt EXPORT:   0%|          | 1/640 [00:01<13:02,  1.23s/it]    /inputs2 EXPORT:   0%|          | 1/640 [00:01<13:02,  1.23s/it]          /inputs2 VALIDATE:   0%|          | 1/640 [00:02<13:02,  1.23s/it]    /inputs2 VALIDATE:   0%|          | 3/640 [00:02<09:25,  1.13it/s]    /inputs_empty_cache EXPORT:   0%|          | 3/640 [00:02<09:25,  1.13it/s]    /inputs_empty_cache EXPORT:   1%|          | 4/640 [00:03<08:57,  1.18it/s]    /inputs_batch1 EXPORT:   1%|          | 4/640 [00:03<08:57,  1.18it/s]         /inputs_batch1 EXPORT:   1%|          | 5/640 [00:04<08:10,  1.30it/s]    rt/inputs EXPORT:   1%|          | 5/640 [00:04<08:10,  1.30it/s]         rt/inputs VALIDATE:   1%|          | 5/640 [00:05<08:10,  1.30it/s]    rt/inputs VALIDATE:   1%|          | 6/640 [00:05<10:00,  1.05it/s]    rt/inputs_prompt EXPORT:   1%|          | 6/640 [00:05<10:00,  1.05it/s]    rt/inputs2 EXPORT:   1%|          | 6/640 [00:05<10:00,  1.05it/s]          rt/inputs2 VALIDATE:   1%|          | 6/640 [00:06<10:00,  1.05it/s]    rt/inputs2 VALIDATE:   1%|▏         | 8/640 [00:06<08:15,  1.27it/s]    rt/inputs_empty_cache EXPORT:   1%|▏         | 8/640 [00:06<08:15,  1.27it/s]    rt/inputs_empty_cache EXPORT:   1%|▏         | 9/640 [00:07<08:05,  1.30it/s]    rt/inputs_batch1 EXPORT:   1%|▏         | 9/640 [00:07<08:05,  1.30it/s]         rt/inputs_batch1 EXPORT:   2%|▏         | 10/640 [00:07<07:30,  1.40it/s]    oblivious/inputs EXPORT:   2%|▏         | 10/640 [00:07<07:30,  1.40it/s]    oblivious/inputs VALIDATE:   2%|▏         | 10/640 [00:09<07:30,  1.40it/s]    oblivious/inputs VALIDATE:   2%|▏         | 11/640 [00:09<09:20,  1.12it/s]    oblivious/inputs_prompt EXPORT:   2%|▏         | 11/640 [00:09<09:20,  1.12it/s]    oblivious/inputs2 EXPORT:   2%|▏         | 11/640 [00:09<09:20,  1.12it/s]          oblivious/inputs2 VALIDATE:   2%|▏         | 11/640 [00:10<09:20,  1.12it/s]    oblivious/inputs2 VALIDATE:   2%|▏         | 13/640 [00:10<09:01,  1.16it/s]    oblivious/inputs_empty_cache EXPORT:   2%|▏         | 13/640 [00:10<09:01,  1.16it/s]    oblivious/inputs_empty_cache VALIDATE:   2%|▏         | 13/640 [00:12<09:01,  1.16it/s]    oblivious/inputs_empty_cache VALIDATE:   2%|▏         | 14/640 [00:12<09:58,  1.05it/s]    oblivious/inputs_batch1 EXPORT:   2%|▏         | 14/640 [00:12<09:58,  1.05it/s]           oblivious/inputs_batch1 VALIDATE:   2%|▏         | 14/640 [00:13<09:58,  1.05it/s]    oblivious/inputs_batch1 VALIDATE:   2%|▏         | 15/640 [00:13<10:55,  1.05s/it]    oblivious-rt/inputs EXPORT:   2%|▏         | 15/640 [00:13<10:55,  1.05s/it]          oblivious-rt/inputs VALIDATE:   2%|▏         | 15/640 [00:14<10:55,  1.05s/it]    oblivious-rt/inputs VALIDATE:   2%|▎         | 16/640 [00:14<11:42,  1.13s/it]    oblivious-rt/inputs_prompt EXPORT:   2%|▎         | 16/640 [00:14<11:42,  1.13s/it]    oblivious-rt/inputs2 EXPORT:   2%|▎         | 16/640 [00:14<11:42,  1.13s/it]          oblivious-rt/inputs2 VALIDATE:   2%|▎         | 16/640 [00:16<11:42,  1.13s/it]    oblivious-rt/inputs2 VALIDATE:   3%|▎         | 18/640 [00:16<09:32,  1.09it/s]    oblivious-rt/inputs_empty_cache EXPORT:   3%|▎         | 18/640 [00:16<09:32,  1.09it/s]    oblivious-rt/inputs_empty_cache VALIDATE:   3%|▎         | 18/640 [00:17<09:32,  1.09it/s]    oblivious-rt/inputs_empty_cache VALIDATE:   3%|▎         | 19/640 [00:17<10:45,  1.04s/it]    oblivious-rt/inputs_batch1 EXPORT:   3%|▎         | 19/640 [00:17<10:45,  1.04s/it]           oblivious-rt/inputs_batch1 VALIDATE:   3%|▎         | 19/640 [00:18<10:45,  1.04s/it]    oblivious-rt/inputs_batch1 VALIDATE:   3%|▎         | 20/640 [00:19<11:40,  1.13s/it]    oblivious:auto/inputs EXPORT:   3%|▎         | 20/640 [00:19<11:40,  1.13s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto/inputs VALIDATE:   3%|▎         | 20/640 [00:20<11:40,  1.13s/it]    oblivious:auto/inputs VALIDATE:   3%|▎         | 21/640 [00:20<12:36,  1.22s/it]    oblivious:auto/inputs_prompt EXPORT:   3%|▎         | 21/640 [00:20<12:36,  1.22s/it]    oblivious:auto/inputs2 EXPORT:   3%|▎         | 21/640 [00:20<12:36,  1.22s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto/inputs2 VALIDATE:   3%|▎         | 21/640 [00:22<12:36,  1.22s/it]    oblivious:auto/inputs2 VALIDATE:   4%|▎         | 23/640 [00:22<11:46,  1.14s/it]    oblivious:auto/inputs_empty_cache EXPORT:   4%|▎         | 23/640 [00:22<11:46,  1.14s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto/inputs_empty_cache VALIDATE:   4%|▎         | 23/640 [00:23<11:46,  1.14s/it]    oblivious:auto/inputs_empty_cache VALIDATE:   4%|▍         | 24/640 [00:23<12:18,  1.20s/it]    oblivious:auto/inputs_batch1 EXPORT:   4%|▍         | 24/640 [00:23<12:18,  1.20s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto/inputs_batch1 VALIDATE:   4%|▍         | 24/640 [00:25<12:18,  1.20s/it]    oblivious:auto/inputs_batch1 VALIDATE:   4%|▍         | 25/640 [00:25<12:51,  1.25s/it]    oblivious:auto-rt/inputs EXPORT:   4%|▍         | 25/640 [00:25<12:51,  1.25s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto-rt/inputs VALIDATE:   4%|▍         | 25/640 [00:26<12:51,  1.25s/it]    oblivious:auto-rt/inputs VALIDATE:   4%|▍         | 26/640 [00:26<12:52,  1.26s/it]    oblivious:auto-rt/inputs_prompt EXPORT:   4%|▍         | 26/640 [00:26<12:52,  1.26s/it]    oblivious:auto-rt/inputs2 EXPORT:   4%|▍         | 26/640 [00:26<12:52,  1.26s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto-rt/inputs2 VALIDATE:   4%|▍         | 26/640 [00:27<12:52,  1.26s/it]    oblivious:auto-rt/inputs2 VALIDATE:   4%|▍         | 28/640 [00:27<10:10,  1.00it/s]    oblivious:auto-rt/inputs_empty_cache EXPORT:   4%|▍         | 28/640 [00:27<10:10,  1.00it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto-rt/inputs_empty_cache VALIDATE:   4%|▍         | 28/640 [00:29<10:10,  1.00it/s]    oblivious:auto-rt/inputs_empty_cache VALIDATE:   5%|▍         | 29/640 [00:29<10:48,  1.06s/it]    oblivious:auto-rt/inputs_batch1 EXPORT:   5%|▍         | 29/640 [00:29<10:48,  1.06s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    oblivious:auto-rt/inputs_batch1 VALIDATE:   5%|▍         | 29/640 [00:30<10:48,  1.06s/it]    oblivious:auto-rt/inputs_batch1 VALIDATE:   5%|▍         | 30/640 [00:30<11:06,  1.09s/it]    oblivious:half/inputs EXPORT:   5%|▍         | 30/640 [00:30<11:06,  1.09s/it]                oblivious:half/inputs VALIDATE:   5%|▍         | 30/640 [00:31<11:06,  1.09s/it]    oblivious:half/inputs VALIDATE:   5%|▍         | 31/640 [00:31<11:31,  1.14s/it]    oblivious:half/inputs_prompt EXPORT:   5%|▍         | 31/640 [00:31<11:31,  1.14s/it]    oblivious:half/inputs2 EXPORT:   5%|▍         | 31/640 [00:31<11:31,  1.14s/it]          oblivious:half/inputs2 VALIDATE:   5%|▍         | 31/640 [00:32<11:31,  1.14s/it]    oblivious:half/inputs2 VALIDATE:   5%|▌         | 33/640 [00:32<09:26,  1.07it/s]    oblivious:half/inputs_empty_cache EXPORT:   5%|▌         | 33/640 [00:32<09:26,  1.07it/s]    oblivious:half/inputs_empty_cache VALIDATE:   5%|▌         | 33/640 [00:34<09:26,  1.07it/s]    oblivious:half/inputs_empty_cache VALIDATE:   5%|▌         | 34/640 [00:34<11:45,  1.16s/it]    oblivious:half/inputs_batch1 EXPORT:   5%|▌         | 34/640 [00:34<11:45,  1.16s/it]           oblivious:half/inputs_batch1 VALIDATE:   5%|▌         | 34/640 [00:36<11:45,  1.16s/it]    oblivious:half/inputs_batch1 VALIDATE:   5%|▌         | 35/640 [00:36<12:18,  1.22s/it]    oblivious:half-rt/inputs EXPORT:   5%|▌         | 35/640 [00:36<12:18,  1.22s/it]          oblivious:half-rt/inputs VALIDATE:   5%|▌         | 35/640 [00:37<12:18,  1.22s/it]    oblivious:half-rt/inputs VALIDATE:   6%|▌         | 36/640 [00:37<12:34,  1.25s/it]    oblivious:half-rt/inputs_prompt EXPORT:   6%|▌         | 36/640 [00:37<12:34,  1.25s/it]    oblivious:half-rt/inputs2 EXPORT:   6%|▌         | 36/640 [00:37<12:34,  1.25s/it]          oblivious:half-rt/inputs2 VALIDATE:   6%|▌         | 36/640 [00:38<12:34,  1.25s/it]    oblivious:half-rt/inputs2 VALIDATE:   6%|▌         | 38/640 [00:38<09:41,  1.04it/s]    oblivious:half-rt/inputs_empty_cache EXPORT:   6%|▌         | 38/640 [00:38<09:41,  1.04it/s]    oblivious:half-rt/inputs_empty_cache VALIDATE:   6%|▌         | 38/640 [00:39<09:41,  1.04it/s]    oblivious:half-rt/inputs_empty_cache VALIDATE:   6%|▌         | 39/640 [00:40<10:38,  1.06s/it]    oblivious:half-rt/inputs_batch1 EXPORT:   6%|▌         | 39/640 [00:40<10:38,  1.06s/it]           oblivious:half-rt/inputs_batch1 VALIDATE:   6%|▌         | 39/640 [00:41<10:38,  1.06s/it]    oblivious:half-rt/inputs_batch1 VALIDATE:   6%|▋         | 40/640 [00:41<10:57,  1.10s/it]    strict/inputs EXPORT:   6%|▋         | 40/640 [00:41<10:57,  1.10s/it]                    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/distributed/tensor/experimental/_context_parallel/_attention.py:1035: UserWarning: You are calling torch.compile inside torch.export region. To capture an useful graph, we will implicitly switch to torch.compile(backend=eager)
      _compiled_create_block_mask = torch.compile(
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    strict/inputs EXPORT:   6%|▋         | 41/640 [00:45<18:33,  1.86s/it]    strict/inputs_prompt EXPORT:   6%|▋         | 41/640 [00:45<18:33,  1.86s/it]    strict/inputs2 EXPORT:   6%|▋         | 41/640 [00:45<18:33,  1.86s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    strict/inputs2 EXPORT:   7%|▋         | 43/640 [00:46<13:39,  1.37s/it]    strict/inputs_empty_cache EXPORT:   7%|▋         | 43/640 [00:46<13:39,  1.37s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    strict/inputs_empty_cache EXPORT:   7%|▋         | 44/640 [00:47<13:10,  1.33s/it]    strict/inputs_batch1 EXPORT:   7%|▋         | 44/640 [00:47<13:10,  1.33s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    strict/inputs_batch1 EXPORT:   7%|▋         | 45/640 [00:50<15:00,  1.51s/it]    rt-strict/inputs EXPORT:   7%|▋         | 45/640 [00:50<15:00,  1.51s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    rt-strict/inputs EXPORT:   7%|▋         | 46/640 [00:52<17:06,  1.73s/it]    rt-strict/inputs_prompt EXPORT:   7%|▋         | 46/640 [00:52<17:06,  1.73s/it]    rt-strict/inputs2 EXPORT:   7%|▋         | 46/640 [00:52<17:06,  1.73s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    rt-strict/inputs2 EXPORT:   8%|▊         | 48/640 [00:54<14:46,  1.50s/it]    rt-strict/inputs_empty_cache EXPORT:   8%|▊         | 48/640 [00:54<14:46,  1.50s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    rt-strict/inputs_empty_cache EXPORT:   8%|▊         | 49/640 [00:57<17:41,  1.80s/it]    rt-strict/inputs_batch1 EXPORT:   8%|▊         | 49/640 [00:57<17:41,  1.80s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    rt-strict/inputs_batch1 EXPORT:   8%|▊         | 50/640 [00:59<18:09,  1.85s/it]    oblivious-strict/inputs EXPORT:   8%|▊         | 50/640 [00:59<18:09,  1.85s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-strict/inputs EXPORT:   8%|▊         | 51/640 [01:00<16:22,  1.67s/it]    oblivious-strict/inputs_prompt EXPORT:   8%|▊         | 51/640 [01:00<16:22,  1.67s/it]    oblivious-strict/inputs2 EXPORT:   8%|▊         | 51/640 [01:00<16:22,  1.67s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-strict/inputs2 EXPORT:   8%|▊         | 53/640 [01:01<11:43,  1.20s/it]    oblivious-strict/inputs_empty_cache EXPORT:   8%|▊         | 53/640 [01:01<11:43,  1.20s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-strict/inputs_empty_cache EXPORT:   8%|▊         | 54/640 [01:02<11:29,  1.18s/it]    oblivious-strict/inputs_batch1 EXPORT:   8%|▊         | 54/640 [01:02<11:29,  1.18s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-strict/inputs_batch1 EXPORT:   9%|▊         | 55/640 [01:05<13:36,  1.40s/it]    oblivious-rt-strict/inputs EXPORT:   9%|▊         | 55/640 [01:05<13:36,  1.40s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-rt-strict/inputs EXPORT:   9%|▉         | 56/640 [01:07<15:10,  1.56s/it]    oblivious-rt-strict/inputs_prompt EXPORT:   9%|▉         | 56/640 [01:07<15:10,  1.56s/it]    oblivious-rt-strict/inputs2 EXPORT:   9%|▉         | 56/640 [01:07<15:10,  1.56s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-rt-strict/inputs2 EXPORT:   9%|▉         | 58/640 [01:09<14:23,  1.48s/it]    oblivious-rt-strict/inputs_empty_cache EXPORT:   9%|▉         | 58/640 [01:09<14:23,  1.48s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-rt-strict/inputs_empty_cache EXPORT:   9%|▉         | 59/640 [01:11<15:28,  1.60s/it]    oblivious-rt-strict/inputs_batch1 EXPORT:   9%|▉         | 59/640 [01:11<15:28,  1.60s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious-rt-strict/inputs_batch1 EXPORT:   9%|▉         | 60/640 [01:13<16:28,  1.70s/it]    oblivious:auto-strict/inputs EXPORT:   9%|▉         | 60/640 [01:13<16:28,  1.70s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-strict/inputs EXPORT:  10%|▉         | 61/640 [01:14<14:50,  1.54s/it]    oblivious:auto-strict/inputs_prompt EXPORT:  10%|▉         | 61/640 [01:14<14:50,  1.54s/it]    oblivious:auto-strict/inputs2 EXPORT:  10%|▉         | 61/640 [01:14<14:50,  1.54s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-strict/inputs2 EXPORT:  10%|▉         | 63/640 [01:16<10:46,  1.12s/it]    oblivious:auto-strict/inputs_empty_cache EXPORT:  10%|▉         | 63/640 [01:16<10:46,  1.12s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-strict/inputs_empty_cache EXPORT:  10%|█         | 64/640 [01:17<10:53,  1.13s/it]    oblivious:auto-strict/inputs_batch1 EXPORT:  10%|█         | 64/640 [01:17<10:53,  1.13s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-strict/inputs_batch1 EXPORT:  10%|█         | 65/640 [01:19<12:53,  1.34s/it]    oblivious:auto-rt-strict/inputs EXPORT:  10%|█         | 65/640 [01:19<12:53,  1.34s/it]    /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-rt-strict/inputs EXPORT:  10%|█         | 66/640 [01:22<16:56,  1.77s/it]    oblivious:auto-rt-strict/inputs_prompt EXPORT:  10%|█         | 66/640 [01:22<16:56,  1.77s/it]    oblivious:auto-rt-strict/inputs2 EXPORT:  10%|█         | 66/640 [01:22<16:56,  1.77s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-rt-strict/inputs2 EXPORT:  11%|█         | 68/640 [01:24<14:21,  1.51s/it]    oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  11%|█         | 68/640 [01:24<14:21,  1.51s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  11%|█         | 69/640 [01:26<15:44,  1.65s/it]    oblivious:auto-rt-strict/inputs_batch1 EXPORT:  11%|█         | 69/640 [01:26<15:44,  1.65s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:auto-rt-strict/inputs_batch1 EXPORT:  11%|█         | 70/640 [01:28<16:27,  1.73s/it]    oblivious:half-strict/inputs EXPORT:  11%|█         | 70/640 [01:28<16:27,  1.73s/it]          /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-strict/inputs EXPORT:  11%|█         | 71/640 [01:29<14:51,  1.57s/it]    oblivious:half-strict/inputs_prompt EXPORT:  11%|█         | 71/640 [01:29<14:51,  1.57s/it]    oblivious:half-strict/inputs2 EXPORT:  11%|█         | 71/640 [01:29<14:51,  1.57s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-strict/inputs2 EXPORT:  11%|█▏        | 73/640 [01:30<10:48,  1.14s/it]    oblivious:half-strict/inputs_empty_cache EXPORT:  11%|█▏        | 73/640 [01:30<10:48,  1.14s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-strict/inputs_empty_cache EXPORT:  12%|█▏        | 74/640 [01:31<10:43,  1.14s/it]    oblivious:half-strict/inputs_batch1 EXPORT:  12%|█▏        | 74/640 [01:31<10:43,  1.14s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-strict/inputs_batch1 EXPORT:  12%|█▏        | 75/640 [01:33<12:41,  1.35s/it]    oblivious:half-rt-strict/inputs EXPORT:  12%|█▏        | 75/640 [01:33<12:41,  1.35s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-rt-strict/inputs EXPORT:  12%|█▏        | 76/640 [01:36<16:28,  1.75s/it]    oblivious:half-rt-strict/inputs_prompt EXPORT:  12%|█▏        | 76/640 [01:36<16:28,  1.75s/it]    oblivious:half-rt-strict/inputs2 EXPORT:  12%|█▏        | 76/640 [01:36<16:28,  1.75s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-rt-strict/inputs2 EXPORT:  12%|█▏        | 78/640 [01:38<13:34,  1.45s/it]    oblivious:half-rt-strict/inputs_empty_cache EXPORT:  12%|█▏        | 78/640 [01:38<13:34,  1.45s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-rt-strict/inputs_empty_cache EXPORT:  12%|█▏        | 79/640 [01:40<14:33,  1.56s/it]    oblivious:half-rt-strict/inputs_batch1 EXPORT:  12%|█▏        | 79/640 [01:40<14:33,  1.56s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    oblivious:half-rt-strict/inputs_batch1 EXPORT:  12%|█▎        | 80/640 [01:42<15:12,  1.63s/it]    cache/inputs EXPORT:  12%|█▎        | 80/640 [01:42<15:12,  1.63s/it]                              cache/inputs VALIDATE:  12%|█▎        | 80/640 [01:43<15:12,  1.63s/it]    cache/inputs VALIDATE:  50%|█████     | 321/640 [01:44<00:07, 40.23it/s]    cache/inputs_prompt EXPORT:  50%|█████     | 321/640 [01:44<00:07, 40.23it/s]    cache/inputs2 EXPORT:  50%|█████     | 321/640 [01:44<00:07, 40.23it/s]          cache/inputs2 VALIDATE:  50%|█████     | 321/640 [01:45<00:07, 40.23it/s]    cache/inputs_empty_cache EXPORT:  50%|█████     | 321/640 [01:45<00:07, 40.23it/s]    cache/inputs_empty_cache VALIDATE:  50%|█████     | 321/640 [01:46<00:07, 40.23it/s]    cache/inputs_batch1 EXPORT:  50%|█████     | 321/640 [01:46<00:07, 40.23it/s]           cache-rt/inputs EXPORT:  50%|█████     | 321/640 [01:47<00:07, 40.23it/s]        cache-rt/inputs VALIDATE:  50%|█████     | 321/640 [01:48<00:07, 40.23it/s]    cache-rt/inputs VALIDATE:  51%|█████     | 326/640 [01:48<00:15, 19.80it/s]    cache-rt/inputs_prompt EXPORT:  51%|█████     | 326/640 [01:48<00:15, 19.80it/s]    cache-rt/inputs2 EXPORT:  51%|█████     | 326/640 [01:48<00:15, 19.80it/s]          cache-rt/inputs2 VALIDATE:  51%|█████     | 326/640 [01:49<00:15, 19.80it/s]    cache-rt/inputs_empty_cache EXPORT:  51%|█████     | 326/640 [01:50<00:15, 19.80it/s]    cache-rt/inputs_empty_cache VALIDATE:  51%|█████     | 326/640 [01:51<00:15, 19.80it/s]    cache-rt/inputs_batch1 EXPORT:  51%|█████     | 326/640 [01:51<00:15, 19.80it/s]           cache-rt/inputs_batch1 EXPORT:  52%|█████▏    | 330/640 [01:53<00:25, 12.00it/s]    cache-oblivious/inputs EXPORT:  52%|█████▏    | 330/640 [01:53<00:25, 12.00it/s]    cache-oblivious/inputs VALIDATE:  52%|█████▏    | 330/640 [01:54<00:25, 12.00it/s]    cache-oblivious/inputs_prompt EXPORT:  52%|█████▏    | 330/640 [01:54<00:25, 12.00it/s]    cache-oblivious/inputs2 EXPORT:  52%|█████▏    | 330/640 [01:54<00:25, 12.00it/s]          cache-oblivious/inputs2 VALIDATE:  52%|█████▏    | 330/640 [01:55<00:25, 12.00it/s]    cache-oblivious/inputs2 VALIDATE:  52%|█████▏    | 333/640 [01:55<00:33,  9.17it/s]    cache-oblivious/inputs_empty_cache EXPORT:  52%|█████▏    | 333/640 [01:55<00:33,  9.17it/s]    cache-oblivious/inputs_empty_cache VALIDATE:  52%|█████▏    | 333/640 [01:56<00:33,  9.17it/s]    cache-oblivious/inputs_batch1 EXPORT:  52%|█████▏    | 333/640 [01:57<00:33,  9.17it/s]           cache-oblivious/inputs_batch1 VALIDATE:  52%|█████▏    | 333/640 [01:58<00:33,  9.17it/s]    cache-oblivious/inputs_batch1 VALIDATE:  52%|█████▏    | 335/640 [01:58<00:44,  6.83it/s]    cache-oblivious-rt/inputs EXPORT:  52%|█████▏    | 335/640 [01:58<00:44,  6.83it/s]          cache-oblivious-rt/inputs VALIDATE:  52%|█████▏    | 335/640 [01:59<00:44,  6.83it/s]    cache-oblivious-rt/inputs_prompt EXPORT:  52%|█████▏    | 335/640 [01:59<00:44,  6.83it/s]    cache-oblivious-rt/inputs_prompt EXPORT:  53%|█████▎    | 337/640 [01:59<00:51,  5.93it/s]    cache-oblivious-rt/inputs2 EXPORT:  53%|█████▎    | 337/640 [01:59<00:51,  5.93it/s]          cache-oblivious-rt/inputs2 VALIDATE:  53%|█████▎    | 337/640 [02:00<00:51,  5.93it/s]    cache-oblivious-rt/inputs2 VALIDATE:  53%|█████▎    | 338/640 [02:01<01:00,  4.97it/s]    cache-oblivious-rt/inputs_empty_cache EXPORT:  53%|█████▎    | 338/640 [02:01<01:00,  4.97it/s]    cache-oblivious-rt/inputs_empty_cache VALIDATE:  53%|█████▎    | 338/640 [02:02<01:00,  4.97it/s]    cache-oblivious-rt/inputs_empty_cache VALIDATE:  53%|█████▎    | 339/640 [02:02<01:13,  4.09it/s]    cache-oblivious-rt/inputs_batch1 EXPORT:  53%|█████▎    | 339/640 [02:02<01:13,  4.09it/s]           cache-oblivious-rt/inputs_batch1 VALIDATE:  53%|█████▎    | 339/640 [02:03<01:13,  4.09it/s]    cache-oblivious-rt/inputs_batch1 VALIDATE:  53%|█████▎    | 340/640 [02:03<01:29,  3.36it/s]    cache-oblivious:auto/inputs EXPORT:  53%|█████▎    | 340/640 [02:03<01:29,  3.36it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto/inputs VALIDATE:  53%|█████▎    | 340/640 [02:04<01:29,  3.36it/s]    cache-oblivious:auto/inputs VALIDATE:  53%|█████▎    | 341/640 [02:05<01:52,  2.67it/s]    cache-oblivious:auto/inputs_prompt EXPORT:  53%|█████▎    | 341/640 [02:05<01:52,  2.67it/s]    cache-oblivious:auto/inputs2 EXPORT:  53%|█████▎    | 341/640 [02:05<01:52,  2.67it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto/inputs2 VALIDATE:  53%|█████▎    | 341/640 [02:06<01:52,  2.67it/s]    cache-oblivious:auto/inputs2 VALIDATE:  54%|█████▎    | 343/640 [02:06<02:03,  2.40it/s]    cache-oblivious:auto/inputs_empty_cache EXPORT:  54%|█████▎    | 343/640 [02:06<02:03,  2.40it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto/inputs_empty_cache VALIDATE:  54%|█████▎    | 343/640 [02:07<02:03,  2.40it/s]    cache-oblivious:auto/inputs_empty_cache VALIDATE:  54%|█████▍    | 344/640 [02:07<02:31,  1.95it/s]    cache-oblivious:auto/inputs_batch1 EXPORT:  54%|█████▍    | 344/640 [02:07<02:31,  1.95it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto/inputs_batch1 VALIDATE:  54%|█████▍    | 344/640 [02:08<02:31,  1.95it/s]    cache-oblivious:auto/inputs_batch1 VALIDATE:  54%|█████▍    | 345/640 [02:08<03:01,  1.62it/s]    cache-oblivious:auto-rt/inputs EXPORT:  54%|█████▍    | 345/640 [02:08<03:01,  1.62it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto-rt/inputs VALIDATE:  54%|█████▍    | 345/640 [02:10<03:01,  1.62it/s]    cache-oblivious:auto-rt/inputs VALIDATE:  54%|█████▍    | 346/640 [02:10<03:36,  1.36it/s]    cache-oblivious:auto-rt/inputs_prompt EXPORT:  54%|█████▍    | 346/640 [02:10<03:36,  1.36it/s]    cache-oblivious:auto-rt/inputs2 EXPORT:  54%|█████▍    | 346/640 [02:10<03:36,  1.36it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto-rt/inputs2 VALIDATE:  54%|█████▍    | 346/640 [02:11<03:36,  1.36it/s]    cache-oblivious:auto-rt/inputs2 VALIDATE:  54%|█████▍    | 348/640 [02:11<03:31,  1.38it/s]    cache-oblivious:auto-rt/inputs_empty_cache EXPORT:  54%|█████▍    | 348/640 [02:11<03:31,  1.38it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto-rt/inputs_empty_cache VALIDATE:  54%|█████▍    | 348/640 [02:12<03:31,  1.38it/s]    cache-oblivious:auto-rt/inputs_empty_cache VALIDATE:  55%|█████▍    | 349/640 [02:12<03:58,  1.22it/s]    cache-oblivious:auto-rt/inputs_batch1 EXPORT:  55%|█████▍    | 349/640 [02:12<03:58,  1.22it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-oblivious:auto-rt/inputs_batch1 VALIDATE:  55%|█████▍    | 349/640 [02:13<03:58,  1.22it/s]    cache-oblivious:auto-rt/inputs_batch1 VALIDATE:  55%|█████▍    | 350/640 [02:14<04:25,  1.09it/s]    cache-oblivious:half/inputs EXPORT:  55%|█████▍    | 350/640 [02:14<04:25,  1.09it/s]                cache-oblivious:half/inputs VALIDATE:  55%|█████▍    | 350/640 [02:16<04:25,  1.09it/s]    cache-oblivious:half/inputs VALIDATE:  55%|█████▍    | 351/640 [02:16<06:16,  1.30s/it]    cache-oblivious:half/inputs_prompt EXPORT:  55%|█████▍    | 351/640 [02:16<06:16,  1.30s/it]    cache-oblivious:half/inputs2 EXPORT:  55%|█████▍    | 351/640 [02:16<06:16,  1.30s/it]          cache-oblivious:half/inputs2 VALIDATE:  55%|█████▍    | 351/640 [02:17<06:16,  1.30s/it]    cache-oblivious:half/inputs2 VALIDATE:  55%|█████▌    | 353/640 [02:18<04:57,  1.04s/it]    cache-oblivious:half/inputs_empty_cache EXPORT:  55%|█████▌    | 353/640 [02:18<04:57,  1.04s/it]    cache-oblivious:half/inputs_empty_cache VALIDATE:  55%|█████▌    | 353/640 [02:19<04:57,  1.04s/it]    cache-oblivious:half/inputs_empty_cache VALIDATE:  55%|█████▌    | 354/640 [02:19<05:15,  1.10s/it]    cache-oblivious:half/inputs_batch1 EXPORT:  55%|█████▌    | 354/640 [02:19<05:15,  1.10s/it]           cache-oblivious:half/inputs_batch1 VALIDATE:  55%|█████▌    | 354/640 [02:20<05:15,  1.10s/it]    cache-oblivious:half/inputs_batch1 VALIDATE:  55%|█████▌    | 355/640 [02:20<05:23,  1.13s/it]    cache-oblivious:half-rt/inputs EXPORT:  55%|█████▌    | 355/640 [02:20<05:23,  1.13s/it]          cache-oblivious:half-rt/inputs VALIDATE:  55%|█████▌    | 355/640 [02:21<05:23,  1.13s/it]    cache-oblivious:half-rt/inputs VALIDATE:  56%|█████▌    | 356/640 [02:21<05:34,  1.18s/it]    cache-oblivious:half-rt/inputs_prompt EXPORT:  56%|█████▌    | 356/640 [02:21<05:34,  1.18s/it]    cache-oblivious:half-rt/inputs2 EXPORT:  56%|█████▌    | 356/640 [02:21<05:34,  1.18s/it]          cache-oblivious:half-rt/inputs2 VALIDATE:  56%|█████▌    | 356/640 [02:23<05:34,  1.18s/it]    cache-oblivious:half-rt/inputs2 VALIDATE:  56%|█████▌    | 358/640 [02:23<04:36,  1.02it/s]    cache-oblivious:half-rt/inputs_empty_cache EXPORT:  56%|█████▌    | 358/640 [02:23<04:36,  1.02it/s]    cache-oblivious:half-rt/inputs_empty_cache VALIDATE:  56%|█████▌    | 358/640 [02:24<04:36,  1.02it/s]    cache-oblivious:half-rt/inputs_empty_cache VALIDATE:  56%|█████▌    | 359/640 [02:24<05:00,  1.07s/it]    cache-oblivious:half-rt/inputs_batch1 EXPORT:  56%|█████▌    | 359/640 [02:24<05:00,  1.07s/it]           cache-oblivious:half-rt/inputs_batch1 VALIDATE:  56%|█████▌    | 359/640 [02:25<05:00,  1.07s/it]    cache-oblivious:half-rt/inputs_batch1 VALIDATE:  56%|█████▋    | 360/640 [02:26<05:17,  1.14s/it]    cache-strict/inputs EXPORT:  56%|█████▋    | 360/640 [02:26<05:17,  1.14s/it]                    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-strict/inputs EXPORT:  56%|█████▋    | 361/640 [02:27<05:28,  1.18s/it]    cache-strict/inputs_prompt EXPORT:  56%|█████▋    | 361/640 [02:27<05:28,  1.18s/it]    cache-strict/inputs2 EXPORT:  56%|█████▋    | 361/640 [02:27<05:28,  1.18s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-strict/inputs2 EXPORT:  57%|█████▋    | 363/640 [02:28<04:24,  1.05it/s]    cache-strict/inputs_empty_cache EXPORT:  57%|█████▋    | 363/640 [02:28<04:24,  1.05it/s]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-strict/inputs_empty_cache EXPORT:  57%|█████▋    | 364/640 [02:29<04:37,  1.01s/it]    cache-strict/inputs_batch1 EXPORT:  57%|█████▋    | 364/640 [02:29<04:37,  1.01s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-strict/inputs_batch1 EXPORT:  57%|█████▋    | 365/640 [02:31<05:49,  1.27s/it]    cache-rt-strict/inputs EXPORT:  57%|█████▋    | 365/640 [02:31<05:49,  1.27s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-rt-strict/inputs EXPORT:  57%|█████▋    | 366/640 [02:34<07:10,  1.57s/it]    cache-rt-strict/inputs_prompt EXPORT:  57%|█████▋    | 366/640 [02:34<07:10,  1.57s/it]    cache-rt-strict/inputs2 EXPORT:  57%|█████▋    | 366/640 [02:34<07:10,  1.57s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-rt-strict/inputs2 EXPORT:  57%|█████▊    | 368/640 [02:36<06:23,  1.41s/it]    cache-rt-strict/inputs_empty_cache EXPORT:  57%|█████▊    | 368/640 [02:36<06:23,  1.41s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-rt-strict/inputs_empty_cache EXPORT:  58%|█████▊    | 369/640 [02:40<08:54,  1.97s/it]    cache-rt-strict/inputs_batch1 EXPORT:  58%|█████▊    | 369/640 [02:40<08:54,  1.97s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-rt-strict/inputs_batch1 EXPORT:  58%|█████▊    | 370/640 [02:42<08:57,  1.99s/it]    cache-oblivious-strict/inputs EXPORT:  58%|█████▊    | 370/640 [02:42<08:57,  1.99s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-strict/inputs EXPORT:  58%|█████▊    | 371/640 [02:43<08:06,  1.81s/it]    cache-oblivious-strict/inputs_prompt EXPORT:  58%|█████▊    | 371/640 [02:43<08:06,  1.81s/it]    cache-oblivious-strict/inputs2 EXPORT:  58%|█████▊    | 371/640 [02:43<08:06,  1.81s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-strict/inputs2 EXPORT:  58%|█████▊    | 373/640 [02:45<05:45,  1.29s/it]    cache-oblivious-strict/inputs_empty_cache EXPORT:  58%|█████▊    | 373/640 [02:45<05:45,  1.29s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-strict/inputs_empty_cache EXPORT:  58%|█████▊    | 374/640 [02:46<05:35,  1.26s/it]    cache-oblivious-strict/inputs_batch1 EXPORT:  58%|█████▊    | 374/640 [02:46<05:35,  1.26s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-strict/inputs_batch1 EXPORT:  59%|█████▊    | 375/640 [02:48<06:27,  1.46s/it]    cache-oblivious-rt-strict/inputs EXPORT:  59%|█████▊    | 375/640 [02:48<06:27,  1.46s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-rt-strict/inputs EXPORT:  59%|█████▉    | 376/640 [02:50<07:04,  1.61s/it]    cache-oblivious-rt-strict/inputs_prompt EXPORT:  59%|█████▉    | 376/640 [02:50<07:04,  1.61s/it]    cache-oblivious-rt-strict/inputs2 EXPORT:  59%|█████▉    | 376/640 [02:50<07:04,  1.61s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-rt-strict/inputs2 EXPORT:  59%|█████▉    | 378/640 [02:52<05:52,  1.34s/it]    cache-oblivious-rt-strict/inputs_empty_cache EXPORT:  59%|█████▉    | 378/640 [02:52<05:52,  1.34s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-rt-strict/inputs_empty_cache EXPORT:  59%|█████▉    | 379/640 [02:54<06:41,  1.54s/it]    cache-oblivious-rt-strict/inputs_batch1 EXPORT:  59%|█████▉    | 379/640 [02:54<06:41,  1.54s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious-rt-strict/inputs_batch1 EXPORT:  59%|█████▉    | 380/640 [02:56<07:05,  1.63s/it]    cache-oblivious:auto-strict/inputs EXPORT:  59%|█████▉    | 380/640 [02:56<07:05,  1.63s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-strict/inputs EXPORT:  60%|█████▉    | 381/640 [02:57<06:32,  1.52s/it]    cache-oblivious:auto-strict/inputs_prompt EXPORT:  60%|█████▉    | 381/640 [02:57<06:32,  1.52s/it]    cache-oblivious:auto-strict/inputs2 EXPORT:  60%|█████▉    | 381/640 [02:57<06:32,  1.52s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-strict/inputs2 EXPORT:  60%|█████▉    | 383/640 [03:00<05:59,  1.40s/it]    cache-oblivious:auto-strict/inputs_empty_cache EXPORT:  60%|█████▉    | 383/640 [03:00<05:59,  1.40s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-strict/inputs_empty_cache EXPORT:  60%|██████    | 384/640 [03:01<05:41,  1.33s/it]    cache-oblivious:auto-strict/inputs_batch1 EXPORT:  60%|██████    | 384/640 [03:01<05:41,  1.33s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-strict/inputs_batch1 EXPORT:  60%|██████    | 385/640 [03:03<06:44,  1.59s/it]    cache-oblivious:auto-rt-strict/inputs EXPORT:  60%|██████    | 385/640 [03:03<06:44,  1.59s/it]    /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-rt-strict/inputs EXPORT:  60%|██████    | 386/640 [03:05<07:28,  1.76s/it]    cache-oblivious:auto-rt-strict/inputs_prompt EXPORT:  60%|██████    | 386/640 [03:05<07:28,  1.76s/it]    cache-oblivious:auto-rt-strict/inputs2 EXPORT:  60%|██████    | 386/640 [03:05<07:28,  1.76s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-rt-strict/inputs2 EXPORT:  61%|██████    | 388/640 [03:08<06:23,  1.52s/it]    cache-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  61%|██████    | 388/640 [03:08<06:23,  1.52s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  61%|██████    | 389/640 [03:10<07:03,  1.69s/it]    cache-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  61%|██████    | 389/640 [03:10<07:03,  1.69s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  61%|██████    | 390/640 [03:12<07:32,  1.81s/it]    cache-oblivious:half-strict/inputs EXPORT:  61%|██████    | 390/640 [03:12<07:32,  1.81s/it]          /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-strict/inputs EXPORT:  61%|██████    | 391/640 [03:13<06:46,  1.63s/it]    cache-oblivious:half-strict/inputs_prompt EXPORT:  61%|██████    | 391/640 [03:13<06:46,  1.63s/it]    cache-oblivious:half-strict/inputs2 EXPORT:  61%|██████    | 391/640 [03:13<06:46,  1.63s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-strict/inputs2 EXPORT:  61%|██████▏   | 393/640 [03:14<04:48,  1.17s/it]    cache-oblivious:half-strict/inputs_empty_cache EXPORT:  61%|██████▏   | 393/640 [03:14<04:48,  1.17s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-strict/inputs_empty_cache EXPORT:  62%|██████▏   | 394/640 [03:15<04:39,  1.14s/it]    cache-oblivious:half-strict/inputs_batch1 EXPORT:  62%|██████▏   | 394/640 [03:15<04:39,  1.14s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-strict/inputs_batch1 EXPORT:  62%|██████▏   | 395/640 [03:17<05:28,  1.34s/it]    cache-oblivious:half-rt-strict/inputs EXPORT:  62%|██████▏   | 395/640 [03:17<05:28,  1.34s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-rt-strict/inputs EXPORT:  62%|██████▏   | 396/640 [03:19<06:11,  1.52s/it]    cache-oblivious:half-rt-strict/inputs_prompt EXPORT:  62%|██████▏   | 396/640 [03:19<06:11,  1.52s/it]    cache-oblivious:half-rt-strict/inputs2 EXPORT:  62%|██████▏   | 396/640 [03:19<06:11,  1.52s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-rt-strict/inputs2 EXPORT:  62%|██████▏   | 398/640 [03:21<05:14,  1.30s/it]    cache-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  62%|██████▏   | 398/640 [03:21<05:14,  1.30s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  62%|██████▏   | 399/640 [03:25<07:33,  1.88s/it]    cache-oblivious:half-rt-strict/inputs_batch1 EXPORT:  62%|██████▏   | 399/640 [03:25<07:33,  1.88s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-oblivious:half-rt-strict/inputs_batch1 EXPORT:  62%|██████▎   | 400/640 [03:27<07:49,  1.95s/it]    cache-cache_patch:all/inputs EXPORT:  62%|██████▎   | 400/640 [03:27<07:49,  1.95s/it]                    cache-cache_patch:all/inputs EXPORT:  63%|██████▎   | 401/640 [03:28<06:56,  1.74s/it]    cache-cache_patch:all/inputs_prompt EXPORT:  63%|██████▎   | 401/640 [03:28<06:56,  1.74s/it]    cache-cache_patch:all/inputs2 EXPORT:  63%|██████▎   | 401/640 [03:28<06:56,  1.74s/it]          cache-cache_patch:all/inputs2 EXPORT:  63%|██████▎   | 403/640 [03:29<04:36,  1.17s/it]    cache-cache_patch:all/inputs_empty_cache EXPORT:  63%|██████▎   | 403/640 [03:29<04:36,  1.17s/it]    cache-cache_patch:all/inputs_empty_cache EXPORT:  63%|██████▎   | 404/640 [03:30<04:04,  1.04s/it]    cache-cache_patch:all/inputs_batch1 EXPORT:  63%|██████▎   | 404/640 [03:30<04:04,  1.04s/it]         cache-cache_patch:all/inputs_batch1 VALIDATE:  63%|██████▎   | 404/640 [03:31<04:04,  1.04s/it]    cache-cache_patch:all/inputs_batch1 VALIDATE:  63%|██████▎   | 405/640 [03:31<04:17,  1.10s/it]    cache-cache_patch:all-rt/inputs EXPORT:  63%|██████▎   | 405/640 [03:31<04:17,  1.10s/it]          cache-cache_patch:all-rt/inputs EXPORT:  63%|██████▎   | 406/640 [03:32<04:15,  1.09s/it]    cache-cache_patch:all-rt/inputs_prompt EXPORT:  63%|██████▎   | 406/640 [03:32<04:15,  1.09s/it]    cache-cache_patch:all-rt/inputs2 EXPORT:  63%|██████▎   | 406/640 [03:32<04:15,  1.09s/it]          cache-cache_patch:all-rt/inputs2 EXPORT:  64%|██████▍   | 408/640 [03:33<03:02,  1.27it/s]    cache-cache_patch:all-rt/inputs_empty_cache EXPORT:  64%|██████▍   | 408/640 [03:33<03:02,  1.27it/s]    cache-cache_patch:all-rt/inputs_empty_cache EXPORT:  64%|██████▍   | 409/640 [03:34<02:55,  1.32it/s]    cache-cache_patch:all-rt/inputs_batch1 EXPORT:  64%|██████▍   | 409/640 [03:34<02:55,  1.32it/s]         cache-cache_patch:all-rt/inputs_batch1 VALIDATE:  64%|██████▍   | 409/640 [03:35<02:55,  1.32it/s]    cache-cache_patch:all-rt/inputs_batch1 VALIDATE:  64%|██████▍   | 410/640 [03:35<03:40,  1.04it/s]    cache-cache_patch:all-oblivious/inputs EXPORT:  64%|██████▍   | 410/640 [03:35<03:40,  1.04it/s]      cache-cache_patch:all-oblivious/inputs VALIDATE:  64%|██████▍   | 410/640 [03:37<03:40,  1.04it/s]    cache-cache_patch:all-oblivious/inputs VALIDATE:  64%|██████▍   | 411/640 [03:37<04:31,  1.19s/it]    cache-cache_patch:all-oblivious/inputs_prompt EXPORT:  64%|██████▍   | 411/640 [03:37<04:31,  1.19s/it]    cache-cache_patch:all-oblivious/inputs2 EXPORT:  64%|██████▍   | 411/640 [03:37<04:31,  1.19s/it]          cache-cache_patch:all-oblivious/inputs2 VALIDATE:  64%|██████▍   | 411/640 [03:39<04:31,  1.19s/it]    cache-cache_patch:all-oblivious/inputs2 VALIDATE:  65%|██████▍   | 413/640 [03:39<03:56,  1.04s/it]    cache-cache_patch:all-oblivious/inputs_empty_cache EXPORT:  65%|██████▍   | 413/640 [03:39<03:56,  1.04s/it]    cache-cache_patch:all-oblivious/inputs_empty_cache VALIDATE:  65%|██████▍   | 413/640 [03:40<03:56,  1.04s/it]    cache-cache_patch:all-oblivious/inputs_empty_cache VALIDATE:  65%|██████▍   | 414/640 [03:40<04:13,  1.12s/it]    cache-cache_patch:all-oblivious/inputs_batch1 EXPORT:  65%|██████▍   | 414/640 [03:40<04:13,  1.12s/it]           cache-cache_patch:all-oblivious/inputs_batch1 VALIDATE:  65%|██████▍   | 414/640 [03:41<04:13,  1.12s/it]    cache-cache_patch:all-oblivious/inputs_batch1 VALIDATE:  65%|██████▍   | 415/640 [03:42<04:32,  1.21s/it]    cache-cache_patch:all-oblivious-rt/inputs EXPORT:  65%|██████▍   | 415/640 [03:42<04:32,  1.21s/it]          cache-cache_patch:all-oblivious-rt/inputs VALIDATE:  65%|██████▍   | 415/640 [03:43<04:32,  1.21s/it]    cache-cache_patch:all-oblivious-rt/inputs VALIDATE:  65%|██████▌   | 416/640 [03:43<04:49,  1.29s/it]    cache-cache_patch:all-oblivious-rt/inputs_prompt EXPORT:  65%|██████▌   | 416/640 [03:43<04:49,  1.29s/it]    cache-cache_patch:all-oblivious-rt/inputs2 EXPORT:  65%|██████▌   | 416/640 [03:43<04:49,  1.29s/it]          cache-cache_patch:all-oblivious-rt/inputs2 VALIDATE:  65%|██████▌   | 416/640 [03:45<04:49,  1.29s/it]    cache-cache_patch:all-oblivious-rt/inputs2 VALIDATE:  65%|██████▌   | 418/640 [03:45<04:06,  1.11s/it]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache EXPORT:  65%|██████▌   | 418/640 [03:45<04:06,  1.11s/it]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache VALIDATE:  65%|██████▌   | 418/640 [03:46<04:06,  1.11s/it]    cache-cache_patch:all-oblivious-rt/inputs_empty_cache VALIDATE:  65%|██████▌   | 419/640 [03:46<04:28,  1.22s/it]    cache-cache_patch:all-oblivious-rt/inputs_batch1 EXPORT:  65%|██████▌   | 419/640 [03:46<04:28,  1.22s/it]           cache-cache_patch:all-oblivious-rt/inputs_batch1 VALIDATE:  65%|██████▌   | 419/640 [03:48<04:28,  1.22s/it]    cache-cache_patch:all-oblivious-rt/inputs_batch1 VALIDATE:  66%|██████▌   | 420/640 [03:48<05:06,  1.39s/it]    cache-cache_patch:all-oblivious:auto/inputs EXPORT:  66%|██████▌   | 420/640 [03:48<05:06,  1.39s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto/inputs EXPORT:  66%|██████▌   | 421/640 [03:49<04:37,  1.27s/it]    cache-cache_patch:all-oblivious:auto/inputs_prompt EXPORT:  66%|██████▌   | 421/640 [03:49<04:37,  1.27s/it]    cache-cache_patch:all-oblivious:auto/inputs2 EXPORT:  66%|██████▌   | 421/640 [03:49<04:37,  1.27s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto/inputs2 EXPORT:  66%|██████▌   | 423/640 [03:50<03:06,  1.17it/s]    cache-cache_patch:all-oblivious:auto/inputs_empty_cache EXPORT:  66%|██████▌   | 423/640 [03:50<03:06,  1.17it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto/inputs_empty_cache VALIDATE:  66%|██████▌   | 423/640 [03:51<03:06,  1.17it/s]    cache-cache_patch:all-oblivious:auto/inputs_empty_cache VALIDATE:  66%|██████▋   | 424/640 [03:51<03:30,  1.03it/s]    cache-cache_patch:all-oblivious:auto/inputs_batch1 EXPORT:  66%|██████▋   | 424/640 [03:51<03:30,  1.03it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto/inputs_batch1 VALIDATE:  66%|██████▋   | 424/640 [03:52<03:30,  1.03it/s]    cache-cache_patch:all-oblivious:auto/inputs_batch1 VALIDATE:  66%|██████▋   | 425/640 [03:53<03:52,  1.08s/it]    cache-cache_patch:all-oblivious:auto-rt/inputs EXPORT:  66%|██████▋   | 425/640 [03:53<03:52,  1.08s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt/inputs EXPORT:  67%|██████▋   | 426/640 [03:55<05:12,  1.46s/it]    cache-cache_patch:all-oblivious:auto-rt/inputs_prompt EXPORT:  67%|██████▋   | 426/640 [03:55<05:12,  1.46s/it]    cache-cache_patch:all-oblivious:auto-rt/inputs2 EXPORT:  67%|██████▋   | 426/640 [03:55<05:12,  1.46s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt/inputs2 EXPORT:  67%|██████▋   | 428/640 [03:56<03:25,  1.03it/s]    cache-cache_patch:all-oblivious:auto-rt/inputs_empty_cache EXPORT:  67%|██████▋   | 428/640 [03:56<03:25,  1.03it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt/inputs_empty_cache VALIDATE:  67%|██████▋   | 428/640 [03:57<03:25,  1.03it/s]    cache-cache_patch:all-oblivious:auto-rt/inputs_empty_cache VALIDATE:  67%|██████▋   | 429/640 [03:57<03:47,  1.08s/it]    cache-cache_patch:all-oblivious:auto-rt/inputs_batch1 EXPORT:  67%|██████▋   | 429/640 [03:57<03:47,  1.08s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt/inputs_batch1 VALIDATE:  67%|██████▋   | 429/640 [03:58<03:47,  1.08s/it]    cache-cache_patch:all-oblivious:auto-rt/inputs_batch1 VALIDATE:  67%|██████▋   | 430/640 [03:59<03:58,  1.14s/it]    cache-cache_patch:all-oblivious:half/inputs EXPORT:  67%|██████▋   | 430/640 [03:59<03:58,  1.14s/it]                cache-cache_patch:all-oblivious:half/inputs VALIDATE:  67%|██████▋   | 430/640 [04:00<03:58,  1.14s/it]    cache-cache_patch:all-oblivious:half/inputs VALIDATE:  67%|██████▋   | 431/640 [04:00<04:11,  1.20s/it]    cache-cache_patch:all-oblivious:half/inputs_prompt EXPORT:  67%|██████▋   | 431/640 [04:00<04:11,  1.20s/it]    cache-cache_patch:all-oblivious:half/inputs2 EXPORT:  67%|██████▋   | 431/640 [04:00<04:11,  1.20s/it]          cache-cache_patch:all-oblivious:half/inputs2 VALIDATE:  67%|██████▋   | 431/640 [04:01<04:11,  1.20s/it]    cache-cache_patch:all-oblivious:half/inputs2 VALIDATE:  68%|██████▊   | 433/640 [04:01<03:24,  1.01it/s]    cache-cache_patch:all-oblivious:half/inputs_empty_cache EXPORT:  68%|██████▊   | 433/640 [04:01<03:24,  1.01it/s]    cache-cache_patch:all-oblivious:half/inputs_empty_cache VALIDATE:  68%|██████▊   | 433/640 [04:02<03:24,  1.01it/s]    cache-cache_patch:all-oblivious:half/inputs_empty_cache VALIDATE:  68%|██████▊   | 434/640 [04:03<03:40,  1.07s/it]    cache-cache_patch:all-oblivious:half/inputs_batch1 EXPORT:  68%|██████▊   | 434/640 [04:03<03:40,  1.07s/it]           cache-cache_patch:all-oblivious:half/inputs_batch1 VALIDATE:  68%|██████▊   | 434/640 [04:04<03:40,  1.07s/it]    cache-cache_patch:all-oblivious:half/inputs_batch1 VALIDATE:  68%|██████▊   | 435/640 [04:04<03:59,  1.17s/it]    cache-cache_patch:all-oblivious:half-rt/inputs EXPORT:  68%|██████▊   | 435/640 [04:04<03:59,  1.17s/it]          cache-cache_patch:all-oblivious:half-rt/inputs VALIDATE:  68%|██████▊   | 435/640 [04:05<03:59,  1.17s/it]    cache-cache_patch:all-oblivious:half-rt/inputs VALIDATE:  68%|██████▊   | 436/640 [04:06<04:12,  1.24s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_prompt EXPORT:  68%|██████▊   | 436/640 [04:06<04:12,  1.24s/it]    cache-cache_patch:all-oblivious:half-rt/inputs2 EXPORT:  68%|██████▊   | 436/640 [04:06<04:12,  1.24s/it]          cache-cache_patch:all-oblivious:half-rt/inputs2 VALIDATE:  68%|██████▊   | 436/640 [04:07<04:12,  1.24s/it]    cache-cache_patch:all-oblivious:half-rt/inputs2 VALIDATE:  68%|██████▊   | 438/640 [04:07<03:24,  1.01s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_empty_cache EXPORT:  68%|██████▊   | 438/640 [04:07<03:24,  1.01s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_empty_cache VALIDATE:  68%|██████▊   | 438/640 [04:08<03:24,  1.01s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_empty_cache VALIDATE:  69%|██████▊   | 439/640 [04:08<03:39,  1.09s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_batch1 EXPORT:  69%|██████▊   | 439/640 [04:08<03:39,  1.09s/it]           cache-cache_patch:all-oblivious:half-rt/inputs_batch1 VALIDATE:  69%|██████▊   | 439/640 [04:10<03:39,  1.09s/it]    cache-cache_patch:all-oblivious:half-rt/inputs_batch1 VALIDATE:  69%|██████▉   | 440/640 [04:10<03:54,  1.17s/it]    cache-cache_patch:all-strict/inputs EXPORT:  69%|██████▉   | 440/640 [04:10<03:54,  1.17s/it]                        cache-cache_patch:all-strict/inputs EXPORT:  69%|██████▉   | 441/640 [04:11<03:34,  1.08s/it]    cache-cache_patch:all-strict/inputs_prompt EXPORT:  69%|██████▉   | 441/640 [04:11<03:34,  1.08s/it]    cache-cache_patch:all-strict/inputs2 EXPORT:  69%|██████▉   | 441/640 [04:11<03:34,  1.08s/it]          cache-cache_patch:all-strict/inputs2 EXPORT:  69%|██████▉   | 443/640 [04:11<02:31,  1.30it/s]    cache-cache_patch:all-strict/inputs_empty_cache EXPORT:  69%|██████▉   | 443/640 [04:11<02:31,  1.30it/s]    cache-cache_patch:all-strict/inputs_empty_cache EXPORT:  69%|██████▉   | 444/640 [04:12<02:29,  1.31it/s]    cache-cache_patch:all-strict/inputs_batch1 EXPORT:  69%|██████▉   | 444/640 [04:12<02:29,  1.31it/s]         cache-cache_patch:all-strict/inputs_batch1 EXPORT:  70%|██████▉   | 445/640 [04:13<02:20,  1.39it/s]    cache-cache_patch:all-rt-strict/inputs EXPORT:  70%|██████▉   | 445/640 [04:13<02:20,  1.39it/s]        cache-cache_patch:all-rt-strict/inputs EXPORT:  70%|██████▉   | 446/640 [04:13<02:19,  1.39it/s]    cache-cache_patch:all-rt-strict/inputs_prompt EXPORT:  70%|██████▉   | 446/640 [04:13<02:19,  1.39it/s]    cache-cache_patch:all-rt-strict/inputs2 EXPORT:  70%|██████▉   | 446/640 [04:13<02:19,  1.39it/s]          cache-cache_patch:all-rt-strict/inputs2 EXPORT:  70%|███████   | 448/640 [04:14<01:48,  1.77it/s]    cache-cache_patch:all-rt-strict/inputs_empty_cache EXPORT:  70%|███████   | 448/640 [04:14<01:48,  1.77it/s]    cache-cache_patch:all-rt-strict/inputs_empty_cache EXPORT:  70%|███████   | 449/640 [04:15<01:54,  1.67it/s]    cache-cache_patch:all-rt-strict/inputs_batch1 EXPORT:  70%|███████   | 449/640 [04:15<01:54,  1.67it/s]         cache-cache_patch:all-rt-strict/inputs_batch1 EXPORT:  70%|███████   | 450/640 [04:15<01:54,  1.66it/s]    cache-cache_patch:all-oblivious-strict/inputs EXPORT:  70%|███████   | 450/640 [04:15<01:54,  1.66it/s]    cache-cache_patch:all-oblivious-strict/inputs EXPORT:  70%|███████   | 451/640 [04:16<02:07,  1.48it/s]    cache-cache_patch:all-oblivious-strict/inputs_prompt EXPORT:  70%|███████   | 451/640 [04:16<02:07,  1.48it/s]    cache-cache_patch:all-oblivious-strict/inputs2 EXPORT:  70%|███████   | 451/640 [04:16<02:07,  1.48it/s]          cache-cache_patch:all-oblivious-strict/inputs2 EXPORT:  71%|███████   | 453/640 [04:17<01:42,  1.83it/s]    cache-cache_patch:all-oblivious-strict/inputs_empty_cache EXPORT:  71%|███████   | 453/640 [04:17<01:42,  1.83it/s]    cache-cache_patch:all-oblivious-strict/inputs_empty_cache EXPORT:  71%|███████   | 454/640 [04:18<01:47,  1.74it/s]    cache-cache_patch:all-oblivious-strict/inputs_batch1 EXPORT:  71%|███████   | 454/640 [04:18<01:47,  1.74it/s]         cache-cache_patch:all-oblivious-strict/inputs_batch1 EXPORT:  71%|███████   | 455/640 [04:18<01:55,  1.60it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs EXPORT:  71%|███████   | 455/640 [04:18<01:55,  1.60it/s]        cache-cache_patch:all-oblivious-rt-strict/inputs EXPORT:  71%|███████▏  | 456/640 [04:19<01:58,  1.55it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs_prompt EXPORT:  71%|███████▏  | 456/640 [04:19<01:58,  1.55it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs2 EXPORT:  71%|███████▏  | 456/640 [04:19<01:58,  1.55it/s]          cache-cache_patch:all-oblivious-rt-strict/inputs2 EXPORT:  72%|███████▏  | 458/640 [04:20<01:33,  1.95it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs_empty_cache EXPORT:  72%|███████▏  | 458/640 [04:20<01:33,  1.95it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs_empty_cache EXPORT:  72%|███████▏  | 459/640 [04:22<02:53,  1.04it/s]    cache-cache_patch:all-oblivious-rt-strict/inputs_batch1 EXPORT:  72%|███████▏  | 459/640 [04:22<02:53,  1.04it/s]         cache-cache_patch:all-oblivious-rt-strict/inputs_batch1 EXPORT:  72%|███████▏  | 460/640 [04:23<02:44,  1.09it/s]    cache-cache_patch:all-oblivious:auto-strict/inputs EXPORT:  72%|███████▏  | 460/640 [04:23<02:44,  1.09it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-strict/inputs EXPORT:  72%|███████▏  | 461/640 [04:24<02:40,  1.11it/s]    cache-cache_patch:all-oblivious:auto-strict/inputs_prompt EXPORT:  72%|███████▏  | 461/640 [04:24<02:40,  1.11it/s]    cache-cache_patch:all-oblivious:auto-strict/inputs2 EXPORT:  72%|███████▏  | 461/640 [04:24<02:40,  1.11it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-strict/inputs2 EXPORT:  72%|███████▏  | 463/640 [04:25<01:57,  1.50it/s]    cache-cache_patch:all-oblivious:auto-strict/inputs_empty_cache EXPORT:  72%|███████▏  | 463/640 [04:25<01:57,  1.50it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-strict/inputs_empty_cache EXPORT:  72%|███████▎  | 464/640 [04:25<01:58,  1.49it/s]    cache-cache_patch:all-oblivious:auto-strict/inputs_batch1 EXPORT:  72%|███████▎  | 464/640 [04:25<01:58,  1.49it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-strict/inputs_batch1 EXPORT:  73%|███████▎  | 465/640 [04:26<02:11,  1.33it/s]    cache-cache_patch:all-oblivious:auto-rt-strict/inputs EXPORT:  73%|███████▎  | 465/640 [04:26<02:11,  1.33it/s]    /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt-strict/inputs EXPORT:  73%|███████▎  | 466/640 [04:27<02:08,  1.36it/s]    cache-cache_patch:all-oblivious:auto-rt-strict/inputs_prompt EXPORT:  73%|███████▎  | 466/640 [04:27<02:08,  1.36it/s]    cache-cache_patch:all-oblivious:auto-rt-strict/inputs2 EXPORT:  73%|███████▎  | 466/640 [04:27<02:08,  1.36it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt-strict/inputs2 EXPORT:  73%|███████▎  | 468/640 [04:28<01:42,  1.68it/s]    cache-cache_patch:all-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  73%|███████▎  | 468/640 [04:28<01:42,  1.68it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  73%|███████▎  | 469/640 [04:29<01:48,  1.58it/s]    cache-cache_patch:all-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  73%|███████▎  | 469/640 [04:29<01:48,  1.58it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:all-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  73%|███████▎  | 470/640 [04:29<01:55,  1.47it/s]    cache-cache_patch:all-oblivious:half-strict/inputs EXPORT:  73%|███████▎  | 470/640 [04:29<01:55,  1.47it/s]              cache-cache_patch:all-oblivious:half-strict/inputs EXPORT:  74%|███████▎  | 471/640 [04:30<02:01,  1.39it/s]    cache-cache_patch:all-oblivious:half-strict/inputs_prompt EXPORT:  74%|███████▎  | 471/640 [04:30<02:01,  1.39it/s]    cache-cache_patch:all-oblivious:half-strict/inputs2 EXPORT:  74%|███████▎  | 471/640 [04:30<02:01,  1.39it/s]          cache-cache_patch:all-oblivious:half-strict/inputs2 EXPORT:  74%|███████▍  | 473/640 [04:31<01:33,  1.78it/s]    cache-cache_patch:all-oblivious:half-strict/inputs_empty_cache EXPORT:  74%|███████▍  | 473/640 [04:31<01:33,  1.78it/s]    cache-cache_patch:all-oblivious:half-strict/inputs_empty_cache EXPORT:  74%|███████▍  | 474/640 [04:32<01:36,  1.72it/s]    cache-cache_patch:all-oblivious:half-strict/inputs_batch1 EXPORT:  74%|███████▍  | 474/640 [04:32<01:36,  1.72it/s]         cache-cache_patch:all-oblivious:half-strict/inputs_batch1 EXPORT:  74%|███████▍  | 475/640 [04:32<01:45,  1.56it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs EXPORT:  74%|███████▍  | 475/640 [04:32<01:45,  1.56it/s]        cache-cache_patch:all-oblivious:half-rt-strict/inputs EXPORT:  74%|███████▍  | 476/640 [04:33<01:50,  1.49it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs_prompt EXPORT:  74%|███████▍  | 476/640 [04:33<01:50,  1.49it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs2 EXPORT:  74%|███████▍  | 476/640 [04:33<01:50,  1.49it/s]          cache-cache_patch:all-oblivious:half-rt-strict/inputs2 EXPORT:  75%|███████▍  | 478/640 [04:34<01:27,  1.84it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  75%|███████▍  | 478/640 [04:34<01:27,  1.84it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  75%|███████▍  | 479/640 [04:35<01:35,  1.68it/s]    cache-cache_patch:all-oblivious:half-rt-strict/inputs_batch1 EXPORT:  75%|███████▍  | 479/640 [04:35<01:35,  1.68it/s]         cache-cache_patch:all-oblivious:half-rt-strict/inputs_batch1 EXPORT:  75%|███████▌  | 480/640 [04:35<01:40,  1.59it/s]    cache-cache_patch:torch/inputs EXPORT:  75%|███████▌  | 480/640 [04:35<01:40,  1.59it/s]                                  cache-cache_patch:torch/inputs EXPORT:  75%|███████▌  | 481/640 [04:36<01:51,  1.43it/s]    cache-cache_patch:torch/inputs_prompt EXPORT:  75%|███████▌  | 481/640 [04:36<01:51,  1.43it/s]    cache-cache_patch:torch/inputs2 EXPORT:  75%|███████▌  | 481/640 [04:36<01:51,  1.43it/s]          cache-cache_patch:torch/inputs2 EXPORT:  75%|███████▌  | 483/640 [04:37<01:23,  1.87it/s]    cache-cache_patch:torch/inputs_empty_cache EXPORT:  75%|███████▌  | 483/640 [04:37<01:23,  1.87it/s]    cache-cache_patch:torch/inputs_empty_cache EXPORT:  76%|███████▌  | 484/640 [04:37<01:26,  1.81it/s]    cache-cache_patch:torch/inputs_batch1 EXPORT:  76%|███████▌  | 484/640 [04:37<01:26,  1.81it/s]         cache-cache_patch:torch/inputs_batch1 VALIDATE:  76%|███████▌  | 484/640 [04:39<01:26,  1.81it/s]    cache-cache_patch:torch/inputs_batch1 VALIDATE:  76%|███████▌  | 485/640 [04:39<01:59,  1.30it/s]    cache-cache_patch:torch-rt/inputs EXPORT:  76%|███████▌  | 485/640 [04:39<01:59,  1.30it/s]          cache-cache_patch:torch-rt/inputs EXPORT:  76%|███████▌  | 486/640 [04:40<01:57,  1.31it/s]    cache-cache_patch:torch-rt/inputs_prompt EXPORT:  76%|███████▌  | 486/640 [04:40<01:57,  1.31it/s]    cache-cache_patch:torch-rt/inputs2 EXPORT:  76%|███████▌  | 486/640 [04:40<01:57,  1.31it/s]          cache-cache_patch:torch-rt/inputs2 EXPORT:  76%|███████▋  | 488/640 [04:40<01:27,  1.73it/s]    cache-cache_patch:torch-rt/inputs_empty_cache EXPORT:  76%|███████▋  | 488/640 [04:40<01:27,  1.73it/s]    cache-cache_patch:torch-rt/inputs_empty_cache EXPORT:  76%|███████▋  | 489/640 [04:41<01:29,  1.69it/s]    cache-cache_patch:torch-rt/inputs_batch1 EXPORT:  76%|███████▋  | 489/640 [04:41<01:29,  1.69it/s]         cache-cache_patch:torch-rt/inputs_batch1 VALIDATE:  76%|███████▋  | 489/640 [04:42<01:29,  1.69it/s]    cache-cache_patch:torch-rt/inputs_batch1 VALIDATE:  77%|███████▋  | 490/640 [04:42<01:57,  1.28it/s]    cache-cache_patch:torch-oblivious/inputs EXPORT:  77%|███████▋  | 490/640 [04:42<01:57,  1.28it/s]      cache-cache_patch:torch-oblivious/inputs VALIDATE:  77%|███████▋  | 490/640 [04:44<01:57,  1.28it/s]    cache-cache_patch:torch-oblivious/inputs VALIDATE:  77%|███████▋  | 491/640 [04:44<02:29,  1.00s/it]    cache-cache_patch:torch-oblivious/inputs_prompt EXPORT:  77%|███████▋  | 491/640 [04:44<02:29,  1.00s/it]    cache-cache_patch:torch-oblivious/inputs2 EXPORT:  77%|███████▋  | 491/640 [04:44<02:29,  1.00s/it]          cache-cache_patch:torch-oblivious/inputs2 VALIDATE:  77%|███████▋  | 491/640 [04:45<02:29,  1.00s/it]    cache-cache_patch:torch-oblivious/inputs2 VALIDATE:  77%|███████▋  | 493/640 [04:45<02:10,  1.13it/s]    cache-cache_patch:torch-oblivious/inputs_empty_cache EXPORT:  77%|███████▋  | 493/640 [04:45<02:10,  1.13it/s]    cache-cache_patch:torch-oblivious/inputs_empty_cache VALIDATE:  77%|███████▋  | 493/640 [04:47<02:10,  1.13it/s]    cache-cache_patch:torch-oblivious/inputs_empty_cache VALIDATE:  77%|███████▋  | 494/640 [04:47<02:23,  1.02it/s]    cache-cache_patch:torch-oblivious/inputs_batch1 EXPORT:  77%|███████▋  | 494/640 [04:47<02:23,  1.02it/s]           cache-cache_patch:torch-oblivious/inputs_batch1 VALIDATE:  77%|███████▋  | 494/640 [04:48<02:23,  1.02it/s]    cache-cache_patch:torch-oblivious/inputs_batch1 VALIDATE:  77%|███████▋  | 495/640 [04:48<02:43,  1.13s/it]    cache-cache_patch:torch-oblivious-rt/inputs EXPORT:  77%|███████▋  | 495/640 [04:48<02:43,  1.13s/it]          cache-cache_patch:torch-oblivious-rt/inputs VALIDATE:  77%|███████▋  | 495/640 [04:52<02:43,  1.13s/it]    cache-cache_patch:torch-oblivious-rt/inputs VALIDATE:  78%|███████▊  | 496/640 [04:52<04:38,  1.93s/it]    cache-cache_patch:torch-oblivious-rt/inputs_prompt EXPORT:  78%|███████▊  | 496/640 [04:52<04:38,  1.93s/it]    cache-cache_patch:torch-oblivious-rt/inputs2 EXPORT:  78%|███████▊  | 496/640 [04:52<04:38,  1.93s/it]          cache-cache_patch:torch-oblivious-rt/inputs2 VALIDATE:  78%|███████▊  | 496/640 [04:54<04:38,  1.93s/it]    cache-cache_patch:torch-oblivious-rt/inputs2 VALIDATE:  78%|███████▊  | 498/640 [04:54<03:22,  1.42s/it]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache EXPORT:  78%|███████▊  | 498/640 [04:54<03:22,  1.42s/it]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache VALIDATE:  78%|███████▊  | 498/640 [04:55<03:22,  1.42s/it]    cache-cache_patch:torch-oblivious-rt/inputs_empty_cache VALIDATE:  78%|███████▊  | 499/640 [04:55<03:20,  1.42s/it]    cache-cache_patch:torch-oblivious-rt/inputs_batch1 EXPORT:  78%|███████▊  | 499/640 [04:55<03:20,  1.42s/it]           cache-cache_patch:torch-oblivious-rt/inputs_batch1 VALIDATE:  78%|███████▊  | 499/640 [04:57<03:20,  1.42s/it]    cache-cache_patch:torch-oblivious-rt/inputs_batch1 VALIDATE:  78%|███████▊  | 500/640 [04:57<03:21,  1.44s/it]    cache-cache_patch:torch-oblivious:auto/inputs EXPORT:  78%|███████▊  | 500/640 [04:57<03:21,  1.44s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto/inputs EXPORT:  78%|███████▊  | 501/640 [04:58<02:52,  1.24s/it]    cache-cache_patch:torch-oblivious:auto/inputs_prompt EXPORT:  78%|███████▊  | 501/640 [04:58<02:52,  1.24s/it]    cache-cache_patch:torch-oblivious:auto/inputs2 EXPORT:  78%|███████▊  | 501/640 [04:58<02:52,  1.24s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto/inputs2 EXPORT:  79%|███████▊  | 503/640 [04:58<01:55,  1.18it/s]    cache-cache_patch:torch-oblivious:auto/inputs_empty_cache EXPORT:  79%|███████▊  | 503/640 [04:58<01:55,  1.18it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto/inputs_empty_cache VALIDATE:  79%|███████▊  | 503/640 [04:59<01:55,  1.18it/s]    cache-cache_patch:torch-oblivious:auto/inputs_empty_cache VALIDATE:  79%|███████▉  | 504/640 [05:00<02:11,  1.03it/s]    cache-cache_patch:torch-oblivious:auto/inputs_batch1 EXPORT:  79%|███████▉  | 504/640 [05:00<02:11,  1.03it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto/inputs_batch1 VALIDATE:  79%|███████▉  | 504/640 [05:01<02:11,  1.03it/s]    cache-cache_patch:torch-oblivious:auto/inputs_batch1 VALIDATE:  79%|███████▉  | 505/640 [05:01<02:33,  1.14s/it]    cache-cache_patch:torch-oblivious:auto-rt/inputs EXPORT:  79%|███████▉  | 505/640 [05:01<02:33,  1.14s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto-rt/inputs EXPORT:  79%|███████▉  | 506/640 [05:02<02:14,  1.00s/it]    cache-cache_patch:torch-oblivious:auto-rt/inputs_prompt EXPORT:  79%|███████▉  | 506/640 [05:02<02:14,  1.00s/it]    cache-cache_patch:torch-oblivious:auto-rt/inputs2 EXPORT:  79%|███████▉  | 506/640 [05:02<02:14,  1.00s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto-rt/inputs2 EXPORT:  79%|███████▉  | 508/640 [05:02<01:33,  1.42it/s]    cache-cache_patch:torch-oblivious:auto-rt/inputs_empty_cache EXPORT:  79%|███████▉  | 508/640 [05:02<01:33,  1.42it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto-rt/inputs_empty_cache VALIDATE:  79%|███████▉  | 508/640 [05:04<01:33,  1.42it/s]    cache-cache_patch:torch-oblivious:auto-rt/inputs_empty_cache VALIDATE:  80%|███████▉  | 509/640 [05:04<01:52,  1.16it/s]    cache-cache_patch:torch-oblivious:auto-rt/inputs_batch1 EXPORT:  80%|███████▉  | 509/640 [05:04<01:52,  1.16it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:torch-oblivious:auto-rt/inputs_batch1 VALIDATE:  80%|███████▉  | 509/640 [05:05<01:52,  1.16it/s]    cache-cache_patch:torch-oblivious:auto-rt/inputs_batch1 VALIDATE:  80%|███████▉  | 510/640 [05:05<02:11,  1.01s/it]    cache-cache_patch:torch-oblivious:half/inputs EXPORT:  80%|███████▉  | 510/640 [05:05<02:11,  1.01s/it]                cache-cache_patch:torch-oblivious:half/inputs VALIDATE:  80%|███████▉  | 510/640 [05:07<02:11,  1.01s/it]    cache-cache_patch:torch-oblivious:half/inputs VALIDATE:  80%|███████▉  | 511/640 [05:07<02:28,  1.15s/it]    cache-cache_patch:torch-oblivious:half/inputs_prompt EXPORT:  80%|███████▉  | 511/640 [05:07<02:28,  1.15s/it]    cache-cache_patch:torch-oblivious:half/inputs2 EXPORT:  80%|███████▉  | 511/640 [05:07<02:28,  1.15s/it]          cache-cache_patch:torch-oblivious:half/inputs2 VALIDATE:  80%|███████▉  | 511/640 [05:08<02:28,  1.15s/it]    cache-cache_patch:torch-oblivious:half/inputs2 VALIDATE:  80%|████████  | 513/640 [05:08<01:59,  1.06it/s]    cache-cache_patch:torch-oblivious:half/inputs_empty_cache EXPORT:  80%|████████  | 513/640 [05:08<01:59,  1.06it/s]    cache-cache_patch:torch-oblivious:half/inputs_empty_cache VALIDATE:  80%|████████  | 513/640 [05:09<01:59,  1.06it/s]    cache-cache_patch:torch-oblivious:half/inputs_empty_cache VALIDATE:  80%|████████  | 514/640 [05:09<02:10,  1.04s/it]    cache-cache_patch:torch-oblivious:half/inputs_batch1 EXPORT:  80%|████████  | 514/640 [05:09<02:10,  1.04s/it]           cache-cache_patch:torch-oblivious:half/inputs_batch1 VALIDATE:  80%|████████  | 514/640 [05:11<02:10,  1.04s/it]    cache-cache_patch:torch-oblivious:half/inputs_batch1 VALIDATE:  80%|████████  | 515/640 [05:11<02:20,  1.12s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs EXPORT:  80%|████████  | 515/640 [05:11<02:20,  1.12s/it]          cache-cache_patch:torch-oblivious:half-rt/inputs VALIDATE:  80%|████████  | 515/640 [05:12<02:20,  1.12s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs VALIDATE:  81%|████████  | 516/640 [05:12<02:28,  1.20s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs_prompt EXPORT:  81%|████████  | 516/640 [05:12<02:28,  1.20s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs2 EXPORT:  81%|████████  | 516/640 [05:12<02:28,  1.20s/it]          cache-cache_patch:torch-oblivious:half-rt/inputs2 VALIDATE:  81%|████████  | 516/640 [05:13<02:28,  1.20s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs2 VALIDATE:  81%|████████  | 518/640 [05:14<01:59,  1.02it/s]    cache-cache_patch:torch-oblivious:half-rt/inputs_empty_cache EXPORT:  81%|████████  | 518/640 [05:14<01:59,  1.02it/s]    cache-cache_patch:torch-oblivious:half-rt/inputs_empty_cache VALIDATE:  81%|████████  | 518/640 [05:15<01:59,  1.02it/s]    cache-cache_patch:torch-oblivious:half-rt/inputs_empty_cache VALIDATE:  81%|████████  | 519/640 [05:15<02:09,  1.07s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs_batch1 EXPORT:  81%|████████  | 519/640 [05:15<02:09,  1.07s/it]           cache-cache_patch:torch-oblivious:half-rt/inputs_batch1 VALIDATE:  81%|████████  | 519/640 [05:16<02:09,  1.07s/it]    cache-cache_patch:torch-oblivious:half-rt/inputs_batch1 VALIDATE:  81%|████████▏ | 520/640 [05:16<02:17,  1.15s/it]    cache-cache_patch:torch-strict/inputs EXPORT:  81%|████████▏ | 520/640 [05:16<02:17,  1.15s/it]                    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-strict/inputs EXPORT:  81%|████████▏ | 521/640 [05:18<02:19,  1.17s/it]    cache-cache_patch:torch-strict/inputs_prompt EXPORT:  81%|████████▏ | 521/640 [05:18<02:19,  1.17s/it]    cache-cache_patch:torch-strict/inputs2 EXPORT:  81%|████████▏ | 521/640 [05:18<02:19,  1.17s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-strict/inputs2 EXPORT:  82%|████████▏ | 523/640 [05:19<01:48,  1.08it/s]    cache-cache_patch:torch-strict/inputs_empty_cache EXPORT:  82%|████████▏ | 523/640 [05:19<01:48,  1.08it/s]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-strict/inputs_empty_cache EXPORT:  82%|████████▏ | 524/640 [05:20<01:54,  1.01it/s]    cache-cache_patch:torch-strict/inputs_batch1 EXPORT:  82%|████████▏ | 524/640 [05:20<01:54,  1.01it/s]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-strict/inputs_batch1 EXPORT:  82%|████████▏ | 525/640 [05:22<02:21,  1.23s/it]    cache-cache_patch:torch-rt-strict/inputs EXPORT:  82%|████████▏ | 525/640 [05:22<02:21,  1.23s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-rt-strict/inputs EXPORT:  82%|████████▏ | 526/640 [05:24<02:49,  1.49s/it]    cache-cache_patch:torch-rt-strict/inputs_prompt EXPORT:  82%|████████▏ | 526/640 [05:24<02:49,  1.49s/it]    cache-cache_patch:torch-rt-strict/inputs2 EXPORT:  82%|████████▏ | 526/640 [05:24<02:49,  1.49s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-rt-strict/inputs2 EXPORT:  82%|████████▎ | 528/640 [05:26<02:28,  1.33s/it]    cache-cache_patch:torch-rt-strict/inputs_empty_cache EXPORT:  82%|████████▎ | 528/640 [05:26<02:28,  1.33s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-rt-strict/inputs_empty_cache EXPORT:  83%|████████▎ | 529/640 [05:31<03:52,  2.09s/it]    cache-cache_patch:torch-rt-strict/inputs_batch1 EXPORT:  83%|████████▎ | 529/640 [05:31<03:52,  2.09s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-rt-strict/inputs_batch1 EXPORT:  83%|████████▎ | 530/640 [05:33<03:51,  2.10s/it]    cache-cache_patch:torch-oblivious-strict/inputs EXPORT:  83%|████████▎ | 530/640 [05:33<03:51,  2.10s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-strict/inputs EXPORT:  83%|████████▎ | 531/640 [05:35<03:29,  1.93s/it]    cache-cache_patch:torch-oblivious-strict/inputs_prompt EXPORT:  83%|████████▎ | 531/640 [05:35<03:29,  1.93s/it]    cache-cache_patch:torch-oblivious-strict/inputs2 EXPORT:  83%|████████▎ | 531/640 [05:35<03:29,  1.93s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-strict/inputs2 EXPORT:  83%|████████▎ | 533/640 [05:36<02:28,  1.38s/it]    cache-cache_patch:torch-oblivious-strict/inputs_empty_cache EXPORT:  83%|████████▎ | 533/640 [05:36<02:28,  1.38s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-strict/inputs_empty_cache EXPORT:  83%|████████▎ | 534/640 [05:37<02:25,  1.38s/it]    cache-cache_patch:torch-oblivious-strict/inputs_batch1 EXPORT:  83%|████████▎ | 534/640 [05:37<02:25,  1.38s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-strict/inputs_batch1 EXPORT:  84%|████████▎ | 535/640 [05:40<02:50,  1.62s/it]    cache-cache_patch:torch-oblivious-rt-strict/inputs EXPORT:  84%|████████▎ | 535/640 [05:40<02:50,  1.62s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-rt-strict/inputs EXPORT:  84%|████████▍ | 536/640 [05:42<03:08,  1.81s/it]    cache-cache_patch:torch-oblivious-rt-strict/inputs_prompt EXPORT:  84%|████████▍ | 536/640 [05:42<03:08,  1.81s/it]    cache-cache_patch:torch-oblivious-rt-strict/inputs2 EXPORT:  84%|████████▍ | 536/640 [05:42<03:08,  1.81s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-rt-strict/inputs2 EXPORT:  84%|████████▍ | 538/640 [05:44<02:36,  1.54s/it]    cache-cache_patch:torch-oblivious-rt-strict/inputs_empty_cache EXPORT:  84%|████████▍ | 538/640 [05:44<02:36,  1.54s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-rt-strict/inputs_empty_cache EXPORT:  84%|████████▍ | 539/640 [05:47<02:58,  1.77s/it]    cache-cache_patch:torch-oblivious-rt-strict/inputs_batch1 EXPORT:  84%|████████▍ | 539/640 [05:47<02:58,  1.77s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious-rt-strict/inputs_batch1 EXPORT:  84%|████████▍ | 540/640 [05:49<03:08,  1.89s/it]    cache-cache_patch:torch-oblivious:auto-strict/inputs EXPORT:  84%|████████▍ | 540/640 [05:49<03:08,  1.89s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-strict/inputs EXPORT:  85%|████████▍ | 541/640 [05:50<02:49,  1.71s/it]    cache-cache_patch:torch-oblivious:auto-strict/inputs_prompt EXPORT:  85%|████████▍ | 541/640 [05:50<02:49,  1.71s/it]    cache-cache_patch:torch-oblivious:auto-strict/inputs2 EXPORT:  85%|████████▍ | 541/640 [05:50<02:49,  1.71s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-strict/inputs2 EXPORT:  85%|████████▍ | 543/640 [05:52<02:04,  1.28s/it]    cache-cache_patch:torch-oblivious:auto-strict/inputs_empty_cache EXPORT:  85%|████████▍ | 543/640 [05:52<02:04,  1.28s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-strict/inputs_empty_cache EXPORT:  85%|████████▌ | 544/640 [05:53<02:03,  1.28s/it]    cache-cache_patch:torch-oblivious:auto-strict/inputs_batch1 EXPORT:  85%|████████▌ | 544/640 [05:53<02:03,  1.28s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-strict/inputs_batch1 EXPORT:  85%|████████▌ | 545/640 [05:55<02:23,  1.51s/it]    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs EXPORT:  85%|████████▌ | 545/640 [05:55<02:23,  1.51s/it]    /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs EXPORT:  85%|████████▌ | 546/640 [05:57<02:40,  1.70s/it]    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs_prompt EXPORT:  85%|████████▌ | 546/640 [05:57<02:40,  1.70s/it]    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs2 EXPORT:  85%|████████▌ | 546/640 [05:57<02:40,  1.70s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs2 EXPORT:  86%|████████▌ | 548/640 [06:00<02:13,  1.45s/it]    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  86%|████████▌ | 548/640 [06:00<02:13,  1.45s/it]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  86%|████████▌ | 549/640 [06:02<02:28,  1.64s/it]    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  86%|████████▌ | 549/640 [06:02<02:28,  1.64s/it]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  86%|████████▌ | 550/640 [06:06<03:27,  2.31s/it]    cache-cache_patch:torch-oblivious:half-strict/inputs EXPORT:  86%|████████▌ | 550/640 [06:06<03:27,  2.31s/it]          /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-strict/inputs EXPORT:  86%|████████▌ | 551/640 [06:07<03:00,  2.03s/it]    cache-cache_patch:torch-oblivious:half-strict/inputs_prompt EXPORT:  86%|████████▌ | 551/640 [06:07<03:00,  2.03s/it]    cache-cache_patch:torch-oblivious:half-strict/inputs2 EXPORT:  86%|████████▌ | 551/640 [06:07<03:00,  2.03s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-strict/inputs2 EXPORT:  86%|████████▋ | 553/640 [06:09<02:03,  1.42s/it]    cache-cache_patch:torch-oblivious:half-strict/inputs_empty_cache EXPORT:  86%|████████▋ | 553/640 [06:09<02:03,  1.42s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-strict/inputs_empty_cache EXPORT:  87%|████████▋ | 554/640 [06:10<01:56,  1.36s/it]    cache-cache_patch:torch-oblivious:half-strict/inputs_batch1 EXPORT:  87%|████████▋ | 554/640 [06:10<01:56,  1.36s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-strict/inputs_batch1 EXPORT:  87%|████████▋ | 555/640 [06:12<02:13,  1.57s/it]    cache-cache_patch:torch-oblivious:half-rt-strict/inputs EXPORT:  87%|████████▋ | 555/640 [06:12<02:13,  1.57s/it]    /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-rt-strict/inputs EXPORT:  87%|████████▋ | 556/640 [06:14<02:27,  1.76s/it]    cache-cache_patch:torch-oblivious:half-rt-strict/inputs_prompt EXPORT:  87%|████████▋ | 556/640 [06:14<02:27,  1.76s/it]    cache-cache_patch:torch-oblivious:half-rt-strict/inputs2 EXPORT:  87%|████████▋ | 556/640 [06:14<02:27,  1.76s/it]      /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-rt-strict/inputs2 EXPORT:  87%|████████▋ | 558/640 [06:17<02:03,  1.51s/it]    cache-cache_patch:torch-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  87%|████████▋ | 558/640 [06:17<02:03,  1.51s/it]/home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-rt-strict/inputs_empty_cache EXPORT:  87%|████████▋ | 559/640 [06:19<02:16,  1.69s/it]    cache-cache_patch:torch-oblivious:half-rt-strict/inputs_batch1 EXPORT:  87%|████████▋ | 559/640 [06:19<02:16,  1.69s/it]     /home/xadupre/vv/this312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py:1788: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
      return ctor(*args, **kwargs)
    cache-cache_patch:torch-oblivious:half-rt-strict/inputs_batch1 EXPORT:  88%|████████▊ | 560/640 [06:21<02:25,  1.82s/it]    cache-cache_patch:transformers/inputs EXPORT:  88%|████████▊ | 560/640 [06:21<02:25,  1.82s/it]                             cache-cache_patch:transformers/inputs VALIDATE:  88%|████████▊ | 560/640 [06:23<02:25,  1.82s/it]    cache-cache_patch:transformers/inputs VALIDATE:  88%|████████▊ | 561/640 [06:23<02:19,  1.76s/it]    cache-cache_patch:transformers/inputs_prompt EXPORT:  88%|████████▊ | 561/640 [06:23<02:19,  1.76s/it]    cache-cache_patch:transformers/inputs2 EXPORT:  88%|████████▊ | 561/640 [06:23<02:19,  1.76s/it]          cache-cache_patch:transformers/inputs2 VALIDATE:  88%|████████▊ | 561/640 [06:24<02:19,  1.76s/it]    cache-cache_patch:transformers/inputs2 VALIDATE:  88%|████████▊ | 563/640 [06:24<01:37,  1.27s/it]    cache-cache_patch:transformers/inputs_empty_cache EXPORT:  88%|████████▊ | 563/640 [06:24<01:37,  1.27s/it]    cache-cache_patch:transformers/inputs_empty_cache VALIDATE:  88%|████████▊ | 563/640 [06:25<01:37,  1.27s/it]    cache-cache_patch:transformers/inputs_empty_cache VALIDATE:  88%|████████▊ | 564/640 [06:25<01:39,  1.30s/it]    cache-cache_patch:transformers/inputs_batch1 EXPORT:  88%|████████▊ | 564/640 [06:25<01:39,  1.30s/it]           cache-cache_patch:transformers/inputs_batch1 EXPORT:  88%|████████▊ | 565/640 [06:26<01:27,  1.16s/it]    cache-cache_patch:transformers-rt/inputs EXPORT:  88%|████████▊ | 565/640 [06:26<01:27,  1.16s/it]        cache-cache_patch:transformers-rt/inputs VALIDATE:  88%|████████▊ | 565/640 [06:27<01:27,  1.16s/it]    cache-cache_patch:transformers-rt/inputs VALIDATE:  88%|████████▊ | 566/640 [06:27<01:28,  1.19s/it]    cache-cache_patch:transformers-rt/inputs_prompt EXPORT:  88%|████████▊ | 566/640 [06:27<01:28,  1.19s/it]    cache-cache_patch:transformers-rt/inputs2 EXPORT:  88%|████████▊ | 566/640 [06:27<01:28,  1.19s/it]          cache-cache_patch:transformers-rt/inputs2 VALIDATE:  88%|████████▊ | 566/640 [06:29<01:28,  1.19s/it]    cache-cache_patch:transformers-rt/inputs2 VALIDATE:  89%|████████▉ | 568/640 [06:29<01:09,  1.04it/s]    cache-cache_patch:transformers-rt/inputs_empty_cache EXPORT:  89%|████████▉ | 568/640 [06:29<01:09,  1.04it/s]    cache-cache_patch:transformers-rt/inputs_empty_cache VALIDATE:  89%|████████▉ | 568/640 [06:30<01:09,  1.04it/s]    cache-cache_patch:transformers-rt/inputs_empty_cache VALIDATE:  89%|████████▉ | 569/640 [06:30<01:14,  1.05s/it]    cache-cache_patch:transformers-rt/inputs_batch1 EXPORT:  89%|████████▉ | 569/640 [06:30<01:14,  1.05s/it]           cache-cache_patch:transformers-rt/inputs_batch1 EXPORT:  89%|████████▉ | 570/640 [06:31<01:10,  1.00s/it]    cache-cache_patch:transformers-oblivious/inputs EXPORT:  89%|████████▉ | 570/640 [06:31<01:10,  1.00s/it]    cache-cache_patch:transformers-oblivious/inputs VALIDATE:  89%|████████▉ | 570/640 [06:32<01:10,  1.00s/it]    cache-cache_patch:transformers-oblivious/inputs VALIDATE:  89%|████████▉ | 571/640 [06:32<01:15,  1.09s/it]    cache-cache_patch:transformers-oblivious/inputs_prompt EXPORT:  89%|████████▉ | 571/640 [06:32<01:15,  1.09s/it]    cache-cache_patch:transformers-oblivious/inputs2 EXPORT:  89%|████████▉ | 571/640 [06:32<01:15,  1.09s/it]          cache-cache_patch:transformers-oblivious/inputs2 VALIDATE:  89%|████████▉ | 571/640 [06:33<01:15,  1.09s/it]    cache-cache_patch:transformers-oblivious/inputs2 VALIDATE:  90%|████████▉ | 573/640 [06:33<00:59,  1.13it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache EXPORT:  90%|████████▉ | 573/640 [06:33<00:59,  1.13it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache VALIDATE:  90%|████████▉ | 573/640 [06:35<00:59,  1.13it/s]    cache-cache_patch:transformers-oblivious/inputs_empty_cache VALIDATE:  90%|████████▉ | 574/640 [06:35<01:04,  1.02it/s]    cache-cache_patch:transformers-oblivious/inputs_batch1 EXPORT:  90%|████████▉ | 574/640 [06:35<01:04,  1.02it/s]           cache-cache_patch:transformers-oblivious/inputs_batch1 VALIDATE:  90%|████████▉ | 574/640 [06:36<01:04,  1.02it/s]    cache-cache_patch:transformers-oblivious/inputs_batch1 VALIDATE:  90%|████████▉ | 575/640 [06:36<01:08,  1.05s/it]    cache-cache_patch:transformers-oblivious-rt/inputs EXPORT:  90%|████████▉ | 575/640 [06:36<01:08,  1.05s/it]          cache-cache_patch:transformers-oblivious-rt/inputs VALIDATE:  90%|████████▉ | 575/640 [06:37<01:08,  1.05s/it]    cache-cache_patch:transformers-oblivious-rt/inputs VALIDATE:  90%|█████████ | 576/640 [06:37<01:10,  1.11s/it]    cache-cache_patch:transformers-oblivious-rt/inputs_prompt EXPORT:  90%|█████████ | 576/640 [06:37<01:10,  1.11s/it]    cache-cache_patch:transformers-oblivious-rt/inputs2 EXPORT:  90%|█████████ | 576/640 [06:37<01:10,  1.11s/it]          cache-cache_patch:transformers-oblivious-rt/inputs2 VALIDATE:  90%|█████████ | 576/640 [06:38<01:10,  1.11s/it]    cache-cache_patch:transformers-oblivious-rt/inputs2 VALIDATE:  90%|█████████ | 578/640 [06:39<00:56,  1.11it/s]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache EXPORT:  90%|█████████ | 578/640 [06:39<00:56,  1.11it/s]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache VALIDATE:  90%|█████████ | 578/640 [06:40<00:56,  1.11it/s]    cache-cache_patch:transformers-oblivious-rt/inputs_empty_cache VALIDATE:  90%|█████████ | 579/640 [06:40<01:00,  1.00it/s]    cache-cache_patch:transformers-oblivious-rt/inputs_batch1 EXPORT:  90%|█████████ | 579/640 [06:40<01:00,  1.00it/s]           cache-cache_patch:transformers-oblivious-rt/inputs_batch1 VALIDATE:  90%|█████████ | 579/640 [06:41<01:00,  1.00it/s]    cache-cache_patch:transformers-oblivious-rt/inputs_batch1 VALIDATE:  91%|█████████ | 580/640 [06:41<01:03,  1.06s/it]    cache-cache_patch:transformers-oblivious:auto/inputs EXPORT:  91%|█████████ | 580/640 [06:41<01:03,  1.06s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto/inputs VALIDATE:  91%|█████████ | 580/640 [06:42<01:03,  1.06s/it]    cache-cache_patch:transformers-oblivious:auto/inputs VALIDATE:  91%|█████████ | 581/640 [06:42<01:05,  1.11s/it]    cache-cache_patch:transformers-oblivious:auto/inputs_prompt EXPORT:  91%|█████████ | 581/640 [06:42<01:05,  1.11s/it]    cache-cache_patch:transformers-oblivious:auto/inputs2 EXPORT:  91%|█████████ | 581/640 [06:42<01:05,  1.11s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto/inputs2 VALIDATE:  91%|█████████ | 581/640 [06:43<01:05,  1.11s/it]    cache-cache_patch:transformers-oblivious:auto/inputs2 VALIDATE:  91%|█████████ | 583/640 [06:44<00:51,  1.10it/s]    cache-cache_patch:transformers-oblivious:auto/inputs_empty_cache EXPORT:  91%|█████████ | 583/640 [06:44<00:51,  1.10it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto/inputs_empty_cache VALIDATE:  91%|█████████ | 583/640 [06:45<00:51,  1.10it/s]    cache-cache_patch:transformers-oblivious:auto/inputs_empty_cache VALIDATE:  91%|█████████▏| 584/640 [06:45<00:54,  1.03it/s]    cache-cache_patch:transformers-oblivious:auto/inputs_batch1 EXPORT:  91%|█████████▏| 584/640 [06:45<00:54,  1.03it/s]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto/inputs_batch1 VALIDATE:  91%|█████████▏| 584/640 [06:46<00:54,  1.03it/s]    cache-cache_patch:transformers-oblivious:auto/inputs_batch1 VALIDATE:  91%|█████████▏| 585/640 [06:46<00:57,  1.05s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs EXPORT:  91%|█████████▏| 585/640 [06:46<00:57,  1.05s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt/inputs VALIDATE:  91%|█████████▏| 585/640 [06:47<00:57,  1.05s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs VALIDATE:  92%|█████████▏| 586/640 [06:47<01:00,  1.12s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs_prompt EXPORT:  92%|█████████▏| 586/640 [06:47<01:00,  1.12s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs2 EXPORT:  92%|█████████▏| 586/640 [06:47<01:00,  1.12s/it]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt/inputs2 VALIDATE:  92%|█████████▏| 586/640 [06:49<01:00,  1.12s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs2 VALIDATE:  92%|█████████▏| 588/640 [06:49<00:49,  1.06it/s]    cache-cache_patch:transformers-oblivious:auto-rt/inputs_empty_cache EXPORT:  92%|█████████▏| 588/640 [06:49<00:49,  1.06it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt/inputs_empty_cache VALIDATE:  92%|█████████▏| 588/640 [06:53<00:49,  1.06it/s]    cache-cache_patch:transformers-oblivious:auto-rt/inputs_empty_cache VALIDATE:  92%|█████████▏| 589/640 [06:53<01:25,  1.68s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs_batch1 EXPORT:  92%|█████████▏| 589/640 [06:53<01:25,  1.68s/it]       /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt/inputs_batch1 VALIDATE:  92%|█████████▏| 589/640 [06:54<01:25,  1.68s/it]    cache-cache_patch:transformers-oblivious:auto-rt/inputs_batch1 VALIDATE:  92%|█████████▏| 590/640 [06:54<01:19,  1.58s/it]    cache-cache_patch:transformers-oblivious:half/inputs EXPORT:  92%|█████████▏| 590/640 [06:54<01:19,  1.58s/it]                cache-cache_patch:transformers-oblivious:half/inputs VALIDATE:  92%|█████████▏| 590/640 [06:55<01:19,  1.58s/it]    cache-cache_patch:transformers-oblivious:half/inputs VALIDATE:  92%|█████████▏| 591/640 [06:55<01:12,  1.49s/it]    cache-cache_patch:transformers-oblivious:half/inputs_prompt EXPORT:  92%|█████████▏| 591/640 [06:55<01:12,  1.49s/it]    cache-cache_patch:transformers-oblivious:half/inputs2 EXPORT:  92%|█████████▏| 591/640 [06:55<01:12,  1.49s/it]          cache-cache_patch:transformers-oblivious:half/inputs2 VALIDATE:  92%|█████████▏| 591/640 [06:57<01:12,  1.49s/it]    cache-cache_patch:transformers-oblivious:half/inputs2 VALIDATE:  93%|█████████▎| 593/640 [06:57<00:52,  1.12s/it]    cache-cache_patch:transformers-oblivious:half/inputs_empty_cache EXPORT:  93%|█████████▎| 593/640 [06:57<00:52,  1.12s/it]    cache-cache_patch:transformers-oblivious:half/inputs_empty_cache VALIDATE:  93%|█████████▎| 593/640 [06:58<00:52,  1.12s/it]    cache-cache_patch:transformers-oblivious:half/inputs_empty_cache VALIDATE:  93%|█████████▎| 594/640 [06:58<00:52,  1.14s/it]    cache-cache_patch:transformers-oblivious:half/inputs_batch1 EXPORT:  93%|█████████▎| 594/640 [06:58<00:52,  1.14s/it]           cache-cache_patch:transformers-oblivious:half/inputs_batch1 VALIDATE:  93%|█████████▎| 594/640 [06:59<00:52,  1.14s/it]    cache-cache_patch:transformers-oblivious:half/inputs_batch1 VALIDATE:  93%|█████████▎| 595/640 [06:59<00:53,  1.19s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs EXPORT:  93%|█████████▎| 595/640 [06:59<00:53,  1.19s/it]          cache-cache_patch:transformers-oblivious:half-rt/inputs VALIDATE:  93%|█████████▎| 595/640 [07:00<00:53,  1.19s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs VALIDATE:  93%|█████████▎| 596/640 [07:01<00:53,  1.21s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs_prompt EXPORT:  93%|█████████▎| 596/640 [07:01<00:53,  1.21s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs2 EXPORT:  93%|█████████▎| 596/640 [07:01<00:53,  1.21s/it]          cache-cache_patch:transformers-oblivious:half-rt/inputs2 VALIDATE:  93%|█████████▎| 596/640 [07:02<00:53,  1.21s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs2 VALIDATE:  93%|█████████▎| 598/640 [07:02<00:40,  1.03it/s]    cache-cache_patch:transformers-oblivious:half-rt/inputs_empty_cache EXPORT:  93%|█████████▎| 598/640 [07:02<00:40,  1.03it/s]    cache-cache_patch:transformers-oblivious:half-rt/inputs_empty_cache VALIDATE:  93%|█████████▎| 598/640 [07:03<00:40,  1.03it/s]    cache-cache_patch:transformers-oblivious:half-rt/inputs_empty_cache VALIDATE:  94%|█████████▎| 599/640 [07:03<00:43,  1.05s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs_batch1 EXPORT:  94%|█████████▎| 599/640 [07:03<00:43,  1.05s/it]           cache-cache_patch:transformers-oblivious:half-rt/inputs_batch1 VALIDATE:  94%|█████████▎| 599/640 [07:04<00:43,  1.05s/it]    cache-cache_patch:transformers-oblivious:half-rt/inputs_batch1 VALIDATE:  94%|█████████▍| 600/640 [07:05<00:45,  1.13s/it]    cache-cache_patch:transformers-strict/inputs EXPORT:  94%|█████████▍| 600/640 [07:05<00:45,  1.13s/it]                        cache-cache_patch:transformers-strict/inputs EXPORT:  94%|█████████▍| 601/640 [07:05<00:41,  1.06s/it]    cache-cache_patch:transformers-strict/inputs_prompt EXPORT:  94%|█████████▍| 601/640 [07:05<00:41,  1.06s/it]    cache-cache_patch:transformers-strict/inputs2 EXPORT:  94%|█████████▍| 601/640 [07:05<00:41,  1.06s/it]          cache-cache_patch:transformers-strict/inputs2 EXPORT:  94%|█████████▍| 603/640 [07:06<00:28,  1.30it/s]    cache-cache_patch:transformers-strict/inputs_empty_cache EXPORT:  94%|█████████▍| 603/640 [07:06<00:28,  1.30it/s]    cache-cache_patch:transformers-strict/inputs_empty_cache EXPORT:  94%|█████████▍| 604/640 [07:07<00:27,  1.33it/s]    cache-cache_patch:transformers-strict/inputs_batch1 EXPORT:  94%|█████████▍| 604/640 [07:07<00:27,  1.33it/s]         cache-cache_patch:transformers-strict/inputs_batch1 EXPORT:  95%|█████████▍| 605/640 [07:07<00:24,  1.41it/s]    cache-cache_patch:transformers-rt-strict/inputs EXPORT:  95%|█████████▍| 605/640 [07:07<00:24,  1.41it/s]        cache-cache_patch:transformers-rt-strict/inputs EXPORT:  95%|█████████▍| 606/640 [07:08<00:24,  1.41it/s]    cache-cache_patch:transformers-rt-strict/inputs_prompt EXPORT:  95%|█████████▍| 606/640 [07:08<00:24,  1.41it/s]    cache-cache_patch:transformers-rt-strict/inputs2 EXPORT:  95%|█████████▍| 606/640 [07:08<00:24,  1.41it/s]          cache-cache_patch:transformers-rt-strict/inputs2 EXPORT:  95%|█████████▌| 608/640 [07:09<00:18,  1.77it/s]    cache-cache_patch:transformers-rt-strict/inputs_empty_cache EXPORT:  95%|█████████▌| 608/640 [07:09<00:18,  1.77it/s]    cache-cache_patch:transformers-rt-strict/inputs_empty_cache EXPORT:  95%|█████████▌| 609/640 [07:10<00:18,  1.67it/s]    cache-cache_patch:transformers-rt-strict/inputs_batch1 EXPORT:  95%|█████████▌| 609/640 [07:10<00:18,  1.67it/s]         cache-cache_patch:transformers-rt-strict/inputs_batch1 EXPORT:  95%|█████████▌| 610/640 [07:10<00:18,  1.63it/s]    cache-cache_patch:transformers-oblivious-strict/inputs EXPORT:  95%|█████████▌| 610/640 [07:10<00:18,  1.63it/s]    cache-cache_patch:transformers-oblivious-strict/inputs EXPORT:  95%|█████████▌| 611/640 [07:11<00:18,  1.59it/s]    cache-cache_patch:transformers-oblivious-strict/inputs_prompt EXPORT:  95%|█████████▌| 611/640 [07:11<00:18,  1.59it/s]    cache-cache_patch:transformers-oblivious-strict/inputs2 EXPORT:  95%|█████████▌| 611/640 [07:11<00:18,  1.59it/s]          cache-cache_patch:transformers-oblivious-strict/inputs2 EXPORT:  96%|█████████▌| 613/640 [07:12<00:14,  1.92it/s]    cache-cache_patch:transformers-oblivious-strict/inputs_empty_cache EXPORT:  96%|█████████▌| 613/640 [07:12<00:14,  1.92it/s]    cache-cache_patch:transformers-oblivious-strict/inputs_empty_cache EXPORT:  96%|█████████▌| 614/640 [07:12<00:14,  1.80it/s]    cache-cache_patch:transformers-oblivious-strict/inputs_batch1 EXPORT:  96%|█████████▌| 614/640 [07:12<00:14,  1.80it/s]         cache-cache_patch:transformers-oblivious-strict/inputs_batch1 EXPORT:  96%|█████████▌| 615/640 [07:13<00:15,  1.66it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs EXPORT:  96%|█████████▌| 615/640 [07:13<00:15,  1.66it/s]        cache-cache_patch:transformers-oblivious-rt-strict/inputs EXPORT:  96%|█████████▋| 616/640 [07:14<00:14,  1.62it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs_prompt EXPORT:  96%|█████████▋| 616/640 [07:14<00:14,  1.62it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs2 EXPORT:  96%|█████████▋| 616/640 [07:14<00:14,  1.62it/s]          cache-cache_patch:transformers-oblivious-rt-strict/inputs2 EXPORT:  97%|█████████▋| 618/640 [07:14<00:10,  2.02it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs_empty_cache EXPORT:  97%|█████████▋| 618/640 [07:14<00:10,  2.02it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs_empty_cache EXPORT:  97%|█████████▋| 619/640 [07:15<00:11,  1.87it/s]    cache-cache_patch:transformers-oblivious-rt-strict/inputs_batch1 EXPORT:  97%|█████████▋| 619/640 [07:15<00:11,  1.87it/s]         cache-cache_patch:transformers-oblivious-rt-strict/inputs_batch1 EXPORT:  97%|█████████▋| 620/640 [07:16<00:11,  1.71it/s]    cache-cache_patch:transformers-oblivious:auto-strict/inputs EXPORT:  97%|█████████▋| 620/640 [07:16<00:11,  1.71it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-strict/inputs EXPORT:  97%|█████████▋| 621/640 [07:17<00:11,  1.62it/s]    cache-cache_patch:transformers-oblivious:auto-strict/inputs_prompt EXPORT:  97%|█████████▋| 621/640 [07:17<00:11,  1.62it/s]    cache-cache_patch:transformers-oblivious:auto-strict/inputs2 EXPORT:  97%|█████████▋| 621/640 [07:17<00:11,  1.62it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-strict/inputs2 EXPORT:  97%|█████████▋| 623/640 [07:17<00:08,  1.96it/s]    cache-cache_patch:transformers-oblivious:auto-strict/inputs_empty_cache EXPORT:  97%|█████████▋| 623/640 [07:17<00:08,  1.96it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-strict/inputs_empty_cache EXPORT:  98%|█████████▊| 624/640 [07:18<00:08,  1.79it/s]    cache-cache_patch:transformers-oblivious:auto-strict/inputs_batch1 EXPORT:  98%|█████████▊| 624/640 [07:18<00:08,  1.79it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-strict/inputs_batch1 EXPORT:  98%|█████████▊| 625/640 [07:19<00:09,  1.66it/s]    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs EXPORT:  98%|█████████▊| 625/640 [07:19<00:09,  1.66it/s]    /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs EXPORT:  98%|█████████▊| 626/640 [07:19<00:09,  1.55it/s]    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs_prompt EXPORT:  98%|█████████▊| 626/640 [07:19<00:09,  1.55it/s]    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs2 EXPORT:  98%|█████████▊| 626/640 [07:19<00:09,  1.55it/s]      /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs2 EXPORT:  98%|█████████▊| 628/640 [07:20<00:06,  1.91it/s]    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  98%|█████████▊| 628/640 [07:20<00:06,  1.91it/s]/home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs_empty_cache EXPORT:  98%|█████████▊| 629/640 [07:21<00:06,  1.76it/s]    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  98%|█████████▊| 629/640 [07:21<00:06,  1.76it/s]     /home/xadupre/github/onnx-diagnostic/onnx_diagnostic/helpers/cache_helper.py:83: FutureWarning: `treespec.children_specs` is deprecated. Use `treespec.child(index)` to access a single child, or `treespec.children()` to get all children.
      for subspec in spec.children_specs:
    cache-cache_patch:transformers-oblivious:auto-rt-strict/inputs_batch1 EXPORT:  98%|█████████▊| 630/640 [07:22<00:06,  1.65it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs EXPORT:  98%|█████████▊| 630/640 [07:22<00:06,  1.65it/s]              cache-cache_patch:transformers-oblivious:half-strict/inputs EXPORT:  99%|█████████▊| 631/640 [07:22<00:05,  1.57it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs_prompt EXPORT:  99%|█████████▊| 631/640 [07:22<00:05,  1.57it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs2 EXPORT:  99%|█████████▊| 631/640 [07:22<00:05,  1.57it/s]          cache-cache_patch:transformers-oblivious:half-strict/inputs2 EXPORT:  99%|█████████▉| 633/640 [07:23<00:03,  1.96it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs_empty_cache EXPORT:  99%|█████████▉| 633/640 [07:23<00:03,  1.96it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs_empty_cache EXPORT:  99%|█████████▉| 634/640 [07:24<00:03,  1.79it/s]    cache-cache_patch:transformers-oblivious:half-strict/inputs_batch1 EXPORT:  99%|█████████▉| 634/640 [07:24<00:03,  1.79it/s]         cache-cache_patch:transformers-oblivious:half-strict/inputs_batch1 EXPORT:  99%|█████████▉| 635/640 [07:25<00:03,  1.61it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs EXPORT:  99%|█████████▉| 635/640 [07:25<00:03,  1.61it/s]        cache-cache_patch:transformers-oblivious:half-rt-strict/inputs EXPORT:  99%|█████████▉| 636/640 [07:25<00:02,  1.54it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_prompt EXPORT:  99%|█████████▉| 636/640 [07:25<00:02,  1.54it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs2 EXPORT:  99%|█████████▉| 636/640 [07:25<00:02,  1.54it/s]          cache-cache_patch:transformers-oblivious:half-rt-strict/inputs2 EXPORT: 100%|█████████▉| 638/640 [07:26<00:01,  1.89it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_empty_cache EXPORT: 100%|█████████▉| 638/640 [07:26<00:01,  1.89it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_empty_cache EXPORT: 100%|█████████▉| 639/640 [07:27<00:00,  1.75it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_batch1 EXPORT: 100%|█████████▉| 639/640 [07:27<00:00,  1.75it/s]         cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_batch1 EXPORT: 100%|██████████| 640/640 [07:27<00:00,  1.63it/s]    cache-cache_patch:transformers-oblivious:half-rt-strict/inputs_batch1 EXPORT: 100%|██████████| 640/640 [07:27<00:00,  1.43it/s]




.. GENERATED FROM PYTHON SOURCE LINES 240-241

Let's save the results.

.. GENERATED FROM PYTHON SOURCE LINES 241-246

.. code-block:: Python


    df = pandas.DataFrame(results)
    df.to_excel("plot_export_tiny_llm_dim01_onnx.xlsx")
    df






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>cache</th>
          <th>cache_patch</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>strict</th>
          <th>export_with</th>
          <th>EXPORT</th>
          <th>run_with</th>
          <th>WORKS</th>
          <th>ERR-RUN</th>
          <th>ERR-EXPORT</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0.0</td>
          <td>Not the same number of given inputs 1 and the ...</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs2</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>1.0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>923</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>924</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>925</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs2</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>926</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>927</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
      </tbody>
    </table>
    <p>928 rows × 11 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 247-252

.. code-block:: Python


    no_export = df[df.EXPORT == 0]
    no_export.to_excel("plot_export_tiny_llm_dim01_onnx_custom.no_export.xlsx")
    no_export






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>cache</th>
          <th>cache_patch</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>strict</th>
          <th>export_with</th>
          <th>EXPORT</th>
          <th>run_with</th>
          <th>WORKS</th>
          <th>ERR-RUN</th>
          <th>ERR-EXPORT</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>5</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>11</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>12</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>18</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>1</td>
          <td>0</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>24</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>1</td>
          <td>0</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Found the following conflicts between user-spe...</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>923</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>924</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_prompt</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>When `dynamic_shapes` is specified as a dict, ...</td>
        </tr>
        <tr>
          <th>925</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs2</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>926</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_empty_cache</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
        <tr>
          <th>927</th>
          <td>1</td>
          <td>transformers</td>
          <td>half</td>
          <td>1</td>
          <td>1</td>
          <td>inputs_batch1</td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Failed to convert args/kwargs to proxy</td>
        </tr>
      </tbody>
    </table>
    <p>268 rows × 11 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 253-254

The validation failures.

.. GENERATED FROM PYTHON SOURCE LINES 254-263

.. code-block:: Python


    invalid = df[(df.EXPORT == 1) & (df.WORKS == 0)].pivot(
        index=["cache", "cache_patch", "strict", "oblivious", "rt", "export_with"],
        columns=["run_with"],
        values=["WORKS", "ERR-RUN"],
    )
    invalid.to_excel("plot_export_tiny_llm_dim01_onnx_custom.invalid.xlsx")
    invalid






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th colspan="4" halign="left">WORKS</th>
          <th colspan="4" halign="left">ERR-RUN</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>run_with</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_empty_cache</th>
          <th>inputs_prompt</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_empty_cache</th>
          <th>inputs_prompt</th>
        </tr>
        <tr>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="4" valign="top">0</th>
          <th rowspan="2" valign="top">0</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">1</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>1</th>
          <th>0</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">1</th>
          <th rowspan="5" valign="top">transformers</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">half</th>
          <th>0</th>
          <th>inputs_empty_cache</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th rowspan="4" valign="top">1</th>
          <th>inputs</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>inputs_batch1</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
        <tr>
          <th>inputs_empty_cache</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>0.0</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>Not the same number of given inputs 1 and the ...</td>
        </tr>
      </tbody>
    </table>
    <p>132 rows × 8 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 264-274

.. code-block:: Python


    success = df[(df.EXPORT == 1) & (df.WORKS == 1)].pivot(
        index=["cache", "cache_patch", "strict", "oblivious", "rt", "export_with"],
        columns=["run_with"],
        values=["WORKS"],
    )
    success.to_excel("plot_export_tiny_llm_dim01_onnx_custom.success.xlsx")
    success







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th colspan="4" halign="left">WORKS</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>run_with</th>
          <th>inputs</th>
          <th>inputs2</th>
          <th>inputs_batch1</th>
          <th>inputs_empty_cache</th>
        </tr>
        <tr>
          <th>cache</th>
          <th>cache_patch</th>
          <th>strict</th>
          <th>oblivious</th>
          <th>rt</th>
          <th>export_with</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="4" valign="top">0</th>
          <th rowspan="2" valign="top">0</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th rowspan="2" valign="top">1</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>1</th>
          <th>0</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">1</th>
          <th rowspan="5" valign="top">transformers</th>
          <th rowspan="5" valign="top">0</th>
          <th rowspan="5" valign="top">half</th>
          <th>0</th>
          <th>inputs_empty_cache</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th rowspan="4" valign="top">1</th>
          <th>inputs</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs2</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs_batch1</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>inputs_empty_cache</th>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
          <td>1.0</td>
        </tr>
      </tbody>
    </table>
    <p>132 rows × 4 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 275-277

If you have any error, then look at example
:ref:`l-plot-tiny-llm-export-patched`.

.. GENERATED FROM PYTHON SOURCE LINES 277-279

.. code-block:: Python


    doc.plot_legend("Tiny-LLM\nexport with\ndimension in {0,1}", "to_onnx", "tomato")



.. image-sg:: /auto_examples/images/sphx_glr_plot_export_tiny_llm_dim01_onnx_custom_001.png
   :alt: plot export tiny llm dim01 onnx custom
   :srcset: /auto_examples/images/sphx_glr_plot_export_tiny_llm_dim01_onnx_custom_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (7 minutes 42.717 seconds)


.. _sphx_glr_download_auto_examples_plot_export_tiny_llm_dim01_onnx_custom.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_export_tiny_llm_dim01_onnx_custom.ipynb <plot_export_tiny_llm_dim01_onnx_custom.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_export_tiny_llm_dim01_onnx_custom.py <plot_export_tiny_llm_dim01_onnx_custom.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_export_tiny_llm_dim01_onnx_custom.zip <plot_export_tiny_llm_dim01_onnx_custom.zip>`


.. include:: plot_export_tiny_llm_dim01_onnx_custom.recommendations


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
