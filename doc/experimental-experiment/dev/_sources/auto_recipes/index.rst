:orphan:

Exporter Recipes Gallery
========================

A model can be converted to ONNX if :func:`torch.export.export` is
able to convert that model into a graph. This is not always
possible but usually possible with some code changes.
These changes may not be desired as they may hurt the performance
and make the code more complex than it should be.
The conversion is a necessary step to be able to use
ONNX. Next examples shows some recurrent code patterns and
ways to rewrite them so that the exporter works.

See :ref:`l-exporter-recipes` for an organized version of this gallery.




.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Control flow cannot be exported with a change. The code of the model can be changed or patched to introduce function torch.cond.">

.. only:: html

  .. image:: /auto_recipes/images/thumb/sphx_glr_plot_exporter_recipes_c_cond_thumb.png
    :alt:

  :ref:`sphx_glr_auto_recipes_plot_exporter_recipes_c_cond.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">to_onnx and a model with a test</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to convert a custom operator as defined in the tutorial Python Custom Operators.">

.. only:: html

  .. image:: /auto_recipes/images/thumb/sphx_glr_plot_exporter_recipes_c_custom_ops_inplace_thumb.png
    :alt:

  :ref:`sphx_glr_auto_recipes_plot_exporter_recipes_c_custom_ops_inplace.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">to_onnx and a custom operator inplace</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example shows how to convert a custom operator, inspired from Python Custom Operators.">

.. only:: html

  .. image:: /auto_recipes/images/thumb/sphx_glr_plot_exporter_recipes_c_custom_ops_fct_thumb.png
    :alt:

  :ref:`sphx_glr_auto_recipes_plot_exporter_recipes_c_custom_ops_fct.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">to_onnx and a custom operator registered with a function</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Big models are hard to read once converted into onnx. Let&#x27;s see how to improve their readibility. The code is inspired from LLM from scratch with Pytorch.">

.. only:: html

  .. image:: /auto_recipes/images/thumb/sphx_glr_plot_exporter_recipes_c_modules_thumb.png
    :alt:

  :ref:`sphx_glr_auto_recipes_plot_exporter_recipes_c_modules.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">to_onnx and submodules from LLMs</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_recipes/plot_exporter_recipes_c_cond
   /auto_recipes/plot_exporter_recipes_c_custom_ops_inplace
   /auto_recipes/plot_exporter_recipes_c_custom_ops_fct
   /auto_recipes/plot_exporter_recipes_c_modules


.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-gallery

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download all examples in Python source code: auto_recipes_python.zip </auto_recipes/auto_recipes_python.zip>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download all examples in Jupyter notebooks: auto_recipes_jupyter.zip </auto_recipes/auto_recipes_jupyter.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
