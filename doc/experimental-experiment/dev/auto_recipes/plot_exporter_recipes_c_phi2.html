<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="to_onnx and a custom operator inplace" href="plot_exporter_recipes_c_custom_ops_inplace.html" /><link rel="prev" title="Measures the exporter success on many test cases" href="plot_exporter_coverage.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>to_onnx and Phi-2 - experimental-experiment 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">experimental-experiment 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">experimental-experiment 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../design/index.html">Design</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Design</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../design/exporter.html">Custom Exporter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/optimizer.html">Pattern Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/backends.html">Dynamo Backends</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/docker.html">Start from a docker</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/exported.html">Supported Model Signatures</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Supported Model Signatures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/exported_program.html">Exported Programs with Static Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/exported_program_dynamic.html">Exported Programs with Dynamic Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/exported_onnx.html">Exported into ONNX with Static Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/exported_onnx_dynamic.html">Exported into ONNX with Dynamic Shapes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/gradient/index.html">.gradient</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of .gradient</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/gradient/ops/index.html">.gradient.ops</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of .gradient.ops</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/gradient/ops/op_broadcast_gradient_args.html">.gradient.ops.op_broadcast_gradient_args</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/gradient/grad_helper.html">.gradient.grad_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/gradient/loss_helper.html">.gradient.loss_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/reference/index.html">.reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of .reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/reference/ops/index.html">.reference.ops</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of .reference.ops</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_add_add_mul_mul.html">.reference.ops.op_add_add_mul_mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_average_pool_grad.html">.reference.ops.op_average_pool_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_cast_like.html">.reference.ops.op_cast_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_concat.html">.reference.ops.op_concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_constant_of_shape.html">.reference.ops.op_constant_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_fused_matmul.html">.reference.ops.op_fused_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_gather_grad.html">.reference.ops.op_gather_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_memcpy_host.html">.reference.ops.op_memcpy_host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_mul_sigmoid.html">.reference.ops.op_mul_sigmoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_negxplus1.html">.reference.ops.op_negxplus1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_quick_gelu.html">.reference.ops.op_quick_gelu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_replace_zero.html">.reference.ops.op_replace_zero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_rotary.html">.reference.ops.op_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_average_pool.html">.reference.ops.op_qlinear_average_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_conv.html">.reference.ops.op_qlinear_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatter_elements.html">.reference.ops.op_scatter_elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatternd_of_shape.html">.reference.ops.op_scatternd_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_simplified_layer_normalization.html">.reference.ops.op_simplified_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_slice.html">.reference.ops.op_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_transpose_cast.html">.reference.ops.op_transpose_cast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_tri_matrix.html">.reference.ops.op_tri_matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/evaluator.html">.reference.evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/ort_evaluator.html">.reference.ort_evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/quantized_tensor.html">.reference.quantized_tensor</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/convert/index.html">.convert</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of .convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/convert/convert_helper.html">.convert.convert_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/convert/ort_helper.html">.convert.ort_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/plotting/index.html">.plotting</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of .plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/plotting/data.html">.plotting.data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/plotting/memory.html">.plotting.memory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_interpreter/index.html">.torch_interpreter</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of .torch_interpreter</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_functions.html">.torch_interpreter._aten_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_functions_attention.html">.torch_interpreter._aten_functions_attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_methods.html">.torch_interpreter._aten_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_doc_.html">.torch_interpreter._doc_</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_exceptions.html">.torch_interpreter._exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_prims_functions.html">.torch_interpreter._prims_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_torch_helper.html">.torch_interpreter._torch_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/aten_functions.html">.torch_interpreter.aten_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/aten_methods.html">.torch_interpreter.aten_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/diagnose.html">.torch_interpreter.diagnose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/dispatcher.html">.torch_interpreter.dispatcher</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_interpreter/eval/index.html">.torch_interpreter.eval</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of .torch_interpreter.eval</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_interpreter/eval/model_cases.html">.torch_interpreter.eval.model_cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/export_options.html">.torch_interpreter.export_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/interpreter.html">.torch_interpreter.interpreter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/onnx_export.html">.torch_interpreter.onnx_export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/onnx_export_errors.html">.torch_interpreter.onnx_export_errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/onnx_export_serialization.html">.torch_interpreter.onnx_export_serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/oxs_dispatcher.html">.torch_interpreter.oxs_dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/oxs_opset.html">.torch_interpreter.oxs_opset</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/torch_interpreter/patches/index.html">.torch_interpreter.patches</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of .torch_interpreter.patches</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_interpreter/patches/patch_torch.html">.torch_interpreter.patches.patch_torch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/torch_interpreter/patches/patch_transformers.html">.torch_interpreter.patches.patch_transformers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/tracing.html">.torch_interpreter.tracing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_models/index.html">.torch_models</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of .torch_models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/diffusion_model_helper.html">.torch_models.diffusion_model_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/dump_helper.html">.torch_models.dump_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llama_helper.html">.torch_models.llama_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llm_model_helper.html">.torch_models.llm_model_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llm_model_setup.html">.torch_models.llm_model_setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/mistral_helper.html">.torch_models.mistral_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/phi3_helper.html">.torch_models.phi3_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/phi_helper.html">.torch_models.phi_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/training_helper.html">.torch_models.training_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/xbuilder/index.html">.xbuilder</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of .xbuilder</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_graph_builder_runtime.html">.xbuilder._graph_builder_runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_onnx_helper.html">.xbuilder._onnx_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_shape_helper.html">.xbuilder._shape_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/expression_dimension.html">.xbuilder.expression_dimension</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/graph_builder.html">.xbuilder.graph_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/graph_builder_opset.html">.xbuilder.graph_builder_opset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/model_container.html">.xbuilder.model_container</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/optimization_options.html">.xbuilder.optimization_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/shape_type_compute.html">.xbuilder.shape_type_compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/type_inference.html">.xbuilder.type_inference</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/xoptim/index.html">.xoptim</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of .xoptim</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_investigation/index.html">.xoptim.patterns_investigation</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_investigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_investigation/element_wise.html">.xoptim.patterns_investigation.element_wise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_investigation/llm_patterns.html">.xoptim.patterns_investigation.llm_patterns</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_ml/index.html">.xoptim.patterns_ml</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_ml</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ml/tree_ensemble.html">.xoptim.patterns_ml.tree_ensemble</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_exp/index.html">.xoptim.patterns_exp</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_exp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/binary_operators.html">.xoptim.patterns_exp.binary_operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/constant_of_shape_scatter_nd.html">.xoptim.patterns_exp.constant_of_shape_scatter_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/constants.html">.xoptim.patterns_exp.constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/simple_rotary.html">.xoptim.patterns_exp.simple_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/unary_operators.html">.xoptim.patterns_exp.unary_operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/where_replace.html">.xoptim.patterns_exp.where_replace</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns/index.html">.xoptim.patterns</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of .xoptim.patterns</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_any.html">.xoptim.patterns.onnx_any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_cast.html">.xoptim.patterns.onnx_cast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_clip.html">.xoptim.patterns.onnx_clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_conv.html">.xoptim.patterns.onnx_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_dropout.html">.xoptim.patterns.onnx_dropout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_equal.html">.xoptim.patterns.onnx_equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_expand.html">.xoptim.patterns.onnx_expand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_functions.html">.xoptim.patterns.onnx_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_layer_normalization.html">.xoptim.patterns.onnx_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_matmul.html">.xoptim.patterns.onnx_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_mul.html">.xoptim.patterns.onnx_mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_reduce.html">.xoptim.patterns.onnx_reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_reshape.html">.xoptim.patterns.onnx_reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_rotary.html">.xoptim.patterns.onnx_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_slice.html">.xoptim.patterns.onnx_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_split.html">.xoptim.patterns.onnx_split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_sub.html">.xoptim.patterns.onnx_sub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_sequence.html">.xoptim.patterns.onnx_sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_transpose.html">.xoptim.patterns.onnx_transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_unsqueeze.html">.xoptim.patterns.onnx_unsqueeze</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_ort/index.html">.xoptim.patterns_ort</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_ort</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/activation.html">.xoptim.patterns_ort.activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/activation_grad.html">.xoptim.patterns_ort.activation_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/batch_normalization.html">.xoptim.patterns_ort.batch_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/fused_conv.html">.xoptim.patterns_ort.fused_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/fused_matmul.html">.xoptim.patterns_ort.fused_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/gather_grad.html">.xoptim.patterns_ort.gather_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/llm_optim.html">.xoptim.patterns_ort.llm_optim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/simplified_layer_normalization.html">.xoptim.patterns_ort.simplified_layer_normalization</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_fix/index.html">.xoptim.patterns_fix</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_fix</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_fix/add_reduction_scatter_nd.html">.xoptim.patterns_fix.add_reduction_scatter_nd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/graph_builder_optim.html">.xoptim.graph_builder_optim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/order_optim.html">.xoptim.order_optim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/patterns_api.html">.xoptim.patterns_api</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_dynamo/index.html">.torch_dynamo</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of .torch_dynamo</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/_dynamo_exporter.html">.torch_dynamo._dynamo_exporter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/backend_helper.html">.torch_dynamo.backend_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/debug_backend.html">.torch_dynamo.debug_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/fast_backend.html">.torch_dynamo.fast_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/partition.html">experimental_experiment.torch_dynamo.partition</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_bench/index.html">.torch_bench</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of .torch_bench</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner_agg.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner_agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner_agg_helper.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner_agg_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_cmd.html">experimental_experiment.torch_bench._bash_bench_cmd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_model_runner.html">experimental_experiment.torch_bench._bash_bench_model_runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_models_helper.html">experimental_experiment.torch_bench._bash_bench_models_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_dummies.html">experimental_experiment.torch_bench._bash_bench_set_dummies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_explicit.html">experimental_experiment.torch_bench._bash_bench_set_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_huggingface.html">experimental_experiment.torch_bench._bash_bench_set_huggingface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_huggingface_big.html">experimental_experiment.torch_bench._bash_bench_set_huggingface_big</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_issues.html">experimental_experiment.torch_bench._bash_bench_set_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_timm.html">experimental_experiment.torch_bench._bash_bench_set_timm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_torchbench.html">experimental_experiment.torch_bench._bash_bench_set_torchbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_torchbench_ado.html">experimental_experiment.torch_bench._bash_bench_set_torchbench_ado</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_suites.html">experimental_experiment.torch_bench._bash_bench_suites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_dort_cmd_common.html">experimental_experiment.torch_bench._dort_cmd_common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_dort_cmd_common_models.html">experimental_experiment.torch_bench._dort_cmd_common_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_agg.html">.torch_bench.bash_bench_agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_explicit.html">.torch_bench.bash_bench_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_huggingface.html">.torch_bench.bash_bench_huggingface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_huggingface_big.html">.torch_bench.bash_bench_huggingface_big</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_issues.html">.torch_bench.bash_bench_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_timm.html">.torch_bench.bash_bench_timm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_torchbench.html">.torch_bench.bash_bench_torchbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_torchbench_ado.html">.torch_bench.bash_bench_torchbench_ado</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_untrained.html">.torch_bench.bash_bench_untrained</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/check_model.html">.torch_bench.check_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_bench.html">.torch_bench.dort_bench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_bench_profile.html">.torch_bench.dort_bench_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_profile.html">.torch_bench.dort_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/export_model.html">.torch_bench.export_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/export_model_helper.html">.torch_bench.export_model_helper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/_bench_test.html">._bench_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/_command_lines_parser.html">._command_lines_parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/args.html">.args</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bench_run.html">.bench_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/checks.html">.checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ext_test_case.html">.ext_test_case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/helpers.html">.helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/memory_peak.html">.memory_peak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mini_onnx_builder.html">.mini_onnx_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/model_run.html">.model_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/onnx_tools.html">.onnx_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/torch_test_helper.html">.torch_test_helper</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../galleries.html">Galleries of Examples and Recipes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Galleries of Examples and Recipes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Examples Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_custom_backend_101.html">101: A custom backend for torch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_linreg_101.html">101: Linear Regression and export to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_optimize_101.html">101: Onnx Model Optimization based on Pattern Rewriting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_rewrite_101.html">101: Onnx Model Rewriting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_profile_existing_onnx_101.html">101: Profile an existing model with onnxruntime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_101.html">101: Some dummy examples with torch.export.export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_convolutation_matmul_102.html">102: Convolution and Matrix Multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_onnxscript_102.html">102: Examples with onnxscript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_custom_backend_llama_102.html">102: Fuse kernels in a small Llama Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_bench_102.html">102: Measure LLAMA speed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_compile_102.html">102: Tweak onnx export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_dort_201.html">201: Evaluate DORT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_aot_201.html">201: Evaluate DORT Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_201.html">201: Evaluate different ways to export a torch model to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_diff_export_301.html">301: Compares LLAMA exporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_diff_dort_301.html">301: Compares LLAMA exporters for onnxrt backend</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Exporter Recipes Gallery</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Exporter Recipes Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_dynamic_shapes.html">A few tricks about dynamic shapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_inputs.html">Do no use Module as inputs!</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_with_dyamic_cache.html">Export a model using a custom type as input</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_lr.html">Linear Regression and export to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_coverage.html">Measures the exporter success on many test cases</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">to_onnx and Phi-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_custom_ops_inplace.html">to_onnx and a custom operator inplace</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_custom_ops_fct.html">to_onnx and a custom operator registered with a function</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_scan_pdist.html">to_onnx and a model with a loop (scan)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_cond.html">to_onnx and a model with a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_ds.html">to_onnx and infer dynamic shapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_modules.html">to_onnx and submodules from LLMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_phi35.html">to_onnx, failures Phi-3.5-mini-instruct</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_phi2.html">torch.onnx.export and Phi-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_cond.html">torch.onnx.export and a model with a test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../command_lines.html">Command Lines</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Command Lines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../bench/index.html">Benchmarks from the command line</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Benchmarks from the command line</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../bench/dort_bench.html">experimental_experiment.torch_bench.dort_bench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/dort_profile.html">experimental_experiment.torch_bench.dort_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/scripts.html">Interesting scripts or command lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/bash_bench.html">Measuring the exporters on a short list of sets of models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tools/index.html">Tools from the command line</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Tools from the command line</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/lighten.html">python -m experimental_experiment lighten and unlighten</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/optimize.html">python -m experimental_experiment optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/print.html">python -m experimental_experiment print</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/run.html">python -m experimental_experiment run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../miscellaneous/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Miscellaneous</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../miscellaneous/export_times.html">Export Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../miscellaneous/long_outputs.html">Long Outputs uneasy to read</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../miscellaneous/models/index.html">Supported Models By the Custom Backend</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Supported Models By the Custom Backend</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../miscellaneous/models/phi.html">Phi</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/auto_recipes/plot_exporter_recipes_c_phi2.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-recipes-plot-exporter-recipes-c-phi2-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="to-onnx-and-phi-2">
<span id="l-plot-exporter-recipes-custom-phi2"></span><span id="sphx-glr-auto-recipes-plot-exporter-recipes-c-phi2-py"></span><h1>to_onnx and Phi-2<a class="headerlink" href="#to-onnx-and-phi-2" title="Link to this heading"></a></h1>
<p>Exports model <a class="reference external" href="https://huggingface.co/microsoft/phi-2">Phi-2</a>.
We use a dummy model. The main difficulty is to set the dynamic shapes properly.
If there is an issue, you can go to the following line:
<a class="reference external" href="https://github.com/pytorch/pytorch/blob/main/torch/fx/experimental/symbolic_shapes.py#L5965">torch/fx/experimental/symbolic_shapes.py#L5965</a>
and look for <code class="docutils literal notranslate"><span class="pre">log.info(&quot;set_replacement</span> <span class="pre">%s</span> <span class="pre">=</span> <span class="pre">%s</span> <span class="pre">(%s)</span> <span class="pre">%s&quot;,</span> <span class="pre">a,</span> <span class="pre">tgt,</span> <span class="pre">msg,</span> <span class="pre">tgt_bound)</span></code> and add
before or after, something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tgt</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;dynamic shape becomes a constant &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">tgt</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="p">(</span><span class="n">tgt</span><span class="p">),</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tgt_bound</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Adding <code class="docutils literal notranslate"><span class="pre">TORCH_LOGS=&quot;+dynamo&quot;</span> <span class="pre">TORCHDYNAMO_VERBOSE=1</span></code> prints out more information
about dynamic shapes.</p>
<section id="model">
<h2>Model<a class="headerlink" href="#model" title="Link to this heading"></a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><span class="n">Any</span></a></a></a><span class="p">,</span> <a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Dict</span></a></a></a>
<span class="kn">import</span> <span class="nn">onnx</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">transformers</span>
<span class="kn">from</span> <span class="nn">onnx_array_api.plotting.graphviz_helper</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><span class="n">plot_dot</span></a></a></a>
<span class="kn">from</span> <span class="nn">experimental_experiment.helpers</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a>
<span class="kn">from</span> <span class="nn">experimental_experiment.xbuilder</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><span class="n">GraphBuilder</span></a></a></a><span class="p">,</span> <span class="n">InferShapesOptions</span>
<span class="kn">from</span> <span class="nn">experimental_experiment.torch_interpreter</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><span class="n">to_onnx</span></a></a></a><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><span class="n">ExportOptions</span></a></a></a>


<span class="k">def</span> <span class="nf">get_phi2_untrained</span><span class="p">(</span><span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Dict</span></a></a></a><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><span class="n">Any</span></a></a></a><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets a non initialized model with its inputs</span>

<span class="sd">    :param batch_size: batch size</span>
<span class="sd">    :param kwargs: to overwrite the configuration, example ``num_hidden_layers=1``</span>
<span class="sd">    :return: dictionary</span>

<span class="sd">    See `Phi-2/config.json</span>
<span class="sd">    &lt;https://huggingface.co/microsoft/phi-2/blob/main/config.json&gt;`_.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;_name_or_path&quot;</span><span class="p">:</span> <span class="s2">&quot;microsoft/phi-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;architectures&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PhiForCausalLM&quot;</span><span class="p">],</span>
        <span class="s2">&quot;attention_dropout&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;bos_token_id&quot;</span><span class="p">:</span> <span class="mi">50256</span><span class="p">,</span>
        <span class="s2">&quot;embd_pdrop&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;eos_token_id&quot;</span><span class="p">:</span> <span class="mi">50256</span><span class="p">,</span>
        <span class="s2">&quot;hidden_act&quot;</span><span class="p">:</span> <span class="s2">&quot;gelu_new&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hidden_size&quot;</span><span class="p">:</span> <span class="mi">2560</span><span class="p">,</span>
        <span class="s2">&quot;initializer_range&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
        <span class="s2">&quot;intermediate_size&quot;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
        <span class="s2">&quot;layer_norm_eps&quot;</span><span class="p">:</span> <span class="mf">1e-05</span><span class="p">,</span>
        <span class="s2">&quot;max_position_embeddings&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_attention_heads&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;num_key_value_heads&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;partial_rotary_factor&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
        <span class="s2">&quot;qk_layernorm&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;resid_pdrop&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;rope_scaling&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;rope_theta&quot;</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">&quot;tie_word_embeddings&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;torch_dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;float16&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transformers_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.37.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;use_cache&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;vocab_size&quot;</span><span class="p">:</span> <span class="mi">51200</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">transformers</span><span class="o">.</span><span class="n">PhiConfig</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">transformers</span><span class="o">.</span><span class="n">PhiForCausalLM</span></a></a></a><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
    <a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">eval</span></a></a></a><span class="p">()</span>

    <span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span><span class="p">(</span><span class="s2">&quot;batch&quot;</span><span class="p">)</span>
    <span class="n">seq_length</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span><span class="p">(</span><span class="s2">&quot;seq_length&quot;</span><span class="p">)</span>
    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">cache</span> <span class="o">=</span> <a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">transformers</span><span class="o">.</span><span class="n">cache_utils</span><span class="o">.</span><span class="n">DynamicCache</span></a></a></a><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">]):</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">i</span>
        <span class="p">)</span>
    <span class="n">cache2</span> <span class="o">=</span> <a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">transformers</span><span class="o">.</span><span class="n">cache_utils</span><span class="o">.</span><span class="n">DynamicCache</span></a></a></a><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">]):</span>
        <span class="n">cache2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a><span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
            <a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a><span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
            <span class="n">i</span><span class="p">,</span>
        <span class="p">)</span>

    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randint</span></a></a></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50285</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a><span class="p">),</span>
        <span class="n">attention_mask</span><span class="o">=</span><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">ones</span></a></a></a><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">33</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a><span class="p">),</span>
        <span class="n">past_key_values</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">inputs2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randint</span></a></a></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50285</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a><span class="p">),</span>
        <span class="n">attention_mask</span><span class="o">=</span><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">ones</span></a></a></a><span class="p">((</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a><span class="p">),</span>
        <span class="n">past_key_values</span><span class="o">=</span><span class="n">cache2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cache</span><span class="o">.</span><span class="n">key_cache</span><span class="p">)</span>
    <span class="n">cache_length</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span><span class="p">(</span><span class="s2">&quot;cache_length&quot;</span><span class="p">)</span>
    <span class="n">shapes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">seq_length</span><span class="p">},</span>
            <span class="s2">&quot;attention_mask&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span>
                <span class="mi">1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span><span class="o">.</span><span class="n">DYNAMIC</span><span class="p">,</span>  <span class="c1"># cache_length + seq_length</span>
            <span class="p">},</span>
            <span class="s2">&quot;past_key_values&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">cache_length</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)],</span>  <span class="c1"># 0: batch,</span>
                <span class="p">[{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">cache_length</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)],</span>  <span class="c1"># 0: batch,</span>
            <span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a><span class="o">=</span><span class="n">shapes</span><span class="p">,</span> <span class="n">inputs2</span><span class="o">=</span><span class="n">inputs2</span><span class="p">)</span>


<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a> <span class="o">=</span> <span class="n">get_phi2_untrained</span><span class="p">(</span><span class="n">num_hidden_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a><span class="p">[</span><span class="s2">&quot;dynamic_shapes&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dynamic_shapes&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>inputs dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
dynamic_shapes {&#39;input_ids&#39;: {0: &lt;class &#39;__main__.batch&#39;&gt;, 1: &lt;class &#39;__main__.seq_length&#39;&gt;}, &#39;attention_mask&#39;: {0: &lt;class &#39;__main__.batch&#39;&gt;, 1: &lt;_DimHint.DYNAMIC: 3&gt;}, &#39;past_key_values&#39;: [[{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}, {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}], [{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}, {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}]]}
</pre></div>
</div>
<p>Lets check it is working.
We need to copy the input before calling the model
because it modified the inputs and they are not properly
set up when the export starts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">(</span><span class="o">**</span><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>CausalLMOutputWithPast(loss=None, logits=tensor([[[-0.3812, -1.1278,  1.1944,  ...,  0.9844,  1.1447,  0.7562],
         [ 1.1919,  0.6332,  0.5400,  ...,  1.6002, -2.1151,  0.3507],
         [ 2.1920,  1.2839,  1.1958,  ...,  0.2948, -0.4734, -1.2206]],

        [[ 1.3238,  0.4629,  0.4342,  ...,  0.4077, -0.8261,  1.6520],
         [ 1.0973, -0.6386, -1.2466,  ...,  0.0478,  0.8131, -0.0728],
         [ 1.5062, -0.1672,  0.5034,  ..., -0.9577, -0.1961,  0.4847]]],
       grad_fn=&lt;UnsafeViewBackward0&gt;), past_key_values=DynamicCache(), hidden_states=None, attentions=None)
</pre></div>
</div>
</section>
<section id="export">
<h2>Export<a class="headerlink" href="#export" title="Link to this heading"></a></h2>
<p>We try to export with <a class="reference internal" href="../api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx"><code class="xref py py-func docutils literal notranslate"><span class="pre">experimental_experiment.torch_interpreter.to_onnx()</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">to_onnx(model,</span> <span class="pre">(),</span> <span class="pre">kwargs=copy.deepcopy(inputs),</span> <span class="pre">dynamic_shapes=dynamic_shapes)</span></code></p>
<p>This fails because of dynamic shapes issues.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Constraints violated (batch, seq_length)! For more information,
run with TORCH_LOGS=&quot;+dynamic&quot;.
Cannot associate shape
    [[{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;},
      {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}],
     [{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;},
      {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}]]
    specified at `dynamic_shapes[&#39;past_key_values&#39;]`
        to non-tensor type &lt;class &#39;transformers.cache_utils.DynamicCache&#39;&gt;
        at `inputs[&#39;past_key_values&#39;]` (expected None)
</pre></div>
</div>
<p>The export fails for a couple of reason but it is possible to patch the
code to make it work. All those modifications are put in place by
<a class="reference internal" href="../api/torch_interpreter/onnx_export_errors.html#module-experimental_experiment.torch_interpreter.onnx_export_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors"><code class="xref py py-func docutils literal notranslate"><span class="pre">onnx_export_errors</span></code></a>
and reverted after the export is done. Among other things, this function registers
serialization functions as shown in example
<a class="reference internal" href="plot_exporter_exporter_with_dyamic_cache.html#l-plot-torch-export-with-dynamic-cache-201"><span class="std std-ref">Export a model using a custom type as input</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">experimental_experiment.torch_interpreter.onnx_export_errors</span> <span class="kn">import</span> <span class="p">(</span>
    <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><span class="n">bypass_export_some_errors</span></a></a></a><span class="p">,</span>
<span class="p">)</span>

<span class="k">with</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/onnx_export_errors.html#experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" title="experimental_experiment.torch_interpreter.onnx_export_errors.bypass_export_some_errors" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter-onnx_export_errors sphx-glr-backref-type-py-function"><span class="n">bypass_export_some_errors</span></a></a></a><span class="p">(</span>
    <span class="n">patch_transformers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace_dynamic_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">modificator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs before&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a> <span class="o">=</span> <span class="n">modificator</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs after&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="c1"># ep = torch.export.export(model, (), inputs, dynamic_shapes=dynamic_shapes, strict=False)</span>
    <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">large_onx</span></a></a></a> <span class="o">=</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><span class="n">to_onnx</span></a></a></a><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="p">(),</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a><span class="p">,</span>
        <span class="n">export_options</span><span class="o">=</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><span class="n">ExportOptions</span></a></a></a><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">large_model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <a href="https://onnx.ai/onnx/api/model_container.html#onnx.model_container.ModelContainer.save" title="onnx.model_container.ModelContainer.save" class="sphx-glr-backref-module-onnx-model_container sphx-glr-backref-type-py-method"><a href="https://onnx.ai/onnx/api/model_container.html#onnx.model_container.ModelContainer.save" title="onnx.model_container.ModelContainer.save" class="sphx-glr-backref-module-onnx-model_container sphx-glr-backref-type-py-method"><a href="https://onnx.ai/onnx/api/model_container.html#onnx.model_container.ModelContainer.save" title="onnx.model_container.ModelContainer.save" class="sphx-glr-backref-module-onnx-model_container sphx-glr-backref-type-py-method"><span class="n">large_onx</span><span class="o">.</span><span class="n">save</span></a></a></a><span class="p">(</span><span class="s2">&quot;plot_exporter_recipes_c_phi2.onnx&quot;</span><span class="p">,</span> <span class="n">all_tensors_to_one_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[bypass_export_some_errors] replace torch.jit.isinstance, torch._dynamo.mark_static_address
[bypass_export_some_errors] register MambaCache
[bypass_export_some_errors] register DynamicCache
[bypass_export_some_errors] register patched_DynamicCache
[bypass_export_some_errors] patch sympy
[bypass_export_some_errors] patch pytorch
[bypass_export_some_errors] catch produce_guards_and_solve_constraints
[bypass_export_some_errors] patch transformers
[bypass_export_some_errors] replace DynamicCache
inputs before dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
inputs after dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:patched_DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
[_catch_produce_guards_and_solve_constraints] ERRORproduce_guards_and_solve_constraints failed, use SKIP_SOLVE_CONSTRAINTS=0 to avoid skipping
fake_mode=&lt;torch._subclasses.fake_tensor.FakeTensorMode object at 0x7fdc2fe45be0&gt;
dynamic_shapes={&#39;input_ids&#39;: {0: &lt;class &#39;__main__.batch&#39;&gt;, 1: &lt;class &#39;__main__.seq_length&#39;&gt;}, &#39;attention_mask&#39;: {0: &lt;class &#39;__main__.batch&#39;&gt;, 1: &lt;_DimHint.DYNAMIC: 3&gt;}, &#39;past_key_values&#39;: [[{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}, {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}], [{0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}, {0: &lt;class &#39;__main__.batch&#39;&gt;, 2: &lt;class &#39;__main__.cache_length&#39;&gt;}]]}
equalities_inputs=EqualityConstraint(warn_only=False, source_pairs=[(TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;attention_mask&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2)), (TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2))], derived_equalities=[], phantom_symbols=[], relaxed_sources={TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;attention_mask&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=1)}, _parents={TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;attention_mask&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;input_ids&#39;, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=0), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2), TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;value_cache&#39;, index_is_slice=False), index=1, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2): TensorPropertySource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=GetItemSource(base=LocalSource(local_name=&#39;args&#39;, is_input=False, is_derefed_cell_contents=False), index=1, index_is_slice=False), index=&#39;past_key_values&#39;, index_is_slice=False), index=&#39;key_cache&#39;, index_is_slice=False), index=0, index_is_slice=False), prop=&lt;TensorProperty.SIZE: 0&gt;, idx=2)}, _defs={})
original_signature=(input_ids: torch.LongTensor = None, attention_mask: Optional[torch.Tensor] = None, position_ids: Optional[torch.LongTensor] = None, past_key_values: Union[transformers.cache_utils.Cache, List[torch.FloatTensor], NoneType] = None, inputs_embeds: Optional[torch.FloatTensor] = None, labels: Optional[torch.LongTensor] = None, use_cache: Optional[bool] = None, output_attentions: Optional[bool] = None, output_hidden_states: Optional[bool] = None, return_dict: Optional[bool] = None, cache_position: Optional[torch.LongTensor] = None, num_logits_to_keep: int = 0, **kwargs: Unpack[transformers.models.phi.modeling_phi.KwargsForCausalLM]) -&gt; Union[Tuple, transformers.modeling_outputs.CausalLMOutputWithPast]
_is_torch_jit_trace=False
exc=Constraints violated (batch, seq_length)! For more information, run with TORCH_LOGS=&quot;+dynamic&quot;.
  - Not all values of seq_length = L[&#39;args&#39;][1][&#39;input_ids&#39;].size()[1] in the specified range satisfy the generated guard L[&#39;args&#39;][1][&#39;input_ids&#39;].size()[1] != 9223372036854775807.
  - Not all values of batch = L[&#39;args&#39;][1][&#39;input_ids&#39;].size()[0] in the specified range satisfy the generated guard L[&#39;args&#39;][1][&#39;input_ids&#39;].size()[0] != 9223372036854775807.
gm=&lt;lambda&gt;()



def forward(self, arg0_1, arg1_1, arg2_1, arg3_1, arg4_1, arg5_1, arg6_1, arg7_1, arg8_1, arg9_1, arg10_1, arg11_1, arg12_1, arg13_1, arg14_1, arg15_1, arg16_1, arg17_1, arg18_1, arg19_1, arg20_1, arg21_1, arg22_1, arg23_1, arg24_1, arg25_1, arg26_1, arg27_1, arg28_1, arg29_1, arg30_1, arg31_1, arg32_1, arg33_1, arg34_1, arg35_1, arg36_1, arg37_1, arg38_1):
    embedding = torch.ops.aten.embedding.default(arg0_1, arg33_1);  arg0_1 = None
    sym_size_int = torch.ops.aten.sym_size.int(arg35_1, 2)
    sym_size_int_1 = torch.ops.aten.sym_size.int(arg33_1, 1)
    add = sym_size_int + sym_size_int_1
    arange = torch.ops.aten.arange.start(sym_size_int, add, device = device(type=&#39;cpu&#39;), pin_memory = False);  sym_size_int = add = None
    unsqueeze = torch.ops.aten.unsqueeze.default(arange, 0)
    sym_size_int_2 = torch.ops.aten.sym_size.int(arg34_1, 1)
    full = torch.ops.aten.full.default([sym_size_int_1, sym_size_int_2], -3.4028234663852886e+38, dtype = torch.float32, device = device(type=&#39;cpu&#39;), pin_memory = False)
    triu = torch.ops.aten.triu.default(full, 1);  full = None
    arange_1 = torch.ops.aten.arange.default(sym_size_int_2, device = device(type=&#39;cpu&#39;), pin_memory = False);  sym_size_int_2 = None
    reshape = torch.ops.aten.reshape.default(arange, [-1, 1]);  arange = None
    gt = torch.ops.aten.gt.Tensor(arange_1, reshape);  arange_1 = reshape = None
    mul_ = torch.ops.aten.mul_.Tensor(triu, gt);  triu = gt = None
    unsqueeze_1 = torch.ops.aten.unsqueeze.default(mul_, 0);  mul_ = None
    unsqueeze_2 = torch.ops.aten.unsqueeze.default(unsqueeze_1, 1);  unsqueeze_1 = None
    slice_1 = torch.ops.aten.slice.Tensor(unsqueeze_2, 2, 0, 9223372036854775807);  unsqueeze_2 = None
    slice_2 = torch.ops.aten.slice.Tensor(slice_1, 3, 0, 9223372036854775807);  slice_1 = None
    sym_size_int_5 = torch.ops.aten.sym_size.int(arg33_1, 0);  arg33_1 = None
    expand = torch.ops.aten.expand.default(slice_2, [sym_size_int_5, 1, -1, -1]);  slice_2 = None
    clone = torch.ops.aten.clone.default(expand);  expand = None
    slice_3 = torch.ops.aten.slice.Tensor(clone, 0, 0, 9223372036854775807)
    slice_4 = torch.ops.aten.slice.Tensor(slice_3, 1, 0, 9223372036854775807);  slice_3 = None
    slice_5 = torch.ops.aten.slice.Tensor(slice_4, 2, 0, 9223372036854775807);  slice_4 = None
    slice_6 = torch.ops.aten.slice.Tensor(arg34_1, 0, 0, 9223372036854775807);  arg34_1 = None
    unsqueeze_3 = torch.ops.aten.unsqueeze.default(slice_6, 1);  slice_6 = None
    unsqueeze_4 = torch.ops.aten.unsqueeze.default(unsqueeze_3, 2);  unsqueeze_3 = None
    slice_7 = torch.ops.aten.slice.Tensor(unsqueeze_4, 3, 0, 9223372036854775807);  unsqueeze_4 = None
    add_2 = torch.ops.aten.add.Tensor(slice_5, slice_7);  slice_5 = slice_7 = None
    eq_7 = torch.ops.aten.eq.Scalar(add_2, 0);  add_2 = None
    slice_8 = torch.ops.aten.slice.Tensor(clone, 0, 0, 9223372036854775807)
    slice_9 = torch.ops.aten.slice.Tensor(slice_8, 1, 0, 9223372036854775807);  slice_8 = None
    slice_10 = torch.ops.aten.slice.Tensor(slice_9, 2, 0, 9223372036854775807);  slice_9 = None
    masked_fill = torch.ops.aten.masked_fill.Scalar(slice_10, eq_7, -3.4028234663852886e+38);  slice_10 = eq_7 = None
    slice_11 = torch.ops.aten.slice.Tensor(clone, 0, 0, 9223372036854775807)
    slice_12 = torch.ops.aten.slice.Tensor(slice_11, 1, 0, 9223372036854775807);  slice_11 = None
    slice_13 = torch.ops.aten.slice.Tensor(slice_12, 2, 0, 9223372036854775807);  slice_12 = None
    copy_ = torch.ops.aten.copy_.default(slice_13, masked_fill);  slice_13 = masked_fill = copy_ = None
    dropout = torch.ops.aten.dropout.default(embedding, 0.0, False);  embedding = None
    _set_grad_enabled = torch._C._set_grad_enabled(False);  _set_grad_enabled = None
    unsqueeze_5 = torch.ops.aten.unsqueeze.default(arg32_1, 0);  arg32_1 = None
    slice_14 = torch.ops.aten.slice.Tensor(unsqueeze_5, 1, 0, 9223372036854775807);  unsqueeze_5 = None
    unsqueeze_6 = torch.ops.aten.unsqueeze.default(slice_14, 2);  slice_14 = None
    to = torch.ops.aten.to.dtype(unsqueeze_6, torch.float32);  unsqueeze_6 = None
    expand_1 = torch.ops.aten.expand.default(to, [1, -1, 1]);  to = None
    slice_15 = torch.ops.aten.slice.Tensor(unsqueeze, 0, 0, 9223372036854775807);  unsqueeze = None
    unsqueeze_7 = torch.ops.aten.unsqueeze.default(slice_15, 1);  slice_15 = None
    slice_16 = torch.ops.aten.slice.Tensor(unsqueeze_7, 2, 0, 9223372036854775807);  unsqueeze_7 = None
    to_1 = torch.ops.aten.to.dtype(slice_16, torch.float32);  slice_16 = None
    _enter_autocast = torch.amp.autocast_mode._enter_autocast(&#39;cpu&#39;, torch.bfloat16, False, False)
    to_2 = torch.ops.aten.to.dtype(expand_1, torch.float32);  expand_1 = None
    to_3 = torch.ops.aten.to.dtype(to_1, torch.float32);  to_1 = None
    matmul = torch.ops.aten.matmul.default(to_2, to_3);  to_2 = to_3 = None
    transpose = torch.ops.aten.transpose.int(matmul, 1, 2);  matmul = None
    cat = torch.ops.aten.cat.default([transpose, transpose], -1);  transpose = None
    cos = torch.ops.aten.cos.default(cat)
    sin = torch.ops.aten.sin.default(cat);  cat = None
    _exit_autocast = torch.amp.autocast_mode._exit_autocast(_enter_autocast);  _enter_autocast = _exit_autocast = None
    mul = torch.ops.aten.mul.Tensor(cos, 1.0);  cos = None
    mul_1 = torch.ops.aten.mul.Tensor(sin, 1.0);  sin = None
    to_4 = torch.ops.aten.to.dtype(mul, torch.float32);  mul = None
    to_5 = torch.ops.aten.to.dtype(mul_1, torch.float32);  mul_1 = None
    _set_grad_enabled_1 = torch._C._set_grad_enabled(True);  _set_grad_enabled_1 = None
    layer_norm = torch.ops.aten.layer_norm.default(dropout, [2560], arg13_1, arg14_1);  arg13_1 = arg14_1 = None
    linear = torch.ops.aten.linear.default(layer_norm, arg1_1, arg2_1);  arg1_1 = arg2_1 = None
    view = torch.ops.aten.view.default(linear, [sym_size_int_5, sym_size_int_1, -1, 80]);  linear = None
    transpose_1 = torch.ops.aten.transpose.int(view, 1, 2);  view = None
    linear_1 = torch.ops.aten.linear.default(layer_norm, arg3_1, arg4_1);  arg3_1 = arg4_1 = None
    view_1 = torch.ops.aten.view.default(linear_1, [sym_size_int_5, sym_size_int_1, -1, 80]);  linear_1 = None
    transpose_2 = torch.ops.aten.transpose.int(view_1, 1, 2);  view_1 = None
    linear_2 = torch.ops.aten.linear.default(layer_norm, arg5_1, arg6_1);  arg5_1 = arg6_1 = None
    view_2 = torch.ops.aten.view.default(linear_2, [sym_size_int_5, sym_size_int_1, -1, 80]);  linear_2 = None
    transpose_3 = torch.ops.aten.transpose.int(view_2, 1, 2);  view_2 = None
    slice_17 = torch.ops.aten.slice.Tensor(transpose_1, 3, 0, 32)
    slice_18 = torch.ops.aten.slice.Tensor(transpose_1, 3, 32, 9223372036854775807);  transpose_1 = None
    slice_19 = torch.ops.aten.slice.Tensor(transpose_2, 3, 0, 32)
    slice_20 = torch.ops.aten.slice.Tensor(transpose_2, 3, 32, 9223372036854775807);  transpose_2 = None
    unsqueeze_8 = torch.ops.aten.unsqueeze.default(to_4, 1)
    unsqueeze_9 = torch.ops.aten.unsqueeze.default(to_5, 1)
    mul_2 = torch.ops.aten.mul.Tensor(slice_17, unsqueeze_8)
    slice_21 = torch.ops.aten.slice.Tensor(slice_17, 3, 0, 16)
    slice_22 = torch.ops.aten.slice.Tensor(slice_17, 3, 16, 9223372036854775807);  slice_17 = None
    neg = torch.ops.aten.neg.default(slice_22);  slice_22 = None
    cat_1 = torch.ops.aten.cat.default([neg, slice_21], -1);  neg = slice_21 = None
    mul_3 = torch.ops.aten.mul.Tensor(cat_1, unsqueeze_9);  cat_1 = None
    add_3 = torch.ops.aten.add.Tensor(mul_2, mul_3);  mul_2 = mul_3 = None
    mul_4 = torch.ops.aten.mul.Tensor(slice_19, unsqueeze_8);  unsqueeze_8 = None
    slice_23 = torch.ops.aten.slice.Tensor(slice_19, 3, 0, 16)
    slice_24 = torch.ops.aten.slice.Tensor(slice_19, 3, 16, 9223372036854775807);  slice_19 = None
    neg_1 = torch.ops.aten.neg.default(slice_24);  slice_24 = None
    cat_2 = torch.ops.aten.cat.default([neg_1, slice_23], -1);  neg_1 = slice_23 = None
    mul_5 = torch.ops.aten.mul.Tensor(cat_2, unsqueeze_9);  cat_2 = unsqueeze_9 = None
    add_4 = torch.ops.aten.add.Tensor(mul_4, mul_5);  mul_4 = mul_5 = None
    cat_3 = torch.ops.aten.cat.default([add_3, slice_18], -1);  add_3 = slice_18 = None
    cat_4 = torch.ops.aten.cat.default([add_4, slice_20], -1);  add_4 = slice_20 = None
    cat_5 = torch.ops.aten.cat.default([arg35_1, cat_4], -2);  arg35_1 = cat_4 = None
    cat_6 = torch.ops.aten.cat.default([arg37_1, transpose_3], -2);  arg37_1 = transpose_3 = None
    slice_25 = torch.ops.aten.slice.Tensor(clone, 0, 0, 9223372036854775807)
    slice_26 = torch.ops.aten.slice.Tensor(slice_25, 1, 0, 9223372036854775807);  slice_25 = None
    slice_27 = torch.ops.aten.slice.Tensor(slice_26, 2, 0, 9223372036854775807);  slice_26 = None
    scaled_dot_product_attention = torch.ops.aten.scaled_dot_product_attention.default(cat_3, cat_5, cat_6, slice_27, scale = 0.11180339887498948);  cat_3 = slice_27 = None
    transpose_4 = torch.ops.aten.transpose.int(scaled_dot_product_attention, 1, 2);  scaled_dot_product_attention = None
    contiguous = torch.ops.aten.contiguous.default(transpose_4);  transpose_4 = None
    reshape_1 = torch.ops.aten.reshape.default(contiguous, [sym_size_int_5, sym_size_int_1, -1]);  contiguous = sym_size_int_1 = None
    linear_3 = torch.ops.aten.linear.default(reshape_1, arg7_1, arg8_1);  reshape_1 = arg7_1 = arg8_1 = None
    dropout_1 = torch.ops.aten.dropout.default(linear_3, 0.1, False)
    linear_4 = torch.ops.aten.linear.default(layer_norm, arg9_1, arg10_1);  layer_norm = arg9_1 = arg10_1 = None
    mul_6 = torch.ops.aten.mul.Tensor(linear_4, 0.5)
    pow_1 = torch.ops.aten.pow.Tensor_Scalar(linear_4, 3.0)
    mul_7 = torch.ops.aten.mul.Tensor(pow_1, 0.044715);  pow_1 = None
    add_6 = torch.ops.aten.add.Tensor(linear_4, mul_7);  linear_4 = mul_7 = None
    mul_8 = torch.ops.aten.mul.Tensor(add_6, 0.7978845608028654);  add_6 = None
    tanh = torch.ops.aten.tanh.default(mul_8);  mul_8 = None
    add_7 = torch.ops.aten.add.Tensor(tanh, 1.0);  tanh = None
    mul_9 = torch.ops.aten.mul.Tensor(mul_6, add_7);  mul_6 = add_7 = None
    linear_5 = torch.ops.aten.linear.default(mul_9, arg11_1, arg12_1);  mul_9 = arg11_1 = arg12_1 = None
    dropout_2 = torch.ops.aten.dropout.default(linear_5, 0.1, False);  linear_5 = None
    add_8 = torch.ops.aten.add.Tensor(dropout_1, dropout_2);  dropout_1 = dropout_2 = None
    add_9 = torch.ops.aten.add.Tensor(add_8, dropout);  add_8 = dropout = None
    layer_norm_1 = torch.ops.aten.layer_norm.default(add_9, [2560], arg27_1, arg28_1);  arg27_1 = arg28_1 = None
    linear_6 = torch.ops.aten.linear.default(layer_norm_1, arg15_1, arg16_1);  arg15_1 = arg16_1 = None
    sym_size_int_16 = torch.ops.aten.sym_size.int(linear_3, 1);  linear_3 = None
    view_3 = torch.ops.aten.view.default(linear_6, [sym_size_int_5, sym_size_int_16, -1, 80]);  linear_6 = None
    transpose_5 = torch.ops.aten.transpose.int(view_3, 1, 2);  view_3 = None
    linear_7 = torch.ops.aten.linear.default(layer_norm_1, arg17_1, arg18_1);  arg17_1 = arg18_1 = None
    view_4 = torch.ops.aten.view.default(linear_7, [sym_size_int_5, sym_size_int_16, -1, 80]);  linear_7 = None
    transpose_6 = torch.ops.aten.transpose.int(view_4, 1, 2);  view_4 = None
    linear_8 = torch.ops.aten.linear.default(layer_norm_1, arg19_1, arg20_1);  arg19_1 = arg20_1 = None
    view_5 = torch.ops.aten.view.default(linear_8, [sym_size_int_5, sym_size_int_16, -1, 80]);  linear_8 = None
    transpose_7 = torch.ops.aten.transpose.int(view_5, 1, 2);  view_5 = None
    slice_28 = torch.ops.aten.slice.Tensor(transpose_5, 3, 0, 32)
    slice_29 = torch.ops.aten.slice.Tensor(transpose_5, 3, 32, 9223372036854775807);  transpose_5 = None
    slice_30 = torch.ops.aten.slice.Tensor(transpose_6, 3, 0, 32)
    slice_31 = torch.ops.aten.slice.Tensor(transpose_6, 3, 32, 9223372036854775807);  transpose_6 = None
    unsqueeze_10 = torch.ops.aten.unsqueeze.default(to_4, 1);  to_4 = None
    unsqueeze_11 = torch.ops.aten.unsqueeze.default(to_5, 1);  to_5 = None
    mul_10 = torch.ops.aten.mul.Tensor(slice_28, unsqueeze_10)
    slice_32 = torch.ops.aten.slice.Tensor(slice_28, 3, 0, 16)
    slice_33 = torch.ops.aten.slice.Tensor(slice_28, 3, 16, 9223372036854775807);  slice_28 = None
    neg_2 = torch.ops.aten.neg.default(slice_33);  slice_33 = None
    cat_7 = torch.ops.aten.cat.default([neg_2, slice_32], -1);  neg_2 = slice_32 = None
    mul_11 = torch.ops.aten.mul.Tensor(cat_7, unsqueeze_11);  cat_7 = None
    add_10 = torch.ops.aten.add.Tensor(mul_10, mul_11);  mul_10 = mul_11 = None
    mul_12 = torch.ops.aten.mul.Tensor(slice_30, unsqueeze_10);  unsqueeze_10 = None
    slice_34 = torch.ops.aten.slice.Tensor(slice_30, 3, 0, 16)
    slice_35 = torch.ops.aten.slice.Tensor(slice_30, 3, 16, 9223372036854775807);  slice_30 = None
    neg_3 = torch.ops.aten.neg.default(slice_35);  slice_35 = None
    cat_8 = torch.ops.aten.cat.default([neg_3, slice_34], -1);  neg_3 = slice_34 = None
    mul_13 = torch.ops.aten.mul.Tensor(cat_8, unsqueeze_11);  cat_8 = unsqueeze_11 = None
    add_11 = torch.ops.aten.add.Tensor(mul_12, mul_13);  mul_12 = mul_13 = None
    cat_9 = torch.ops.aten.cat.default([add_10, slice_29], -1);  add_10 = slice_29 = None
    cat_10 = torch.ops.aten.cat.default([add_11, slice_31], -1);  add_11 = slice_31 = None
    cat_11 = torch.ops.aten.cat.default([arg36_1, cat_10], -2);  arg36_1 = cat_10 = None
    cat_12 = torch.ops.aten.cat.default([arg38_1, transpose_7], -2);  arg38_1 = transpose_7 = None
    slice_36 = torch.ops.aten.slice.Tensor(clone, 0, 0, 9223372036854775807);  clone = None
    slice_37 = torch.ops.aten.slice.Tensor(slice_36, 1, 0, 9223372036854775807);  slice_36 = None
    slice_38 = torch.ops.aten.slice.Tensor(slice_37, 2, 0, 9223372036854775807);  slice_37 = None
    scaled_dot_product_attention_1 = torch.ops.aten.scaled_dot_product_attention.default(cat_9, cat_11, cat_12, slice_38, scale = 0.11180339887498948);  cat_9 = slice_38 = None
    transpose_8 = torch.ops.aten.transpose.int(scaled_dot_product_attention_1, 1, 2);  scaled_dot_product_attention_1 = None
    contiguous_1 = torch.ops.aten.contiguous.default(transpose_8);  transpose_8 = None
    reshape_2 = torch.ops.aten.reshape.default(contiguous_1, [sym_size_int_5, sym_size_int_16, -1]);  contiguous_1 = sym_size_int_5 = sym_size_int_16 = None
    linear_9 = torch.ops.aten.linear.default(reshape_2, arg21_1, arg22_1);  reshape_2 = arg21_1 = arg22_1 = None
    dropout_3 = torch.ops.aten.dropout.default(linear_9, 0.1, False);  linear_9 = None
    linear_10 = torch.ops.aten.linear.default(layer_norm_1, arg23_1, arg24_1);  layer_norm_1 = arg23_1 = arg24_1 = None
    mul_14 = torch.ops.aten.mul.Tensor(linear_10, 0.5)
    pow_2 = torch.ops.aten.pow.Tensor_Scalar(linear_10, 3.0)
    mul_15 = torch.ops.aten.mul.Tensor(pow_2, 0.044715);  pow_2 = None
    add_12 = torch.ops.aten.add.Tensor(linear_10, mul_15);  linear_10 = mul_15 = None
    mul_16 = torch.ops.aten.mul.Tensor(add_12, 0.7978845608028654);  add_12 = None
    tanh_1 = torch.ops.aten.tanh.default(mul_16);  mul_16 = None
    add_13 = torch.ops.aten.add.Tensor(tanh_1, 1.0);  tanh_1 = None
    mul_17 = torch.ops.aten.mul.Tensor(mul_14, add_13);  mul_14 = add_13 = None
    linear_11 = torch.ops.aten.linear.default(mul_17, arg25_1, arg26_1);  mul_17 = arg25_1 = arg26_1 = None
    dropout_4 = torch.ops.aten.dropout.default(linear_11, 0.1, False);  linear_11 = None
    add_14 = torch.ops.aten.add.Tensor(dropout_3, dropout_4);  dropout_3 = dropout_4 = None
    add_15 = torch.ops.aten.add.Tensor(add_14, add_9);  add_14 = add_9 = None
    layer_norm_2 = torch.ops.aten.layer_norm.default(add_15, [2560], arg29_1, arg30_1);  add_15 = arg29_1 = arg30_1 = None
    slice_39 = torch.ops.aten.slice.Tensor(layer_norm_2, 0, 0, 9223372036854775807);  layer_norm_2 = None
    slice_40 = torch.ops.aten.slice.Tensor(slice_39, 1, 0, 9223372036854775807);  slice_39 = None
    slice_41 = torch.ops.aten.slice.Tensor(slice_40, 2, 0, 9223372036854775807);  slice_40 = None
    linear_12 = torch.ops.aten.linear.default(slice_41, arg31_1);  slice_41 = arg31_1 = None
    return (linear_12, cat_5, cat_11, cat_6, cat_12)

# To see more debug info, please use `graph_module.print_readable()`
[bypass_export_some_errors] restored sympy functions
[bypass_export_some_errors] restored pytorch functions
[bypass_export_some_errors] restored produce_guards_and_solve_constraints
[bypass_export_some_errors] restored transformer
[bypass_export_some_errors] restored DynamicCache
[bypass_export_some_errors] unregistered MambaCache
[bypass_export_some_errors] unregistered DynamicCache
[bypass_export_some_errors] unregistered patched_DynamicCache
</pre></div>
</div>
<p>Lets display the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a> <span class="o">=</span> <a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><span class="n">onnx</span><span class="o">.</span><span class="n">load</span></a></a></a><span class="p">(</span><span class="s2">&quot;plot_exporter_recipes_c_phi2.onnx&quot;</span><span class="p">)</span>
<a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gr</span></a></a></a> <span class="o">=</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><span class="n">GraphBuilder</span></a></a></a><span class="p">(</span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a><span class="p">,</span> <span class="n">infer_shapes_options</span><span class="o">=</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">InferShapesOptions</span><span class="o">.</span><span class="n">NONE</span></a></a></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gr</span></a></a></a><span class="o">.</span><span class="n">pretty_text</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>dyn---: DYN0 -&gt; WrapSym(DYN0)
dyn---: batch -&gt; WrapSym(batch)
dyn---: cache_length -&gt; WrapSym(cache_length)
dyn---: cache_length+seq_length -&gt; WrapSym(cache_length+seq_length)
dyn---: seq_length -&gt; WrapSym(seq_length)
dynrev: DYN0 -&gt; [(&#39;DYN0&#39;, SymInt(DYN0))]
dynrev: batch -&gt; [(&#39;batch&#39;, SymInt(batch))]
dynrev: cache_length -&gt; [(&#39;cache_length&#39;, SymInt(cache_length))]
dynrev: cache_length+seq_length -&gt; [(&#39;cache_length+seq_length&#39;, SymInt(cache_length+seq_length))]
dynrev: seq_length -&gt; [(&#39;seq_length&#39;, SymInt(seq_length))]
dynsrc: DYN0 -&gt; [{DYN0:(&#39;input_name&#39;, &#39;attention_mask&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;full&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;triu&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;arange_1&#39;), DYN0:(&#39;axis&#39;, 0)}, {DYN0:(&#39;input_name&#39;, &#39;gt&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;expand&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_cast_unsqueeze_40&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;add_2&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;eq_7&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;masked_fill&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;expand_as&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;arange_1&#39;), DYN0:(&#39;axis&#39;, 0)}, {DYN0:(&#39;input_name&#39;, &#39;eq_7&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_cast_unsqueeze_40&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_1&#39;), DYN0:(&#39;axis&#39;, 2)}, {DYN0:(&#39;input_name&#39;, &#39;full&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;masked_fill&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;clone&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;add_2&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;expand&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;mul_&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;triu&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;gt&#39;), DYN0:(&#39;axis&#39;, 1)}, {DYN0:(&#39;input_name&#39;, &#39;expand_as&#39;), DYN0:(&#39;axis&#39;, 3)}, {DYN0:(&#39;input_name&#39;, &#39;unsqueeze_3&#39;), DYN0:(&#39;axis&#39;, 2)}]
dynsrc: batch -&gt; [{batch:(&#39;input_name&#39;, &#39;input_ids&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;attention_mask&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_key_cache_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_key_cache_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_value_cache_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_value_cache_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;embedding&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_cast_unsqueeze_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;eq_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;masked_fill&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand_as&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_18&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_21&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_22&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_19&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_23&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_24&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_transpose_cat_50&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_28&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_29&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_32&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_33&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_30&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_31&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_34&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_35&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_transpose_cat_110&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_add_1500000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_29&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_19&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_22&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;eq_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_transpose_cat_50&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_dropout000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_30&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_23&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_add_9000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul__onx_transpose_cat_1100&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_cast_unsqueeze_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_add_90000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_32&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_35&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_28&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_add_150000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_21&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_dropout000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_add_90000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_33&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;masked_fill&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;contiguous&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_dropout0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_dropout0000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;embedding&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_add_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;clone&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_add_15000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;contiguous_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_add_150&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_add_150&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_add_900000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_add_9000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_34&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_add_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul__onx_transpose_cat_500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_transpose_cat_110&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_24&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_cat_30&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_18&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_16&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_add_150000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand_as&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_cat_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_31&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_dropout00000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_dropout0000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_dropout0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_add_15000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_3&#39;), batch:(&#39;axis&#39;, 0)}]
dynsrc: cache_length -&gt; [{cache_length:(&#39;input_name&#39;, &#39;past_key_values_key_cache_0&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_key_cache_1&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_value_cache_0&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_value_cache_1&#39;), cache_length:(&#39;axis&#39;, 2)}]
dynsrc: cache_length+seq_length -&gt; [{cache_length+seq_length:(&#39;input_name&#39;, &#39;output_1&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_2&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_3&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_4&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_transpose_cat_50&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_transpose_cat_110&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_6&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_11&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_transpose_cat_50&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_mul__onx_transpose_cat_1100&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_mul__onx_transpose_cat_500&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;_onx_transpose_cat_110&#39;), cache_length+seq_length:(&#39;axis&#39;, 3)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_5&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_12&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}]
dynsrc: seq_length -&gt; [{seq_length:(&#39;input_name&#39;, &#39;input_ids&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;output_0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;embedding&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;arange&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;full&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;triu&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;reshape&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;gt&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;expand&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;eq_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;masked_fill&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;expand_as&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_17&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_18&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_21&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_22&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_19&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_20&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_23&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_24&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_28&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_29&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_32&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_33&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_31&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_34&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_35&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_12&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_13&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_13&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_17&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;to_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_add_1500000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;neg_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_29&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_19&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_22&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;eq_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_11&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_dropout000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_23&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_add_9000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;cat_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_17&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_add_90000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_32&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_35&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;arange&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;neg_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_28&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_add_150000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_21&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;view_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_17&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;dropout&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_dropout000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_add_90000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;full&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;slice_33&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;masked_fill&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;contiguous&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_dropout0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_reducemean__onx_pow__onx_sub_dropout0000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;neg_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;embedding&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_add_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_13&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_12&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;clone&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_add_15000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;contiguous_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_add_150&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;linear_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;to_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;expand&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_add_150&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;view_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_add_900000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul__onx_div__onx_sub_add_9000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_34&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_add_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_13&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_24&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;reshape&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;triu&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_cat_30&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;pow_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;gt&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow__onx_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_18&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_16&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_add_150000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;expand_as&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_cat_90&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_31&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_20&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt__onx_add__onx_reducemean__onx_pow__onx_sub_dropout00000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add__onx_mul__onx_div__onx_sub_dropout0000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div__onx_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_dropout0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean__onx_pow__onx_sub_add_15000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_8&#39;), seq_length:(&#39;axis&#39;, 2)}]
opset: : 18
opset: local_functions.0: 1
opset: local_functions: 1
init: b_model_rotary_emb_inv_freq: ?: ?                                -- GraphBuilder._update_structures_with_proto.1/from(b_model_rotary_emb_inv_freq)
init: init7_s1_1: int64: 1                                             -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_1)##GraphBuilder.compute_constant/from(init7_s1_1)##GraphBuilder._update_structures_with_proto.1/from(init7_s1_1)
init: init7_s_1: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init7_s_1)
init: init7_s1_0: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_0)
init: init7_s_0: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init7_s_0)
init: init7_s2_-1_1: int64: 2                                          -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_1)##GraphBuilder.compute_constant/from(init7_s2_-1_1)##GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_1)
init: init7_s1_2: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_2)
init: init7_s1_3: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_3)
init: init1_s_: ?: ?                                                   -- GraphBuilder._update_structures_with_proto.1/from(init1_s_)
init: init1_s1_: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s1_)
init: init7_s1_-1: ?: ?                                                -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_-1)
init: init7_s1_80: ?: ?                                                -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_80)
init: init1_s_3: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s_3)
init: init1_s1_5: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init1_s1_5)
init: init1_s_4: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s_4)
init: init1_s_5: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s_5)
init: init1_s_6: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s_6)
init: init7_s2_0_1: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_0_1)
init: init7_s2_1_2: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_1_2)
init: init1_s2560_: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_)
init: init1_s2560_2: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_2)
init: init1_s2560_3: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_3)
init: init1_s2560_4: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_4)
init: init1_s2560_5: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_5)
init: init1_s2560_6: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_6)
init: init1_s1_6: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init1_s1_6)
init: init7_s2_32_48: ?: ?                                             -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_32_48)
init: init7_s2_16_16: ?: ?                                             -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_16_16)
init: init7_s2_-1_2560: int64: 2                                       -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_2560)##GraphBuilder.compute_constant/from(init7_s2_-1_2560)##GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_2560)
init: init7_s1_-12: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_-12)
init: model.embed_tokens.weight: ?: ?                                  -- GraphBuilder._update_structures_with_proto.1/from(model.embed_tokens.weight)
init: model.layers.0.self_attn.q_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.self_attn.q_proj.weight)
init: model.layers.0.self_attn.k_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.self_attn.k_proj.weight)
init: model.layers.0.self_attn.v_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.self_attn.v_proj.weight)
init: model.layers.0.self_attn.dense.weight: ?: ?                      -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.self_attn.dense.weight)
init: model.layers.0.mlp.fc1.weight: ?: ?                              -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.mlp.fc1.weight)
init: model.layers.0.mlp.fc2.weight: ?: ?                              -- GraphBuilder._update_structures_with_proto.1/from(model.layers.0.mlp.fc2.weight)
init: model.layers.1.self_attn.q_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.self_attn.q_proj.weight)
init: model.layers.1.self_attn.k_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.self_attn.k_proj.weight)
init: model.layers.1.self_attn.v_proj.weight: ?: ?                     -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.self_attn.v_proj.weight)
init: model.layers.1.self_attn.dense.weight: ?: ?                      -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.self_attn.dense.weight)
init: model.layers.1.mlp.fc1.weight: ?: ?                              -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.mlp.fc1.weight)
init: model.layers.1.mlp.fc2.weight: ?: ?                              -- GraphBuilder._update_structures_with_proto.1/from(model.layers.1.mlp.fc2.weight)
init: lm_head.weight: ?: ?                                             -- GraphBuilder._update_structures_with_proto.1/from(lm_head.weight)
input:: input_ids                                                               |T7: batch x seq_length
input:: attention_mask                                                          |T7: batch x DYN0
input:: past_key_values_key_cache_0                                             |T1: batch x 32 x cache_length x 80
input:: past_key_values_key_cache_1                                             |T1: batch x 32 x cache_length x 80
input:: past_key_values_value_cache_0                                           |T1: batch x 32 x cache_length x 80
input:: past_key_values_value_cache_1                                           |T1: batch x 32 x cache_length x 80
Shape: input_ids -&gt; _onx_shape_input_ids0                                       |T7: 1                        - sym_size_int
Squeeze: _onx_shape_input_ids0 -&gt; sym_size_int_19                               |T7:                          - sym_size_int2
Unsqueeze: sym_size_int_19, init7_s1_0 -&gt; _onx_unsqueeze_sym_size_int_190       |T7: 1                        - _mkshape1_sym_size_int_19
Shape: input_ids -&gt; _onx_shape_input_ids02                                      |T7: 1                        - sym_size_int3
Squeeze: _onx_shape_input_ids02 -&gt; sym_size_int_20                              |T7:                          - sym_size_int4
Unsqueeze: sym_size_int_20, init7_s1_0 -&gt; _onx_unsqueeze_sym_size_int_200       |T7: 1                        - _mkshape1_sym_size_int_20
Shape: past_key_values_key_cache_0 -&gt; _onx_shape_past_key_values_key_cache_00   |T7: 1                        - sym_size_int5
Squeeze: _onx_shape_past_key_values_key_cache_00 -&gt; sym_size_int_21             |T7:                          - sym_size_int6
Gather: model.embed_tokens.weight, input_ids -&gt; embedding                       |T1: batch x seq_length x 2560- embedding
Add: sym_size_int_21, sym_size_int_20 -&gt; add                                    |T7:                          - add3
Range: sym_size_int_21, add, init7_s_1 -&gt; arange                                |T7: seq_length               - arange
Unsqueeze: arange, init7_s1_0 -&gt; unsqueeze                                      |T7: 1 x seq_length           - unsqueeze
Unsqueeze: add, init7_s1_0 -&gt; _onx_unsqueeze_add0                               |T7: 1                        - _mkshape1_add
Concat: _onx_unsqueeze_sym_size_int_200, _onx_unsqueeze_add0 -&gt; _onx_concat__onx_unsqueeze_sym_size_int_2000                            |T7: 2- _mkshape_add
ConstantOfShape: _onx_concat__onx_unsqueeze_sym_size_int_2000 -&gt; full           |T1: seq_length x DYN0        - fullD2
Trilu: full, init7_s_1 -&gt; triu                                                  |T1: seq_length x DYN0        - triu
Range: init7_s_0, add, init7_s_1 -&gt; arange_1                                    |T7: DYN0                     - arange2
Reshape: arange, init7_s2_-1_1 -&gt; reshape                                       |T7: seq_length x 1           - reshape
Greater: arange_1, reshape -&gt; gt                                                |T9: seq_length x DYN0        - gt_Tensor
Cast: gt -&gt; _onx_cast_gt0                                                       |T1: seq_length x DYN0        - mul__Tensor
Mul: triu, _onx_cast_gt0 -&gt; _onx_mul_triu0                                      |T1: seq_length x DYN0        - mul__Tensor2
Unsqueeze: _onx_mul_triu0, init7_s2_0_1 -&gt; unsqueeze_2                          |T1: 1 x 1 x seq_length x DYN0- UnsqueezeUnsqueezePattern--unsqueeze2
Shape: unsqueeze_2 -&gt; _onx_shape_unsqueeze_20                                   |T7: 4                        - expand
Gather: _onx_shape_unsqueeze_20, init7_s1_2 -&gt; _onx_gather__onx_shape_unsqueeze_200   |T7: 1                  - expand2
Gather: _onx_shape_unsqueeze_20, init7_s1_3 -&gt; _onx_gather__onx_shape_unsqueeze_2002    |T7: 1                - expand3
Concat: _onx_unsqueeze_sym_size_int_190, init7_s1_1, _onx_gather__onx_shape_unsqueeze_200, _onx_gather__onx_shape_unsqueeze_2002 -&gt; _onx_concat__onx_unsqueeze_sym_size_int_1900                                                                                                |T7: 4- _mkshape__onx_gather__onx_shape_unsqueeze_2002
Expand: unsqueeze_2, _onx_concat__onx_unsqueeze_sym_size_int_1900 -&gt; expand     |T1: batch x 1 x seq_length x DYN0- expand_neg
Unsqueeze: attention_mask, init7_s2_1_2 -&gt; unsqueeze_4                          |T7: batch x 1 x 1 x DYN0     - UnsqueezeUnsqueezePattern--unsqueeze4
Cast: unsqueeze_4 -&gt; _onx_cast_unsqueeze_40                                     |T1: batch x 1 x 1 x DYN0     - Opset
Add: expand, _onx_cast_unsqueeze_40 -&gt; add_2                                    |T1: batch x 1 x seq_length x DYN0- add_Tensor
Reshape: init1_s_, init7_s1_1 -&gt; _onx_reshape_init1_s_0                         |T1: 1                        - Opset2
Equal: add_2, _onx_reshape_init1_s_0 -&gt; eq_7                                    |T9: batch x 1 x seq_length x DYN0- eq
Where: eq_7, init1_s1_, expand -&gt; masked_fill                                   |T1: batch x 1 x seq_length x DYN0- masked_fill_Scalar
Shape: expand -&gt; _onx_shape_clone0                                              |T7: 4                        - aten_meth_expand_as
Expand: masked_fill, _onx_shape_clone0 -&gt; expand_as                             |T1: batch x 1 x seq_length x DYN0- aten_meth_expand_as2
submod_3[local_functions]: b_model_rotary_emb_inv_freq, unsqueeze -&gt; wrap_with_set_grad_enabled#0, wrap_with_set_grad_enabled#1                                               |T1: 1 x seq_length x 32 T1: 1 x seq_length x 32- wrap_with_set_grad_enabled
Unsqueeze: wrap_with_set_grad_enabled#0, init7_s1_1 -&gt; unsqueeze_8              |T1: 1 x 1 x seq_length x 32  - unsqueeze6
LayerNormalization: embedding, init1_s2560_, init1_s2560_2 -&gt; _onx_div__onx_sub_dropout00         |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm4
Transpose: model.layers.0.self_attn.q_proj.weight -&gt; _onx_transpose_p_model_layers_0_self_attn_q_proj_weight0                             |T1: 2560 x 2560- linear
MatMul: _onx_div__onx_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_q_proj_weight0 -&gt; _onx_matmul_layer_norm0                                        |T1: batch x seq_length x 2560- Opset3
Concat: _onx_unsqueeze_sym_size_int_190, _onx_unsqueeze_sym_size_int_200, init7_s1_-1, init7_s1_80 -&gt; _onx_concat__onx_unsqueeze_sym_size_int_19020                                                                   |T7: 4- _mkshape_sym_size_int_20
Reshape: _onx_matmul_layer_norm0, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view       |T1: batch x seq_length x 32 x 80- view
Transpose: view -&gt; transpose_1                                                  |T1: batch x 32 x seq_length x 80- transpose_int
Split: transpose_1, init7_s2_32_48 -&gt; slice_17, slice_18                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slice_Tensor
Split: slice_17, init7_s2_16_16 -&gt; slice_21, slice_22                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slice_Tensor5
Transpose: model.layers.0.self_attn.k_proj.weight -&gt; _onx_transpose_p_model_layers_0_self_attn_k_proj_weight0                             |T1: 2560 x 2560- linear2
MatMul: _onx_div__onx_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_k_proj_weight0 -&gt; _onx_matmul_layer_norm02                                         |T1: batch x seq_length x 2560- Opset5
Reshape: _onx_matmul_layer_norm02, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view_1          |T1: batch x seq_length x 32 x 80- view2
Transpose: view_1 -&gt; transpose_2                                                |T1: batch x 32 x seq_length x 80- transpose_int2
Split: transpose_2, init7_s2_32_48 -&gt; slice_19, slice_20                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slice_Tensor3
Split: slice_19, init7_s2_16_16 -&gt; slice_23, slice_24                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slice_Tensor7
Transpose: model.layers.0.self_attn.v_proj.weight -&gt; _onx_transpose_p_model_layers_0_self_attn_v_proj_weight0                             |T1: 2560 x 2560- linear3
MatMul: _onx_div__onx_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_v_proj_weight0 -&gt; _onx_matmul_layer_norm03                                         |T1: batch x seq_length x 2560- Opset7
Reshape: _onx_matmul_layer_norm03, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view_2          |T1: batch x seq_length x 32 x 80- view3
Transpose: view_2 -&gt; transpose_3                                                |T1: batch x 32 x seq_length x 80- transpose_int3
Unsqueeze: wrap_with_set_grad_enabled#1, init7_s1_1 -&gt; unsqueeze_9              |T1: 1 x 1 x seq_length x 32  - unsqueeze7
Mul: slice_17, unsqueeze_8 -&gt; mul_2                                             |T1: batch x 32 x seq_length x 32- mul_Tensor
Neg: slice_22 -&gt; neg                                                            |T1: batch x 32 x seq_length x 16- neg
Concat: neg, slice_21 -&gt; cat_1                                                  |T1: batch x 32 x seq_length x 32- cat
Mul: cat_1, unsqueeze_9 -&gt; mul_3                                                |T1: batch x 32 x seq_length x 32- mul_Tensor2
Add: mul_2, mul_3 -&gt; add_3                                                      |T1: batch x 32 x seq_length x 32- add_Tensor2
Mul: slice_19, unsqueeze_8 -&gt; mul_4                                             |T1: batch x 32 x seq_length x 32- mul_Tensor3
Neg: slice_24 -&gt; neg_1                                                          |T1: batch x 32 x seq_length x 16- neg2
Concat: neg_1, slice_23 -&gt; cat_2                                                |T1: batch x 32 x seq_length x 32- cat2
Mul: cat_2, unsqueeze_9 -&gt; mul_5                                                |T1: batch x 32 x seq_length x 32- mul_Tensor4
Add: mul_4, mul_5 -&gt; add_4                                                      |T1: batch x 32 x seq_length x 32- add_Tensor3
Concat: add_3, slice_18 -&gt; cat_3                                                |T1: batch x 32 x seq_length x 80- cat3
Concat: add_4, slice_20 -&gt; cat_4                                                |T1: batch x 32 x seq_length x 80- cat4
Concat: past_key_values_key_cache_0, cat_4 -&gt; output_1                          |T1: batch x 32 x cache_length+seq_length x 80- cat5
Concat: past_key_values_value_cache_0, transpose_3 -&gt; output_3                  |T1: batch x 32 x cache_length+seq_length x 80- cat6
Transpose: output_1 -&gt; _onx_transpose_cat_50                                    |T1: batch x 32 x 80 x cache_length+seq_length- aten_scaled_dot_product_attention
MatMul: cat_3, _onx_transpose_cat_50 -&gt; MulMulMatMulPattern__onx_matmul__onx_mul_cat_300        |T1: batch x 32 x seq_length x cache_length+seq_length- MulMulMatMulPattern--aten_scaled_dot_product_attention5-1
Mul: MulMulMatMulPattern__onx_matmul__onx_mul_cat_300, init1_s1_6 -&gt; _onx_matmul__onx_mul_cat_300                 |T1: batch x 32 x seq_length x cache_length+seq_length- MulMulMatMulPattern--aten_scaled_dot_product_attention5-2
Add: _onx_matmul__onx_mul_cat_300, expand_as -&gt; _onx_add__onx_matmul__onx_mul_cat_3000      |T1: batch x 32 x seq_length x cache_length+seq_length- aten_scaled_dot_product_attention6
Softmax: _onx_add__onx_matmul__onx_mul_cat_3000 -&gt; _onx_softmax__onx_add__onx_matmul__onx_mul_cat_30000                       |T1: batch x 32 x seq_length x cache_length+seq_length- aten_scaled_dot_product_attention7
MatMul: _onx_softmax__onx_add__onx_matmul__onx_mul_cat_30000, output_3 -&gt; scaled_dot_product_attention                      |T1: batch x 32 x seq_length x 80- aten_scaled_dot_product_attention8
Transpose: scaled_dot_product_attention -&gt; transpose_4                          |T1: batch x seq_length x 32 x 80- transpose_int4
Concat: _onx_unsqueeze_sym_size_int_190, _onx_unsqueeze_sym_size_int_200, init7_s1_-1 -&gt; _onx_concat__onx_unsqueeze_sym_size_int_19030                                                      |T7: 3- _mkshape_sym_size_int_202
Reshape: transpose_4, _onx_concat__onx_unsqueeze_sym_size_int_19030 -&gt; reshape_1|T1: batch x seq_length x 2560- reshape2
Transpose: model.layers.0.mlp.fc1.weight -&gt; _onx_transpose_p_model_layers_0_mlp_fc1_weight0           |T1: 2560 x 10240- linear5
MatMul: _onx_div__onx_sub_dropout00, _onx_transpose_p_model_layers_0_mlp_fc1_weight0 -&gt; _onx_matmul_layer_norm04                                |T1: batch x seq_length x 10240- Opset11
Reshape: init1_s_3, init7_s1_1 -&gt; _onx_reshape_init1_s_30                       |T1: 1                        - mul_Tensor5
Mul: _onx_matmul_layer_norm04, _onx_reshape_init1_s_30 -&gt; _onx_mul_linear_40    |T1: batch x seq_length x 10240- mul_Tensor6
Pow: _onx_matmul_layer_norm04, init1_s1_5 -&gt; pow_1                              |T1: batch x seq_length x 10240- pow_Tensor_Scalar
Reshape: init1_s_4, init7_s1_1 -&gt; _onx_reshape_init1_s_40                       |T1: 1                        - mul_Tensor8
Mul: pow_1, _onx_reshape_init1_s_40 -&gt; _onx_mul_pow_10                          |T1: batch x seq_length x 10240- mul_Tensor9
Add: _onx_matmul_layer_norm04, _onx_mul_pow_10 -&gt; add_6                         |T1: batch x seq_length x 10240- add_Tensor4
Reshape: init1_s_5, init7_s1_1 -&gt; _onx_reshape_init1_s_50                       |T1: 1                        - mul_Tensor11
Mul: add_6, _onx_reshape_init1_s_50 -&gt; _onx_mul_add_60                          |T1: batch x seq_length x 10240- mul_Tensor12
Tanh: _onx_mul_add_60 -&gt; tanh                                                   |T1: batch x seq_length x 10240- tanh
Reshape: init1_s_6, init7_s1_1 -&gt; _onx_reshape_init1_s_60                       |T1: 1                        - Opset13
Add: tanh, _onx_reshape_init1_s_60 -&gt; add_7                                     |T1: batch x seq_length x 10240- add_Tensor5
Mul: _onx_mul_linear_40, add_7 -&gt; mul_9                                         |T1: batch x seq_length x 10240- mul_Tensor14
Transpose: model.layers.0.mlp.fc2.weight -&gt; _onx_transpose_p_model_layers_0_mlp_fc2_weight0           |T1: 10240 x 2560- linear6
MatMul: mul_9, _onx_transpose_p_model_layers_0_mlp_fc2_weight0 -&gt; _onx_matmul_mul_90    |T1: batch x seq_length x 2560- Opset14
Reshape: reshape_1, init7_s2_-1_2560 -&gt; MatMulAddPattern--reshape_1             |T1:                          - MatMulAddPattern--Opset9
Reshape: _onx_matmul_mul_90, init7_s2_-1_2560 -&gt; MatMulAddPattern--reshape_12   |T1:                          - MatMulAddPattern--Opset92
Shape: reshape_1 -&gt; MatMulAddPattern--reshape_14                                |T7: 2                        - MatMulAddPattern--Opset93
Concat: MatMulAddPattern--reshape_14, init7_s1_-12 -&gt; MatMulAddPattern--reshape_15  |T7: 3                    - MatMulAddPattern--Opset94
Gemm: MatMulAddPattern--reshape_1, model.layers.0.self_attn.dense.weight, MatMulAddPattern--reshape_12 -&gt; MatMulAddPattern--reshape_13                                                      |T1: - GemmTransposePattern--MatMulAddPattern--Opset962
Reshape: MatMulAddPattern--reshape_13, MatMulAddPattern--reshape_15 -&gt; add_8    |T1: batch x seq_length x 2560- MatMulAddPattern--Opset95
Add: add_8, embedding -&gt; add_9                                                  |T1: batch x seq_length x 2560- add_Tensor7
LayerNormalization: add_9, init1_s2560_3, init1_s2560_4 -&gt; _onx_div__onx_sub_add_900    |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm13
Transpose: model.layers.1.self_attn.q_proj.weight -&gt; _onx_transpose_p_model_layers_1_self_attn_q_proj_weight0                             |T1: 2560 x 2560- linear7
MatMul: _onx_div__onx_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_q_proj_weight0 -&gt; _onx_matmul_layer_norm_10                                        |T1: batch x seq_length x 2560- Opset16
Reshape: _onx_matmul_layer_norm_10, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view_3           |T1: batch x seq_length x 32 x 80- view4
Transpose: view_3 -&gt; transpose_5                                                |T1: batch x 32 x seq_length x 80- transpose_int5
Split: transpose_5, init7_s2_32_48 -&gt; slice_28, slice_29                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slice_Tensor9
Split: slice_28, init7_s2_16_16 -&gt; slice_32, slice_33                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slice_Tensor13
Transpose: model.layers.1.self_attn.k_proj.weight -&gt; _onx_transpose_p_model_layers_1_self_attn_k_proj_weight0                             |T1: 2560 x 2560- linear8
MatMul: _onx_div__onx_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_k_proj_weight0 -&gt; _onx_matmul_layer_norm_102                                         |T1: batch x seq_length x 2560- Opset18
Reshape: _onx_matmul_layer_norm_102, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view_4            |T1: batch x seq_length x 32 x 80- view5
Transpose: view_4 -&gt; transpose_6                                                |T1: batch x 32 x seq_length x 80- transpose_int6
Split: transpose_6, init7_s2_32_48 -&gt; slice_30, slice_31                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slice_Tensor11
Split: slice_30, init7_s2_16_16 -&gt; slice_34, slice_35                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slice_Tensor15
Transpose: model.layers.1.self_attn.v_proj.weight -&gt; _onx_transpose_p_model_layers_1_self_attn_v_proj_weight0                             |T1: 2560 x 2560- linear9
MatMul: _onx_div__onx_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_v_proj_weight0 -&gt; _onx_matmul_layer_norm_103                                         |T1: batch x seq_length x 2560- Opset20
Reshape: _onx_matmul_layer_norm_103, _onx_concat__onx_unsqueeze_sym_size_int_19020 -&gt; view_5            |T1: batch x seq_length x 32 x 80- view6
Transpose: view_5 -&gt; transpose_7                                                |T1: batch x 32 x seq_length x 80- transpose_int7
Unsqueeze: wrap_with_set_grad_enabled#1, init7_s1_1 -&gt; unsqueeze_11             |T1: 1 x 1 x seq_length x 32  - unsqueeze9
Mul: slice_28, unsqueeze_8 -&gt; mul_10                                            |T1: batch x 32 x seq_length x 32- mul_Tensor15
Neg: slice_33 -&gt; neg_2                                                          |T1: batch x 32 x seq_length x 16- neg3
Concat: neg_2, slice_32 -&gt; cat_7                                                |T1: batch x 32 x seq_length x 32- cat7
Mul: cat_7, unsqueeze_11 -&gt; mul_11                                              |T1: batch x 32 x seq_length x 32- mul_Tensor16
Add: mul_10, mul_11 -&gt; add_10                                                   |T1: batch x 32 x seq_length x 32- add_Tensor8
Mul: slice_30, unsqueeze_8 -&gt; mul_12                                            |T1: batch x 32 x seq_length x 32- mul_Tensor17
Neg: slice_35 -&gt; neg_3                                                          |T1: batch x 32 x seq_length x 16- neg4
Concat: neg_3, slice_34 -&gt; cat_8                                                |T1: batch x 32 x seq_length x 32- cat8
Mul: cat_8, unsqueeze_11 -&gt; mul_13                                              |T1: batch x 32 x seq_length x 32- mul_Tensor18
Add: mul_12, mul_13 -&gt; add_11                                                   |T1: batch x 32 x seq_length x 32- add_Tensor9
Concat: add_10, slice_29 -&gt; cat_9                                               |T1: batch x 32 x seq_length x 80- cat9
Concat: add_11, slice_31 -&gt; cat_10                                              |T1: batch x 32 x seq_length x 80- cat10
Concat: past_key_values_key_cache_1, cat_10 -&gt; output_2                         |T1: batch x 32 x cache_length+seq_length x 80- cat11
Concat: past_key_values_value_cache_1, transpose_7 -&gt; output_4                  |T1: batch x 32 x cache_length+seq_length x 80- cat12
Transpose: output_2 -&gt; _onx_transpose_cat_110                                   |T1: batch x 32 x 80 x cache_length+seq_length- aten_scaled_dot_product_attention9
MatMul: cat_9, _onx_transpose_cat_110 -&gt; MulMulMatMulPattern__onx_matmul__onx_mul_cat_900         |T1: batch x 32 x seq_length x cache_length+seq_length- MulMulMatMulPattern--aten_scaled_dot_product_attention13-1
Mul: MulMulMatMulPattern__onx_matmul__onx_mul_cat_900, init1_s1_6 -&gt; _onx_matmul__onx_mul_cat_900                 |T1: batch x 32 x seq_length x cache_length+seq_length- MulMulMatMulPattern--aten_scaled_dot_product_attention13-2
Add: _onx_matmul__onx_mul_cat_900, expand_as -&gt; _onx_add__onx_matmul__onx_mul_cat_9000      |T1: batch x 32 x seq_length x cache_length+seq_length- aten_scaled_dot_product_attention14
Softmax: _onx_add__onx_matmul__onx_mul_cat_9000 -&gt; _onx_softmax__onx_add__onx_matmul__onx_mul_cat_90000                       |T1: batch x 32 x seq_length x cache_length+seq_length- aten_scaled_dot_product_attention15
MatMul: _onx_softmax__onx_add__onx_matmul__onx_mul_cat_90000, output_4 -&gt; scaled_dot_product_attention_1                        |T1: batch x 32 x seq_length x 80- aten_scaled_dot_product_attention16
Transpose: scaled_dot_product_attention_1 -&gt; transpose_8                        |T1: batch x seq_length x 32 x 80- transpose_int8
Reshape: transpose_8, _onx_concat__onx_unsqueeze_sym_size_int_19030 -&gt; reshape_2|T1: batch x seq_length x 2560- reshape3
Transpose: model.layers.1.mlp.fc1.weight -&gt; _onx_transpose_p_model_layers_1_mlp_fc1_weight0           |T1: 2560 x 10240- linear11
MatMul: _onx_div__onx_sub_add_900, _onx_transpose_p_model_layers_1_mlp_fc1_weight0 -&gt; _onx_matmul_layer_norm_104                                |T1: batch x seq_length x 10240- Opset24
Reshape: init1_s_3, init7_s1_1 -&gt; _onx_reshape_init1_s_302                      |T1: 1                        - mul_Tensor19
Mul: _onx_matmul_layer_norm_104, _onx_reshape_init1_s_302 -&gt; _onx_mul_linear_100|T1: batch x seq_length x 10240- mul_Tensor20
Pow: _onx_matmul_layer_norm_104, init1_s1_5 -&gt; pow_2                            |T1: batch x seq_length x 10240- pow_Tensor_Scalar2
Reshape: init1_s_4, init7_s1_1 -&gt; _onx_reshape_init1_s_402                      |T1: 1                        - mul_Tensor22
Mul: pow_2, _onx_reshape_init1_s_402 -&gt; _onx_mul_pow_20                         |T1: batch x seq_length x 10240- mul_Tensor23
Add: _onx_matmul_layer_norm_104, _onx_mul_pow_20 -&gt; add_12                      |T1: batch x seq_length x 10240- add_Tensor10
Reshape: init1_s_5, init7_s1_1 -&gt; _onx_reshape_init1_s_502                      |T1: 1                        - mul_Tensor25
Mul: add_12, _onx_reshape_init1_s_502 -&gt; _onx_mul_add_120                       |T1: batch x seq_length x 10240- mul_Tensor26
Tanh: _onx_mul_add_120 -&gt; tanh_1                                                |T1: batch x seq_length x 10240- tanh2
Reshape: init1_s_6, init7_s1_1 -&gt; _onx_reshape_init1_s_602                      |T1: 1                        - Opset26
Add: tanh_1, _onx_reshape_init1_s_602 -&gt; add_13                                 |T1: batch x seq_length x 10240- add_Tensor11
Mul: _onx_mul_linear_100, add_13 -&gt; mul_17                                      |T1: batch x seq_length x 10240- mul_Tensor28
Transpose: model.layers.1.mlp.fc2.weight -&gt; _onx_transpose_p_model_layers_1_mlp_fc2_weight0           |T1: 10240 x 2560- linear12
MatMul: mul_17, _onx_transpose_p_model_layers_1_mlp_fc2_weight0 -&gt; _onx_matmul_mul_170      |T1: batch x seq_length x 2560- Opset27
Reshape: reshape_2, init7_s2_-1_2560 -&gt; MatMulAddPattern--reshape_2             |T1:                          - MatMulAddPattern--Opset22
Reshape: _onx_matmul_mul_170, init7_s2_-1_2560 -&gt; MatMulAddPattern--reshape_22  |T1:                          - MatMulAddPattern--Opset222
Shape: reshape_2 -&gt; MatMulAddPattern--reshape_24                                |T7: 2                        - MatMulAddPattern--Opset223
Concat: MatMulAddPattern--reshape_24, init7_s1_-12 -&gt; MatMulAddPattern--reshape_25  |T7: 3                    - MatMulAddPattern--Opset224
Gemm: MatMulAddPattern--reshape_2, model.layers.1.self_attn.dense.weight, MatMulAddPattern--reshape_22 -&gt; MatMulAddPattern--reshape_23                                                      |T1: - GemmTransposePattern--MatMulAddPattern--Opset2262
Reshape: MatMulAddPattern--reshape_23, MatMulAddPattern--reshape_25 -&gt; add_14   |T1: batch x seq_length x 2560- MatMulAddPattern--Opset225
Add: add_14, add_9 -&gt; add_15                                                    |T1: batch x seq_length x 2560- add_Tensor13
LayerNormalization: add_15, init1_s2560_5, init1_s2560_6 -&gt; _onx_div__onx_sub_add_1500      |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm22
Transpose: lm_head.weight -&gt; _onx_transpose_p_lm_head_weight0                   |T1: 2560 x 51200             - linear13
MatMul: _onx_div__onx_sub_add_1500, _onx_transpose_p_lm_head_weight0 -&gt; output_0|T1: batch x seq_length x 51200- linear14
output:: output_0                                                               |T1: batch x seq_length x 51200
output:: output_1                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_2                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_3                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_4                                                               |T1: batch x 32 x cache_length+seq_length x 80

FUNCKEY: (&#39;local_functions.0&#39;, &#39;submod_3&#39;)
FUNC submod_3[local_functions.0]: [&#39;expand_1&#39;, &#39;to_1&#39;] -&gt; [&#39;output_0&#39;, &#39;output_1&#39;]
  opset: &#39;&#39;: 18
  MatMul: expand_1, to_1 -&gt; matmul                                                |:                            - Opset
  Transpose: matmul -&gt; transpose                                                  |:                            - transpose_int
  Concat: transpose, transpose -&gt; cat                                             |:                            - cat
  Cos: cat -&gt; output_0                                                            |T1: batch x seq_length x 51200- cos
  Sin: cat -&gt; output_1                                                            |T1: batch x 32 x cache_length+seq_length x 80- sin

FUNCKEY: (&#39;local_functions&#39;, &#39;submod_3&#39;)
FUNC submod_3[local_functions]: [&#39;b_model_rotary_emb_inv_freq&#39;, &#39;unsqueeze&#39;] -&gt; [&#39;output_0&#39;, &#39;output_1&#39;]
  opset: &#39;&#39;: 18
  opset: local_functions.0: 1
  Constant:  -&gt; init7_s1_1                                                        |T7: 1                        - init2cst
  Constant:  -&gt; init7_s2_0_2                                                      |:                            - init2cst2
  Unsqueeze: b_model_rotary_emb_inv_freq, init7_s2_0_2 -&gt; unsqueeze_6             |:                            - UnsqueezeUnsqueezePattern--unsqueeze
  Unsqueeze: unsqueeze, init7_s1_1 -&gt; unsqueeze_7                                 |:                            - unsqueeze3
  Cast: unsqueeze_7 -&gt; to_1                                                       |:                            - to_dtype2
  submod_3[local_functions.0]: unsqueeze_6, to_1 -&gt; output_0, output_1            |T1: batch x seq_length x 51200 T1: batch x 32 x cache_length+seq_length x 80- wrap_with_autocast
</pre></div>
</div>
<p>Visually.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><span class="n">plot_dot</span></a></a></a><span class="p">(</span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_exporter_recipes_c_phi2_001.png" srcset="../_images/sphx_glr_plot_exporter_recipes_c_phi2_001.png" alt="plot exporter recipes c phi2" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 18.311 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-recipes-plot-exporter-recipes-c-phi2-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/24b19746af22318bd4f75a874a908bb2/plot_exporter_recipes_c_phi2.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_exporter_recipes_c_phi2.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/235ca6ff7b5302f675fe9e76ff52500c/plot_exporter_recipes_c_phi2.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_exporter_recipes_c_phi2.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b4213a18dfd166961a70adb9157bccc1/plot_exporter_recipes_c_phi2.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_exporter_recipes_c_phi2.zip</span></code></a></p>
</div>
</div>
<p class="rubric">Related examples</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Exports model Phi-2. We use a dummy model. The main difficulty is to set the dynamic shapes properly."><img alt="" src="../_images/sphx_glr_plot_exporter_recipes_oe_phi2_thumb.png" />
<p><a class="reference internal" href="plot_exporter_recipes_oe_phi2.html#sphx-glr-auto-recipes-plot-exporter-recipes-oe-phi2-py"><span class="std std-ref">torch.onnx.export and Phi-2</span></a></p>
  <div class="sphx-glr-thumbnail-title">torch.onnx.export and Phi-2</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Example l-plot-exporter-recipes-custom-phi2 shows how to export a simple LLM model with dynamic shapes. What if it does not work?"><img alt="" src="../_images/sphx_glr_plot_exporter_recipes_c_phi35_thumb.png" />
<p><a class="reference internal" href="plot_exporter_recipes_c_phi35.html#sphx-glr-auto-recipes-plot-exporter-recipes-c-phi35-py"><span class="std std-ref">to_onnx, failures Phi-3.5-mini-instruct</span></a></p>
  <div class="sphx-glr-thumbnail-title">to_onnx, failures Phi-3.5-mini-instruct</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Big models are hard to read once converted into onnx. Let&#x27;s see how to improve their readibility. The code is inspired from LLM from scratch with Pytorch."><img alt="" src="../_images/sphx_glr_plot_exporter_recipes_c_modules_thumb.png" />
<p><a class="reference internal" href="plot_exporter_recipes_c_modules.html#sphx-glr-auto-recipes-plot-exporter-recipes-c-modules-py"><span class="std std-ref">to_onnx and submodules from LLMs</span></a></p>
  <div class="sphx-glr-thumbnail-title">to_onnx and submodules from LLMs</div>
</div></div><p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="plot_exporter_recipes_c_custom_ops_inplace.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">to_onnx and a custom operator inplace</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="plot_exporter_coverage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Measures the exporter success on many test cases</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2024
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">to_onnx and Phi-2</a><ul>
<li><a class="reference internal" href="#model">Model</a></li>
<li><a class="reference internal" href="#export">Export</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=a1637f0b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>