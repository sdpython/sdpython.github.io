<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="to_onnx and a custom operator inplace" href="plot_exporter_recipes_c_custom_ops_inplace.html" /><link rel="prev" title="Use DYNAMIC or AUTO when dynamic shapes has constraints" href="plot_exporter_exporter_dynamic_shapes_auto.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>to_onnx and Phi-2 - experimental-experiment 0.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">experimental-experiment 0.1.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">experimental-experiment 0.1.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../design/index.html">Design</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Design</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../design/exporter.html">Custom Exporter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/optimizer.html">Pattern Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design/backends.html">Dynamo Backends</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/errors.html">Unexpected Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/docker.html">Start from a docker</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/gradient/index.html">.gradient</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of .gradient</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/gradient/ops/index.html">.gradient.ops</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of .gradient.ops</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/gradient/ops/op_broadcast_gradient_args.html">.gradient.ops.op_broadcast_gradient_args</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/gradient/grad_helper.html">.gradient.grad_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/gradient/loss_helper.html">.gradient.loss_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/reference/index.html">.reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of .reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/reference/ops/index.html">.reference.ops</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of .reference.ops</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_add_add_mul_mul.html">.reference.ops.op_add_add_mul_mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_average_pool_grad.html">.reference.ops.op_average_pool_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_cast_like.html">.reference.ops.op_cast_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_complex.html">.reference.ops.op_complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_concat.html">.reference.ops.op_concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_constant_of_shape.html">.reference.ops.op_constant_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_fused_matmul.html">.reference.ops.op_fused_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_gather_grad.html">.reference.ops.op_gather_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_memcpy_host.html">.reference.ops.op_memcpy_host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_mul_sigmoid.html">.reference.ops.op_mul_sigmoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_negxplus1.html">.reference.ops.op_negxplus1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_quick_gelu.html">.reference.ops.op_quick_gelu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_replace_zero.html">.reference.ops.op_replace_zero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_rotary.html">.reference.ops.op_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_average_pool.html">.reference.ops.op_qlinear_average_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_qlinear_conv.html">.reference.ops.op_qlinear_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatter_elements.html">.reference.ops.op_scatter_elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_scatternd_of_shape.html">.reference.ops.op_scatternd_of_shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_simplified_layer_normalization.html">.reference.ops.op_simplified_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_skip_layer_normalization.html">.reference.ops.op_skip_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_slice.html">.reference.ops.op_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_transpose_cast.html">.reference.ops.op_transpose_cast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/reference/ops/op_tri_matrix.html">.reference.ops.op_tri_matrix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/evaluator.html">.reference.evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/ort_evaluator.html">.reference.ort_evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/reference/quantized_tensor.html">.reference.quantized_tensor</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/convert/index.html">.convert</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of .convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/convert/convert_helper.html">.convert.convert_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/convert/ort_helper.html">.convert.ort_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/plotting/index.html">.plotting</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of .plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/plotting/data.html">.plotting.data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/plotting/memory.html">.plotting.memory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/skl/index.html">.skl</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of .skl</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/skl/convert.html">.skl.convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/skl/helpers.html">.skl.helpers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_interpreter/index.html">.torch_interpreter</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of .torch_interpreter</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_functions.html">.torch_interpreter._aten_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_functions_attention.html">.torch_interpreter._aten_functions_attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_non_aten_functions.html">.torch_interpreter._non_aten_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_aten_methods.html">.torch_interpreter._aten_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_doc_.html">.torch_interpreter._doc_</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_exceptions.html">.torch_interpreter._exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_prims_functions.html">.torch_interpreter._prims_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/_torch_helper.html">.torch_interpreter._torch_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/aten_functions.html">.torch_interpreter.aten_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/aten_methods.html">.torch_interpreter.aten_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/dispatcher.html">.torch_interpreter.dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/export_options.html">.torch_interpreter.export_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/interpreter.html">.torch_interpreter.interpreter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/investigate_helper.html">.torch_interpreter.investigate_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/onnx_export.html">.torch_interpreter.onnx_export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/oxs_dispatcher.html">.torch_interpreter.oxs_dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/oxs_opset.html">.torch_interpreter.oxs_opset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/piece_by_piece.html">.torch_interpreter.piece_by_piece</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/piece_by_piece_serialize.html">.torch_interpreter.piece_by_piece_serialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_interpreter/tracing.html">.torch_interpreter.tracing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_models/index.html">.torch_models</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of .torch_models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/diffusion_model_helper.html">.torch_models.diffusion_model_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/dump_helper.html">.torch_models.dump_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llama_helper.html">.torch_models.llama_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llm_model_helper.html">.torch_models.llm_model_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/llm_model_setup.html">.torch_models.llm_model_setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/mistral_helper.html">.torch_models.mistral_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/phi3_helper.html">.torch_models.phi3_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/phi_helper.html">.torch_models.phi_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_models/training_helper.html">.torch_models.training_helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/xbuilder/index.html">.xbuilder</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of .xbuilder</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_graph_builder_runtime.html">.xbuilder._graph_builder_runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_onnx_helper.html">.xbuilder._onnx_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/_shape_helper.html">.xbuilder._shape_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/expression_dimension.html">.xbuilder.expression_dimension</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/graph_builder.html">.xbuilder.graph_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/graph_builder_opset.html">.xbuilder.graph_builder_opset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/model_container.html">.xbuilder.model_container</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/optimization_options.html">.xbuilder.optimization_options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/reverse_graph_builder.html">.xbuilder.reverse_graph_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/shape_type_compute.html">.xbuilder.shape_type_compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xbuilder/type_inference.html">.xbuilder.type_inference</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/xoptim/index.html">.xoptim</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of .xoptim</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_investigation/index.html">.xoptim.patterns_investigation</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_investigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_investigation/element_wise.html">.xoptim.patterns_investigation.element_wise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_investigation/llm_patterns.html">.xoptim.patterns_investigation.llm_patterns</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_ml/index.html">.xoptim.patterns_ml</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_ml</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ml/tree_ensemble.html">.xoptim.patterns_ml.tree_ensemble</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_exp/index.html">.xoptim.patterns_exp</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_exp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/binary_operators.html">.xoptim.patterns_exp.binary_operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/constant_of_shape_scatter_nd.html">.xoptim.patterns_exp.constant_of_shape_scatter_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/constants.html">.xoptim.patterns_exp.constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/simple_rotary.html">.xoptim.patterns_exp.simple_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/unary_operators.html">.xoptim.patterns_exp.unary_operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_exp/where_replace.html">.xoptim.patterns_exp.where_replace</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns/index.html">.xoptim.patterns</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of .xoptim.patterns</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_any.html">.xoptim.patterns.onnx_any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_cast.html">.xoptim.patterns.onnx_cast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_clip.html">.xoptim.patterns.onnx_clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_constants.html">.xoptim.patterns.onnx_constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_conv.html">.xoptim.patterns.onnx_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_dropout.html">.xoptim.patterns.onnx_dropout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_equal.html">.xoptim.patterns.onnx_equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_expand.html">.xoptim.patterns.onnx_expand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_functions.html">.xoptim.patterns.onnx_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_layer_normalization.html">.xoptim.patterns.onnx_layer_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_matmul.html">.xoptim.patterns.onnx_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_mul.html">.xoptim.patterns.onnx_mul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_reduce.html">.xoptim.patterns.onnx_reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_reshape.html">.xoptim.patterns.onnx_reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_rotary.html">.xoptim.patterns.onnx_rotary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_slice.html">.xoptim.patterns.onnx_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_split.html">.xoptim.patterns.onnx_split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_sub.html">.xoptim.patterns.onnx_sub</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_sequence.html">.xoptim.patterns.onnx_sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_transpose.html">.xoptim.patterns.onnx_transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns/onnx_unsqueeze.html">.xoptim.patterns.onnx_unsqueeze</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_ort/index.html">.xoptim.patterns_ort</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_ort</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/activation.html">.xoptim.patterns_ort.activation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/activation_grad.html">.xoptim.patterns_ort.activation_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/attention_patterns.html">.xoptim.patterns_ort.attention_patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/batch_normalization.html">.xoptim.patterns_ort.batch_normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/fused_conv.html">.xoptim.patterns_ort.fused_conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/fused_matmul.html">.xoptim.patterns_ort.fused_matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/gather_grad.html">.xoptim.patterns_ort.gather_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/llm_optim.html">.xoptim.patterns_ort.llm_optim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_ort/simplified_layer_normalization.html">.xoptim.patterns_ort.simplified_layer_normalization</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/xoptim/patterns_fix/index.html">.xoptim.patterns_fix</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of .xoptim.patterns_fix</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/xoptim/patterns_fix/add_reduction_scatter_nd.html">.xoptim.patterns_fix.add_reduction_scatter_nd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/graph_builder_optim.html">.xoptim.graph_builder_optim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/order_optim.html">.xoptim.order_optim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/patterns_api.html">.xoptim.patterns_api</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/xoptim/unfused.html">.xoptim.unfused</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_dynamo/index.html">.torch_dynamo</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of .torch_dynamo</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/_dynamo_exporter.html">.torch_dynamo._dynamo_exporter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/backend_helper.html">.torch_dynamo.backend_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/debug_backend.html">.torch_dynamo.debug_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/fast_backend.html">.torch_dynamo.fast_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_dynamo/partition.html">experimental_experiment.torch_dynamo.partition</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/torch_bench/index.html">.torch_bench</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of .torch_bench</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner_agg.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner_agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_benchmark_runner_agg_helper.html">experimental_experiment.torch_bench._bash_bench_benchmark_runner_agg_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_cmd.html">experimental_experiment.torch_bench._bash_bench_cmd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_model_runner.html">experimental_experiment.torch_bench._bash_bench_model_runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_models_helper.html">experimental_experiment.torch_bench._bash_bench_models_helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_dummies.html">experimental_experiment.torch_bench._bash_bench_set_dummies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_explicit.html">experimental_experiment.torch_bench._bash_bench_set_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_huggingface.html">experimental_experiment.torch_bench._bash_bench_set_huggingface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_huggingface_big.html">experimental_experiment.torch_bench._bash_bench_set_huggingface_big</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_issues.html">experimental_experiment.torch_bench._bash_bench_set_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_timm.html">experimental_experiment.torch_bench._bash_bench_set_timm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_torchbench.html">experimental_experiment.torch_bench._bash_bench_set_torchbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_set_torchbench_ado.html">experimental_experiment.torch_bench._bash_bench_set_torchbench_ado</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_bash_bench_untrained.html">experimental_experiment.torch_bench._bash_bench_untrained</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_dort_cmd_common.html">experimental_experiment.torch_bench._dort_cmd_common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/_dort_cmd_common_models.html">experimental_experiment.torch_bench._dort_cmd_common_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_agg.html">.torch_bench.bash_bench_agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_explicit.html">.torch_bench.bash_bench_explicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_huggingface.html">.torch_bench.bash_bench_huggingface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_huggingface_big.html">.torch_bench.bash_bench_huggingface_big</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_issues.html">.torch_bench.bash_bench_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_timm.html">.torch_bench.bash_bench_timm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_torchbench.html">.torch_bench.bash_bench_torchbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_torchbench_ado.html">.torch_bench.bash_bench_torchbench_ado</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/bash_bench_untrained.html">.torch_bench.bash_bench_untrained</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/check_model.html">.torch_bench.check_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_bench.html">.torch_bench.dort_bench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_bench_profile.html">.torch_bench.dort_bench_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/dort_profile.html">.torch_bench.dort_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/export_model.html">.torch_bench.export_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/torch_bench/export_model_helper.html">.torch_bench.export_model_helper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/_bench_test.html">._bench_test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/_command_lines_parser.html">._command_lines_parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/args.html">.args</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bench_run.html">.bench_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/checks.html">.checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ext_test_case.html">.ext_test_case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/helpers.html">.helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/memory_peak.html">.memory_peak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mini_onnx_builder.html">.mini_onnx_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/model_run.html">.model_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/onnx_tools.html">.onnx_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ort_session.html">.ort_session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/torch_test_helper.html">.torch_test_helper</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../galleries.html">Galleries of Examples and Recipes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Galleries of Examples and Recipes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Examples Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_custom_backend_101.html">101: A custom backend for torch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_linreg_101.html">101: Linear Regression and export to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_optimize_101.html">101: Onnx Model Optimization based on Pattern Rewriting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_rewrite_101.html">101: Onnx Model Rewriting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_profile_existing_onnx_101.html">101: Profile an existing model with onnxruntime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_101.html">101: Some dummy examples with torch.export.export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_convolutation_matmul_102.html">102: Convolution and Matrix Multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_onnxscript_102.html">102: Examples with onnxscript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_custom_backend_llama_102.html">102: Fuse kernels in a small Llama Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_bench_102.html">102: Measure LLAMA speed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_compile_102.html">102: Tweak onnx export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_dort_201.html">201: Evaluate DORT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_aot_201.html">201: Evaluate DORT Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_export_201.html">201: Evaluate different ways to export a torch model to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_torch_sklearn_201.html">201: Use torch to export a scikit-learn model into ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_diff_export_301.html">301: Compares LLAMA exporters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_llama_diff_dort_301.html">301: Compares LLAMA exporters for onnxrt backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_model_to_python.html">Playground for big optimization pattern</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Exporter Recipes Gallery</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Exporter Recipes Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_lost_dynamic_dimension.html">A dynamic dimension lost by torch.export.export</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_untrained_tinyllm.html">Check the exporter on a dummy from HuggingFace</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_inputs.html">Do no use Module as inputs!</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_phi35_piece.html">Export Phi-3.5-mini-instruct piece by piece</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_draft_mode.html">Export Phi-3.5-mini-instruct with draft_export</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_reportibility.html">Export Phi-3.5-mini-instruct with report_exportability</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_with_dynamic_cache.html">Export a model using a custom type as input</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_scan_pdist.html">Export a model with a loop (scan)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_infer_ds.html">Infer dynamic shapes before exporting</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_lr.html">Linear Regression and export to ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_coverage.html">Measures the exporter success on many test cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_exporter_dynamic_shapes_auto.html">Use DYNAMIC or AUTO when dynamic shapes has constraints</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">to_onnx and Phi-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_custom_ops_inplace.html">to_onnx and a custom operator inplace</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_custom_ops_fct.html">to_onnx and a custom operator registered with a function</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_scan_pdist.html">to_onnx and a model with a loop (scan)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_cond.html">to_onnx and a model with a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_dynpad.html">to_onnx and padding one dimension to a mulitple of a constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_modules.html">to_onnx and submodules from LLMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_c_named_ds_auto.html">to_onnx: Rename Dynamic Shapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_phi2.html">torch.onnx.export and Phi-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_custom_ops_inplace.html">torch.onnx.export and a custom operator inplace</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_custom_ops_fct.html">torch.onnx.export and a custom operator registered with a function</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_cond.html">torch.onnx.export and a model with a test</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_dynpad.html">torch.onnx.export and padding one dimension to a mulitple of a constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_exporter_recipes_oe_named_ds_auto.html">torch.onnx.export: Rename Dynamic Shapes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../command_lines.html">Command Lines</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Command Lines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../bench/index.html">Benchmarks from the command line</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Benchmarks from the command line</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../bench/dort_bench.html">experimental_experiment.torch_bench.dort_bench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/dort_profile.html">experimental_experiment.torch_bench.dort_profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/scripts.html">Interesting scripts or command lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bench/bash_bench.html">Measuring the exporters on a short list of sets of models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tools/index.html">Tools from the command line</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Tools from the command line</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/lighten.html">python -m experimental_experiment lighten and unlighten</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/optimize.html">python -m experimental_experiment optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/print.html">python -m experimental_experiment print</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/run.html">python -m experimental_experiment run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../miscellaneous/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Miscellaneous</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../miscellaneous/export_times.html">Export Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../miscellaneous/long_outputs.html">Long Outputs uneasy to read</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../miscellaneous/models/index.html">Supported Models By the Custom Backend</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Supported Models By the Custom Backend</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../miscellaneous/models/phi.html">Phi</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/auto_recipes/plot_exporter_recipes_c_phi2.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-recipes-plot-exporter-recipes-c-phi2-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="to-onnx-and-phi-2">
<span id="l-plot-exporter-recipes-custom-phi2"></span><span id="sphx-glr-auto-recipes-plot-exporter-recipes-c-phi2-py"></span><h1>to_onnx and Phi-2<a class="headerlink" href="#to-onnx-and-phi-2" title="Link to this heading">¶</a></h1>
<p>Exports model <a class="reference external" href="https://huggingface.co/microsoft/phi-2">Phi-2</a>.
We use a dummy model. The main difficulty is to set the dynamic shapes properly.
If there is an issue, you can go to the following line:
<a class="reference external" href="https://github.com/pytorch/pytorch/blob/main/torch/fx/experimental/symbolic_shapes.py#L5965">torch/fx/experimental/symbolic_shapes.py#L5965</a>
and look for <code class="docutils literal notranslate"><span class="pre">log.info(&quot;set_replacement</span> <span class="pre">%s</span> <span class="pre">=</span> <span class="pre">%s</span> <span class="pre">(%s)</span> <span class="pre">%s&quot;,</span> <span class="pre">a,</span> <span class="pre">tgt,</span> <span class="pre">msg,</span> <span class="pre">tgt_bound)</span></code> and add
before or after, something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tgt</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;dynamic shape becomes a constant &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">tgt</span><span class="p">,</span><span class="w"> </span><span class="nb">type</span><span class="p">(</span><span class="n">tgt</span><span class="p">),</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tgt_bound</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Adding <code class="docutils literal notranslate"><span class="pre">TORCH_LOGS=&quot;+dynamo&quot;</span> <span class="pre">TORCHDYNAMO_VERBOSE=1</span></code> prints out more information
about dynamic shapes.</p>
<section id="model">
<h2>Model<a class="headerlink" href="#model" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><span class="n">Any</span></a></a></a></a><span class="p">,</span> <a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Dict</span></a></a></a></a>
<span class="kn">import</span> <span class="nn">onnx</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">transformers</span>
<span class="kn">from</span> <span class="nn">onnx_array_api.plotting.graphviz_helper</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><span class="n">plot_dot</span></a></a></a></a>
<span class="kn">from</span> <span class="nn">onnx_diagnostic.helpers.cache_helper</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><span class="n">make_dynamic_cache</span></a></a></a></a>
<span class="kn">from</span> <span class="nn">experimental_experiment.helpers</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a></a>
<span class="kn">from</span> <span class="nn">experimental_experiment.xbuilder</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><span class="n">GraphBuilder</span></a></a></a></a><span class="p">,</span> <span class="n">InferShapesOptions</span>
<span class="kn">from</span> <span class="nn">experimental_experiment.torch_interpreter</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><span class="n">to_onnx</span></a></a></a></a><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><span class="n">ExportOptions</span></a></a></a></a>


<span class="k">def</span> <span class="nf">get_phi2_untrained</span><span class="p">(</span><span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/typing.html#typing.Dict" title="typing.Dict" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Dict</span></a></a></a></a><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><a href="https://docs.python.org/3/library/typing.html#typing.Any" title="typing.Any" class="sphx-glr-backref-module-typing sphx-glr-backref-type-py-data"><span class="n">Any</span></a></a></a></a><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets a non initialized model with its inputs</span>

<span class="sd">    :param batch_size: batch size</span>
<span class="sd">    :param kwargs: to overwrite the configuration, example ``num_hidden_layers=1``</span>
<span class="sd">    :return: dictionary</span>

<span class="sd">    See `Phi-2/config.json</span>
<span class="sd">    &lt;https://huggingface.co/microsoft/phi-2/blob/main/config.json&gt;`_.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;_name_or_path&quot;</span><span class="p">:</span> <span class="s2">&quot;microsoft/phi-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;architectures&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PhiForCausalLM&quot;</span><span class="p">],</span>
        <span class="s2">&quot;attention_dropout&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;bos_token_id&quot;</span><span class="p">:</span> <span class="mi">50256</span><span class="p">,</span>
        <span class="s2">&quot;embd_pdrop&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;eos_token_id&quot;</span><span class="p">:</span> <span class="mi">50256</span><span class="p">,</span>
        <span class="s2">&quot;hidden_act&quot;</span><span class="p">:</span> <span class="s2">&quot;gelu_new&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hidden_size&quot;</span><span class="p">:</span> <span class="mi">2560</span><span class="p">,</span>
        <span class="s2">&quot;initializer_range&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
        <span class="s2">&quot;intermediate_size&quot;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
        <span class="s2">&quot;layer_norm_eps&quot;</span><span class="p">:</span> <span class="mf">1e-05</span><span class="p">,</span>
        <span class="s2">&quot;max_position_embeddings&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_attention_heads&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;num_key_value_heads&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="s2">&quot;partial_rotary_factor&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
        <span class="s2">&quot;qk_layernorm&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;resid_pdrop&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;rope_scaling&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;rope_theta&quot;</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
        <span class="s2">&quot;tie_word_embeddings&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;torch_dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;float16&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transformers_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.37.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;use_cache&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;vocab_size&quot;</span><span class="p">:</span> <span class="mi">51200</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">transformers</span><span class="o">.</span><span class="n">PhiConfig</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module" title="torch.nn.Module" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-class"><span class="n">transformers</span><span class="o">.</span><span class="n">PhiForCausalLM</span></a></a></a></a><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
    <a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><a href="https://docs.pytorch.org/docs/main/generated/torch.nn.Module.html#torch.nn.Module.eval" title="torch.nn.Module.eval" class="sphx-glr-backref-module-torch-nn sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">eval</span></a></a></a></a><span class="p">()</span>

    <span class="n">batch</span> <span class="o">=</span> <a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span></a></a></a></a><span class="p">(</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">seq_length</span> <span class="o">=</span> <a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span></a></a></a></a><span class="p">(</span><span class="s2">&quot;seq_length&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">cache</span> <span class="o">=</span> <a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><span class="n">make_dynamic_cache</span></a></a></a></a><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">(</span><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a></a><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a></a><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">])</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">cache2</span> <span class="o">=</span> <a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/helpers/cache_helper.html#onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" title="onnx_diagnostic.helpers.cache_helper.make_dynamic_cache" class="sphx-glr-backref-module-onnx_diagnostic-helpers-cache_helper sphx-glr-backref-type-py-function"><span class="n">make_dynamic_cache</span></a></a></a></a><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">(</span><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a></a><span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randn.html#torch.randn" title="torch.randn" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randn</span></a></a></a></a><span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">])</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randint</span></a></a></a></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50285</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a></a><span class="p">),</span>
        <span class="n">attention_mask</span><span class="o">=</span><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">ones</span></a></a></a></a><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">33</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a></a><span class="p">),</span>
        <span class="n">past_key_values</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">inputs2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_ids</span><span class="o">=</span><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.randint.html#torch.randint" title="torch.randint" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">randint</span></a></a></a></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50285</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a></a><span class="p">),</span>
        <span class="n">attention_mask</span><span class="o">=</span><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><a href="https://docs.pytorch.org/docs/main/generated/torch.ones.html#torch.ones" title="torch.ones" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-function"><span class="n">torch</span><span class="o">.</span><span class="n">ones</span></a></a></a></a><span class="p">((</span><span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.pytorch.org/docs/main/tensor_attributes.html#torch.dtype" title="torch.dtype" class="sphx-glr-backref-module-torch sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">torch</span><span class="o">.</span><span class="n">int64</span></a></a></a></a><span class="p">),</span>
        <span class="n">past_key_values</span><span class="o">=</span><span class="n">cache2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cache</span><span class="o">.</span><span class="n">key_cache</span><span class="p">)</span>
    <span class="n">cache_length</span> <span class="o">=</span> <a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span></a></a></a></a><span class="p">(</span><span class="s2">&quot;cache_length&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">shapes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">seq_length</span><span class="p">},</span>
            <span class="s2">&quot;attention_mask&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span>
                <span class="mi">1</span><span class="p">:</span> <a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><a href="https://docs.pytorch.org/docs/main/export.html#torch.export.dynamic_shapes.Dim" title="torch.export.dynamic_shapes.Dim" class="sphx-glr-backref-module-torch-export-dynamic_shapes sphx-glr-backref-type-py-class"><span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">Dim</span></a></a></a></a><span class="o">.</span><span class="n">DYNAMIC</span><span class="p">,</span>  <span class="c1"># cache_length + seq_length</span>
            <span class="p">},</span>
            <span class="s2">&quot;past_key_values&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">cache_length</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)],</span>  <span class="c1"># 0: batch,</span>
                <span class="p">[{</span><span class="mi">0</span><span class="p">:</span> <span class="n">batch</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">cache_length</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)],</span>  <span class="c1"># 0: batch,</span>
            <span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="o">=</span><span class="n">shapes</span><span class="p">,</span> <span class="n">inputs2</span><span class="o">=</span><span class="n">inputs2</span><span class="p">)</span>


<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a> <span class="o">=</span> <span class="n">get_phi2_untrained</span><span class="p">(</span><span class="n">num_hidden_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a></a></a></a><span class="p">[</span><span class="s2">&quot;dynamic_shapes&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dynamic_shapes&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>inputs dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
dynamic_shapes {&#39;input_ids&#39;: {0: Dim(&#39;batch&#39;, min=1, max=1024), 1: Dim(&#39;seq_length&#39;, min=1, max=4096)}, &#39;attention_mask&#39;: {0: Dim(&#39;batch&#39;, min=1, max=1024), 1: _DimHint(type=&lt;_DimHintType.DYNAMIC: 3&gt;, min=None, max=None, _factory=True)}, &#39;past_key_values&#39;: [[{0: Dim(&#39;batch&#39;, min=1, max=1024), 2: Dim(&#39;cache_length&#39;, min=1, max=4096)}, {0: Dim(&#39;batch&#39;, min=1, max=1024), 2: Dim(&#39;cache_length&#39;, min=1, max=4096)}], [{0: Dim(&#39;batch&#39;, min=1, max=1024), 2: Dim(&#39;cache_length&#39;, min=1, max=4096)}, {0: Dim(&#39;batch&#39;, min=1, max=1024), 2: Dim(&#39;cache_length&#39;, min=1, max=4096)}]]}
</pre></div>
</div>
<p>Let’s check it is working.
We need to copy the input before calling the model
because it modifies the inputs and they are not properly
set up when the export starts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">(</span><span class="o">**</span><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span></a></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>CausalLMOutputWithPast(loss=None, logits=tensor([[[-0.7569, -1.1639,  0.0343,  ...,  0.3633,  1.0943, -1.3043],
         [-1.2233,  0.0731,  0.1871,  ...,  0.0664, -0.3355, -1.0516],
         [ 0.4762,  0.2255,  0.9164,  ..., -0.4592,  0.0905, -1.3772]],

        [[ 0.5157,  1.1595,  1.1264,  ...,  0.2345, -0.0154,  0.2576],
         [ 0.0053, -0.3712, -0.7050,  ..., -0.2585,  0.1625,  0.3259],
         [-0.5399,  0.3683,  0.5486,  ...,  0.2258, -0.3614, -0.2666]]],
       grad_fn=&lt;ViewBackward0&gt;), past_key_values=&lt;transformers.cache_utils.DynamicCache object at 0x7fea3dc08200&gt;, hidden_states=None, attentions=None)
</pre></div>
</div>
</section>
<section id="export">
<h2>Export<a class="headerlink" href="#export" title="Link to this heading">¶</a></h2>
<p>We try to export with <a class="reference internal" href="../api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx"><code class="xref py py-func docutils literal notranslate"><span class="pre">experimental_experiment.torch_interpreter.to_onnx()</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><span class="n">to_onnx</span></a></a></a></a><span class="p">(</span>
        <a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span></a></a></a></a><span class="p">(</span><span class="n">model</span><span class="p">),</span>
        <span class="p">(),</span>
        <span class="n">kwargs</span><span class="o">=</span><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><a href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="copy.deepcopy" class="sphx-glr-backref-module-copy sphx-glr-backref-type-py-function"><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span></a></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">),</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="p">,</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;export failed due to </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The export fails for a couple of reason but it is possible to patch the
code to make it work. All those modifications are put in place by
<a class="reference external" href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="(in onnx-diagnostic v0.6.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch_export_patches</span></code></a>
and reverted after the export is done. Among other things, this function registers
serialization functions as shown in example
<a class="reference internal" href="plot_exporter_exporter_with_dynamic_cache.html#l-plot-torch-export-with-dynamic-cache-201"><span class="std std-ref">Export a model using a custom type as input</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">onnx_diagnostic.torch_export_patches</span> <span class="kn">import</span> <a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><span class="n">torch_export_patches</span></a></a></a></a>

<span class="k">with</span> <a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-diagnostic/dev/api/torch_export_patches/index.html#onnx_diagnostic.torch_export_patches.torch_export_patches" title="onnx_diagnostic.torch_export_patches.torch_export_patches" class="sphx-glr-backref-module-onnx_diagnostic-torch_export_patches sphx-glr-backref-type-py-function"><span class="n">torch_export_patches</span></a></a></a></a><span class="p">(</span><span class="n">patch_transformers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">modificator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs before&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a> <span class="o">=</span> <span class="n">modificator</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inputs after&quot;</span><span class="p">,</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/helpers.html#experimental_experiment.helpers.string_type" title="experimental_experiment.helpers.string_type" class="sphx-glr-backref-module-experimental_experiment-helpers sphx-glr-backref-type-py-function"><span class="n">string_type</span></a></a></a></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">,</span> <span class="n">with_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="c1"># ep = torch.export.export(model, (), inputs, dynamic_shapes=dynamic_shapes, strict=False)</span>
    <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer" title="experimental_experiment.xbuilder.model_container.TorchModelContainer" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">large_onx</span></a></a></a></a> <span class="o">=</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.to_onnx" title="experimental_experiment.torch_interpreter.to_onnx" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-function"><span class="n">to_onnx</span></a></a></a></a><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="p">(),</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inputs</span></a></a></a></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dynamic_shapes</span></a></a></a></a><span class="p">,</span>
        <span class="n">export_options</span><span class="o">=</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/torch_interpreter/index.html#experimental_experiment.torch_interpreter.ExportOptions" title="experimental_experiment.torch_interpreter.ExportOptions" class="sphx-glr-backref-module-experimental_experiment-torch_interpreter sphx-glr-backref-type-py-class"><span class="n">ExportOptions</span></a></a></a></a><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">large_model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer.save" title="experimental_experiment.xbuilder.model_container.TorchModelContainer.save" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer.save" title="experimental_experiment.xbuilder.model_container.TorchModelContainer.save" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer.save" title="experimental_experiment.xbuilder.model_container.TorchModelContainer.save" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/model_container.html#experimental_experiment.xbuilder.model_container.TorchModelContainer.save" title="experimental_experiment.xbuilder.model_container.TorchModelContainer.save" class="sphx-glr-backref-module-experimental_experiment-xbuilder-model_container sphx-glr-backref-type-py-method"><span class="n">large_onx</span><span class="o">.</span><span class="n">save</span></a></a></a></a><span class="p">(</span><span class="s2">&quot;plot_exporter_recipes_c_phi2.onnx&quot;</span><span class="p">,</span> <span class="n">all_tensors_to_one_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[torch_export_patches] replace torch.jit.isinstance, torch._dynamo.mark_static_address
[register_cache_serialization] register &lt;class &#39;transformers.cache_utils.MambaCache&#39;&gt;
[register_cache_serialization] register &lt;class &#39;transformers.cache_utils.EncoderDecoderCache&#39;&gt;
[torch_export_patches] sympy.__version__=&#39;1.13.3&#39;
[torch_export_patches] patch sympy
[torch_export_patches] torch.__version__=&#39;2.8.0.dev20250519+cu126&#39;
[torch_export_patches] stop_if_static=0
[torch_export_patches] patch pytorch
[torch_export_patches] modifies shape constraints
[torch_export_patches] transformers.__version__=&#39;4.52.0.dev0&#39;
[patch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_AttentionMaskConverter:
[patch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_DynamicCache: reorder_cache, update, crop, from_batch_splits, get_seq_length
[patch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_GenerationMixin: _cache_dependant_input_preparation, _cache_dependant_input_preparation_exporting, prepare_inputs_for_generation
[torch_export_patches] done patching
inputs before dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
inputs after dict(input_ids:T7s2x3,attention_mask:T7s2x33,past_key_values:DynamicCache(key_cache=#2[T1s2x32x30x80,T1s2x32x30x80], value_cache=#2[T1s2x32x30x80,T1s2x32x30x80]))
[torch_export_patches] remove patches
[torch_export_patches] restored sympy functions
[torch_export_patches] restored pytorch functions
[torch_export_patches] restored shape constraints
[torch_export_patches] unpatch transformers
[unpatch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_AttentionMaskConverter:
[unpatch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_DynamicCache: reorder_cache, update, crop, from_batch_splits, get_seq_length
[unpatch_module_or_classes] onnx_diagnostic.torch_export_patches.patches.patch_transformers.patched_GenerationMixin: _cache_dependant_input_preparation, _cache_dependant_input_preparation_exporting, prepare_inputs_for_generation
[unregister_cache_serialization] unregistered MambaCache
[unregister_cache_serialization] unregistered EncoderDecoderCache
</pre></div>
</div>
</section>
<section id="exported-model">
<h2>Exported Model<a class="headerlink" href="#exported-model" title="Link to this heading">¶</a></h2>
<p>Let’s display the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a></a> <span class="o">=</span> <a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.load" title="onnx.load" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-function"><span class="n">onnx</span><span class="o">.</span><span class="n">load</span></a></a></a></a><span class="p">(</span><span class="s2">&quot;plot_exporter_recipes_c_phi2.onnx&quot;</span><span class="p">)</span>
<a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gr</span></a></a></a></a> <span class="o">=</span> <a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder" title="experimental_experiment.xbuilder.GraphBuilder" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class"><span class="n">GraphBuilder</span></a></a></a></a><span class="p">(</span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a></a><span class="p">,</span> <span class="n">infer_shapes_options</span><span class="o">=</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.InferShapesOptions" title="experimental_experiment.xbuilder.InferShapesOptions" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">InferShapesOptions</span><span class="o">.</span><span class="n">NONE</span></a></a></a></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder.pretty_text" title="experimental_experiment.xbuilder.GraphBuilder.pretty_text" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder.pretty_text" title="experimental_experiment.xbuilder.GraphBuilder.pretty_text" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder.pretty_text" title="experimental_experiment.xbuilder.GraphBuilder.pretty_text" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-method"><a href="https://sdpython.github.io/doc/experimental-experiment/dev/api/xbuilder/index.html#experimental_experiment.xbuilder.GraphBuilder.pretty_text" title="experimental_experiment.xbuilder.GraphBuilder.pretty_text" class="sphx-glr-backref-module-experimental_experiment-xbuilder sphx-glr-backref-type-py-method"><span class="n">gr</span><span class="o">.</span><span class="n">pretty_text</span></a></a></a></a><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>dyn---: batch -&gt; WrapSym(batch)
dyn---: cache_length -&gt; WrapSym(cache_length)
dyn---: cache_length+seq_length -&gt; WrapSym(cache_length+seq_length)
dyn---: channel -&gt; WrapSym(channel)
dyn---: seq_length -&gt; WrapSym(seq_length)
dyn---: seq_length+cache_length -&gt; WrapSym(seq_length+cache_length)
dynrev: batch -&gt; [(&#39;batch&#39;, SymInt(batch))]
dynrev: cache_length -&gt; [(&#39;cache_length&#39;, SymInt(cache_length))]
dynrev: cache_length+seq_length -&gt; [(&#39;cache_length+seq_length&#39;, SymInt(cache_length+seq_length))]
dynrev: channel -&gt; [(&#39;channel&#39;, SymInt(channel))]
dynrev: seq_length -&gt; [(&#39;seq_length&#39;, SymInt(seq_length))]
dynrev: seq_length+cache_length -&gt; [(&#39;seq_length+cache_length&#39;, SymInt(seq_length+cache_length))]
dynsrc: batch -&gt; [{batch:(&#39;input_name&#39;, &#39;input_ids&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;attention_mask&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_key_cache_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_key_cache_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_value_cache_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;past_key_values_value_cache_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;output_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;embedding&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_cast_to0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;eq_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;masked_fill&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand_as&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_30&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_19&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_23&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_24&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_21&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_22&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_25&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_26&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_31&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_32&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_35&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_36&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_33&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_34&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_37&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_38&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_dropout0000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_39&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_add_9000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_dropout000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_44&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;eq_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_43&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_add_150&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_cast_to0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_dropout000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_34&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_add_900000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_add_150&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_add_90000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_14&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_add_15000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_36&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_31&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_add_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;contiguous_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_add_90000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;clone&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_33&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_23&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_dropout00000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_28&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_38&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;masked_fill&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_add_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_add_9000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_13&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow_sub_add_900&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_reducemean_dropout0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_19&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_45&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;neg&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;layer_norm&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_17&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_21&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_29&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_add_150000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_27&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_add_150000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_15&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;view_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_add_15000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_slice_450&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_22&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;contiguous&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_pow_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_37&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_add_1500000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_5&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_26&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_35&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_6&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_11&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;pow_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;embedding&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_dropout0000&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_41&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;expand_as&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;to&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_24&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_42&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_8&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;transpose_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;tanh_1&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_12&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_add_1500&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_3&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;linear_9&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;dropout_4&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_32&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_30&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;add_7&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_sub_dropout0&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;reshape_2&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;mul_16&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;_onx_div_sub_dropout00&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;slice_25&#39;), batch:(&#39;axis&#39;, 0)}, {batch:(&#39;input_name&#39;, &#39;cat_8&#39;), batch:(&#39;axis&#39;, 0)}]
dynsrc: cache_length -&gt; [{cache_length:(&#39;input_name&#39;, &#39;past_key_values_key_cache_0&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_key_cache_1&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_value_cache_0&#39;), cache_length:(&#39;axis&#39;, 2)}, {cache_length:(&#39;input_name&#39;, &#39;past_key_values_value_cache_1&#39;), cache_length:(&#39;axis&#39;, 2)}]
dynsrc: cache_length+seq_length -&gt; [{cache_length+seq_length:(&#39;input_name&#39;, &#39;output_1&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_2&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_3&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;output_4&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_11&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_5&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_6&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}, {cache_length+seq_length:(&#39;input_name&#39;, &#39;cat_12&#39;), cache_length+seq_length:(&#39;axis&#39;, 2)}]
dynsrc: channel -&gt; [{channel:(&#39;input_name&#39;, &#39;attention_mask&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;full&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;triu&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;arange_1&#39;), channel:(&#39;axis&#39;, 0)}, {channel:(&#39;input_name&#39;, &#39;gt&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;expand&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_6&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;_onx_cast_to0&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;add_2&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;eq_6&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;masked_fill&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;expand_as&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_39&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;eq_6&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;_onx_cast_to0&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_3&#39;), channel:(&#39;axis&#39;, 2)}, {channel:(&#39;input_name&#39;, &#39;triu&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;slice_6&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;expand&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_5&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;mul_&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;arange_1&#39;), channel:(&#39;axis&#39;, 0)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_4&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_1&#39;), channel:(&#39;axis&#39;, 2)}, {channel:(&#39;input_name&#39;, &#39;clone&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;full&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;slice_28&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;add_2&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;masked_fill&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;slice_9&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_40&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_3&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;gt&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;slice_29&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), channel:(&#39;axis&#39;, 1)}, {channel:(&#39;input_name&#39;, &#39;slice_27&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_10&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_11&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_4&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_41&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;expand_as&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;to&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), channel:(&#39;axis&#39;, 3)}, {channel:(&#39;input_name&#39;, &#39;slice_12&#39;), channel:(&#39;axis&#39;, 3)}]
dynsrc: seq_length -&gt; [{seq_length:(&#39;input_name&#39;, &#39;input_ids&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;output_0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;embedding&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;arange&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;full&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;triu&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;reshape&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;gt&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;expand&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;eq_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;masked_fill&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;expand_as&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;to_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;matmul&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_19&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_20&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_23&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_24&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_21&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_22&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_25&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_26&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_31&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_32&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_35&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_36&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_33&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_34&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_37&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_38&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_12&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_13&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_13&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_17&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;arange&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;add_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;view_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_dropout0000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_103&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;pow_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm04&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_39&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_add_9000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;to_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;neg_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_dropout000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_170&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_44&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_11&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;eq_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_43&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_add_150&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_dropout000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_34&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;triu&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_add_900000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_6&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_add_150&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_add_90000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;expand&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_14&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_pow_sub_add_15000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;tanh&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_36&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_31&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_add_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;contiguous_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_add_90000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;clone&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm02&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;full&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;mul_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_33&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_20&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_13&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_23&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_dropout00000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_28&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm03&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_38&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;masked_fill&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_3&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_triu0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;cat_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_add_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_104&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_120&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_add_9000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_5&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_13&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow_sub_add_900&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_8&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_reducemean_dropout0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_pow_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_19&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_40&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_45&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;dropout&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;to_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;neg&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;layer_norm&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_40&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_17&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;matmul&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_21&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_102&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;gt&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;slice_29&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_mul_div_sub_add_150000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;scaled_dot_product_attention_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;wrap_with_set_grad_enabled#0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_cast_gt0&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_mul_90&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_27&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_add_150000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_12&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_15&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;view_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;to_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_div_sub_add_15000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;linear_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_slice_450&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_12&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_22&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;contiguous&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_pow_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_37&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sqrt_add_reducemean_pow_sub_add_1500000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape&#39;), seq_length:(&#39;axis&#39;, 0)}, {seq_length:(&#39;input_name&#39;, &#39;mul_5&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_10&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_26&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_35&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_6&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_11&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;pow_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;embedding&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;cat&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_add_reducemean_pow_sub_dropout0000&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_4&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_41&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_linear_100&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_mul_add_60&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;expand_as&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_9&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_24&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;slice_42&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_8&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_2&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;transpose_1&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;tanh_1&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_12&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;unsqueeze_7&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_reshape_20&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_add_1500&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;add_3&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;linear_9&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;dropout_4&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_32&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;mul_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;add_7&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_sub_dropout0&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;reshape_2&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_matmul_layer_norm_10&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;mul_16&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;_onx_div_sub_dropout00&#39;), seq_length:(&#39;axis&#39;, 1)}, {seq_length:(&#39;input_name&#39;, &#39;slice_25&#39;), seq_length:(&#39;axis&#39;, 2)}, {seq_length:(&#39;input_name&#39;, &#39;cat_8&#39;), seq_length:(&#39;axis&#39;, 2)}]
dynsrc: seq_length+cache_length -&gt; [{seq_length+cache_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length+cache_length:(&#39;axis&#39;, 3)}, {seq_length+cache_length:(&#39;input_name&#39;, &#39;slice_42&#39;), seq_length+cache_length:(&#39;axis&#39;, 3)}, {seq_length+cache_length:(&#39;input_name&#39;, &#39;slice_30&#39;), seq_length+cache_length:(&#39;axis&#39;, 3)}]
opset: : 18
opset: local_functions.0: 1
opset: local_functions: 1
opset: aten: 1
init: b_model_rotary_emb_inv_freq: ?: ?                                -- GraphBuilder._update_structures_with_proto.1/from(b_model_rotary_emb_inv_freq)
init: init7_s1_1: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_1)
init: init7_s_1: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init7_s_1)
init: init7_s1_0: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_0)
init: init7_s_0: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init7_s_0)
init: init7_s2_-1_1: int64: 2                                          -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_1)##GraphBuilder.compute_constant/from(init7_s2_-1_1)##GraphBuilder._update_structures_with_proto.1/from(init7_s2_-1_1)
init: init7_s1_3: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_3)
init: init1_s1_: ?: ?                                                  -- GraphBuilder._update_structures_with_proto.1/from(init1_s1_)
init: init7_s1_-1: ?: ?                                                -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_-1)
init: init7_s1_80: ?: ?                                                -- GraphBuilder._update_structures_with_proto.1/from(init7_s1_80)
init: init1_s1_4: ?: ?                                                 -- GraphBuilder._update_structures_with_proto.1/from(init1_s1_4)
init: _reshape_init1_s_0: ?: ?                                         -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_0)
init: _onx_transpose_p_model_layers_0_self_attn_q_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_self_attn_q_proj_weight0)
init: _onx_transpose_p_model_layers_0_self_attn_k_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_self_attn_k_proj_weight0)
init: _onx_transpose_p_model_layers_0_self_attn_v_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_self_attn_v_proj_weight0)
init: _onx_transpose_p_model_layers_0_self_attn_dense_weight0: ?: ?    -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_self_attn_dense_weight0)
init: _onx_transpose_p_model_layers_0_mlp_fc1_weight0: ?: ?            -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_mlp_fc1_weight0)
init: _reshape_init1_s_30: ?: ?                                        -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_30)
init: _reshape_init1_s_40: ?: ?                                        -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_40)
init: _reshape_init1_s_50: ?: ?                                        -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_50)
init: _reshape_init1_s_60: ?: ?                                        -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_60)
init: _onx_transpose_p_model_layers_0_mlp_fc2_weight0: ?: ?            -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_0_mlp_fc2_weight0)
init: _onx_transpose_p_model_layers_1_self_attn_q_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_self_attn_q_proj_weight0)
init: _onx_transpose_p_model_layers_1_self_attn_k_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_self_attn_k_proj_weight0)
init: _onx_transpose_p_model_layers_1_self_attn_v_proj_weight0: ?: ?   -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_self_attn_v_proj_weight0)
init: _onx_transpose_p_model_layers_1_self_attn_dense_weight0: ?: ?    -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_self_attn_dense_weight0)
init: _onx_transpose_p_model_layers_1_mlp_fc1_weight0: ?: ?            -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_mlp_fc1_weight0)
init: _reshape_init1_s_302: ?: ?                                       -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_302)
init: _reshape_init1_s_402: ?: ?                                       -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_402)
init: _reshape_init1_s_502: ?: ?                                       -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_502)
init: _reshape_init1_s_602: ?: ?                                       -- GraphBuilder._update_structures_with_proto.1/from(_reshape_init1_s_602)
init: _onx_transpose_p_model_layers_1_mlp_fc2_weight0: ?: ?            -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_model_layers_1_mlp_fc2_weight0)
init: _onx_transpose_p_lm_head_weight0: ?: ?                           -- GraphBuilder._update_structures_with_proto.1/from(_onx_transpose_p_lm_head_weight0)
init: init7_s2_0_1: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_0_1)
init: init7_s2_1_2: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_1_2)
init: init1_s2560_: ?: ?                                               -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_)
init: init1_s2560_2: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_2)
init: init1_s2560_3: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_3)
init: init1_s2560_4: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_4)
init: init1_s2560_5: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_5)
init: init1_s2560_6: ?: ?                                              -- GraphBuilder._update_structures_with_proto.1/from(init1_s2560_6)
init: init7_s2_32_48: ?: ?                                             -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_32_48)
init: init7_s2_16_16: ?: ?                                             -- GraphBuilder._update_structures_with_proto.1/from(init7_s2_16_16)
init: model.embed_tokens.weight: ?: ?                                  -- GraphBuilder._update_structures_with_proto.1/from(model.embed_tokens.weight)
input:: input_ids                                                               |T7: batch x seq_length
input:: attention_mask                                                          |T7: batch x channel
input:: past_key_values_key_cache_0                                             |T1: batch x 32 x cache_length x 80
input:: past_key_values_key_cache_1                                             |T1: batch x 32 x cache_length x 80
input:: past_key_values_value_cache_0                                           |T1: batch x 32 x cache_length x 80
input:: past_key_values_value_cache_1                                           |T1: batch x 32 x cache_length x 80
Shape: input_ids -&gt; _shape_input_ids0                                           |T7: 1                        - sym_size_int
Shape: input_ids -&gt; _shape_input_ids02                                          |T7: 1                        - sym_size_int3
Squeeze: _shape_input_ids02 -&gt; sym_size_int_22                                  |T7:                          - sym_size_int4
Unsqueeze: sym_size_int_22, init7_s1_0 -&gt; _onx_unsqueeze_sym_size_int_220       |T7: 1                        - _mkshape1_sym_size_int_22
Shape: past_key_values_key_cache_0 -&gt; _shape_past_key_values_key_cache_00       |T7: 1                        - sym_size_int5
Squeeze: _shape_past_key_values_key_cache_00 -&gt; sym_size_int_23                 |T7:                          - sym_size_int6
Gather: model.embed_tokens.weight, input_ids -&gt; embedding                       |T1: batch x seq_length x 2560- embedding
Add: sym_size_int_23, sym_size_int_22 -&gt; add                                    |T7:                          - add3
Unsqueeze: add, init7_s1_0 -&gt; _onx_unsqueeze_add0                               |T7: 1                        - _mkshape1_add
Range: sym_size_int_23, add, init7_s_1 -&gt; arange                                |T7: seq_length               - arange
Unsqueeze: arange, init7_s2_0_1 -&gt; unsqueeze_7                                  |T7: 1 x 1 x seq_length       - UnsqueezeUnsqueezePattern--unsqueeze2
Concat: _onx_unsqueeze_sym_size_int_220, _onx_unsqueeze_add0 -&gt; _onx_concat_unsqueeze_sym_size_int_2200                       |T7: 2- _mkshape_add
ConstantOfShape: _onx_concat_unsqueeze_sym_size_int_2200 -&gt; full                |T1: seq_length x channel     - fullD2
Trilu: full, init7_s_1 -&gt; triu                                                  |T1: seq_length x channel     - triu
Range: init7_s_0, add, init7_s_1 -&gt; arange_1                                    |T7: channel                  - arange2
Reshape: arange, init7_s2_-1_1 -&gt; reshape                                       |T7: seq_length x 1           - reshape
Greater: arange_1, reshape -&gt; gt                                                |T9: seq_length x channel     - gt_Tensor
Cast: gt -&gt; _onx_cast_gt0                                                       |T1: seq_length x channel     - mul__Tensor
Mul: triu, _onx_cast_gt0 -&gt; _onx_mul_triu0                                      |T1: seq_length x channel     - mul__Tensor2
Unsqueeze: _onx_mul_triu0, init7_s2_0_1 -&gt; unsqueeze_2                          |T1: 1 x 1 x seq_length x channel- UnsqueezeUnsqueezePattern--unsqueeze22
Shape: unsqueeze_2 -&gt; _shape_unsqueeze_20                                       |T7: 1                        - expand_B
Shape: unsqueeze_2 -&gt; _shape_unsqueeze_202                                      |T7: 1                        - expand_B2
Concat: _shape_input_ids0, init7_s1_1, _shape_unsqueeze_20, _shape_unsqueeze_202 -&gt; _onx_concat_unsqueeze_sym_size_int_2100                                           |T7: 4- _mkshape__shape_unsqueeze_202
Expand: unsqueeze_2, _onx_concat_unsqueeze_sym_size_int_2100 -&gt; expand          |T1: batch x 1 x seq_length x channel- expand_B_neg
Slice: expand, init7_s1_0, _onx_unsqueeze_add0, init7_s1_3 -&gt; slice_6           |T1: batch x 1 x seq_length x channel- slide_Tensor3
Unsqueeze: attention_mask, init7_s2_1_2 -&gt; unsqueeze_4                          |T7: batch x 1 x 1 x channel  - UnsqueezeUnsqueezePattern--unsqueeze4
Cast: unsqueeze_4 -&gt; _onx_cast_to0                                              |T1: batch x 1 x 1 x channel  - Opset2
Add: slice_6, _onx_cast_to0 -&gt; add_2                                            |T1: batch x 1 x seq_length x channel- add_Tensor
Equal: add_2, _reshape_init1_s_0 -&gt; eq_6                                        |T9: batch x 1 x seq_length x channel- eq
Where: eq_6, init1_s1_, slice_6 -&gt; masked_fill                                  |T1: batch x 1 x seq_length x channel- masked_fill_Scalar
Shape: expand -&gt; _shape_clone0                                                  |T7: 4                        - aten_meth_expand_as
Expand: masked_fill, _shape_clone0 -&gt; expand_as                                 |T1: batch x 1 x seq_length x channel- aten_meth_expand_as2
Slice: expand_as, init7_s1_0, _onx_unsqueeze_add0, init7_s1_3 -&gt; slice_30       |T1: batch x 1 x seq_length x seq_length+cache_length- slide_Tensor17
Constant:  -&gt; init7_s2_0_2                                                      |T7: 2                        - init2cst2
Unsqueeze: b_model_rotary_emb_inv_freq, init7_s2_0_2 -&gt; unsqueeze_6             |T1: 1 x 16 x 1               - UnsqueezeUnsqueezePattern--unsqueeze
Cast: unsqueeze_7 -&gt; to_3                                                       |T1: 1 x 1 x seq_length       - to_dtype2
MatMul: unsqueeze_6, to_3 -&gt; matmul                                             |T1: 1 x 16 x seq_length      - Opset36
Transpose: matmul -&gt; transpose                                                  |T1: 1 x seq_length x 16      - transpose_int9
Concat: transpose, transpose -&gt; cat                                             |T1: 1 x seq_length x 32      - cat13
Cos: cat -&gt; wrap_with_set_grad_enabled#0                                        |T1: 1 x seq_length x 32      - cos
Unsqueeze: wrap_with_set_grad_enabled#0, init7_s1_1 -&gt; unsqueeze_8              |T1: 1 x 1 x seq_length x 32  - unsqueeze6
Sin: cat -&gt; wrap_with_set_grad_enabled#1                                        |T1: 1 x seq_length x 32      - sin
Unsqueeze: wrap_with_set_grad_enabled#1, init7_s1_1 -&gt; unsqueeze_9              |T1: 1 x 1 x seq_length x 32  - unsqueeze7
LayerNormalization: embedding, init1_s2560_, init1_s2560_2 -&gt; _onx_div_sub_dropout00    |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm4
MatMul: _onx_div_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_q_proj_weight0 -&gt; _onx_matmul_layer_norm0                                   |T1: batch x seq_length x 2560- Opset5
Concat: _shape_input_ids0, _onx_unsqueeze_sym_size_int_220, init7_s1_-1, init7_s1_80 -&gt; _onx_concat_unsqueeze_sym_size_int_21020                                                |T7: 4- _mkshape_sym_size_int_22
Reshape: _onx_matmul_layer_norm0, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view  |T1: batch x seq_length x 32 x 80- view
Transpose: view -&gt; transpose_1                                                  |T1: batch x 32 x seq_length x 80- transpose_int
Split: transpose_1, init7_s2_32_48 -&gt; slice_19, slice_20                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slide_Tensor7
Split: slice_19, init7_s2_16_16 -&gt; slice_23, slice_24                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slide_Tensor11
MatMul: _onx_div_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_k_proj_weight0 -&gt; _onx_matmul_layer_norm02                                    |T1: batch x seq_length x 2560- Opset7
Reshape: _onx_matmul_layer_norm02, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view_1     |T1: batch x seq_length x 32 x 80- view2
Transpose: view_1 -&gt; transpose_2                                                |T1: batch x 32 x seq_length x 80- transpose_int2
Split: transpose_2, init7_s2_32_48 -&gt; slice_21, slice_22                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slide_Tensor9
Split: slice_21, init7_s2_16_16 -&gt; slice_25, slice_26                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slide_Tensor13
MatMul: _onx_div_sub_dropout00, _onx_transpose_p_model_layers_0_self_attn_v_proj_weight0 -&gt; _onx_matmul_layer_norm03                                    |T1: batch x seq_length x 2560- Opset9
Reshape: _onx_matmul_layer_norm03, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view_2     |T1: batch x seq_length x 32 x 80- view3
Transpose: view_2 -&gt; transpose_3                                                |T1: batch x 32 x seq_length x 80- transpose_int3
Mul: slice_19, unsqueeze_8 -&gt; mul_2                                             |T1: batch x 32 x seq_length x 32- mul_Tensor
Neg: slice_24 -&gt; neg                                                            |T1: batch x 32 x seq_length x 16- neg
Concat: neg, slice_23 -&gt; cat_1                                                  |T1: batch x 32 x seq_length x 32- cat
Mul: cat_1, unsqueeze_9 -&gt; mul_3                                                |T1: batch x 32 x seq_length x 32- mul_Tensor2
Add: mul_2, mul_3 -&gt; add_3                                                      |T1: batch x 32 x seq_length x 32- add_Tensor2
Mul: slice_21, unsqueeze_8 -&gt; mul_4                                             |T1: batch x 32 x seq_length x 32- mul_Tensor3
Neg: slice_26 -&gt; neg_1                                                          |T1: batch x 32 x seq_length x 16- neg2
Concat: neg_1, slice_25 -&gt; cat_2                                                |T1: batch x 32 x seq_length x 32- cat2
Mul: cat_2, unsqueeze_9 -&gt; mul_5                                                |T1: batch x 32 x seq_length x 32- mul_Tensor4
Add: mul_4, mul_5 -&gt; add_4                                                      |T1: batch x 32 x seq_length x 32- add_Tensor3
Concat: add_3, slice_20 -&gt; cat_3                                                |T1: batch x 32 x seq_length x 80- cat3
Concat: add_4, slice_22 -&gt; cat_4                                                |T1: batch x 32 x seq_length x 80- cat4
Concat: past_key_values_key_cache_0, cat_4 -&gt; output_1                          |T1: batch x 32 x cache_length+seq_length x 80- cat5
Concat: past_key_values_value_cache_0, transpose_3 -&gt; output_3                  |T1: batch x 32 x cache_length+seq_length x 80- cat6
aten_scaled_dot_product_attention_default[aten]: cat_3, output_1, output_3, slice_30 -&gt; scaled_dot_product_attention                                    |T1: batch x 32 x seq_length x 80- aten.scaled_dot_product_attention.default
Transpose: scaled_dot_product_attention -&gt; transpose_4                          |T1: batch x seq_length x 32 x 80- transpose_int4
Concat: _shape_input_ids0, _onx_unsqueeze_sym_size_int_220, init7_s1_-1 -&gt; _onx_concat_unsqueeze_sym_size_int_21030                                   |T7: 3- _mkshape_sym_size_int_222
Reshape: transpose_4, _onx_concat_unsqueeze_sym_size_int_21030 -&gt; reshape_1     |T1: batch x seq_length x 2560- reshape2
MatMul: reshape_1, _onx_transpose_p_model_layers_0_self_attn_dense_weight0 -&gt; _onx_matmul_reshape_10                    |T1: batch x seq_length x 2560- Opset12
MatMul: _onx_div_sub_dropout00, _onx_transpose_p_model_layers_0_mlp_fc1_weight0 -&gt; _onx_matmul_layer_norm04                           |T1: batch x seq_length x 10240- Opset14
Mul: _onx_matmul_layer_norm04, _reshape_init1_s_30 -&gt; _onx_mul_linear_40        |T1: batch x seq_length x 10240- mul_Tensor6
Pow: _onx_matmul_layer_norm04, init1_s1_4 -&gt; pow_1                              |T1: batch x seq_length x 10240- pow_Tensor_Scalar
Mul: pow_1, _reshape_init1_s_40 -&gt; _onx_mul_pow_10                              |T1: batch x seq_length x 10240- mul_Tensor9
Add: _onx_matmul_layer_norm04, _onx_mul_pow_10 -&gt; add_6                         |T1: batch x seq_length x 10240- add_Tensor4
Mul: add_6, _reshape_init1_s_50 -&gt; _onx_mul_add_60                              |T1: batch x seq_length x 10240- mul_Tensor12
Tanh: _onx_mul_add_60 -&gt; tanh                                                   |T1: batch x seq_length x 10240- tanh
Add: tanh, _reshape_init1_s_60 -&gt; add_7                                         |T1: batch x seq_length x 10240- add_Tensor5
Mul: _onx_mul_linear_40, add_7 -&gt; mul_9                                         |T1: batch x seq_length x 10240- mul_Tensor14
MatMul: mul_9, _onx_transpose_p_model_layers_0_mlp_fc2_weight0 -&gt; _onx_matmul_mul_90    |T1: batch x seq_length x 2560- Opset17
Add: _onx_matmul_reshape_10, _onx_matmul_mul_90 -&gt; add_8                        |T1: batch x seq_length x 2560- add_Tensor6
Add: add_8, embedding -&gt; add_9                                                  |T1: batch x seq_length x 2560- add_Tensor7
LayerNormalization: add_9, init1_s2560_3, init1_s2560_4 -&gt; _onx_div_sub_add_900 |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm13
MatMul: _onx_div_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_q_proj_weight0 -&gt; _onx_matmul_layer_norm_10                                   |T1: batch x seq_length x 2560- Opset19
Reshape: _onx_matmul_layer_norm_10, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view_3      |T1: batch x seq_length x 32 x 80- view4
Transpose: view_3 -&gt; transpose_5                                                |T1: batch x 32 x seq_length x 80- transpose_int5
Split: transpose_5, init7_s2_32_48 -&gt; slice_31, slice_32                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slide_Tensor18
Split: slice_31, init7_s2_16_16 -&gt; slice_35, slice_36                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slide_Tensor22
MatMul: _onx_div_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_k_proj_weight0 -&gt; _onx_matmul_layer_norm_102                                    |T1: batch x seq_length x 2560- Opset21
Reshape: _onx_matmul_layer_norm_102, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view_4       |T1: batch x seq_length x 32 x 80- view5
Transpose: view_4 -&gt; transpose_6                                                |T1: batch x 32 x seq_length x 80- transpose_int6
Split: transpose_6, init7_s2_32_48 -&gt; slice_33, slice_34                        |T1: batch x 32 x seq_length x 32 T1: batch x 32 x seq_length x 48- SlicesSplitPattern--slide_Tensor20
Split: slice_33, init7_s2_16_16 -&gt; slice_37, slice_38                           |T1: batch x 32 x seq_length x 16 T1: batch x 32 x seq_length x 16- SlicesSplitPattern--slide_Tensor24
MatMul: _onx_div_sub_add_900, _onx_transpose_p_model_layers_1_self_attn_v_proj_weight0 -&gt; _onx_matmul_layer_norm_103                                    |T1: batch x seq_length x 2560- Opset23
Reshape: _onx_matmul_layer_norm_103, _onx_concat_unsqueeze_sym_size_int_21020 -&gt; view_5       |T1: batch x seq_length x 32 x 80- view6
Transpose: view_5 -&gt; transpose_7                                                |T1: batch x 32 x seq_length x 80- transpose_int7
Mul: slice_31, unsqueeze_8 -&gt; mul_10                                            |T1: batch x 32 x seq_length x 32- mul_Tensor15
Neg: slice_36 -&gt; neg_2                                                          |T1: batch x 32 x seq_length x 16- neg3
Concat: neg_2, slice_35 -&gt; cat_7                                                |T1: batch x 32 x seq_length x 32- cat7
Mul: cat_7, unsqueeze_9 -&gt; mul_11                                               |T1: batch x 32 x seq_length x 32- mul_Tensor16
Add: mul_10, mul_11 -&gt; add_10                                                   |T1: batch x 32 x seq_length x 32- add_Tensor8
Mul: slice_33, unsqueeze_8 -&gt; mul_12                                            |T1: batch x 32 x seq_length x 32- mul_Tensor17
Neg: slice_38 -&gt; neg_3                                                          |T1: batch x 32 x seq_length x 16- neg4
Concat: neg_3, slice_37 -&gt; cat_8                                                |T1: batch x 32 x seq_length x 32- cat8
Mul: cat_8, unsqueeze_9 -&gt; mul_13                                               |T1: batch x 32 x seq_length x 32- mul_Tensor18
Add: mul_12, mul_13 -&gt; add_11                                                   |T1: batch x 32 x seq_length x 32- add_Tensor9
Concat: add_10, slice_32 -&gt; cat_9                                               |T1: batch x 32 x seq_length x 80- cat9
Concat: add_11, slice_34 -&gt; cat_10                                              |T1: batch x 32 x seq_length x 80- cat10
Concat: past_key_values_key_cache_1, cat_10 -&gt; output_2                         |T1: batch x 32 x cache_length+seq_length x 80- cat11
Concat: past_key_values_value_cache_1, transpose_7 -&gt; output_4                  |T1: batch x 32 x cache_length+seq_length x 80- cat12
aten_scaled_dot_product_attention_default[aten]: cat_9, output_2, output_4, slice_30 -&gt; scaled_dot_product_attention_1                                      |T1: batch x 32 x seq_length x 80- aten.scaled_dot_product_attention.default2
Transpose: scaled_dot_product_attention_1 -&gt; transpose_8                        |T1: batch x seq_length x 32 x 80- transpose_int8
Reshape: transpose_8, _onx_concat_unsqueeze_sym_size_int_21030 -&gt; reshape_2     |T1: batch x seq_length x 2560- reshape3
MatMul: reshape_2, _onx_transpose_p_model_layers_1_self_attn_dense_weight0 -&gt; _onx_matmul_reshape_20                    |T1: batch x seq_length x 2560- Opset26
MatMul: _onx_div_sub_add_900, _onx_transpose_p_model_layers_1_mlp_fc1_weight0 -&gt; _onx_matmul_layer_norm_104                           |T1: batch x seq_length x 10240- Opset28
Mul: _onx_matmul_layer_norm_104, _reshape_init1_s_302 -&gt; _onx_mul_linear_100    |T1: batch x seq_length x 10240- mul_Tensor20
Pow: _onx_matmul_layer_norm_104, init1_s1_4 -&gt; pow_2                            |T1: batch x seq_length x 10240- pow_Tensor_Scalar2
Mul: pow_2, _reshape_init1_s_402 -&gt; _onx_mul_pow_20                             |T1: batch x seq_length x 10240- mul_Tensor23
Add: _onx_matmul_layer_norm_104, _onx_mul_pow_20 -&gt; add_12                      |T1: batch x seq_length x 10240- add_Tensor10
Mul: add_12, _reshape_init1_s_502 -&gt; _onx_mul_add_120                           |T1: batch x seq_length x 10240- mul_Tensor26
Tanh: _onx_mul_add_120 -&gt; tanh_1                                                |T1: batch x seq_length x 10240- tanh2
Add: tanh_1, _reshape_init1_s_602 -&gt; add_13                                     |T1: batch x seq_length x 10240- add_Tensor11
Mul: _onx_mul_linear_100, add_13 -&gt; mul_17                                      |T1: batch x seq_length x 10240- mul_Tensor28
MatMul: mul_17, _onx_transpose_p_model_layers_1_mlp_fc2_weight0 -&gt; _onx_matmul_mul_170      |T1: batch x seq_length x 2560- Opset31
Add: _onx_matmul_reshape_20, _onx_matmul_mul_170 -&gt; add_14                      |T1: batch x seq_length x 2560- add_Tensor12
Add: add_14, add_9 -&gt; add_15                                                    |T1: batch x seq_length x 2560- add_Tensor13
LayerNormalization: add_15, init1_s2560_5, init1_s2560_6 -&gt; _onx_div_sub_add_1500 |T1: batch x seq_length x 2560- LayerNormalizationPattern--layer_norm22
MatMul: _onx_div_sub_add_1500, _onx_transpose_p_lm_head_weight0 -&gt; output_0     |T1: batch x seq_length x 51200- Opset34
output:: output_0                                                               |T1: batch x seq_length x 51200
output:: output_1                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_2                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_3                                                               |T1: batch x 32 x cache_length+seq_length x 80
output:: output_4                                                               |T1: batch x 32 x cache_length+seq_length x 80

FUNCKEY: (&#39;aten&#39;, &#39;aten_scaled_dot_product_attention_default&#39;)
FUNC aten_scaled_dot_product_attention_default[aten]: [&#39;cat_3&#39;, &#39;cat_5&#39;, &#39;cat_6&#39;, &#39;slice_30&#39;] -&gt; [&#39;scaled_dot_product_attention&#39;]
  opset: &#39;&#39;: 18
  opset: local_functions.0: 1
  opset: local_functions: 1
  Constant:  -&gt; init1_s1_                                                         |T1: 1                        - init2cst
  Transpose: cat_5 -&gt; _onx_transpose_cat_50                                       |:                            - aten_scaled_dot_product_attention
  Sqrt: init1_s1_ -&gt; _onx_sqrt_init1_s1_0                                         |:                            - aten_scaled_dot_product_attention2
  Mul: cat_3, _onx_sqrt_init1_s1_0 -&gt; _onx_mul_cat_30                             |:                            - aten_scaled_dot_product_attention3
  Mul: _onx_transpose_cat_50, _onx_sqrt_init1_s1_0 -&gt; _onx_mul_transpose_cat_500  |:                            - aten_scaled_dot_product_attention4
  MatMul: _onx_mul_cat_30, _onx_mul_transpose_cat_500 -&gt; _onx_matmul_mul_cat_300  |:                            - aten_scaled_dot_product_attention5
  Add: _onx_matmul_mul_cat_300, slice_30 -&gt; _onx_add_matmul_mul_cat_3000          |:                            - aten_scaled_dot_product_attention6
  Softmax: _onx_add_matmul_mul_cat_3000 -&gt; _onx_softmax_add_matmul_mul_cat_30000  |:                            - aten_scaled_dot_product_attention7
  MatMul: _onx_softmax_add_matmul_mul_cat_30000, cat_6 -&gt; scaled_dot_product_attention    |T1: batch x 32 x seq_length x 80- aten_scaled_dot_product_attention8
</pre></div>
</div>
<p>Visually.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><a href="https://sdpython.github.io/doc/onnx-array-api/dev/api/plotting.html#onnx_array_api.plotting.graphviz_helper.plot_dot" title="onnx_array_api.plotting.graphviz_helper.plot_dot" class="sphx-glr-backref-module-onnx_array_api-plotting-graphviz_helper sphx-glr-backref-type-py-function"><span class="n">plot_dot</span></a></a></a></a><span class="p">(</span><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><a href="https://onnx.ai/onnx/api/serialization.html#onnx.ModelProto" title="onnx.ModelProto" class="sphx-glr-backref-module-onnx sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">onx</span></a></a></a></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_exporter_recipes_c_phi2_001.png" srcset="../_images/sphx_glr_plot_exporter_recipes_c_phi2_001.png" alt="plot exporter recipes c phi2" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 18.509 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-recipes-plot-exporter-recipes-c-phi2-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/24b19746af22318bd4f75a874a908bb2/plot_exporter_recipes_c_phi2.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_exporter_recipes_c_phi2.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/235ca6ff7b5302f675fe9e76ff52500c/plot_exporter_recipes_c_phi2.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_exporter_recipes_c_phi2.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b4213a18dfd166961a70adb9157bccc1/plot_exporter_recipes_c_phi2.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_exporter_recipes_c_phi2.zip</span></code></a></p>
</div>
</div>
<p class="rubric">Related examples</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Exports model Phi-2. We use a dummy model. The main difficulty is to set the dynamic shapes properly."><img alt="" src="../_images/sphx_glr_plot_exporter_recipes_oe_phi2_thumb.png" />
<p><a class="reference internal" href="plot_exporter_recipes_oe_phi2.html#sphx-glr-auto-recipes-plot-exporter-recipes-oe-phi2-py"><span class="std std-ref">torch.onnx.export and Phi-2</span></a></p>
  <div class="sphx-glr-thumbnail-title">torch.onnx.export and Phi-2</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Every conversion task must be tested on a large scale. One huge source of model is HuggingFace. We focus on the model Tiny-LLM. To avoid downloading any weigths, we write a function creating a random model based on the same architecture."><img alt="" src="../_images/sphx_glr_plot_exporter_exporter_untrained_tinyllm_thumb.png" />
<p><a class="reference internal" href="plot_exporter_exporter_untrained_tinyllm.html#sphx-glr-auto-recipes-plot-exporter-exporter-untrained-tinyllm-py"><span class="std std-ref">Check the exporter on a dummy from HuggingFace</span></a></p>
  <div class="sphx-glr-thumbnail-title">Check the exporter on a dummy from HuggingFace</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="torch.export.export often breaks on big models because there are control flows or instructions breaking the propagation of dynamic shapes (see ...). The function usually gives an indication where the model implementation can be fixed but in case, that is not possible, we can try to export the model piece by piece: every module is converted separately from its submodule. A model can be exported even if one of its submodules cannot."><img alt="" src="../_images/sphx_glr_plot_exporter_exporter_phi35_piece_thumb.png" />
<p><a class="reference internal" href="plot_exporter_exporter_phi35_piece.html#sphx-glr-auto-recipes-plot-exporter-exporter-phi35-piece-py"><span class="std std-ref">Export Phi-3.5-mini-instruct piece by piece</span></a></p>
  <div class="sphx-glr-thumbnail-title">Export Phi-3.5-mini-instruct piece by piece</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Tries torch.export._draft_export.draft_export."><img alt="" src="../_images/sphx_glr_plot_exporter_exporter_draft_mode_thumb.png" />
<p><a class="reference internal" href="plot_exporter_exporter_draft_mode.html#sphx-glr-auto-recipes-plot-exporter-exporter-draft-mode-py"><span class="std std-ref">Export Phi-3.5-mini-instruct with draft_export</span></a></p>
  <div class="sphx-glr-thumbnail-title">Export Phi-3.5-mini-instruct with draft_export</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Tries torch._export.tools.report_exportability."><img alt="" src="../_images/sphx_glr_plot_exporter_exporter_reportibility_thumb.png" />
<p><a class="reference internal" href="plot_exporter_exporter_reportibility.html#sphx-glr-auto-recipes-plot-exporter-exporter-reportibility-py"><span class="std std-ref">Export Phi-3.5-mini-instruct with report_exportability</span></a></p>
  <div class="sphx-glr-thumbnail-title">Export Phi-3.5-mini-instruct with report_exportability</div>
</div></div><p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="plot_exporter_recipes_c_custom_ops_inplace.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">to_onnx and a custom operator inplace</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="plot_exporter_exporter_dynamic_shapes_auto.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Use DYNAMIC or AUTO when dynamic shapes has constraints</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2024
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">to_onnx and Phi-2</a><ul>
<li><a class="reference internal" href="#model">Model</a></li>
<li><a class="reference internal" href="#export">Export</a></li>
<li><a class="reference internal" href="#exported-model">Exported Model</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=1a9ffd16"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>