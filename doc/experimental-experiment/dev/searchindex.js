Search.setIndex({"docnames": ["CHANGELOGS", "api/aten_function", "api/gradient", "api/graph_builder", "api/index", "api/interpreter", "api/onnx_export", "auto_examples/bug_dort", "auto_examples/index", "auto_examples/plot_convolutation_matmul", "auto_examples/plot_profile_existing_onnx", "auto_examples/plot_torch_aot", "auto_examples/plot_torch_dort", "auto_examples/plot_torch_export", "auto_examples/plot_torch_linreg", "auto_examples/sg_execution_times", "index", "license", "sg_execution_times", "tutorial/index"], "filenames": ["CHANGELOGS.rst", "api/aten_function.rst", "api/gradient.rst", "api/graph_builder.rst", "api/index.rst", "api/interpreter.rst", "api/onnx_export.rst", "auto_examples/bug_dort.rst", "auto_examples/index.rst", "auto_examples/plot_convolutation_matmul.rst", "auto_examples/plot_profile_existing_onnx.rst", "auto_examples/plot_torch_aot.rst", "auto_examples/plot_torch_dort.rst", "auto_examples/plot_torch_export.rst", "auto_examples/plot_torch_linreg.rst", "auto_examples/sg_execution_times.rst", "index.rst", "license.rst", "sg_execution_times.rst", "tutorial/index.rst"], "titles": ["Change Logs", "aten_functions", "gradient", "graph_builder", "API", "interpreter", "onnx_export", "To ignore", "Example gallery", "Convolution and Matrix Multiplication", "Profile an existing model", "Evaluate DORT Training", "Evaluate DORT", "Evaluate different ways to export a torch model to ONNX", "Linear Regression", "Computation times", "experimental-experiment: fuzzy work", "License", "Computation times", "Tutorial"], "terms": {"first": [0, 9, 10], "version": [0, 9, 13], "class": [2, 3, 5, 7, 11, 12, 13, 14], "experimental_experi": [2, 3, 5, 6, 9, 10, 11, 12, 13], "torch_exp": [3, 5, 6, 13], "target_opset_or_existing_proto": 3, "int": [2, 3, 6, 9, 11, 12, 14], "dict": [2, 3, 6, 11, 12, 13], "str": [2, 3, 6, 11, 12, 13], "modelproto": [2, 3, 6], "functionproto": [3, 6], "input_nam": [3, 6, 13], "sequenc": [3, 6, 9], "none": [2, 3, 6, 7, 9, 10, 11, 12, 13], "as_funct": [3, 6], "bool": [3, 6, 9], "fals": [3, 6, 7, 9, 10, 11, 12, 13], "optimization_opt": 3, "arg": [3, 6, 7, 11, 12, 13], "list": [2, 3, 11, 12, 13], "ani": [2, 3, 10, 11, 13, 17], "verbos": [2, 3, 6, 9, 11, 12, 13, 14], "0": [2, 3, 6, 9, 10, 11, 12, 13, 14, 15, 16, 18], "sourc": [2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16], "constant_fold": [3, 6, 13], "fold": [3, 6, 9, 13], "all": [2, 3, 8, 9, 11, 17, 18], "constant": [2, 3, 6, 13], "ar": [2, 3, 6, 9, 11, 12, 13, 16], "mark": 3, "dure": 3, "creation": 3, "graph": [2, 3, 8, 9, 11, 12, 13], "There": 3, "i": [2, 3, 7, 10, 11, 12, 13, 14, 16, 17], "need": [3, 9], "propag": [3, 9, 12], "thi": [2, 3, 8, 9, 13, 14, 17], "inform": 3, "io_nam": 3, "return": [2, 3, 6, 7, 9, 10, 11, 12, 13, 14], "input": [2, 3, 6, 9, 10, 13], "output": [2, 3, 7, 9, 11, 13], "node": [2, 3, 6, 7, 11, 12, 13], "is_const": 3, "name": [2, 3, 6, 10, 11, 12, 13], "tell": 3, "result": [3, 9, 11, 12, 13], "make_nod": 3, "builder": [3, 9, 12, 13], "output_nam": 3, "prefix": 3, "append": [3, 11, 12, 13], "initi": [2, 3, 9], "from": [2, 3, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18], "anoth": 3, "handl": [3, 9, 11], "renam": [3, 9], "The": [2, 3, 8, 9, 17], "content": 3, "store": [3, 8], "modifi": [2, 3, 17], "inplac": 3, "avoid": [3, 9], "copi": [3, 9, 12, 13, 17], "paramet": [2, 3, 6, 9, 11, 12, 13, 14], "other": [3, 9, 11, 12, 13, 17], "remove_identity_nod": 3, "remov": [3, 6, 11, 13], "ident": [3, 9], "remove_unus": [3, 6, 13], "simpl": [3, 9, 11, 12, 13], "function": [2, 3, 7, 9, 11, 12, 13], "unus": [3, 6, 13], "It": [3, 8, 9, 11, 12], "doe": [2, 3, 7, 11, 12, 13], "look": [2, 3], "subgraph": 3, "assum": [2, 3], "everyth": [3, 9], "done": [3, 9, 11, 12, 13], "one": [2, 3, 9, 13], "pass": [3, 11, 12, 13], "true": [3, 6, 7, 9, 10, 11, 12, 13, 14], "constant_s": 3, "1024": [3, 11, 12, 13], "gradient": [4, 9, 14], "graph_build": [4, 5, 13], "interpret": [4, 12, 13], "onnx_export": [4, 13], "aten_funct": 4, "mod": 6, "torch": [6, 7, 9, 10, 11, 12, 15, 18], "nn": [6, 7, 9, 11, 12, 13, 14], "modul": [6, 7, 11, 12, 13, 14], "fx": [6, 11, 12, 13], "graphmodul": 6, "tensor": [2, 6, 7, 9, 10, 11, 13, 14], "target_opset": 6, "18": [6, 11, 12, 13], "export": [6, 15, 18], "model": [6, 7, 8, 9, 14, 15, 18], "onnx": [2, 6, 8, 9, 10, 11, 12, 15, 18], "us": [2, 6, 8, 10, 14, 17], "dynamo": 6, "argument": [2, 6, 11, 12, 13], "target": 6, "opset": [6, 13], "dictionari": [2, 6], "detect": [6, 9, 10, 14], "while": [2, 6, 9], "convert": [6, 11, 12, 13], "level": 6, "go": [7, 9, 10, 11, 12, 13, 14], "end": [7, 9, 10, 11, 12, 13, 14], "download": [7, 8, 9, 10, 11, 12, 13, 14], "full": [7, 8, 9, 10, 11, 12, 13, 14], "exampl": [2, 7, 9, 10, 11, 12, 13, 14, 15, 16, 18], "code": [7, 8, 9, 10, 11, 12, 13, 14], "import": [7, 9, 10, 11, 12, 13, 14], "_dynamo": [7, 11, 12, 13], "f": [2, 7, 9, 10, 11, 12, 13, 14], "mymodelclass": [7, 11, 12, 13], "def": [7, 9, 10, 11, 12, 13, 14], "__init__": [7, 11, 12, 13, 14], "self": [7, 11, 12, 13, 14], "super": [7, 11, 12, 13, 14], "larg": [7, 8, 11, 12, 13], "conv1": [7, 11, 12, 13], "conv2d": [7, 9, 11, 12, 13], "1": [2, 7, 9, 10, 11, 12, 13, 14, 16], "16": [7, 9, 11, 12, 13], "5": [2, 7, 9, 10, 11, 12, 13, 14], "conv2": [7, 11, 12, 13], "fc1": [7, 11, 12, 13], "linear": [7, 8, 11, 12, 13, 15, 18], "512": [7, 11, 12, 13], "fc2": [7, 11, 12, 13], "128": [7, 10, 11, 12, 13], "fc3": [7, 11, 12, 13], "10": [7, 9, 10, 11, 12, 13, 14], "forward": [7, 11, 12, 13, 14], "x": [7, 9, 11, 12, 13, 14], "max_pool2d": [7, 11, 12, 13], "relu": [7, 11, 12, 13], "2": [2, 7, 9, 10, 11, 12, 13, 14], "flatten": [7, 9, 11, 12, 13], "create_model_and_input": [7, 11, 12, 13], "shape": [2, 7, 9, 10, 11, 12, 13, 14], "input_tensor": [7, 11, 12, 13], "rand": [7, 10, 11, 12, 13], "float32": [7, 9, 10, 11, 12, 13], "assert": [7, 11, 12, 13], "get_torch_dort": [7, 11, 12], "optimized_mod": [7, 11, 12], "compil": 7, "backend": 7, "onnxrt": [7, 11, 12], "fullgraph": [7, 11, 12], "fail": 7, "type": [2, 7, 9, 10, 11, 13], "error": [7, 9, 11, 12, 13, 14], "int64": [7, 9, 10, 13], "max_pool2d_with_indices_1": 7, "_aten_max_pool_with_indices_onnx_16": 7, "match": [7, 11], "expect": [2, 7, 9], "float": [2, 7, 9, 10], "jupyt": [7, 8, 9, 10, 11, 12, 13, 14], "notebook": [7, 8, 9, 10, 11, 12, 13, 14], "bug_dort": [7, 15, 18], "ipynb": [7, 9, 10, 11, 12, 13, 14], "python": [7, 8, 9, 10, 11, 12, 13, 14], "py": [7, 8, 9, 10, 11, 12, 13, 14, 15, 18], "galleri": [7, 9, 10, 11, 12, 13, 14, 16, 18], "gener": [7, 8, 9, 10, 11, 12, 13, 14], "sphinx": [7, 8, 9, 10, 11, 12, 13, 14], "A": [8, 9, 11, 12, 13, 14, 17], "coupl": 8, "illustr": 8, "differ": [8, 15, 18], "implement": [8, 9], "dot": 8, "product": [8, 9, 11, 12, 13], "see": [2, 8, 11], "also": [8, 9], "pytorch": [8, 11, 13], "nightli": 8, "build": [2, 8, 9, 11, 12], "should": 8, "instal": [8, 10, 14], "local": [8, 10, 11, 12, 13, 14], "git": 8, "clone": [8, 13], "http": [8, 11], "github": [8, 11, 12, 13], "com": [8, 11, 13], "xadupr": [8, 10, 11, 12, 13, 14], "experiment": [8, 11, 12, 13], "experi": [8, 11, 12, 13], "pip": 8, "onnxruntim": [2, 8, 10, 11, 12, 13], "gpu": [8, 11, 12, 13], "pynvml": 8, "r": [8, 9, 11, 12, 13], "requir": [8, 9], "dev": 8, "txt": [8, 11, 12, 13], "pythonpath": 8, "folder": 8, "Then": [8, 9], "rewrit": 8, "script": [8, 9, 10, 11, 12, 14], "evalu": [8, 15, 18], "memori": 8, "peak": [8, 11, 12, 13], "comput": [2, 8, 9, 11, 12, 13, 14], "time": [8, 9, 10, 14], "when": [8, 11, 12, 13], "run": [8, 9, 10, 14], "through": [2, 8, 13], "take": [8, 9, 11, 13], "around": [8, 13], "20": [8, 11, 12, 13], "minut": [8, 9, 10, 11, 12, 13, 14], "complet": 8, "disk": 8, "data": [8, 9, 11, 12, 13], "draw": 8, "them": 8, "_doc": [8, 11, 12, 13], "plot_torch_export": [8, 13, 15, 18], "": [2, 8, 9, 11, 12, 13, 14], "To": [8, 9, 11, 12, 13, 15, 18], "ignor": [8, 11, 12, 13, 15, 18], "profil": [8, 15, 18], "an": [2, 8, 9, 15, 17, 18], "exist": [8, 9, 11, 13, 15, 18], "convolut": [8, 15, 18], "matrix": [2, 8, 15, 18], "multipl": [8, 15, 18], "dort": [8, 10, 15, 18], "train": [2, 8, 13, 14, 15, 18], "wai": [2, 8, 9, 15, 18], "auto_examples_python": 8, "zip": [8, 9], "auto_examples_jupyt": 8, "well": [2, 9], "known": 9, "imag": 9, "transform": [9, 10, 12, 13, 14], "can": [2, 9, 13], "blur": 9, "direct": 9, "wide": 9, "deep": 9, "neural": 9, "network": 9, "have": 9, "fast": 9, "often": 9, "4": [9, 10, 11, 12, 13, 14], "dimens": 9, "n": [9, 11, 12, 13], "c": [9, 17], "h": 9, "w": [2, 9, 11, 12, 13], "batch": [9, 14], "channel": [9, 13], "height": 9, "width": 9, "let": [9, 11, 12, 13, 14], "start": 9, "2d": 9, "np": [9, 10, 11, 12, 13], "test": [9, 11, 12, 13], "assert_almost_equ": 9, "refer": 9, "referenceevalu": 9, "onnx_array_api": [9, 11, 12, 13], "light_api": 9, "plot": [9, 11, 12, 13], "graphviz_help": 9, "plot_dot": 9, "inferencesess": [9, 10, 13], "from_numpi": 9, "unfold": [9, 11, 12, 13], "conv_transpose2d": 9, "grad_help": 9, "onnx_deriv": 9, "derivativeopt": 9, "7": [9, 10, 11, 12, 13, 15, 18], "prod": 9, "arang": 9, "astyp": [9, 10, 13], "reshap": [9, 13], "3": [9, 10, 11, 12, 13, 14], "2024": [9, 10, 14, 17], "01": [9, 10, 11, 12, 13, 14], "11": [9, 11, 12, 13], "54": [9, 11, 12], "26": [9, 11, 14], "806": 9, "info": [9, 10, 14], "real_acceler": [9, 10, 14], "158": [9, 10, 12, 13, 14], "get_acceler": [9, 10, 14], "set": [9, 10, 11, 13, 14], "ds_acceler": [9, 10, 14], "cuda": [9, 10, 11, 12, 14], "auto": [9, 10, 14], "kernel": 9, "same": [9, 13], "9": [9, 10, 12, 13], "arrai": [9, 10, 11, 12, 13], "6": [9, 10, 11, 12, 13], "8": [9, 10, 11, 12, 13, 14], "dtype": [2, 9, 10, 11, 12, 13], "raw_convolut": 9, "rx": 9, "ry": 9, "re": [9, 11, 12], "zero": [2, 9], "rang": [9, 10, 11, 12, 13, 14], "j": 9, "y": [9, 11, 12, 14], "b": [9, 13], "continu": [9, 11, 12, 13], "134": [9, 10, 12, 13], "211": 9, "250": [9, 10, 13], "289": [9, 13], "328": 9, "367": 9, "238": [9, 13], "333": 9, "492": [9, 11], "537": [9, 11, 12], "582": 9, "627": [9, 10, 12, 13], "672": 9, "423": 9, "564": 9, "807": 9, "852": 9, "897": 9, "942": [9, 12, 13], "987": 9, "612": 9, "795": 9, "1122": 9, "1167": [9, 13], "1212": 9, "1257": 9, "1302": 9, "801": [9, 13], "422": 9, "571": 9, "592": 9, "613": [9, 12, 13], "634": 9, "655": [9, 13], "382": 9, "optim": [9, 11, 13, 14], "learn": 9, "prefer": 9, "4d": 9, "tenor": 9, "repres": 9, "we": 9, "add": [2, 9, 11], "two": [2, 9], "empti": 9, "previou": [9, 13], "rest": 9, "newaxi": 9, "pad": [9, 13], "size": [9, 11, 12, 13], "work": [2, 9, 11, 12, 13], "could": 9, "reus": 9, "whatev": 9, "goal": 9, "new": [9, 13], "which": 9, "mutipli": 9, "final": 9, "call": [2, 9, 11, 12, 13], "kernel_s": 9, "35": [9, 11, 13], "multipli": 9, "impl": 9, "stochast": [9, 14], "descent": [9, 14], "everi": [2, 9], "layer": [9, 14], "includ": [2, 9, 17], "transpos": 9, "That": [2, 9], "seem": 9, "easier": 9, "second": [9, 10, 11, 12, 13, 14], "express": [9, 17], "reli": [9, 13], "just": 9, "built": [9, 11, 12, 13], "where": [2, 9, 12, 13], "valu": [2, 9, 11, 12, 13], "wa": [2, 9, 13], "3x3": 9, "locat": 9, "against": [2, 9], "sum": [2, 9, 12, 13], "If": 9, "plai": 9, "indic": 9, "do": [9, 13, 17], "thing": 9, "ct": 9, "2672": 9, "5379": 9, "6804": 9, "7659": 9, "8514": 9, "8403": 9, "6254": 9, "8117": 9, "15408": 9, "18909": 9, "20790": 9, "22671": 9, "21780": 9, "15539": 9, "14868": 9, "27315": 9, "32400": 9, "34425": 9, "36450": 9, "34191": 9, "23922": 9, "20039": 9, "35544": 9, "41283": 9, "43164": 9, "45045": 9, "41508": 9, "28325": 9, "18608": 9, "32055": 9, "36756": 9, "38151": 9, "39546": 9, "35943": 9, "23966": 9, "And": [9, 14], "now": 9, "appli": [9, 11, 12], "coeffici": [2, 9, 14], "matric": 9, "concaten": 9, "p": [9, 11, 12, 13, 14], "output_s": 9, "follow": [2, 9, 17], "line": [2, 9, 13], "show": [2, 9], "how": [2, 9], "section": 9, "still": [2, 9], "vin": 9, "cst": 9, "bring": 9, "vout": 9, "to_onnx": [9, 13], "ax": [9, 10, 11, 12, 13], "execut": [9, 15, 18], "ref": 9, "grad": [9, 11, 12], "option": [2, 9], "fillgrad": [2, 9], "keepoutput": [2, 9], "_onnx_derivative_fw": 9, "weight": [2, 9, 13], "guess": 9, "ortmodulegraphbuild": 9, "traininggraphtransformerconfigur": 9, "inputs_nam": 9, "sess": [9, 10, 13], "serializetostr": [9, 13], "provid": [9, 10, 13, 17], "cpuexecutionprovid": [9, 10, 13], "12": [9, 11, 12, 13, 14], "21": [9, 11], "27": [9, 12, 13, 14], "45": [9, 12, 13], "33": [9, 11, 12], "24": [9, 10, 11], "39": [9, 12], "28": [9, 11, 13], "312": 9, "378": [9, 11, 12, 13], "336": 9, "495": [9, 11], "595": 9, "525": [9, 13], "480": [9, 13], "574": [9, 10], "504": 9, "so": [9, 17], "_get_indic": 9, "len": [9, 11, 12, 13], "k": [9, 11, 12, 13], "m": 9, "_is_out": 9, "ind": 9, "im2col_naive_implement": 9, "kernel_shap": [9, 13], "fill_valu": 9, "naiv": 9, "func": 9, "param": [9, 11, 12, 13], "fill": [2, 9], "isinst": [9, 11, 12, 13], "tupl": [9, 13], "rais": [9, 10, 11, 12, 13], "typeerror": 9, "unexpect": 9, "valueerror": [9, 10, 11, 12, 13], "mismatch": 9, "output_shap": 9, "middl": [9, 11, 12, 13], "data_s": 9, "i_data": 9, "i_kernel": 9, "t_data": 9, "t_kernel": 9, "i_out": 9, "els": [9, 10, 11, 12, 13], "v": [9, 11, 12, 13], "left": 9, "compar": [9, 11, 12, 13], "convolv": 9, "mode": [9, 11, 12, 14], "math": 9, "In": 9, "last": [9, 11, 12, 13], "At": 9, "some": 9, "point": 9, "backpropag": [9, 14], "produc": 9, "frac": 9, "d": 9, "e": [9, 11, 12, 13], "sai": 9, "leav": 9, "term": 9, "equal": [2, 9], "except": [9, 10, 11, 12, 13], "null": 9, "replac": [2, 9, 11, 12, 13], "summar": 9, "neq": 9, "veri": [9, 13], "onli": [2, 9, 12], "ones": 9, "simpli": 9, "ad": [2, 9, 14], "purpos": [9, 17], "defin": [2, 9], "right": [9, 17], "total": [9, 10, 11, 12, 13, 14, 15, 18], "216": [9, 12], "plot_convolutation_matmul": [9, 15, 18], "cpu": [10, 11, 12, 14], "o": [10, 11, 12, 13], "numpi": [2, 10, 11, 12, 13, 14], "matplotlib": [10, 11, 12, 13], "pyplot": [10, 11, 12, 13], "plt": [10, 11, 12, 13], "ext_test_cas": [10, 11, 12, 13], "get_parsed_arg": [10, 11, 12, 13], "try": [10, 11, 12, 13], "onnx_extend": 10, "tool": 10, "js_profil": 10, "js_profile_to_datafram": 10, "plot_ort_profil": 10, "importerror": [10, 11, 12, 13], "filenam": [10, 11, 12, 13], "path": [2, 10, 11, 12, 13], "join": [10, 11, 12, 13], "dirnam": [10, 11, 12, 13], "__file__": [10, 11, 12, 13], "example_4700": 10, "cpuep": 10, "opt": [10, 13], "nameerror": 10, "script_arg": [10, 11, 12, 13], "plot_profile_existing_onnx": [10, 15, 18], "file": [10, 15, 17, 18], "repeat": [10, 11, 12, 13], "expos": [10, 11, 12, 13], "att": 10, "split": [10, 11, 12, 13], "print": [10, 11, 12, 13, 14], "getattr": [10, 11, 13], "random": [10, 13], "create_random_input": 10, "feed": [10, 13], "get_input": [10, 13], "ot": 10, "unsuppos": 10, "t": [10, 11, 13, 14], "create_sess": 10, "sessionopt": [10, 13], "enable_profil": 10, "home": [10, 11, 12, 13, 14], "lib": [10, 11, 12, 13, 14], "python3": [10, 11, 12, 13, 14], "site": [10, 11, 12, 13, 14], "packag": [10, 11, 12, 13, 14], "util": [10, 11, 12, 13, 14], "441": [10, 14], "userwarn": [10, 11, 14], "_pytre": [10, 12, 13, 14], "_register_pytree_nod": [10, 14], "deprec": [10, 14], "pleas": [10, 11, 14], "register_pytree_nod": [10, 14], "instead": [10, 14], "_torch_pytre": [10, 14], "13": [10, 11, 12, 13, 14, 15, 18], "14": [10, 11, 12, 13], "05": [10, 11, 13], "50": [10, 11, 12, 13, 14], "758": 10, "309": [10, 11, 14], "87168276": 10, "5849895": 10, "40019014": 10, "6744956": 10, "21614555": 10, "72156703": 10, "9523272": 10, "5432047": 10, "31582326": 10, "67133576": 10, "5249917": 10, "14294657": 10, "50614727": 10, "2924589": 10, "81292444": 10, "52414674": 10, "15105687": 10, "05791514": 10, "8719075": 10, "57889783": 10, "15810284": 10, "4835316": 10, "687401": 10, "5336699": 10, "6975342": 10, "5475038": 10, "4750634": 10, "2925246": 10, "11290062": 10, "855363": 10, "8365906": 10, "66101617": 10, "6590499": 10, "6616499": 10, "96130085": 10, "62589717": 10, "85764015": 10, "19847816": 10, "5216652": 10, "92580277": 10, "1925278": 10, "51014423": 10, "1765241": 10, "67510724": 10, "00754385": 10, "3399087": 10, "36196676": 10, "59723884": 10, "1761274": 10, "4502384": 10, "8449207": 10, "5234231": 10, "72899663": 10, "6151028": 10, "5730254": 10, "9701239": 10, "3598823": 10, "27163774": 10, "09861553": 10, "21611264": 10, "37776116": 10, "46621808": 10, "39836735": 10, "72532916": 10, "41462088": 10, "87282944": 10, "49338537": 10, "19279169": 10, "6847277": 10, "4301376": 10, "53681654": 10, "6034909": 10, "81902844": 10, "3991864": 10, "43752173": 10, "13325712": 10, "6595601": 10, "86819786": 10, "22966914": 10, "9820082": 10, "5449003": 10, "52020353": 10, "48279056": 10, "35004082": 10, "32634553": 10, "3845157": 10, "47090262": 10, "7328266": 10, "05350026": 10, "23339312": 10, "9595374": 10, "4237045": 10, "05050419": 10, "64650905": 10, "41639367": 10, "3098955": 10, "2221446": 10, "8801806": 10, "48232228": 10, "78166485": 10, "9201259": 10, "3748333": 10, "68916005": 10, "02743813": 10, "82726973": 10, "07375638": 10, "40658522": 10, "0502141": 10, "7183814": 10, "450669": 10, "2063847": 10, "3895984": 10, "64108": 10, "253821": 10, "7090135": 10, "3314567": 10, "7322903": 10, "8124456": 10, "7310596": 10, "241654": 10, "1765165": 10, "814709": 10, "961959": 10, "93224": 10, "4779897": 10, "923019": 10, "763394": 10, "29381": 10, "2109056": 10, "0529757": 10, "302044": 10, "782114": 10, "794651": 10, "526697": 10, "694535": 10, "5305834": 10, "044397": 10, "2830906": 10, "3935003": 10, "14778": 10, "18081": 10, "195542": 10, "0397677": 10, "959021": 10, "0778084": 10, "16821": 10, "7691855": 10, "7610726": 10, "051933": 10, "9213176": 10, "0900316": 10, "752808": 10, "779765": 10, "862225": 10, "764553": 10, "9379396": 10, "075316": 10, "052673": 10, "0511613": 10, "25766": 10, "00848": 10, "983225": 10, "117189": 10, "243615": 10, "384557": 10, "799032": 10, "168855": 10, "233152": 10, "440148": 10, "074808": 10, "7869253": 10, "95459": 10, "6641335": 10, "0263076": 10, "3413453": 10, "529695": 10, "359122": 10, "068443": 10, "7478533": 10, "42267": 10, "6416893": 10, "860573": 10, "2878146": 10, "727313": 10, "912261": 10, "4822264": 10, "6949573": 10, "270716": 10, "5271754": 10, "4749155": 10, "636387": 10, "609374": 10, "5599933": 10, "201575": 10, "6493096": 10, "234925": 10, "476214": 10, "5359054": 10, "152104": 10, "5926847": 10, "013266": 10, "949836": 10, "781615": 10, "609929": 10, "1443267": 10, "174416": 10, "7161694": 10, "456949": 10, "214046": 10, "4327683": 10, "8661847": 10, "824549": 10, "9611273": 10, "383351": 10, "2597146": 10, "171747": 10, "0648575": 10, "1597743": 10, "996147": 10, "367678": 10, "3688416": 10, "904491": 10, "4601984": 10, "702834": 10, "1767898": 10, "2837605": 10, "816171": 10, "1989756": 10, "5176883": 10, "2334046": 10, "686782": 10, "0352373": 10, "0786924": 10, "8402586": 10, "999925": 10, "8877006": 10, "4426274": 10, "3417645": 10, "9874415": 10, "787618": 10, "1075454": 10, "42268": 10, "3894763": 10, "828682": 10, "298769": 10, "6889987": 10, "4727807": 10, "8828464": 10, "0614896": 10, "426158": 10, "628367": 10, "6448674": 10, "9274664": 10, "4598885": 10, "1059484": 10, "5206175": 10, "4829826": 10, "7341537": 10, "8005934": 10, "7584534": 10, "7430115": 10, "3221636": 10, "917901": 10, "5504875": 10, "0081463": 10, "9117565": 10, "4567766": 10, "1045847": 10, "262439": 10, "725239": 10, "0718546": 10, "36203": 10, "0865364": 10, "7275496": 10, "6609964": 10, "182846": 10, "7552967": 10, "4161015": 10, "683894": 10, "6501083": 10, "9119215": 10, "026081": 10, "5582027": 10, "0965033": 10, "0015955": 10, "398176": 10, "0337505": 10, "8156824": 10, "238273": 10, "988191": 10, "061314": 10, "175665": 10, "090192": 10, "0971627": 10, "912851": 10, "3711553": 10, "8359213": 10, "5815835": 10, "5063396": 10, "4770136": 10, "064591": 10, "350454": 10, "814572": 10, "4870324": 10, "2194": 10, "599507": 10, "3831434": 10, "4266663": 10, "231935": 10, "229168": 10, "922707": 10, "217845": 10, "581783": 10, "7539687": 10, "1320667": 10, "258685": 10, "586499": 10, "9388223": 10, "7089133": 10, "767417": 10, "229158": 10, "941747": 10, "752945": 10, "932048": 10, "379": [10, 11, 13], "135": [10, 13], "114": [10, 13], "119": [10, 11, 12, 13], "244": [10, 13], "868": [10, 11, 13], "626": [10, 13], "507": 10, "858": [10, 13], "738": [10, 11], "740": 10, "992": 10, "996": 10, "1373": 10, "1107": 10, "1357": 10, "1237": 10, "13888": 10, "14142": 10, "13899": 10, "14001": 10, "14379": 10, "14380": 10, "14757": 10, "14512": 10, "14641": 10, "14747": 10, "14751": 10, "14752": 10, "15007": 10, "15008": 10, "15136": 10, "14994": 10, "14999": 10, "15373": 10, "254": [10, 13], "361": 10, "245": 10, "502": [10, 11], "506": 10, "734": [10, 13], "988": 10, "1243": 10, "1369": 10, "1354": 10, "1484": 10, "14012": 10, "14018": 10, "14023": 10, "14253": 10, "14256": 10, "14870": 10, "15000": 10, "126": [10, 11, 13], "258": 10, "487": [10, 13], "246": [10, 12, 13], "994": 10, "1244": [10, 12], "1375": 10, "1231": 10, "1111": 10, "14017": 10, "14378": 10, "14135": 10, "14508": 10, "14393": 10, "14745": 10, "14628": 10, "15257": 10, "15248": 10, "115": [10, 12, 13], "120": [10, 12, 13], "620": [10, 13], "998": [10, 12], "1126": 10, "1483": 10, "13890": 10, "14141": 10, "14002": 10, "14377": 10, "14513": 10, "14622": 10, "15263": 10, "249": [10, 12], "133": [10, 12, 13], "362": 10, "608": 10, "986": 10, "866": 10, "1245": 10, "1250": [10, 13], "1476": 10, "13889": 10, "14019": 10, "14760": 10, "14765": 10, "14869": 10, "14874": 10, "14884": 10, "14995": 10, "15374": 10, "248": 10, "243": 10, "503": 10, "997": 10, "1003": 10, "1235": 10, "1238": 10, "14271": 10, "14621": 10, "14750": 10, "15006": 10, "14993": 10, "15120": 10, "15249": 10, "3686385": 10, "753965": 10, "5795846": 10, "504945": 10, "947892": 10, "119821": 10, "695": [10, 13], "120430": 10, "120323": 10, "59": [10, 12], "120078": 10, "04": [10, 12, 13], "119397": 10, "805": [10, 13], "120266": 10, "75": [10, 11, 12, 13], "62474968": 10, "60527348": 10, "62347520": 10, "58758236": 10, "60218564": 10, "62324952": 10, "61960032": 10, "61870072": 10, "62421600": 10, "60222808": 10, "61714880": 10, "59941536": 10, "61583796": 10, "61682856": 10, "61746848": 10, "61213928": 10, "62176192": 10, "61385288": 10, "61532204": 10, "60673144": 10, "62437464": 10, "62136732": 10, "62705488": 10, "62142248": 10, "61780776": 10, "63703504": 10, "60606352": 10, "63979760": 10, "62500616": 10, "60581508": 10, "60404416": 10, "60508116": 10, "60565120": 10, "60009408": 10, "62521720": 10, "62690432": 10, "60540928": 10, "59148616": 10, "62455464": 10, "60363912": 10, "62313552": 10, "61909460": 10, "62544944": 10, "60377736": 10, "63260296": 10, "61337000": 10, "60737840": 10, "62514684": 10, "60285204": 10, "65278808": 10, "62572672": 10, "59920492": 10, "60124480": 10, "60271864": 10, "60781892": 10, "59774440": 10, "60937056": 10, "61429352": 10, "61452016": 10, "61666824": 10, "58365256": 10, "60277152": 10, "61454776": 10, "61066172": 10, "62041984": 10, "61421024": 10, "60921608": 10, "61615640": 10, "60823624": 10, "61520776": 10, "62578880": 10, "60036312": 10, "60131764": 10, "61798672": 10, "60578776": 10, "61052840": 10, "60783184": 10, "62139840": 10, "63119664": 10, "60524624": 10, "59954004": 10, "60547008": 10, "63320200": 10, "59541956": 10, "64397024": 10, "60117296": 10, "61859744": 10, "60755584": 10, "61348188": 10, "60691864": 10, "60306644": 10, "58841472": 10, "62604624": 10, "62150624": 10, "61203460": 10, "61211592": 10, "61330584": 10, "59395112": 10, "62278836": 10, "62058304": 10, "60808544": 10, "60357448": 10, "61203168": 10, "62902592": 10, "61942432": 10, "61145504": 10, "62038152": 10, "61240272": 10, "60456524": 10, "59883744": 10, "60269592": 10, "61713736": 10, "61759928": 10, "60765000": 10, "62073040": 10, "59917144": 10, "60790536": 10, "62667824": 10, "61806664": 10, "62007040": 10, "60076460": 10, "61620960": 10, "61246668": 10, "61727308": 10, "62690448": 10, "60799656": 10, "62227648": 10, "60996076": 10, "8611738e": 10, "09": [10, 11, 12, 13, 14], "8797417e": 10, "8866478e": 10, "5831511e": 10, "8652063e": 10, "8792038e": 10, "0345390e": 10, "0959017e": 10, "5564065e": 10, "9997962e": 10, "prof": 10, "end_profil": 10, "df": [10, 11, 12, 13], "first_it_out": 10, "to_csv": [10, 11, 12, 13], "csv": [10, 11, 12, 13], "to_excel": [10, 11, 12, 13], "xlsx": [10, 11, 12, 13], "fig": [10, 11, 12, 13], "subplot": [10, 11, 12, 13], "figsiz": [10, 11, 12, 13], "savefig": [10, 11, 12, 13], "png": [10, 11, 12, 13], "extend": 10, "eager": [11, 12], "default": [2, 11, 12], "plot_torch_aot": [11, 15, 18], "help": [11, 12, 13], "warn": [11, 12, 13, 14], "catch_warn": [11, 12, 13], "simplefilt": [11, 12, 13], "has_cuda": [11, 12, 13], "cudaexecutionprovid": [11, 12, 13], "get_available_provid": [11, 12, 13], "avail": [11, 12, 13], "sy": [11, 12, 13], "exit": [11, 12, 13], "contextlib": [11, 12, 13], "itertool": [11, 12, 13], "gc": [11, 12], "platform": [11, 12, 13], "pickl": [11, 12], "pprint": [11, 12, 13], "multiprocess": [11, 12, 13], "cprofil": [11, 12, 13], "pstat": [11, 12, 13], "io": [11, 12, 13], "log": [2, 11, 12, 13, 16], "sortkei": [11, 12, 13], "panda": [11, 12, 13], "profile2graph": [11, 12, 13], "memory_peak_plot": [11, 12, 13], "measure_tim": [11, 12, 13], "get_figur": [11, 12, 13], "memory_peak": [11, 12, 13], "start_spying_on": [11, 12, 13], "tqdm": [11, 12, 13], "is_avail": [11, 12, 13], "disabl": [2, 11, 12, 13], "system_info": [11, 12, 13], "ob": [11, 12, 13], "processor": [11, 12, 13], "core": [11, 12, 13], "cpu_count": [11, 12, 13], "cuda_count": [11, 12, 13], "device_count": [11, 12, 13], "cuda_nam": [11, 12, 13], "get_device_nam": [11, 12, 13], "cuda_capa": [11, 12, 13], "get_device_cap": [11, 12, 13], "runtimeerror": [11, 12, 13], "assertionerror": [11, 12, 13], "nvidia": [11, 12, 13], "geforc": [11, 12, 13], "gtx": [11, 12, 13], "1060": [11, 12, 13], "x86_64": [11, 12, 13], "descript": [11, 12, 13], "__doc__": [11, 12, 13], "scenario": [11, 12, 13], "small": [11, 12, 13], "55mb": [11, 12, 13], "1gb": [11, 12, 13], "warmup": [11, 12, 13], "repeat1": [11, 12], "maxtim": [11, 12, 13], "maximum": [11, 12, 13, 14], "measur": [11, 12, 13], "32": [11, 12, 13], "30752": [11, 12], "fc": [11, 12, 13], "elif": [11, 12, 13], "144": [11, 12, 13], "4096": [11, 12, 13], "support": [11, 12, 13], "loop": [11, 12, 13], "fca": [11, 12, 13], "fcb": [11, 12, 13], "fcc": [11, 12, 13], "fcd": [11, 12, 13], "fce": [11, 12, 13], "fcf": [11, 12, 13], "fcg": [11, 12, 13], "fch": [11, 12, 13], "fci": [11, 12, 13], "unsupport": [11, 12, 13], "torch_model_s": [11, 12, 13], "size_model": [11, 12, 13], "numel": [11, 12, 13], "finfo": [11, 12, 13], "bit": [11, 12, 13], "model_s": [11, 12, 13], "mb": [11, 12, 13, 15, 18], "5401992797851562": [11, 12], "tensor_x": 11, "tensor_i": 11, "detach": [11, 12, 13, 14], "issu": 11, "loss": [2, 11, 14], "mse_loss": 11, "_backward_": 11, "backward": [11, 14], "get_torch_eag": [11, 12], "my_compil": [11, 12], "gm": [11, 12], "example_input": [11, 12], "redirect_stdout": [11, 12, 13], "stringio": [11, 12, 13], "get_torch_default": [11, 12], "reduc": [11, 12], "overhead": [11, 12], "torchdynamo": [11, 13], "register_backend": 11, "aot_ort": 11, "compiled_model": 11, "check": [11, 12, 13, 14], "thei": [2, 11, 12, 13], "export_funct": [11, 12, 13], "__name__": [11, 12, 13], "get_": [11, 12], "supported_export": [11, 12, 13], "item": [11, 12, 13], "plot_torch_aot_": 11, "reset": [11, 12, 13], "skip": [11, 12, 13], "due": [11, 12, 13], "1000": [11, 12, 13, 14], "noqa": 11, "f821": 11, "del": [11, 12], "collect": [11, 12], "sleep": [11, 12], "torch_eag": [11, 12], "torch_default": [11, 12], "torch_dort": [11, 12], "to_dict": [11, 12, 13], "unit": [11, 12, 13], "g": [11, 12, 13], "enumer": [11, 12, 13, 14], "_": [11, 12, 13], "set_devic": [11, 12, 13], "stat": [11, 12, 13], "stop": [11, 12, 13], "updat": [11, 12, 13], "df1": [11, 12, 13], "datafram": [11, 12, 13], "plot_torch_aot_1_memori": 11, "index": [11, 12, 13], "kei": [11, 12], "bar": [11, 12, 13], "suptitl": [11, 12, 13], "consumpt": [11, 12, 13], "0f": [11, 12, 13], "plot_torch_aot_1_memory_": 11, "mean": [11, 12, 13], "gpu0_end": [11, 12, 13], "3513": 11, "492188": 11, "000002": 11, "269531": [11, 12, 13], "3602": 11, "433594": 11, "3552": 11, "447804": 11, "000055": 11, "898": [11, 13], "3603": 11, "011719": 11, "722656": 11, "000004": 11, "015625": [11, 12], "013672": 11, "row": [11, 12, 13], "column": [2, 11, 12, 13], "opti": [11, 12], "environ": [11, 12], "onnx_optim": [11, 12], "begin": [11, 12, 13], "perf_count": [11, 12, 13], "durat": [11, 12, 13], "min": [11, 12, 13], "max": [11, 12, 13], "std": [11, 12, 13], "00113229999988107": 11, "005596400000285939": 11, "005140200000823825": 11, "0018825999995897291": 11, "001378699998895172": 11, "004846099998758291": 11, "plot_torch_aot_1_tim": 11, "dfi": [11, 12, 13], "set_index": [11, 12, 13], "titl": [11, 12, 13], "yerr": [11, 12, 13], "rot": [11, 12, 13], "30": [11, 12, 13], "tight_layout": [11, 12, 13], "001132": 11, "005596": 11, "005140": 11, "001883": 11, "001379": 11, "004846": 11, "clean_text": [11, 12, 13], "text": [11, 12, 13], "abspath": [11, 12, 13], "normpath": [11, 12, 13], "upper": [11, 12, 13], "profile_funct": [11, 12, 13], "with_arg": [11, 12], "suffix": [11, 12, 13], "pr": [11, 12, 13], "enabl": [11, 12, 13], "sortbi": [11, 12, 13], "cumul": [11, 12, 13], "stream": [11, 12, 13], "sort_stat": [11, 12, 13], "print_stat": [11, 12, 13], "open": [11, 12, 13], "plot_torch_aot_profile_": 11, "wb": [11, 12, 13], "dump": [11, 12], "raw": [11, 12, 13], "getvalu": [11, 12, 13], "200": [11, 12, 13], "write": [11, 12, 13], "root": [11, 12, 13], "to_text": [11, 12, 13], "_h": [11, 12, 13], "function_to_profil": [11, 12], "0x7f66000ed120": 11, "3196": 11, "3131": 11, "primit": [11, 12, 13], "009": [11, 12, 13], "order": [11, 12, 13], "ncall": [11, 12, 13], "tottim": [11, 12, 13], "percal": [11, 12, 13], "cumtim": [11, 12, 13], "lineno": [11, 12, 13], "000": [11, 12, 13, 15, 18], "010": [11, 12, 13], "527": 11, "259": [11, 12, 13], "004": [11, 12, 13], "219": 11, "007": [11, 12, 13], "002": [11, 12, 13], "1507": [11, 12, 13], "_wrapped_call_impl": [11, 12, 13], "1513": [11, 12, 13], "_call_impl": [11, 12, 13], "eval_fram": [11, 12, 13], "385": [11, 12, 13], "_fn": [11, 12, 13], "_functorch": [11, 12, 13], "_aot_autograd": [11, 12, 13], "97": [11, 12], "call_func_at_runtime_with_arg": [11, 12], "006": [11, 12, 13], "001": [11, 12, 13], "graph_modul": [11, 12, 13], "736": [11, 12, 13], "call_wrap": [11, 12, 13], "299": [11, 12, 13], "__call__": [11, 12, 13], "005": [11, 12, 13], "003": [11, 12, 13], "231": [11, 13], "_tensor": 11, "463": 11, "autograd": [11, 12], "165": [11, 13], "685": [11, 12], "_engine_run_backward": [11, 12], "method": [11, 12, 13], "run_backward": [11, 12], "_c": [11, 12, 13], "_enginebas": [11, 12], "object": [11, 12, 13], "_intern": [11, 12, 13], "714": [11, 12], "_ort_acclerated_cal": [11, 12], "277": [11, 13], "jit_compile_runtime_wrapp": [11, 12], "517": [11, 13], "683": 11, "call_compiled_backward": 11, "eval_with_kei": [11, 12, 13], "274": [11, 12, 13, 14], "359": [11, 13], "_run_onnx_session_with_ortvaluevector": 11, "164": [11, 12, 13], "external_util": [11, 12, 13], "23": [11, 12, 13], "inner": [11, 12, 13], "aot_autograd": [11, 12, 13], "899": [11, 12, 13], "80": [11, 12, 13], "runtime_wrapp": [11, 12, 13], "390": [11, 12], "269": 11, "40": [11, 12, 13], "102": [11, 13], "_nvtx_range_pop": 11, "1739": 11, "124": 11, "_nvml_based_avail": 11, "93": 11, "_nvtx_range_push": 11, "_op": [11, 12, 13], "568": [11, 12, 13], "linux_cuda": [11, 12], "releas": [11, 12], "capi": [11, 12], "onnxruntime_inference_collect": [11, 12], "339": [11, 13], "run_with_ortvaluevector": 11, "usr": [11, 12, 13], "772": 11, "getenv": 11, "337": [11, 13], "81": [11, 12], "_collections_abc": 11, "821": [11, 13], "get": [11, 13], "183": [11, 12, 13], "498": [11, 12, 13], "search_reusable_session_execution_info": 11, "335": 11, "_get_ortvalues_from_torch_tensor": 11, "466": [11, 12, 13], "is_support": 11, "190": [11, 13], "_initi": 11, "675": [11, 12, 13], "__getitem__": 11, "2171": 11, "2196": 11, "named_paramet": 11, "421": 11, "416": 11, "builtin": [11, 12, 13], "2157": 11, "_named_memb": 11, "skipfil": 11, "405": [11, 13], "372": [11, 13], "check_verbos": 11, "755": [11, 12], "encod": 11, "aten": [11, 12, 13], "3339": 11, "638": 11, "next": [2, 11, 12, 13], "hasattr": 11, "305": [11, 13], "check_fil": 11, "_is_compil": 11, "ortmodul": 11, "_util": [11, 13], "65": [11, 13], "_ortvalues_to_torch_tensor": 11, "_nn": [11, 12, 13], "130": [11, 12, 13], "__enter__": [11, 12, 13], "118": [11, 13], "backend_cache_wrapp": 11, "nvtx": 11, "25": [11, 13], "range_push": 11, "56": [11, 12, 13], "370": 11, "genexpr": [11, 12, 13], "42": 11, "2333": 11, "named_modul": 11, "1396": 11, "optimize_assert": 11, "604": [11, 12], "get_compiler_fn": 11, "range_pop": 11, "147": [11, 13], "1690": [11, 12, 13], "__setattr__": [11, 12, 13], "19": [11, 12, 13], "unwrap_dead_wrapp": 11, "inspect": 11, "813": 11, "getsourcefil": 11, "functool": 11, "update_wrapp": 11, "48": 11, "853": 11, "139": [11, 13], "__exit__": [11, 13], "package_import": 11, "694": [11, 13], "_patched_getfil": 11, "string": [2, 11], "guard": [11, 13], "_cuda_getdevicecount": 11, "279": [11, 12, 13], "51": 11, "_nvtx": 11, "rangepusha": 11, "repro": [11, 12], "after_dynamo": [11, 12], "49": 11, "wrap_backend_debug": 11, "773": [11, 12, 13], "getfil": 11, "791": 11, "22": [11, 12], "strict_zip": 11, "74": [11, 12, 13], "1026": 11, "__hash__": [11, 13], "47": 11, "broadcast_tensor": 11, "52": [11, 14], "tensorbas": [11, 12, 13], "mutation_guard": 11, "110": [11, 13, 14], "patched_init": 11, "217": 11, "__getattr__": 11, "innermost_fn": 11, "60": [11, 12, 13], "_make_grad": 11, "431": 11, "1675": 11, "contigu": 11, "586": 11, "_optimize_catch_error": 11, "rangepop": 11, "136": [11, 12, 13], "_set_current_backend": 11, "data_ptr": 11, "428": 11, "2224": 11, "lambda": [11, 12, 13], "__instancecheck__": 11, "46": 11, "id": 11, "jit": 11, "_trace": [11, 13], "1119": 11, "is_trac": 11, "genericpath": 11, "38": 11, "startswith": [11, 13], "63": 11, "tag": 11, "448": [11, 13], "__setitem__": 11, "530": 11, "catch_errors_wrapp": 11, "451": [11, 13], "99": 11, "_maybe_init_guarded_backend_cach": 11, "pattern": 11, "variabl": [11, 12, 13], "base": [11, 13], "125": [11, 13], "posix": 11, "grad_mod": 11, "343": [11, 13], "_get_tracing_st": 11, "unwrap_if_dead": 11, "181": [11, 13], "_add_filt": 11, "61": [11, 12], "normalize_as_list": 11, "_warn": 11, "ones_lik": 11, "_is_view": 11, "678": 11, "listcomp": [11, 12, 13], "on_ent": 11, "496": 11, "ordereddict": 11, "482": 11, "569": [11, 13], "1711": 11, "convert_fram": [11, 12, 13], "265": [11, 13], "convert_frame_assert": 11, "setattr": 11, "set_eval_fram": 11, "732": [11, 13], "17": [11, 12, 13], "_parametermeta": 11, "0x7f66b2b52830": 11, "191": [11, 13], "isclass": 11, "101": [11, 12, 13], "install_generation_tagging_init": 11, "_set_view_replay_en": 11, "383": 11, "351": 11, "288": [11, 13], "globalstateguard": 11, "registri": 11, "lookup_backend": 11, "272": [11, 12], "enable_dynam": 11, "458": [11, 12, 13], "735": 11, "_are_functorch_transforms_act": 11, "_log_api_usage_onc": 11, "frozen": 11, "importlib": 11, "_bootstrap": 11, "404": 11, "parent": 11, "1729": 11, "__eq__": 11, "_vf": 11, "tensorguard": 11, "104": [11, 13], "callabl": [5, 11], "823": [11, 12], "360": [11, 12, 13], "reset_graph_break_dup_check": 11, "820": [11, 12], "_is_trac": 11, "182": [11, 13], "ismodul": 11, "wrap": [11, 12, 13], "355": 11, "istraceback": 11, "199": 11, "ismethod": 11, "isfunct": 11, "477": 11, "109": [11, 12, 13], "1710": 11, "geteffectivelevel": 11, "365": [11, 13], "isfram": 11, "schema": 11, "395": [11, 12, 13], "tensors_saved_for_backwards_slic": 11, "iscod": 11, "271": [11, 12], "functionalized_rng_runtime_epilogu": 11, "_jit_intern": [11, 13], "1120": 11, "is_script": 11, "save_for_backward": 11, "maybe_clear_saved_tensor": 11, "_functionbas": 11, "endswith": 11, "560": 11, "data_mem_first_run": [11, 12, 13], "data_mem_run": [11, 12, 13], "conf": [11, 12, 13], "number": [11, 12, 13, 14], "export_fct": [11, 12], "get_torch_": [11, 12], "exported_model": [11, 12], "call_model": [11, 12], "set_descript": [11, 12, 13], "step": [11, 12, 13, 14], "load": [11, 12], "memob": [11, 12, 13], "max_tim": [11, 12, 13], "run_": [11, 12], "averag": [11, 12, 13], "plot_torch_aot_ort_tim": 11, "dfmemr": [11, 12, 13], "plot_torch_aot_ort_run_mem": 11, "dfmemfr": [11, 12, 13], "plot_torch_aot_ort_first_run_mem": 11, "00": [11, 12, 13, 14, 15, 18], "0025252954545232405": 11, "92": [11, 12, 13], "0016075074074229003": 11, "02": [11, 12, 13], "03": [11, 12, 13], "07": [11, 12, 13], "87": [11, 12], "0014254453333220833": 11, "06": [11, 12, 13], "67": [11, 12, 13], "your": [11, 12], "aotautograd": 11, "doesn": 11, "box": 11, "functorch": 11, "make_boxed_func": 11, "yourself": 11, "pull": 11, "83137": 11, "issuecom": 11, "1211320670": 11, "rational": 11, "0021867245614294803": 11, "83": [11, 12, 13], "77": 11, "0072866666666717116": 11, "100": [11, 12, 13], "96": [11, 12], "90": [11, 13], "warmup_tim": [11, 13], "002164": 11, "nan": [11, 12, 13], "003222": 11, "003015": 11, "004172": 11, "006213": 11, "view": [11, 12, 13], "view_tim": [11, 12, 13], "piv": [11, 12, 13], "pivot_t": [11, 12, 13], "_comput": [11, 12, 13], "piv_cpu": [11, 12, 13], "barh": [11, 12, 13], "logx": [11, 12], "piv_gpu": [11, 12, 13], "process": [11, 12, 13], "001425": 11, "002187": 11, "007287": 11, "002525": 11, "001608": 11, "center": [11, 12, 13], "ylabel": [11, 12, 13], "nrun": [11, 12, 13], "plot_torch_aot_first_run_mem_": 11, "backen": [11, 12], "plot_torch_aot_run_mem_": 11, "41": 11, "plot_torch_dort": [12, 15, 18], "get_torch_opti": 12, "plot_torch_dort_": 12, "plot_torch_dort_1_memori": 12, "plot_torch_dort_1_memory_": 12, "2237": 12, "472656": 12, "459375": 12, "000010": 12, "3231": 12, "246094": 12, "2649": 12, "958333": 12, "000564": 12, "770": 12, "3209": 12, "824219": 12, "3208": 12, "832242": 12, "000071": 12, "871094": 12, "842142": 12, "000032": 12, "3441": 12, "3301": 12, "095796": 12, "000160": 12, "846": 12, "04843570000048203": 12, "05946849999963888": 12, "6832434000007197": 12, "37028580000151123": 12, "plot_torch_dort_1_tim": 12, "048436": 12, "059468": 12, "683243": 12, "370286": 12, "plot_torch_dort_profile_": 12, "0x7f6747340d30": 12, "559620": 12, "534282": 12, "967": 12, "519": [12, 13], "239": 12, "15": [12, 13], "839": 12, "531": [12, 13], "catch_error": [12, 13], "_convert_frame_assert": [12, 13], "838": 12, "433": [12, 13], "_compil": [12, 13], "240": [12, 13], "time_wrapp": [12, 13], "513": [12, 13], "compile_inn": [12, 13], "826": 12, "bytecode_transform": [12, 13], "1025": [12, 13], "transform_code_object": [12, 13], "819": 12, "symbolic_convert": [12, 13], "2097": [12, 13], "44": [12, 13, 14], "019": [12, 13], "671": [12, 13], "718": 12, "2202": 12, "return_valu": 12, "output_graph": 12, "803": [12, 13], "compile_subgraph": 12, "717": 12, "76": 12, "1028": 12, "compile_and_call_fx_graph": 12, "711": 12, "1109": 12, "call_user_compil": 12, "debug_wrapp": 12, "1735": 12, "1041": 12, "torch_compile_backend": 12, "939": 12, "common": [12, 13], "compiler_fn": 12, "710": 12, "790": 12, "aot_module_simplifi": 12, "709": 12, "create_aot_dispatcher_funct": [12, 13], "605": [12, 13], "394": [12, 13], "aot_wrapper_dedup": [12, 13], "aot_wrapper_synthetic_bas": [12, 13], "aot_dispatch_autograd": 12, "543": [12, 13], "1186": [12, 13], "577": 12, "462": [12, 13], "_stat": [12, 13], "wrapper": [12, 13], "282": [12, 13], "012": [12, 13], "427": 12, "_subclass": [12, 13], "functional_tensor": [12, 13], "__torch_dispatch__": [12, 13], "403": 12, "dispatch_and_compile_graph": [12, 13], "aot_dispatch_autograd_graph": 12, "31": [12, 13], "_create_graph": [12, 13], "proxy_tensor": [12, 13], "384": 12, "dispatch_trac": [12, 13], "371": 12, "_symbolic_trac": [12, 13], "724": [12, 13], "trace": [12, 13], "366": 12, "flatten_fn": 12, "521": [12, 13], "879": 12, "340": [12, 13], "fake_tensor": [12, 13], "1473": [12, 13], "338": [12, 13], "traced_function_transform": [12, 13], "joint_help": 12, "348": [12, 13], "_functionalized_f_help": [12, 13], "029": 12, "331": 12, "1505": [12, 13], "dispatch": [12, 13], "319": [12, 13], "inner_fn_with_anomali": 12, "184": [12, 13], "inner_fn": [12, 13], "068": [12, 13], "105": [12, 13], "263": 12, "242": [12, 13], "241": 12, "636": [12, 13], "inner_torch_dispatch": [12, 13], "234": [12, 13], "run_nod": [12, 13], "69": 12, "233": [12, 13], "proxy_cal": [12, 13], "1341": [12, 13], "215": [12, 13], "209": [12, 13], "278": 12, "208": 12, "1191": 12, "1008": 12, "197": [12, 13], "tree_map": [12, 13], "177": 12, "088": [12, 13], "594": [12, 13], "functional_cal": [12, 13], "169": [12, 13], "partition": 12, "619": 12, "min_cut_rematerialization_partit": 12, "296": [12, 13], "170": [12, 13], "162": [12, 13], "_prims_common": [12, 13], "159": 12, "173": [12, 13], "5721": 12, "1418": 12, "153": [12, 13], "599": [12, 13], "unflatten": [12, 13], "131": [12, 13], "255": [12, 13], "call_funct": [12, 13], "123": [12, 13], "122": [12, 13], "11968": 12, "5633": 12, "042": [12, 13], "687": [12, 13], "map_aggreg": [12, 13], "1834": 12, "116": [12, 13], "664": [12, 13], "tree_flatten": [12, 13], "6126": 12, "023": 12, "112": [12, 13], "643": [12, 13], "_tree_flatten_help": [12, 13], "tree_map_onli": [12, 13], "108": [12, 13], "107": [12, 13], "117": [12, 13], "snapshot_fak": [12, 13], "5597": 12, "679": [12, 13], "map_arg": [12, 13], "097": [12, 13], "297": [12, 13], "call_modul": [12, 13], "089": [12, 13], "_decomp": [12, 13], "decomposit": [12, 13], "087": [12, 13], "collect_metadata_analysi": [12, 13], "086": [12, 13], "187": [12, 13], "track_tensor_tre": [12, 13], "452": [12, 13], "188": [12, 13], "wrap_with_proxi": [12, 13], "085": [12, 13], "624": [12, 13], "080": [12, 13], "149": [12, 13], "set_meta": [12, 13], "078": [12, 13], "_extract_fwd_bwd_modul": 12, "008": [12, 13], "1279": [12, 13], "wrap_fx_proxi": [12, 13], "1339": [12, 13], "wrap_fx_proxy_cl": [12, 13], "79": 12, "077": [12, 13], "extract_v": [12, 13], "076": 12, "015": [12, 13], "55": [12, 13], "_extract_graph_with_inputs_output": 12, "3334": 12, "073": [12, 13], "657": [12, 13], "072": 12, "707": [12, 13], "recompil": [12, 13], "070": [12, 13], "1532": [12, 13], "get_fake_valu": [12, 13], "069": [12, 13], "1117": [12, 13], "wrap_fake_except": [12, 13], "067": [12, 13], "1268": [12, 13], "python_cod": [12, 13], "066": [12, 13], "016": [12, 13], "nn_modul": [12, 13], "7283": 12, "7127": 12, "693": [12, 13], "064": [12, 13], "1330": [12, 13], "_python_cod": [12, 13], "_gen_python_cod": [12, 13], "fake_tensor_prop": 12, "64": [12, 14], "96635": 12, "94935": 12, "052": [12, 13], "062": [12, 13], "1311": [12, 13], "addmm": [12, 13], "061": [12, 13], "1489": [12, 13], "020": 12, "diagnost": [12, 13], "infra": [12, 13], "decor": [12, 13], "71": [12, 13], "060": [12, 13], "propagate_dont_convert_input": 12, "059": [12, 13], "464": 12, "057": [12, 13], "865": [12, 13], "create_nod": [12, 13], "054": [12, 13], "014": [12, 13], "814": [12, 13], "module_call_wrapp": [12, 13], "816": [12, 13], "376": [12, 13], "1832": [12, 13], "wrap_meta_outputs_with_default_device_log": [12, 13], "303": [12, 13], "049": [12, 13], "1205": 12, "node_copi": 12, "046": [12, 13], "66": 12, "045": [12, 13], "381": 12, "1839": [12, 13], "13361": 12, "040": [12, 13], "_get_node_typ": [12, 13], "9088": 12, "473": [12, 13], "_is_leaf": [12, 13], "474": [12, 13], "163": [12, 13], "038": [12, 13], "1080": 12, "maybe_handle_decomp": 12, "013": [12, 13], "threshold_backward": 12, "037": [12, 13], "_pass": [12, 13], "type_promot": [12, 13], "1712": [12, 13], "_run": [12, 13], "1579": [12, 13], "1649": [12, 13], "034": [12, 13], "1630": [12, 13], "494": [12, 13], "__post_init__": [12, 13], "94": [12, 13], "033": [12, 13], "proxi": [12, 13], "171": [12, 13], "create_proxi": [12, 13], "032": [12, 13], "354": [12, 13], "031": [12, 13], "functional_util": [12, 13], "to_fun": [12, 13], "129": [12, 13], "_reconstruct": [12, 13], "172": [12, 13], "to_funct": [12, 13], "329": 12, "317": [12, 13], "decompos": 12, "36": [12, 13, 14], "030": [12, 13], "1128": [12, 13], "deepcopy_to_fake_tensor": [12, 13], "1130": [12, 13], "deepcopi": [12, 13], "882": [12, 13], "227": [12, 13], "_deepcopy_dict": [12, 13], "028": [12, 13], "1443": 12, "eliminate_dead_cod": 12, "468": [12, 13], "515": [12, 13], "emit_nod": [12, 13], "1372": 12, "lint": 12, "027": 12, "__deepcopy__": [12, 13], "2040": [12, 13], "__torch_function__": [12, 13], "2962": 12, "1432": 12, "026": [12, 13], "688": [12, 13], "_tree_leaves_help": [12, 13], "275": [12, 13], "partition_and_fus": 12, "635": 12, "025": [12, 13], "__update_args_kwarg": 12, "018": [12, 13], "455": [12, 13], "_is_namedtuple_inst": [12, 13], "5166": 12, "4916": 12, "024": [12, 13], "from_meta_and_devic": [12, 13], "214": 12, "fuse_partit": 12, "fuser_util": 12, "218": [12, 13], "fuse_by_partit": 12, "fx_onnx_interpret": [12, 13], "6676": 12, "022": [12, 13], "networkx": 12, "algorithm": 12, "flow": 12, "maxflow": 12, "304": [12, 13], "minimum_cut": 12, "from_real_tensor": [12, 13], "021": [12, 13], "1255": [12, 13], "meta_util": [12, 13], "compile_util": 12, "fx_graph_cs": 12, "preflowpush": 12, "291": [12, 13], "preflow_push": 12, "preflow_push_impl": 12, "186": [12, 13], "meta_tensor": [12, 13], "540": 12, "706": [12, 13], "tree_leav": [12, 13], "203": [12, 13], "475": 12, "676": [12, 13], "tree_unflatten": [12, 13], "358": [12, 13], "436": 12, "_create_inference_sess": 12, "017": 12, "_ref": [12, 13], "610": [12, 13], "5553": 12, "1902": 12, "nop_decomposit": 12, "817": 12, "increase_prec": [12, 13], "alia": 12, "30355": 12, "30259": 12, "1921": [12, 13], "from_tensor": [12, 13], "1646": 12, "exc": 12, "backendcompilerfail": 12, "triton": 12, "devic": [12, 14], "capabl": 12, "plot_torch_dort_ort_tim": 12, "plot_torch_dort_ort_run_mem": 12, "plot_torch_dort_ort_first_run_mem": 12, "0004913864734277926": 12, "0006466560000020157": 12, "91": 12, "0005933378995481913": 12, "00044507250857794107": 12, "08": [12, 13], "0034066558823456837": 12, "88": 12, "84": 12, "inductor": 12, "nruntimeerror": 12, "foun": 12, "000593": 12, "000445": 12, "003407": 12, "000491": 12, "000647": 12, "plot_torch_dort_first_run_mem_": 12, "plot_torch_dort_run_mem_": 12, "perform": 13, "after": [2, 13], "torchscript": 13, "custom": 13, "cus_p0": 13, "limit": [13, 17], "design": 13, "closer": 13, "what": 13, "tensorflow": 13, "were": 13, "larger": 13, "text_plot": 13, "onnx_simple_text_plot": 13, "13456": 13, "fck": 13, "fcl": 13, "fcm": 13, "fcn": 13, "31467437744140625": 13, "export_script": 13, "export_dynamo": 13, "export_output": 13, "dynamo_export": 13, "save": [2, 13], "export_dynopt": 13, "model_onnx": 13, "model_proto": 13, "onnxrewrit": 13, "optimized_model": 13, "export_cus_p0": 13, "onx": [2, 13], "export_cus_p2": 13, "export_": 13, "plot_torch_export_": 13, "st_size": 13, "exported_mod": 13, "plot_torch_export_memori": 13, "3632": 13, "441406": 13, "000005": 13, "974": 13, "000027": 13, "000040": 13, "460938": 13, "449687": 13, "000024": 13, "000021": 13, "527344": 13, "485795": 13, "spend": 13, "befor": [13, 14], "translat": 13, "plot_torch_export_tim": 13, "026533": 13, "023136": 13, "029483": 13, "028804": 13, "002708": 13, "364563": 13, "238618": 13, "491119": 13, "258526": 13, "380691": 13, "101347": 13, "311502": 13, "259847": 13, "357870": 13, "262506": 13, "352984": 13, "042669": 13, "178611": 13, "159881": 13, "225718": 13, "173621": 13, "024331": 13, "182892": 13, "156423": 13, "201245": 13, "194844": 13, "018703": 13, "188989": 13, "176296": 13, "210952": 13, "189749": 13, "011816": 13, "dummyc": 13, "plot_torch_export_profile_": 13, "custom0": 13, "custom2": 13, "0x7f660e6b9870": 13, "1430084": 13, "1358629": 13, "065": 13, "633": 13, "266": 13, "632": 13, "_make_builder_interpret": 13, "127": 13, "625": 13, "exported_program": 13, "_export": 13, "518": 13, "252": 13, "221": 13, "869": 13, "602": 13, "320": [13, 14], "_export_non_strict": 13, "314": 13, "689": 13, "_aot_export_strict": 13, "523": 13, "913": 13, "aot_export_modul": 13, "_aot_export_funct": 13, "3760": 13, "1980": 13, "449": 13, "290": 13, "232": 13, "_export_to_torch_ir": 13, "1156": 13, "3015": 13, "2135": 13, "247": 13, "940": 13, "048": 13, "205": 13, "2660": 13, "_safeguard": 13, "202": 13, "201": 13, "937": 13, "210": 13, "927": 13, "912": 13, "091": 13, "156": 13, "flat_fn": 13, "911": 13, "910": 13, "aot_dispatch_base_graph": 13, "872": 13, "174": 13, "871": 13, "863": 13, "837": 13, "167": 13, "809": 13, "715": 13, "143": 13, "3425": 13, "2365": 13, "705": 13, "703": 13, "701": 13, "698": 13, "140": 13, "3910": 13, "2060": 13, "650": 13, "280": 13, "649": 13, "639": 13, "16340": 13, "3510": 13, "092": 13, "622": 13, "950": 13, "490": 13, "535": 13, "011": 13, "524": 13, "514": 13, "488": 13, "465": 13, "439": 13, "545": 13, "429": 13, "426": 13, "410": 13, "392": 13, "4865": 13, "70": 13, "16615": 13, "334": 13, "1203": 13, "result_capturing_wrapp": 13, "321": 13, "2190": 13, "260": 13, "454": 13, "293": 13, "stateless": 13, "229": 13, "_functional_cal": 13, "292": 13, "907": 13, "058": 13, "285": 13, "934": 13, "276": 13, "overrid": 13, "1560": 13, "handle_torch_funct": 13, "257": 13, "155": 13, "051": 13, "1009": 13, "compile_check_fn": 13, "150": 13, "420": 13, "160": 13, "230": 13, "8785": 13, "3035": 13, "226": 13, "189": 13, "1475": 13, "185": 13, "168": 13, "conv": 13, "459": 13, "213635": 13, "208960": 13, "138": 13, "_conv_forward": 13, "151": 13, "1207": 13, "build_guard_funct": 13, "146": 13, "489": 13, "fn": [2, 13], "774": 13, "_max_pool2d": 13, "82": 13, "_to_fun": 13, "121": 13, "769": 13, "5470": 13, "315": 13, "ast": 13, "414": 13, "visit": 13, "990": 13, "225": 13, "113": 13, "21280": 13, "31245": 13, "5150": 13, "8790": 13, "099": 13, "1020": 13, "add_code_part": 13, "rewrite_signatur": 13, "14415": 13, "13715": 13, "090": 13, "34": 13, "__new__": 13, "10190": 13, "5155": 13, "041": 13, "220": 13, "_mirror_autograd_meta_to": 13, "180": 13, "_traceback": 13, "summari": 13, "084": 13, "_to_functional_tensor": 13, "082": 13, "081": 13, "295": 13, "074": 13, "78": 13, "_ast_unpars": 13, "071": 13, "_extract_symbolized_tb": 13, "1679": 13, "unpars": 13, "1085": 13, "1214": 13, "811": 13, "903": 13, "1385": 13, "3240": 13, "travers": 13, "047": 13, "17595": 13, "_prim": 13, "_prim_elementwise_meta": 13, "063": 13, "499": 13, "count": 13, "6580": 13, "traceback": 13, "decompositions_for_rng": 13, "1280": 13, "load_attr": 13, "1400": 13, "845": 13, "4240": 13, "3960": 13, "generic_visit": 13, "237": 13, "056": 13, "_wrap": 13, "055": 13, "6725": 13, "6210": 13, "7060": 13, "053": 13, "301": 13, "90405": 13, "90240": 13, "mm": 13, "799": 13, "050": 13, "411": 13, "_maybe_broadcast": 13, "le": 13, "1010": 13, "861": 13, "0x7f660e6b9900": 13, "0x7f660e6b9750": 13, "2085154": 13, "2005144": 13, "481": 13, "670": 13, "661": 13, "603": 13, "1172": 13, "808": 13, "562": 13, "dynamo_graph_extractor": 13, "generate_fx": 13, "145": 13, "pre_export_pass": 13, "1449": 13, "common_pre_export_pass": 13, "654": 13, "3735": 13, "1440": 13, "628": 13, "374": 13, "2880": 13, "1780": 13, "206": 13, "222": 13, "2955": 13, "980": 13, "093": 13, "079": 13, "207": 13, "166": 13, "103": 13, "575": 13, "971": 13, "951": 13, "935": 13, "804": 13, "161": 13, "decomp": 13, "646": 13, "607": 13, "decomposition_t": 13, "create_onnx_friendly_decomposition_t": 13, "601": 13, "_create_onnx_supports_op_overload_t": 13, "600": 13, "1035": 13, "460": 13, "584": 13, "566": 13, "529": 13, "106": 13, "528": 13, "2775": 13, "450": 13, "432": 13, "419": 13, "418": 13, "417": 13, "15640": 13, "4110": 13, "342": 13, "36900": 13, "043": 13, "298": 13, "is_registered_op": 13, "4650": 13, "287": 13, "15970": 13, "284": 13, "273": 13, "310": 13, "264": 13, "36975": 13, "256": 13, "get_op_funct": 13, "325": 13, "175": 13, "274270": 13, "267390": 13, "152": 13, "204": 13, "198": 13, "195": 13, "039": 13, "193": 13, "8515": 13, "3235": 13, "modular": 13, "1200": 13, "965": 13, "800": 13, "9330": 13, "780": 13, "157": 13, "1595": 13, "154": 13, "18360": 13, "9335": 13, "132": 13, "591": 13, "build_modul": 13, "58270": 13, "400": 13, "760": 13, "22580": 13, "registr": 13, "58": 13, "from_qualified_nam": 13, "33195": 13, "22415": 13, "22800": 13, "21210": 13, "096": 13, "095": 13, "727": 13, "85": 13, "11440": 13, "11075": 13, "1570": 13, "745": 13, "create_arg": 13, "36995": 13, "075": 13, "from_name_part": 13, "1240": 13, "467": 13, "1275": 13, "1635": 13, "7840": 13, "7110": 13, "810": 13, "1425": 13, "1065": 13, "044": 13, "425": 13, "6445": 13, "2125": 13, "replace_placeholder_name_and_target": 13, "33000": 13, "573": 13, "17045": 13, "74815": 13, "onnxfunction_dispatch": 13, "111": 13, "onnxscript": 13, "function_lib": 13, "torch_lib": 13, "938": 13, "to_model_proto": 13, "90535": 13, "90095": 13, "179": 13, "0x7f660e6b97e0": 13, "graphoptimizationlevel": 13, "data1": 13, "data_mem_load": 13, "listdir": 13, "plot_torch": 13, "aot": 13, "ext": 13, "splitext": 13, "n_node": 13, "n_function": 13, "n_sub": 13, "op_typ": 13, "sub": 13, "obs1": 13, "short_ob": 13, "add_session_config_entri": 13, "session": 13, "disable_aot_function_inlin": 13, "graph_optimization_level": 13, "ort_enable_al": 13, "optimized_model_filepath": 13, "lower": 13, "plot_torch_export_ort_tim": 13, "plot_torch_export_ort_time1_init": 13, "dfmem": 13, "plot_torch_export_ort_load_mem": 13, "plot_torch_export_ort_run_mem": 13, "plot_torch_export_ort_first_run_mem": 13, "df_init": 13, "775847874755525e": 13, "plot_torch_export_cus_p2": 13, "10it": 13, "893754619529318e": 13, "04it": 13, "0013005149425664748": 13, "06it": 13, "0005300441558472309": 13, "01it": 13, "736640420008187e": 13, "plot_torch_export_script": 13, "5503729877580135e": 13, "11it": 13, "0005290873417803818": 13, "14it": 13, "0009241432748644406": 13, "15it": 13, "0001006350427347779": 13, "plot_torch_export_cus_p0": 13, "09it": 13, "0003570333333256218": 13, "0004835017621089599": 13, "03it": 13, "000674908666672612": 13, "05it": 13, "496565506888561e": 13, "plot_torch_export_dynopt": 13, "035727332089125e": 13, "12it": 13, "0004990279569850123": 13, "17it": 13, "0010295017093909322": 13, "22it": 13, "00010891420068058441": 13, "plot_torch_export_dynamo": 13, "20it": 13, "00016820418353838762": 13, "001153339130431287": 13, "95": [13, 14], "08it": 13, "0020766507936752446": 13, "000258": 13, "000460": 13, "002014": 13, "002007": 13, "000261": 13, "000273": 13, "001277": 13, "001356": 13, "000654": 13, "001430": 13, "001592": 13, "002123": 13, "000416": 13, "000370": 13, "001208": 13, "001667": 13, "000352": 13, "000552": 13, "002012": 13, "003069": 13, "plot_torch_export_ort_": 13, "000357": 13, "000101": 13, "000675": 13, "000484": 13, "000079": 13, "000048": 13, "000530": 13, "001301": 13, "000168": 13, "000109": 13, "002077": 13, "001153": 13, "000080": 13, "000085": 13, "001030": 13, "000499": 13, "000046": 13, "000037": 13, "000924": 13, "000529": 13, "without": [13, 17], "long": 13, "nhide": 13, "plot_torch_export_ort_time_2": 13, "time1_init": 13, "013405": 13, "011483": 13, "021502": 13, "023261": 13, "004765": 13, "004980": 13, "018200": 13, "019662": 13, "065682": 13, "026742": 13, "169841": 13, "041885": 13, "021021": 13, "016438": 13, "040249": 13, "031177": 13, "002659": 13, "003798": 13, "025107": 13, "020248": 13, "plot_torch_export_ort_load_mem_": 13, "plot_torch_export_ort_first_run_mem_": 13, "plot_torch_export_ort_run_mem_": 13, "aot0": 13, "domain": 13, "ai": 13, "ml": 13, "preview": 13, "microsoft": 13, "nchwc": 13, "org": 13, "init": 13, "reorder": 13, "arg1_1": 13, "reorder_token_11": 13, "arg3_1": 13, "arg5_1": 13, "arg7_1": 13, "arg9_1": 13, "ortshared_7_1_2_0_token_8": 13, "t_1": 13, "t_2": 13, "activ": 13, "dilat": 13, "group": 13, "stride": 13, "auto_pad": 13, "notset": 13, "reorder_token_10": 13, "reorderoutput": 13, "channels_last": 13, "maxpool": 13, "storage_ord": 13, "ceil_mod": 13, "_onx_maxpool0": 13, "_onx_maxpool1": 13, "reorderinput": 13, "reorder_token_12": 13, "reorder_token_13": 13, "relu_1": 13, "_onx_maxpool03": 13, "_onx_maxpool13": 13, "allowzero": 13, "fusedgemm": 13, "transb": 13, "transa": 13, "alpha": [2, 13], "beta": [2, 13], "relu_2": 13, "relu_3": 13, "gemm": 13, "aot1": 13, "pkg": 13, "dev20240110": 13, "cu118": 13, "l_x_": 13, "reorder_token_38": 13, "bia": [13, 14], "_inlfunc_torch_nn_modules_linear_linear_fc3_1": 13, "folded_0": 13, "inlined_0": 13, "folded_0_t_2": 13, "_inlfunc_torch_nn_modules_linear_linear_fc2_1": 13, "folded_0_t_1": 13, "ortshared_7_1_2_3_token_36": 13, "_inlfunc_torch_nn_modules_linear_linear_fc1_1": 13, "folded_0_t": 13, "ortshared_7_1_2_2_token_35": 13, "ortshared_7_1_2_0_token_33": 13, "ortshared_7_1_2_1_token_34": 13, "reorder_token_37": 13, "_inlfunc__aten_max_pool_with_indices_onnx": 13, "folded_0_pool_result": 13, "folded_0_indic": 13, "reorder_token_39": 13, "reorder_token_40": 13, "folded_1": 13, "fc3_1": 13, "folded_0__": 13, "folded_0_flatten_indic": 13, "slice": 13, "folded_0_delta": 13, "folded_0_indices_3": 13, "reorder_token_71": 13, "ortshared_7_1_2_3_token_69": 13, "_inlfunc_torch_nn_modules_linear_linear_fc1_1_t": 13, "ortshared_7_1_2_1_token_67": 13, "ortshared_7_1_2_2_token_68": 13, "_inlfunc_torch_nn_modules_linear_linear_fc3_1_t_2": 13, "ortshared_7_1_2_0_token_66": 13, "_inlfunc_torch_nn_modules_linear_linear_fc2_1_t_1": 13, "reorder_token_70": 13, "_inlfunc__aten_max_pool_with_indices_onnx_pool_result": 13, "_inlfunc__aten_max_pool_with_indices_onnx_indic": 13, "reorder_token_72": 13, "reorder_token_73": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1_pool_result": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1_indic": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1__": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1_flatten_indic": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1_delta": 13, "_inlfunc__aten_max_pool_with_indices_onnx_token_1_indices_3": 13, "_inlfunc__aten_max_pool_with_indices_onnx__": 13, "_inlfunc__aten_max_pool_with_indices_onnx_flatten_indic": 13, "_inlfunc__aten_max_pool_with_indices_onnx_delta": 13, "_inlfunc__aten_max_pool_with_indices_onnx_indices_3": 13, "arg0_1": 13, "arg2_1": 13, "fusedconv": 13, "addmm_1": 13, "fc1_1": 13, "fc2_1": 13, "485": 13, "563": [], "auto_exampl": 15, "mem": [15, 18], "mostli": 16, "idea": 16, "sdpython": 16, "tutori": 16, "api": 16, "chang": 16, "licens": 16, "copyright": 17, "2023": 17, "permiss": 17, "herebi": 17, "grant": 17, "free": 17, "charg": 17, "person": 17, "obtain": 17, "softwar": 17, "associ": 17, "document": 17, "deal": 17, "restrict": 17, "merg": 17, "publish": 17, "distribut": 17, "sublicens": 17, "sell": 17, "permit": 17, "whom": 17, "furnish": 17, "subject": 17, "condit": 17, "abov": 17, "notic": 17, "shall": 17, "substanti": 17, "portion": 17, "THE": 17, "AS": 17, "warranti": 17, "OF": 17, "kind": 17, "OR": 17, "impli": 17, "BUT": 17, "NOT": 17, "TO": 17, "merchant": 17, "fit": [14, 17], "FOR": 17, "particular": 17, "AND": 17, "noninfring": 17, "IN": 17, "NO": 17, "event": 17, "author": 17, "holder": 17, "BE": 17, "liabl": 17, "claim": 17, "damag": 17, "liabil": 17, "whether": 17, "action": 17, "contract": 17, "tort": 17, "otherwis": 17, "aris": 17, "out": 17, "connect": 17, "WITH": 17, "regress": [8, 15, 18], "scikit": [], "sklearn": 14, "dataset": 14, "make_regress": 14, "linear_model": 14, "linearregress": 14, "metric": 14, "mean_squared_error": 14, "r2_score": 14, "model_select": 14, "train_test_split": 14, "n_featur": 14, "nois": 14, "n_inform": 14, "x_train": 14, "x_test": 14, "y_train": 14, "y_test": 14, "clr": 14, "coef_": 14, "intercept_": 14, "65581376": [], "16848455": [], "12449476": [], "19401403": [], "08584105": [], "06575405489847608": [], "y_pred": 14, "predict": [2, 14], "l2": [2, 14], "r2": 14, "35139238975735": [], "9870757965660628": [], "torchlinearregress": 14, "n_dim": 14, "n_target": 14, "train_loop": 14, "dataload": 14, "loss_fn": 14, "total_loss": 14, "normal": 14, "dropout": 14, "unnecessari": 14, "situat": 14, "best": 14, "practic": 14, "pred": 14, "ravel": 14, "zero_grad": 14, "sgd": [], "lr": 14, "1e": 14, "mseloss": 14, "tensordataset": 14, "batch_siz": 14, "iter": 14, "609": [], "1793051": [], "145955": [], "765625": [], "76050": [], "2578125": [], "72604": [], "3125": [], "72414": [], "859375": [], "tl2": 14, "tr2": 14, "81309545521783": [], "987150322064952": [], "contain": 14, "4835e": [], "1025e": [], "5195e": [], "2436e": [], "3755e": [], "requires_grad": 14, "0245": [], "plot_torch_linreg": [14, 15, 18], "keepyieldop": 2, "keep": 2, "oper": 2, "yieldop": 2, "origin": 2, "specifi": 2, "score_nam": 2, "squared_error": 2, "loss_nam": 2, "label_nam": 2, "label": 2, "weight_nam": 2, "penalti": 2, "output_index": 2, "kwarg": 2, "score": 2, "allow": 2, "consid": [2, 14], "similar": 2, "l1": 2, "must": 2, "more": 2, "than": 2, "integ": 2, "addit": 2, "below": 2, "possibl": 2, "sum_i": 2, "x_i": 2, "y_i": 2, "w_i": 2, "absolute_error": 2, "elast": 2, "mixtur": 2, "l1_weight": 2, "l2_weight": 2, "undefin": 2, "yt": 2, "yp": 2, "binari": 2, "classif": 2, "probabl": 2, "l": [], "orttrain": [], "walk": 2, "element": 2, "doubl": 2, "existing_nam": 2, "norm": [2, 14], "alreadi": 2, "taken": 2, "path_nam": 2, "those": 2, "real": 2, "cl": 2, "case": 2, "epkg": [], "ortmodulegraphbuilderconfigur": 2, "meant": 2, "ortgradientforwardbackward": 2, "These": 2, "user": 2, "graphbuild": 5, "retriev": 5, "37": [], "58747085": [], "08743185": [], "31605706": [], "80312787": [], "16520552": [], "16772832796560044": [], "79479781098034": [], "9640424327634857": [], "672980": [], "101992": [], "921875": 14, "74242": [], "671875": [], "72702": [], "72585": [], "16618333046252": [], "9638849452744864": [], "3535": [], "2217": [], "5016": [], "7696": [], "2641": [], "2832": [], "sgdregressor": 14, "16862047": 14, "27719019": 14, "25621964": 14, "81117422": 14, "49860566": 14, "31509127574197215": 14, "26346117873129": 14, "9634330427887183": 14, "max_it": 14, "epoch": 14, "nnz": 14, "358127": 14, "750": 14, "avg": 14, "771073": 14, "73": 14, "435342": 14, "1500": 14, "636716": 14, "423154": 14, "2250": 14, "53": 14, "754539": 14, "86": 14, "363326": 14, "3000": 14, "624321": 14, "358911": 14, "3750": 14, "454007": 14, "_stochastic_gradi": 14, "1575": 14, "convergencewarn": 14, "reach": 14, "converg": 14, "increas": 14, "improv": 14, "15517763": 14, "3750597": 14, "31082611": 14, "85499387": 14, "33987051": 14, "35891068": 14, "sl2": 14, "sr2": 14, "68165371581833": 14, "9632943565145322": 14, "742280": 14, "4375": 14, "116097": 14, "8203125": 14, "80855": 14, "5625": 14, "78952": 14, "6484375": 14, "78879": 14, "64094822810304": 14, "9633078557808498": 14, "3342": 14, "3307": 14, "4485": 14, "7304": 14, "6217": 14, "2749": 14, "611": [14, 15, 18]}, "objects": {"experimental_experiment.gradient.grad_helper": [[2, 0, 1, "", "DerivativeOptions"], [2, 1, 1, "", "onnx_derivative"]], "experimental_experiment.gradient.loss_helper": [[2, 1, 1, "", "add_loss_output"], [2, 1, 1, "", "get_train_initializer"], [2, 1, 1, "", "penalty_loss_onnx"]], "experimental_experiment.torch_exp": [[1, 2, 0, "-", "_aten_functions"]], "experimental_experiment.torch_exp.graph_builder": [[3, 0, 1, "", "GraphBuilder"], [3, 0, 1, "", "Opset"], [3, 0, 1, "", "OptimizationOptions"]], "experimental_experiment.torch_exp.graph_builder.GraphBuilder": [[3, 3, 1, "", "constant_folding"], [3, 3, 1, "", "io_names"], [3, 3, 1, "", "is_constant"], [3, 3, 1, "", "make_nodes"], [3, 3, 1, "", "remove_identity_nodes"], [3, 3, 1, "", "remove_unused"]], "experimental_experiment.torch_exp.interpreter": [[5, 0, 1, "", "DynamoInterpreter"]], "experimental_experiment.torch_exp.onnx_export": [[6, 1, 1, "", "to_onnx"]]}, "objtypes": {"0": "py:class", "1": "py:function", "2": "py:module", "3": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "function", "Python function"], "2": ["py", "module", "Python module"], "3": ["py", "method", "Python method"]}, "titleterms": {"chang": 0, "log": 0, "0": 0, "1": 0, "aten_funct": 1, "gradient": 2, "grad_help": 2, "derivativeopt": 2, "onnx_deriv": 2, "loss_help": 2, "add_loss_output": 2, "get_train_initi": 2, "penalty_loss_onnx": 2, "graph_build": 3, "graphbuild": 3, "optimizationopt": 3, "opset": 3, "api": 4, "interpret": 5, "dynamointerpret": 5, "onnx_export": 6, "to_onnx": 6, "To": 7, "ignor": 7, "exampl": 8, "galleri": 8, "get": 8, "start": 8, "compar": 8, "torch": [8, 13, 14], "export": [8, 11, 12, 13], "convolut": 9, "matrix": 9, "multipl": 9, "numpi": 9, "raw": 9, "With": 9, "pytorch": 9, "us": 9, "gemm": 9, "what": 9, "i": 9, "convtranspos": 9, "onnxruntim": 9, "train": [9, 11], "conv": 9, "im2col": 9, "col2im": 9, "profil": [10, 11, 12, 13], "an": 10, "exist": 10, "model": [10, 11, 12, 13], "prepar": 10, "evalu": [11, 12, 13, 14], "dort": [11, 12], "some": [11, 12, 13], "helper": [11, 12, 13], "The": [11, 12, 13], "backend": [11, 12], "compil": [11, 12], "memori": [11, 12, 13], "first": [11, 12, 13], "iter": [11, 12], "speed": [11, 12, 13], "benchmark": [11, 12, 13], "ort": [11, 12, 13], "run": [11, 12, 13], "time": [11, 12, 13, 15, 18], "differ": 13, "wai": 13, "onnx": 13, "load": 13, "show": 13, "interest": 13, "cpu": 13, "script": 13, "cus_p2": 13, "dynopt": 13, "dynamo": 13, "cuda": 13, "comput": [15, 18], "experiment": 16, "experi": 16, "fuzzi": 16, "work": 16, "content": 16, "more": 16, "older": 16, "version": 16, "licens": 17, "tutori": 19, "linear": 14, "regress": 14, "data": 14, "sciit": [], "learn": 14, "scikit": 14, "simpl": 14, "sgd": 14, "algorithm": 14}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx.ext.todo": 2, "sphinx": 60}, "alltitles": {"API": [[4, "api"]], "To ignore": [[7, "to-ignore"]], "Convolution and Matrix Multiplication": [[9, "convolution-and-matrix-multiplication"]], "numpy": [[9, "numpy"]], "raw convolution": [[9, "raw-convolution"]], "With pytorch": [[9, "with-pytorch"]], "using Gemm?": [[9, "using-gemm"]], "What is ConvTranspose?": [[9, "what-is-convtranspose"]], "onnxruntime-training": [[9, "onnxruntime-training"]], "Conv": [[9, "conv"]], "ConvTranspose": [[9, "convtranspose"]], "im2col and col2im": [[9, "im2col-and-col2im"]], "Profile an existing model": [[10, "profile-an-existing-model"]], "Preparation": [[10, "preparation"]], "Profiling": [[10, "profiling"]], "Evaluate DORT Training": [[11, "evaluate-dort-training"]], "Some helpers": [[11, "some-helpers"], [12, "some-helpers"], [13, "some-helpers"]], "The model": [[11, "the-model"], [12, "the-model"], [13, "the-model"]], "Backends": [[11, "backends"], [12, "backends"]], "Compile and Memory": [[11, "compile-and-memory"], [12, "compile-and-memory"]], "dort first iteration speed": [[11, "dort-first-iteration-speed"], [12, "dort-first-iteration-speed"]], "Compilation Profiling": [[11, "compilation-profiling"], [12, "compilation-profiling"]], "Benchmark exported models with ORT": [[11, "benchmark-exported-models-with-ort"], [12, "benchmark-exported-models-with-ort"], [13, "benchmark-exported-models-with-ort"]], "Memory First Running Time (ORT)": [[11, "memory-first-running-time-ort"], [12, "memory-first-running-time-ort"], [13, "memory-first-running-time-ort"]], "Memory Running Time (ORT)": [[11, "memory-running-time-ort"], [12, "memory-running-time-ort"], [13, "memory-running-time-ort"]], "Evaluate DORT": [[12, "evaluate-dort"]], "Evaluate different ways to export a torch model to ONNX": [[13, "evaluate-different-ways-to-export-a-torch-model-to-onnx"]], "The exporters": [[13, "the-exporters"]], "Exporter memory": [[13, "exporter-memory"]], "Exporter speed": [[13, "exporter-speed"]], "Exporter Profiling": [[13, "exporter-profiling"]], "Memory Loading Time (ORT)": [[13, "memory-loading-time-ort"]], "Show the interesting models for CPU": [[13, "show-the-interesting-models-for-cpu"]], "script": [[13, "script"], [13, "id1"]], "cus_p2": [[13, "cus-p2"], [13, "id2"]], "dynopt": [[13, "dynopt"], [13, "id3"]], "dynamo": [[13, "dynamo"], [13, "id4"]], "Show the interesting models for CUDA": [[13, "show-the-interesting-models-for-cuda"]], "Tutorial": [[19, "tutorial"]], "aten_functions": [[1, "module-experimental_experiment.torch_exp._aten_functions"]], "graph_builder": [[3, "graph-builder"]], "GraphBuilder": [[3, "graphbuilder"]], "OptimizationOptions": [[3, "optimizationoptions"]], "Opset": [[3, "opset"]], "onnx_export": [[6, "onnx-export"]], "to_onnx": [[6, "to-onnx"]], "experimental-experiment: fuzzy work": [[16, "experimental-experiment-fuzzy-work"]], "Contents": [[16, null]], "More": [[16, null]], "Older versions": [[16, "older-versions"]], "interpreter": [[5, "interpreter"]], "DynamoInterpreter": [[5, "dynamointerpreter"]], "gradient": [[2, "gradient"]], "gradient.grad_helper": [[2, "gradient-grad-helper"]], "DerivativeOptions": [[2, "derivativeoptions"]], "onnx_derivative": [[2, "onnx-derivative"]], "gradient.loss_helper": [[2, "gradient-loss-helper"]], "add_loss_output": [[2, "add-loss-output"]], "get_train_initializer": [[2, "get-train-initializer"]], "penalty_loss_onnx": [[2, "penalty-loss-onnx"]], "Change Logs": [[0, "change-logs"]], "0.1.0": [[0, "id1"]], "Example gallery": [[8, "example-gallery"]], "Getting started": [[8, "getting-started"]], "Compare torch exporters": [[8, "compare-torch-exporters"]], "Linear Regression": [[14, "linear-regression"]], "data": [[14, "data"]], "scikit-learn: the simple regression": [[14, "scikit-learn-the-simple-regression"]], "Evaluation": [[14, "evaluation"]], "scikit-learn: SGD algorithm": [[14, "scikit-learn-sgd-algorithm"]], "torch": [[14, "torch"]], "Computation times": [[15, "computation-times"], [18, "computation-times"]], "License": [[17, "license"]]}, "indexentries": {"experimental_experiment.torch_exp._aten_functions": [[1, "module-experimental_experiment.torch_exp._aten_functions"]], "module": [[1, "module-experimental_experiment.torch_exp._aten_functions"]], "derivativeoptions (class in experimental_experiment.gradient.grad_helper)": [[2, "experimental_experiment.gradient.grad_helper.DerivativeOptions"]], "add_loss_output() (in module experimental_experiment.gradient.loss_helper)": [[2, "experimental_experiment.gradient.loss_helper.add_loss_output"]], "get_train_initializer() (in module experimental_experiment.gradient.loss_helper)": [[2, "experimental_experiment.gradient.loss_helper.get_train_initializer"]], "onnx_derivative() (in module experimental_experiment.gradient.grad_helper)": [[2, "experimental_experiment.gradient.grad_helper.onnx_derivative"]], "penalty_loss_onnx() (in module experimental_experiment.gradient.loss_helper)": [[2, "experimental_experiment.gradient.loss_helper.penalty_loss_onnx"]], "graphbuilder (class in experimental_experiment.torch_exp.graph_builder)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder"]], "opset (class in experimental_experiment.torch_exp.graph_builder)": [[3, "experimental_experiment.torch_exp.graph_builder.Opset"]], "optimizationoptions (class in experimental_experiment.torch_exp.graph_builder)": [[3, "experimental_experiment.torch_exp.graph_builder.OptimizationOptions"]], "constant_folding() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.constant_folding"]], "io_names() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.io_names"]], "is_constant() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.is_constant"]], "make_nodes() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.make_nodes"]], "remove_identity_nodes() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.remove_identity_nodes"]], "remove_unused() (experimental_experiment.torch_exp.graph_builder.graphbuilder method)": [[3, "experimental_experiment.torch_exp.graph_builder.GraphBuilder.remove_unused"]], "dynamointerpreter (class in experimental_experiment.torch_exp.interpreter)": [[5, "experimental_experiment.torch_exp.interpreter.DynamoInterpreter"]], "to_onnx() (in module experimental_experiment.torch_exp.onnx_export)": [[6, "experimental_experiment.torch_exp.onnx_export.to_onnx"]]}})