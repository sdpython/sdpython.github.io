<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="mlinsights.mlmodel (trees)" href="mlmodel_tree.html"><link rel="prev" title="mlinsights.mlbatch" href="batch.html">
        <link rel="prefetch" href="../_static/project_ico.png" as="image">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>mlinsights.mlmodel - mlinsights 0.5.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">mlinsights 0.5.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">mlinsights 0.5.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">API</a><input aria-label="Toggle navigation of API" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plotting.html">mlinsights.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html">mlinsights.helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">mlinsights.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch.html">mlinsights.mlbatch</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">mlinsights.mlmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlmodel_tree.html">mlinsights.mlmodel (trees)</a></li>
<li class="toctree-l2"><a class="reference internal" href="search_rank.html">mlinsights.search_rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="sklapi.html">mlinsights.sklapi</a></li>
<li class="toctree-l2"><a class="reference internal" href="tree.html">Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="blaslapack.html">mlinsights.mlmodel.direct_blas_lapack</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html">mlinsights.timeseries</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a><input aria-label="Toggle navigation of Examples Gallery" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_quantile_mlpregression.html">Quantile MLPRegressor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_traceable_ngrams_tfidf.html">Traceable n-grams with tf-idf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_kmeans_l1.html">KMeans with norm L1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_quantile_regression.html">Quantile Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_digitize.html">numpy.digitize as a tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_piecewise_linear_regression.html">Piecewise linear regression with scikit-learn predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_predictable_tsne.html">Predictable t-SNE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_constraint_kmeans.html">Constraint KMeans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_piecewise_linear_regression_criterion.html">Custom DecisionTreeRegressor adapted to a linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_piecewise_linear_regression_criterion.html#decisiontreeregressor-with-custom-implementation">DecisionTreeRegressor with custom implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_visualize_pipeline.html">Visualize a scikit-learn pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_logistic_regression_clustering.html">LogisticRegression and Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_leave_neighbors.html">Close leaves in a decision trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_piecewise_classification.html">Piecewise classification with scikit-learn predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_search_images_torch.html">Search images with deep learning (torch)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_regression_confidence_interval.html">Regression with confidence interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_sklearn_transformed_target.html">Transformed Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_decision_tree_logreg.html">Decision Tree and Logistic Regression</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i_ex.html">Short Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i_faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/mlmodel.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="mlinsights-mlmodel">
<h1>mlinsights.mlmodel<a class="headerlink" href="#mlinsights-mlmodel" title="Link to this heading">¶</a></h1>
<section id="helpers">
<h2>Helpers<a class="headerlink" href="#helpers" title="Link to this heading">¶</a></h2>
<section id="model-featurizer">
<h3>model_featurizer<a class="headerlink" href="#model-featurizer" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="mlinsights.mlmodel.ml_featurizer.model_featurizer">
<span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.ml_featurizer.</span></span><span class="sig-name descname"><span class="pre">model_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/ml_featurizer.html#model_featurizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.ml_featurizer.model_featurizer" title="Link to this definition">¶</a></dt>
<dd><p>Converts a machine learned model into a function which converts
a vector into features produced by the model.
It can be the output itself or intermediate results.
The model can come from <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>,
<a class="reference external" href="https://pytorch.org/docs/stable/torch.html">torch</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model</p></li>
<li><p><strong>params</strong> – additional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>function</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="clustering">
<h2>Clustering<a class="headerlink" href="#clustering" title="Link to this heading">¶</a></h2>
<section id="constraintkmeans">
<h3>ConstraintKMeans<a class="headerlink" href="#constraintkmeans" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.kmeans_constraint.</span></span><span class="sig-name descname"><span class="pre">ConstraintKMeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k-means++'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lloyd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balanced_predictions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gain'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans" title="Link to this definition">¶</a></dt>
<dd><p>Defines a constraint <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a>.
Clusters are modified to have an equal size.
The algorithm is initialized with a regular <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html">KMeans</a>
and continues with a modified version of it.</p>
<p>Computing the predictions offer a choice.
The first one is to keep the predictions
from the regular <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a>
algorithm but with the balanced clusters.
The second is to compute balanced predictions
over the test set. That implies that the predictions
for the same observations might change depending
on the set it belongs to.</p>
<p>The parameter <em>strategy</em> determines how
obseervations should be assigned to a cluster.
The value can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'distance'</span></code>: observations are ranked by distance to a cluster,
the algorithm assigns first point to the closest center unless it reached
the maximum size, it deals first with the further point and maps it to
the closest center</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'gain'</span></code>: follows the algorithm described at</dt><dd><p>see <a class="reference external" href="https://elki-project.github.io/tutorial/same-size_k_means">Same-size k-Means Variation</a>,</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'weights'</span></code>: estimates weights attached to each cluster,</dt><dd><p>it weights the distance to each cluster in order
to balance the number of points mapped to every cluster,
the strategy uses a learning rate.</p>
</dd>
</dl>
</li>
</ul>
<p>The first two strategies cannot reach a good compromise
without using function <a class="reference internal" href="#mlinsights.mlmodel._kmeans_constraint_._switch_clusters" title="mlinsights.mlmodel._kmeans_constraint_._switch_clusters"><code class="xref py py-func docutils literal notranslate"><span class="pre">_switch_clusters</span></code></a> which
tries every switch between clusters: two points
change clusters. It keeps the number of points and checks
that the inertia is reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> – number of clusters</p></li>
<li><p><strong>init</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>n_init</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>max_iter</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>tol</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>verbose</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>random_state</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>copy_x</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>algorithm</strong> – used by <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a></p></li>
<li><p><strong>balanced_predictions</strong> – produced balanced prediction
or the regular ones</p></li>
<li><p><strong>strategy</strong> – strategy or algorithm used to abide
by the constraint</p></li>
<li><p><strong>kmeans0</strong> – if True, applies <em>k-means</em> algorithm first</p></li>
<li><p><strong>history</strong> – keeps centers accress iterations</p></li>
<li><p><strong>learning_rate</strong> – learning rate, used by strategy <cite>‘weights’</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.cluster_edges">
<span class="sig-name descname"><span class="pre">cluster_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.cluster_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.cluster_edges" title="Link to this definition">¶</a></dt>
<dd><p>Computes edges between clusters based on a
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.Delaunay.html">Delaunay</a>
graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.constraint_kmeans">
<span class="sig-name descname"><span class="pre">constraint_kmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.constraint_kmeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.constraint_kmeans" title="Link to this definition">¶</a></dt>
<dd><p>Completes the constraint k-means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – features</p></li>
<li><p><strong>sample_weight</strong> – sample weight</p></li>
<li><p><strong>state</strong> – state</p></li>
<li><p><strong>learning_rate</strong> – learning rate</p></li>
<li><p><strong>history</strong> – keeps evolution of centers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.fit" title="Link to this definition">¶</a></dt>
<dd><p>Compute k-means clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – array-like or sparse matrix, shape=(n_samples, n_features)
Training instances to cluster. It must be noted that the data
will be converted to C ordering, which will cause a memory
copy if the given data is not C-contiguous.</p></li>
<li><p><strong>y</strong> – Ignored</p></li>
<li><p><strong>sample_weight</strong> – sample weight</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.predict" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>prediction</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.score" title="Link to this definition">¶</a></dt>
<dd><p>Returns the distances to all clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – features</p></li>
<li><p><strong>y</strong> – unused</p></li>
<li><p><strong>sample_weight</strong> – sample weight</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans" title="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans"><span class="pre">ConstraintKMeans</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans" title="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans"><span class="pre">ConstraintKMeans</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id1">
<h4>Parameters<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id2">
<h4>Returns<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_constraint.html#ConstraintKMeans.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.transform" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>prediction</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="kmeansl1l2">
<h3>KMeansL1L2<a class="headerlink" href="#kmeansl1l2" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.kmeans_l1.</span></span><span class="sig-name descname"><span class="pre">KMeansL1L2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k-means++'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lloyd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_l1.html#KMeansL1L2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2" title="Link to this definition">¶</a></dt>
<dd><p>K-Means clustering with either norm L1 or L2.
See notebook <a class="reference internal" href="../auto_examples/plot_kmeans_l1.html#l-kmeans-l1-example"><span class="std std-ref">KMeans with norm L1</span></a> for an example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> – int, default=8
The number of clusters to form as well as the number of
centroids to generate.</p></li>
<li><p><strong>init</strong> – <p>{‘k-means++’, ‘random’} or ndarray of shape             (n_clusters, n_features), default=’k-means++’
Method for initialization, defaults to ‘k-means++’:</p>
<p>’k-means++’ : selects initial cluster centers for k-mean
clustering in a smart way to speed up convergence. See section
Notes in k_init for more details.</p>
<p>’random’: choose k observations (rows) at random from data for
the initial centroids.</p>
<p>If an ndarray is passed, it should be of shape (n_clusters, n_features)
and gives the initial centers.</p>
</p></li>
<li><p><strong>n_init</strong> – int, default=10
Number of time the k-means algorithm will be run with different
centroid seeds. The final results will be the best output of
n_init consecutive runs in terms of inertia.</p></li>
<li><p><strong>max_iter</strong> – int, default=300
Maximum number of iterations of the k-means algorithm for a
single run.</p></li>
<li><p><strong>tol</strong> – float, default=1e-4
Relative tolerance with regards to inertia to declare convergence.</p></li>
<li><p><strong>verbose</strong> – int, default=0
Verbosity mode.</p></li>
<li><p><strong>random_state</strong> – int, RandomState instance, default=None
Determines random number generation for centroid initialization. Use
an int to make the randomness deterministic.</p></li>
<li><p><strong>copy_x</strong> – bool, default=True
When pre-computing distances it is more numerically accurate to center
the data first.  If copy_x is True (default), then the original data is
not modified, ensuring X is C-contiguous.  If False, the original data
is modified, and put back before the function returns, but small
numerical differences may be introduced by subtracting and then adding
the data mean, in this case it will also not ensure that data is
C-contiguous which may cause a significant slowdown.</p></li>
<li><p><strong>algorithm</strong> – {“lloyd”, “elkan”}, default=”lloyd”
K-means algorithm to use. The classical EM-style algorithm is “lloyd”.
The “elkan” variation is more efficient by using the triangle
inequality, but currently doesn’t support sparse data.</p></li>
<li><p><strong>norm</strong> – {“L1”, “L2”}
The norm <em>L2</em> is identical to <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html">KMeans</a>.
Norm <em>L1</em> uses a complete different path.</p></li>
</ul>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>cluster_centers_</cite>: ndarray of shape (n_clusters, n_features)</dt><dd><p>Coordinates of cluster centers. If the algorithm stops before fully
converging (see <code class="docutils literal notranslate"><span class="pre">tol</span></code> and <code class="docutils literal notranslate"><span class="pre">max_iter</span></code>), these will not be
consistent with <code class="docutils literal notranslate"><span class="pre">labels_</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>labels_</cite>: ndarray of shape (n_samples,)</dt><dd><p>Labels of each point</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>inertia_</cite>: float</dt><dd><p>Sum of squared distances of samples to their closest cluster center.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>n_iter_</cite>: int</dt><dd><p>Number of iterations run.</p>
</dd>
</dl>
</li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_l1.html#KMeansL1L2.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.fit" title="Link to this definition">¶</a></dt>
<dd><p>Computes k-means clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – array-like or sparse matrix, shape=(n_samples, n_features)
Training instances to cluster. It must be noted that the data
will be converted to C ordering, which will cause a memory
copy if the given data is not C-contiguous.</p></li>
<li><p><strong>y</strong> – Ignored
Not used, present here for API consistency by convention.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape (n_samples,), optional
The weights for each observation in X. If None, all observations
are assigned equal weight (default: None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self
Fitted estimator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_l1.html#KMeansL1L2.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predicts the closest cluster each sample in X belongs to.</p>
<p>In the vector quantization literature, <cite>cluster_centers_</cite> is called
the code book and each value returned by <cite>predict</cite> is the index of
the closest code in the code book.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – {array-like, sparse matrix} of shape (n_samples, n_features)
New data to predict.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape (n_samples,), optional
The weights for each observation in X. If None, all observations
are assigned equal weight (default: None), unused here</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>labels : array, shape [n_samples,]
Index of the cluster each sample belongs to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2" title="mlinsights.mlmodel.kmeans_l1.KMeansL1L2"><span class="pre">KMeansL1L2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>Returns<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_predict_request">
<span class="sig-name descname"><span class="pre">set_predict_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2" title="mlinsights.mlmodel.kmeans_l1.KMeansL1L2"><span class="pre">KMeansL1L2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_predict_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">predict</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p>
</dd>
</dl>
</section>
<section id="id6">
<h4>Returns<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2" title="mlinsights.mlmodel.kmeans_l1.KMeansL1L2"><span class="pre">KMeansL1L2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id8">
<h4>Returns<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.kmeans_l1.KMeansL1L2.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/kmeans_l1.html#KMeansL1L2.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms <em>X</em> to a cluster-distance space.</p>
<p>In the new space, each dimension is the distance to the cluster
centers.  Note that even if X is sparse, the array returned by
<cite>transform</cite> will typically be dense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix} of shape (n_samples, n_features)
New data to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>X_new : array, shape [n_samples, k]
X transformed in the new space.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="trainers">
<h2>Trainers<a class="headerlink" href="#trainers" title="Link to this heading">¶</a></h2>
<section id="classifierafterkmeans">
<h3>ClassifierAfterKMeans<a class="headerlink" href="#classifierafterkmeans" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.classification_kmeans.</span></span><span class="sig-name descname"><span class="pre">ClassifierAfterKMeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans" title="Link to this definition">¶</a></dt>
<dd><p>Applies a <em>k-means</em> (see <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/cluster.KMeans.html">sklearn.cluster.KMeans</a>)
for each class, then adds the distance to each cluster
as a feature for a classifier.
See example <a class="reference internal" href="../auto_examples/plot_logistic_regression_clustering.html#l-logisitic-regression-clustering"><span class="std std-ref">LogisticRegression and Clustering</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimator</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.linear_model.LogisiticRegression</span></code> by default</p></li>
<li><p><strong>clus</strong> – clustering applied on each class,
by default k-means with two classes</p></li>
<li><p><strong>kwargs</strong> – sent to
<a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params" title="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params</span></code></a>,
see its documentation to understand how to
specify parameters</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.decision_function">
<span class="sig-name descname"><span class="pre">decision_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.decision_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.decision_function" title="Link to this definition">¶</a></dt>
<dd><p>Calls <em>decision_function</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.fit" title="Link to this definition">¶</a></dt>
<dd><p>Runs a <em>k-means</em> on each class
then trains a classifier on the
extended set of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – numpy array or sparse matrix of shape [n_samples,n_features]
Training data</p></li>
<li><p><strong>y</strong> – numpy array of shape [n_samples, n_targets]
Target values. Will be cast to X’s dtype if necessary</p></li>
<li><p><strong>sample_weight</strong> – numpy array of shape [n_samples]
Individual weights for each sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self : returns an instance of self.</p>
</dd>
</dl>
<p>Fitting attributes:
* <cite>labels_</cite>: dictionary of clustering models
* <cite>clus_</cite>: array of clustering models
* <cite>estimator_</cite>: trained classifier</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.get_params" title="Link to this definition">¶</a></dt>
<dd><p>Returns the parameters for both
the clustering and the classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> – unused here</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params" title="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_params</span></code></a>
describes the pattern parameters names follow.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict" title="Link to this definition">¶</a></dt>
<dd><p>Runs the predictions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict_proba" title="Link to this definition">¶</a></dt>
<dd><p>Converts predictions into probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans" title="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans"><span class="pre">ClassifierAfterKMeans</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id9">
<h4>Parameters<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id10">
<h4>Returns<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params" title="Link to this definition">¶</a></dt>
<dd><p>Sets the parameters before training.
Every parameter prefixed by <code class="docutils literal notranslate"><span class="pre">'e_'</span></code> is an estimator
parameter, every parameter prefixed by <code class="docutils literal notranslate"><span class="pre">'c_'</span></code> is for
the <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/cluster.KMeans.html">sklearn.cluster.KMeans</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> – valeurs</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans" title="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans"><span class="pre">ClassifierAfterKMeans</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id11">
<h4>Parameters<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id12">
<h4>Returns<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.transform_features">
<span class="sig-name descname"><span class="pre">transform_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/classification_kmeans.html#ClassifierAfterKMeans.transform_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.transform_features" title="Link to this definition">¶</a></dt>
<dd><p>Applies all the clustering objects
on every observations and extends the list of
features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>extended features</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="customizedmultilayerperceptron">
<h3>CustomizedMultilayerPerceptron<a class="headerlink" href="#customizedmultilayerperceptron" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.quantile_mlpregressor.</span></span><span class="sig-name descname"><span class="pre">CustomizedMultilayerPerceptron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesterovs_momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_fraction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_no_change</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fun</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_mlpregressor.html#CustomizedMultilayerPerceptron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron" title="Link to this definition">¶</a></dt>
<dd><p>Customized MLP Perceptron based on
<a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/neural_network/multilayer_perceptron.py#L40">BaseMultilayerPerceptron</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron" title="mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron"><span class="pre">CustomizedMultilayerPerceptron</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id13">
<h4>Parameters<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id14">
<h4>Returns<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="intervalregressor">
<h3>IntervalRegressor<a class="headerlink" href="#intervalregressor" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.interval_regressor.</span></span><span class="sig-name descname"><span class="pre">IntervalRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/interval_regressor.html#IntervalRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor" title="Link to this definition">¶</a></dt>
<dd><p>Trains multiple regressors to provide a confidence
interval on prediction. It only works for
single regression. Every training is made with a new
sample of the training data, parameter <em>alpha</em>
let the user choose the size of this sample.
A smaller <em>alpha</em> increases the variance
of the predictions. The current implementation
draws sample by random but keeps the weight associated
to each of them. Another way could be to draw
a weighted sample but give them uniform weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimator</strong> – predictor trained on every bucket</p></li>
<li><p><strong>n_estimators</strong> – number of estimators to train</p></li>
<li><p><strong>n_jobs</strong> – number of parallel jobs (for training and predicting)</p></li>
<li><p><strong>alpha</strong> – proportion of samples resampled for each training</p></li>
<li><p><strong>verbose</strong> – boolean or use <code class="docutils literal notranslate"><span class="pre">'tqdm'</span></code> to use <a class="reference external" href="https://tqdm.github.io/">tqdm</a>
to fit the estimators</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/interval_regressor.html#IntervalRegressor.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.fit" title="Link to this definition">¶</a></dt>
<dd><p>Trains the binner and an estimator on every
bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p></li>
<li><p><strong>y</strong> – target</p></li>
<li><p><strong>sample_weight</strong> – sample weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self: returns an instance of self.</p>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><p><cite>binner_</cite>: binner</p></li>
<li><dl class="simple">
<dt><cite>estimators_</cite>: dictionary of estimators, each of them</dt><dd><p>mapped to a leave to the tree</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>mean_estimator_</cite>: estimator trained on the whole</dt><dd><p>datasets in case the binner can find a bucket for
a new observation</p>
</dd>
</dl>
</li>
<li><p><cite>dim_</cite>: dimension of the output</p></li>
<li><p><cite>mean_</cite>: average targets</p></li>
</ul>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.n_estimators_">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_estimators_</span></span><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.n_estimators_" title="Link to this definition">¶</a></dt>
<dd><p>Returns the number of estimators = the number of buckets
the data was split in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/interval_regressor.html#IntervalRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Computes the average predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_all">
<span class="sig-name descname"><span class="pre">predict_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/interval_regressor.html#IntervalRegressor.predict_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_all" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions for all estimators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_sorted">
<span class="sig-name descname"><span class="pre">predict_sorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/interval_regressor.html#IntervalRegressor.predict_sorted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_sorted" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions for all estimators.
Sorts them for all observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions sorted for each observation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor" title="mlinsights.mlmodel.interval_regressor.IntervalRegressor"><span class="pre">IntervalRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id15">
<h4>Parameters<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id16">
<h4>Returns<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor" title="mlinsights.mlmodel.interval_regressor.IntervalRegressor"><span class="pre">IntervalRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id17">
<h4>Parameters<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id18">
<h4>Returns<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="approximatenmfpredictor">
<h3>ApproximateNMFPredictor<a class="headerlink" href="#approximatenmfpredictor" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.anmf_predictor.</span></span><span class="sig-name descname"><span class="pre">ApproximateNMFPredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/anmf_predictor.html#ApproximateNMFPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor" title="Link to this definition">¶</a></dt>
<dd><p>Converts <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/decomposition.NMF.html">sklearn.decomposition.NMF</a> into
a predictor so that the prediction does not involve
training even for new observations. The class uses a
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/decomposition.TruncatedSVD.html">sklearn.decomposition.TruncatedSVD</a> of the components
found by the <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/decomposition.NMF.html">sklearn.decomposition.NMF</a>.
The prediction projects the test data into
the components vector space and retrieves them back
into their original space. The issue is it does not
necessarily produce results with only positive
results as the <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/decomposition.NMF.html">sklearn.decomposition.NMF</a>
would do unless parameter <em>force_positive</em> is True.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel.anmf_predictor</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApproximateNMFPredictor</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">train</span><span class="p">[:</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ApproximateNMFPredictor</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">force_positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[[</span><span class="mf">1.254</span> <span class="mf">0.263</span> <span class="mf">0.263</span> <span class="mf">0.</span>   <span class="p">]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/anmf_predictor.html#ApproximateNMFPredictor.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.fit" title="Link to this definition">¶</a></dt>
<dd><p>Trains a <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/decomposition.NMF.html">sklearn.decomposition.NMF</a>
then a multi-output regressor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/anmf_predictor.html#ApproximateNMFPredictor.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.get_params" title="Link to this definition">¶</a></dt>
<dd><p>Returns the parameters of the estimator
as a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/anmf_predictor.html#ApproximateNMFPredictor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predicts based on the multi-output regressor.
The output has the same dimension as <em>X</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor" title="mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor"><span class="pre">ApproximateNMFPredictor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id19">
<h4>Parameters<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id20">
<h4>Returns<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="piecewiseclassifier">
<h3>PiecewiseClassifier<a class="headerlink" href="#piecewiseclassifier" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.piecewise_estimator.</span></span><span class="sig-name descname"><span class="pre">PiecewiseClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier" title="Link to this definition">¶</a></dt>
<dd><p>Uses a <a class="reference external" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a> to split the space of features
into buckets and trains a logistic regression (default) on each of them.
The second estimator is usually a <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/linear_model.LogisticRegression.html">sklearn.linear_model.LogisticRegression</a>.
It can also be <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/dummy.DummyClassifier.html">sklearn.dummy.DummyClassifier</a> to just get
the average on each bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binner</strong> – transformer or predictor which creates the buckets</p></li>
<li><p><strong>estimator</strong> – predictor trained on every bucket</p></li>
<li><p><strong>n_jobs</strong> – number of parallel jobs (for training and predicting)</p></li>
<li><p><strong>random_state</strong> – to pick up random examples when buckets do not
contain enough examples of each class</p></li>
<li><p><strong>verbose</strong> – boolean or use <code class="docutils literal notranslate"><span class="pre">'tqdm'</span></code> to use <a class="reference external" href="https://tqdm.github.io/">tqdm</a>
to fit the estimators</p></li>
</ul>
</dd>
</dl>
<p><em>binner</em> allows the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tree</span></code>: the model is <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" title="(in scikit-learn v1.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.tree.DecisionTreeClassifier</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bins'</span></code>: the model <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.KBinsDiscretizer.html#sklearn.preprocessing.KBinsDiscretizer" title="(in scikit-learn v1.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.preprocessing.KBinsDiscretizer</span></code></a></p></li>
<li><p>any instanciated model</p></li>
</ul>
<p><em>estimator</em> allows the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: the model is <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="(in scikit-learn v1.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.linear_model.LogisticRegression</span></code></a></p></li>
<li><p>any instanciated model</p></li>
</ul>
<p>The main issue with the <em>PiecewiseClassifier</em> is that each piece requires
one example of each class in each bucket which may not happen.
To avoid that, the training will pick up random example
from other bucket to ensure this case does not happen.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.decision_function">
<span class="sig-name descname"><span class="pre">decision_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseClassifier.decision_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.decision_function" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions probabilities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseClassifier.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseClassifier.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict_proba" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions probabilities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier" title="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier"><span class="pre">PiecewiseClassifier</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id21">
<h4>Parameters<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id22">
<h4>Returns<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier" title="mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier"><span class="pre">PiecewiseClassifier</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id23">
<h4>Parameters<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id24">
<h4>Returns<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="piecewiseregressor">
<h3>PiecewiseRegressor<a class="headerlink" href="#piecewiseregressor" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.piecewise_estimator.</span></span><span class="sig-name descname"><span class="pre">PiecewiseRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor" title="Link to this definition">¶</a></dt>
<dd><p>Uses a <a class="reference external" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a> to split the space of features
into buckets and trains a linear regression (default) on each of them.
The second estimator is usually a <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/linear_model.LinearRegression.html">sklearn.linear_model.LinearRegression</a>.
It can also be <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/dummy.DummyRegressor.html">sklearn.dummy.DummyRegressor</a> to just get
the average on each bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binner</strong> – transformer or predictor which creates the buckets</p></li>
<li><p><strong>estimator</strong> – predictor trained on every bucket</p></li>
<li><p><strong>n_jobs</strong> – number of parallel jobs (for training and predicting)</p></li>
<li><p><strong>verbose</strong> – boolean or use <code class="docutils literal notranslate"><span class="pre">'tqdm'</span></code> to use <a class="reference external" href="https://tqdm.github.io/">tqdm</a>
to fit the estimators</p></li>
</ul>
</dd>
</dl>
<p><em>binner</em> allows the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tree</span></code>: the model is <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html#sklearn.tree.DecisionTreeRegressor" title="(in scikit-learn v1.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.tree.DecisionTreeRegressor</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bins'</span></code>: the model <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.KBinsDiscretizer.html#sklearn.preprocessing.KBinsDiscretizer" title="(in scikit-learn v1.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.preprocessing.KBinsDiscretizer</span></code></a></p></li>
<li><p>any instanciated model</p></li>
</ul>
<p><em>estimator</em> allows the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: the model is <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/linear_model.LinearRegression.html">sklearn.linear_model.LinearRegression</a></p></li>
<li><p>any instanciated model</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/piecewise_estimator.html#PiecewiseRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Computes the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – features, <em>X</em> is converted into an array if <em>X</em> is a dataframe</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor" title="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor"><span class="pre">PiecewiseRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id25">
<h4>Parameters<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id26">
<h4>Returns<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor" title="mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor"><span class="pre">PiecewiseRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id27">
<h4>Parameters<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id28">
<h4>Returns<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="quantilemlpregressor">
<h3>QuantileMLPRegressor<a class="headerlink" href="#quantilemlpregressor" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.quantile_mlpregressor.</span></span><span class="sig-name descname"><span class="pre">QuantileMLPRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesterovs_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_no_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_mlpregressor.html#QuantileMLPRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor" title="Link to this definition">¶</a></dt>
<dd><p>Quantile MLP Regression or neural networks regression
trained with norm <a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Absolute-value_norm">L1</a>. This class inherits from
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/neural_networks.MLPRegressor.html">sklearn.neural_networks.MLPRegressor</a>.
This model optimizes the absolute-loss using LBFGS or stochastic gradient
descent. See <a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron" title="mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomizedMultilayerPerceptron</span></code></a> and
<a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.absolute_loss" title="mlinsights.mlmodel.quantile_mlpregressor.absolute_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">absolute_loss</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layer_sizes</strong> – tuple, length = n_layers - 2, default (100,)
The ith element represents the number of neurons in the ith
hidden layer.</p></li>
<li><p><strong>activation</strong> – {‘identity’, ‘logistic’, ‘tanh’, ‘relu’}, default ‘relu’
Activation function for the hidden layer.
‘identity’, no-op activation, useful to implement linear bottleneck,
returns <img class="math" src="../_images/math/54932960ed63d0a00b0a8826d4e7f20fe7f3897f.svg" alt="f(x) = x"/>,
‘logistic’, the logistic sigmoid function,
returns <img class="math" src="../_images/math/8996ab2e397fc801d95086d9110a33700088ac2b.svg" alt="f(x) = 1 / (1 + exp(-x))"/>.
‘tanh’, the hyperbolic tan function, returns <img class="math" src="../_images/math/4563c4a0275ef4c06db332f940e3b7231a530d4d.svg" alt="f(x) = tanh(x)"/>.
‘relu’, the rectified linear unit function,
returns <img class="math" src="../_images/math/4364e322712dc1044cda27ed6bad0836c8d69763.svg" alt="f(x) = \max(0, x)"/>.</p></li>
<li><p><strong>solver</strong> – <code class="docutils literal notranslate"><span class="pre">{'lbfgs',</span> <span class="pre">'sgd',</span> <span class="pre">'adam'}</span></code>, default ‘adam’
The solver for weight optimization,
<em>‘lbfgs’</em> is an optimizer in the family of quasi-Newton methods.
<em>‘sgd’</em> refers to stochastic gradient descent.
<em>‘adam’</em> refers to a stochastic gradient-based optimizer proposed by
Kingma, Diederik, and Jimmy Ba
Note: The default solver ‘adam’ works pretty well on relatively
large datasets (with thousands of training samples or more) in terms of
both training time and validation score. For small datasets, however,
‘lbfgs’ can converge faster and perform better.</p></li>
<li><p><strong>alpha</strong> – float, optional, default 0.0001
<a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Euclidean_norm">L2</a> penalty (regularization term) parameter.</p></li>
<li><p><strong>batch_size</strong> – int, optional, default ‘auto’
Size of minibatches for stochastic optimizers.
If the solver is ‘lbfgs’, the classifier will not use minibatch.
When set to “auto”, <cite>batch_size=min(200, n_samples)</cite></p></li>
<li><p><strong>learning_rate</strong> – {‘constant’, ‘invscaling’, ‘adaptive’}, default ‘constant’
Learning rate schedule for weight updates.
‘constant’ is a constant learning rate given by ‘learning_rate_init’,
‘invscaling’ gradually decreases the learning rate <code class="docutils literal notranslate"><span class="pre">learning_rate_</span></code>
at each time step ‘t’ using an inverse scaling exponent of ‘power_t’.
effective_learning_rate = learning_rate_init / pow(t, power_t),
‘adaptive’ keeps the learning rate constant to ‘learning_rate_init’
as long as training loss keeps decreasing. Each time two consecutive
epochs fail to decrease training loss by at least tol, or fail to
increase validation score by at least tol if ‘early_stopping’ is on,
the current learning rate is divided by 5. Only used when solver=’sgd’.</p></li>
<li><p><strong>learning_rate_init</strong> – double, optional, default 0.001
The initial learning rate used. It controls the step-size
in updating the weights. Only used when solver=’sgd’ or ‘adam’.</p></li>
<li><p><strong>power_t</strong> – double, optional, default 0.5
The exponent for inverse scaling learning rate.
It is used in updating effective learning rate when the learning_rate
is set to ‘invscaling’. Only used when solver=’sgd’.</p></li>
<li><p><strong>max_iter</strong> – int, optional, default 200
Maximum number of iterations. The solver iterates until convergence
(determined by ‘tol’) or this number of iterations. For stochastic
solvers (‘sgd’, ‘adam’), note that this determines the number of epochs
(how many times each data point will be used), not the number of
gradient steps.</p></li>
<li><p><strong>shuffle</strong> – bool, optional, default True
Whether to shuffle samples in each iteration. Only used when
solver=’sgd’ or ‘adam’.</p></li>
<li><p><strong>random_state</strong> – int, RandomState instance or None, optional, default None
If int, random_state is the seed used by the random number generator;
If RandomState instance, random_state is the random number generator;
If None, the random number generator is the RandomState instance used
by <cite>np.random</cite>.</p></li>
<li><p><strong>tol</strong> – float, optional, default 1e-4
Tolerance for the optimization. When the loss or score is not improving
by at least <code class="docutils literal notranslate"><span class="pre">tol</span></code> for <code class="docutils literal notranslate"><span class="pre">n_iter_no_change</span></code> consecutive iterations,
unless <code class="docutils literal notranslate"><span class="pre">learning_rate</span></code> is set to ‘adaptive’, convergence is
considered to be reached and training stops.</p></li>
<li><p><strong>verbose</strong> – bool, optional, default False
Whether to print progress messages to stdout.</p></li>
<li><p><strong>warm_start</strong> – bool, optional, default False
When set to True, reuse the solution of the previous
call to fit as initialization, otherwise, just erase the
previous solution.</p></li>
<li><p><strong>momentum</strong> – float, default 0.9
Momentum for gradient descent update.  Should be between 0 and 1. Only
used when solver=’sgd’.</p></li>
<li><p><strong>nesterovs_momentum</strong> – boolean, default True
Whether to use Nesterov’s momentum. Only used when solver=’sgd’ and
momentum &gt; 0.</p></li>
<li><p><strong>early_stopping</strong> – bool, default False
Whether to use early stopping to terminate training when validation
score is not improving. If set to true, it will automatically set
aside 10% of training data as validation and terminate training when
validation score is not improving by at least <code class="docutils literal notranslate"><span class="pre">tol</span></code> for
<code class="docutils literal notranslate"><span class="pre">n_iter_no_change</span></code> consecutive epochs.
Only effective when solver=’sgd’ or ‘adam’</p></li>
<li><p><strong>validation_fraction</strong> – float, optional, default 0.1
The proportion of training data to set aside as validation set for
early stopping. Must be between 0 and 1.
Only used if early_stopping is True</p></li>
<li><p><strong>beta_1</strong> – float, optional, default 0.9
Exponential decay rate for estimates of first moment vector in adam,
should be in [0, 1). Only used when solver=’adam’</p></li>
<li><p><strong>beta_2</strong> – float, optional, default 0.999
Exponential decay rate for estimates of second moment vector in adam,
should be in [0, 1). Only used when solver=’adam’</p></li>
<li><p><strong>epsilon</strong> – float, optional, default 1e-8
Value for numerical stability in adam. Only used when solver=’adam’</p></li>
<li><p><strong>n_iter_no_change</strong> – int, optional, default 10
Maximum number of epochs to not meet <code class="docutils literal notranslate"><span class="pre">tol</span></code> improvement.
Only effective when solver=’sgd’ or ‘adam’</p></li>
<li><p><strong>kwargs</strong> – additional parameters sent to the constructor of the parent</p></li>
</ul>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><p><cite>loss_</cite>: float
The current loss computed with the loss function.</p></li>
<li><p><cite>coefs_</cite>: list, length n_layers - 1
The ith element in the list represents the weight matrix corresponding
to layer i.</p></li>
<li><p><cite>intercepts_</cite>: list, length n_layers - 1
The ith element in the list represents the bias vector corresponding to
layer i + 1.</p></li>
<li><p><cite>n_iter_</cite>: int,
The number of iterations the solver has ran.</p></li>
<li><p><cite>n_layers_</cite>: int
Number of layers.</p></li>
<li><p><cite>n_outputs_</cite>: int
Number of outputs.</p></li>
<li><p><cite>out_activation_</cite>: string
Name of the output activation function.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_mlpregressor.html#QuantileMLPRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predicts using the multi-layer perceptron model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix}, shape (n_samples, n_features)
The input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y : array-like, shape (n_samples, n_outputs)
The predicted values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_mlpregressor.html#QuantileMLPRegressor.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.score" title="Link to this definition">¶</a></dt>
<dd><p>Returns mean absolute error regression loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – array-like, shape = (n_samples, n_features)
Test samples.</p></li>
<li><p><strong>y</strong> – array-like, shape = (n_samples) or (n_samples, n_outputs)
True values for X.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape = [n_samples], optional
Sample weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>score, float
mean absolute error regression loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor" title="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor"><span class="pre">QuantileMLPRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id29">
<h4>Parameters<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id30">
<h4>Returns<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor" title="mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor"><span class="pre">QuantileMLPRegressor</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id31">
<h4>Parameters<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id32">
<h4>Returns<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="quantilelinearregression">
<h3>QuantileLinearRegression<a class="headerlink" href="#quantilelinearregression" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.quantile_regression.</span></span><span class="sig-name descname"><span class="pre">QuantileLinearRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_regression.html#QuantileLinearRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression" title="Link to this definition">¶</a></dt>
<dd><p>Quantile Linear Regression or linear regression
trained with norm <a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Absolute-value_norm">L1</a>. This class inherits from
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/linear_models.LinearRegression.html">sklearn.linear_models.LinearRegression</a>.
See example <a class="reference internal" href="../auto_examples/plot_quantile_regression.html#l-quantile-regression-example"><span class="std std-ref">Quantile Regression</span></a>.</p>
<p>Norm <a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Absolute-value_norm">L1</a> is chosen if <code class="docutils literal notranslate"><span class="pre">quantile=0.5</span></code>, otherwise,
for <em>quantile=</em><img class="math" src="../_images/math/b95278abb7cfa1b57b5d17c35dd868e53945f940.svg" alt="\rho"/>,
the following error is optimized:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/f6352821f3b59949ad2c0bd19b5e743a755b0b08.svg" alt="\sum_i \rho |f(X_i) - Y_i|^- + (1-\rho) |f(X_i) - Y_i|^+"/></p>
</div></div>
<p>where <img class="math" src="../_images/math/5e570bc40c73ba7030ff4afdded8130569800ee6.svg" alt="|f(X_i) - Y_i|^-= \max(Y_i - f(X_i), 0)"/> and
<img class="math" src="../_images/math/bbe4d8ccef1e38da0dfec5c62577d1a02331065b.svg" alt="|f(X_i) - Y_i|^+= \max(f(X_i) - Y_i, 0)"/>.
<img class="math" src="../_images/math/58eb28e3b69092ef230b61d20fecf01320b4cb2b.svg" alt="f(i)"/> is the prediction, <img class="math" src="../_images/math/e63ad1df0bd53729398b2396d31657f135c528dc.svg" alt="Y_i"/> the expected
value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_intercept</strong> – boolean, optional, default True
whether to calculate the intercept for this model. If set
to False, no intercept will be used in calculations
(e.g. data is expected to be already centered).</p></li>
<li><p><strong>copy_X</strong> – boolean, optional, default True
If True, X will be copied; else, it may be overwritten.</p></li>
<li><p><strong>n_jobs</strong> – int, optional, default 1
The number of jobs to use for the computation.
If -1 all CPUs are used. This will only provide speedup for
n_targets &gt; 1 and sufficient large problems.</p></li>
<li><p><strong>max_iter</strong> – int, optional, default 1
The number of iteration to do at training time.
This parameter is specific to the quantile regression.</p></li>
<li><p><strong>delta</strong> – float, optional, default 0.0001
Used to ensure matrices has an inverse
(<em>M + delta*I</em>).</p></li>
<li><p><strong>quantile</strong> – float, by default 0.5,
determines which quantile to use
to estimate the regression.</p></li>
<li><p><strong>positive</strong> – when set to True, forces the coefficients to be positive.</p></li>
<li><p><strong>verbose</strong> – bool, optional, default False
Prints error at each iteration of the optimisation.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_regression.html#QuantileLinearRegression.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits a linear model with <a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Absolute-value_norm">L1</a> norm which
is equivalent to a quantile regression.
The implementation is not the most efficient
as it calls multiple times method fit
from <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/linear_models.LinearRegression.html">sklearn.linear_models.LinearRegression</a>.
Data gets checked and rescaled each time.
The optimization follows the algorithm
<a class="reference external" href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">Iteratively reweighted least squares</a>.
It is described in French at
<a class="reference external" href="http://www.xavierdupre.fr/app/ensae_teaching_cs/helpsphinx/notebooks/td_note_2017_2.html">Régression quantile</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – numpy array or sparse matrix of shape [n_samples,n_features]
Training data</p></li>
<li><p><strong>y</strong> – numpy array of shape [n_samples, n_targets]
Target values. Will be cast to X’s dtype if necessary</p></li>
<li><p><strong>sample_weight</strong> – numpy array of shape [n_samples]
Individual weights for each sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self, returns an instance of self.</p>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>coef_</cite>: array, shape (n_features, ) or (n_targets, n_features)</dt><dd><p>Estimated coefficients for the linear regression problem.
If multiple targets are passed during the fit (y 2D), this
is a 2D array of shape (n_targets, n_features), while if only
one target is passed, this is a 1D array of length n_features.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>intercept_</cite>: array</dt><dd><p>Independent term in the linear model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>n_iter_</cite>: int</dt><dd><p>Number of iterations at training time.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_regression.html#QuantileLinearRegression.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.score" title="Link to this definition">¶</a></dt>
<dd><p>Returns Mean absolute error regression loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – array-like, shape = (n_samples, n_features)
Test samples.</p></li>
<li><p><strong>y</strong> – array-like, shape = (n_samples) or (n_samples, n_outputs)
True values for X.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape = [n_samples], optional
Sample weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>score : float
mean absolute error regression loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression" title="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression"><span class="pre">QuantileLinearRegression</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id33">
<h4>Parameters<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id34">
<h4>Returns<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression" title="mlinsights.mlmodel.quantile_regression.QuantileLinearRegression"><span class="pre">QuantileLinearRegression</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id35">
<h4>Parameters<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id36">
<h4>Returns<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="transformedtargetclassifier2">
<h3>TransformedTargetClassifier2<a class="headerlink" href="#transformedtargetclassifier2" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.target_predictors.</span></span><span class="sig-name descname"><span class="pre">TransformedTargetClassifier2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2" title="Link to this definition">¶</a></dt>
<dd><p>Meta-estimator to classify on a transformed target.
Useful for applying permutation transformation in classification
problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> – object, default=LogisticRegression()
Classifier object such as derived from <code class="docutils literal notranslate"><span class="pre">ClassifierMixin</span></code>. This
classifier will automatically be cloned each time prior to fitting.</p></li>
<li><p><strong>transformer</strong> – str or object of type <a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer" title="mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseReciprocalTransformer</span></code></a>
Transforms the features.</p></li>
</ul>
</dd>
</dl>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformedTargetClassifier2</span>

<span class="n">tt</span> <span class="o">=</span> <span class="n">TransformedTargetClassifier2</span><span class="p">(</span>
    <span class="n">classifier</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">(),</span> <span class="n">transformer</span><span class="o">=</span><span class="s2">&quot;permute&quot;</span>
<span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">classifier_</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">TransformedTargetClassifier2</span><span class="p">(</span><span class="n">classifier</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">(),</span>
                                 <span class="n">transformer</span><span class="o">=</span><span class="s1">&#39;permute&#39;</span><span class="p">)</span>
    <span class="mf">0.5</span>
    <span class="p">[[</span><span class="mf">0.453</span><span class="p">]]</span>
</pre></div>
</div>
<p>See example <a class="reference internal" href="../auto_examples/plot_sklearn_transformed_target.html#l-sklearn-transformed-target"><span class="std std-ref">Transformed Target</span></a> for a more complete example.</p>
<p>The class holds two attributes <cite>classifier_</cite>, the fitted classifier,
<cite>transformer_</cite> transformer used in <code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">predict</span></code>,
<code class="docutils literal notranslate"><span class="pre">decision_function</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.classes_">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classes_</span></span><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.classes_" title="Link to this definition">¶</a></dt>
<dd><p>Returns the classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.decision_function">
<span class="sig-name descname"><span class="pre">decision_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2.decision_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.decision_function" title="Link to this definition">¶</a></dt>
<dd><p>Predicts using the base classifier, applying inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix}, shape = (n_samples, n_features)
Samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>raw score : array, shape = (n_samples, ?)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits the model according to the given training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – {array-like, sparse matrix}, shape (n_samples, n_features)
Training vector, where n_samples is the number of samples and
n_features is the number of features.</p></li>
<li><p><strong>y</strong> – array-like, shape (n_samples,)
Target values.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape (n_samples,) optional
Array of weights that are assigned to individual samples.
If not provided, then each sample is given unit weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self, object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predicts using the base classifier, applying inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix}, shape = (n_samples, n_features)
Samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y_hat, array, shape = (n_samples,)
Predicted values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict_proba" title="Link to this definition">¶</a></dt>
<dd><p>Predicts using the base classifier, applying inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix}, shape = (n_samples, n_features)
Samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predict probabilities, array, shape = (n_samples, n_classes)
Predicted values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetClassifier2.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.score" title="Link to this definition">¶</a></dt>
<dd><p>Scores the model with
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/metrics.accuracy_score.html">sklearn.metrics.accuracy_score</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2" title="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2"><span class="pre">TransformedTargetClassifier2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id37">
<h4>Parameters<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id38">
<h4>Returns<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2" title="mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2"><span class="pre">TransformedTargetClassifier2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id39">
<h4>Parameters<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id40">
<h4>Returns<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="transformedtargetregressor2">
<h3>TransformedTargetRegressor2<a class="headerlink" href="#transformedtargetregressor2" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.target_predictors.</span></span><span class="sig-name descname"><span class="pre">TransformedTargetRegressor2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetRegressor2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2" title="Link to this definition">¶</a></dt>
<dd><p>Meta-estimator to regress on a transformed target.
Useful for applying a non-linear transformation in regression
problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor</strong> – object, <cite>default=LinearRegression()</cite>
Regressor object such as derived from <code class="docutils literal notranslate"><span class="pre">RegressorMixin</span></code>. This
regressor will automatically be cloned each time prior to fitting.</p></li>
<li><p><strong>transformer</strong> – str or object of type <a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer" title="mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseReciprocalTransformer</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformedTargetRegressor2</span>

<span class="n">tt</span> <span class="o">=</span> <span class="n">TransformedTargetRegressor2</span><span class="p">(</span><span class="n">regressor</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">transformer</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">regressor_</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">TransformedTargetRegressor2</span><span class="p">(</span><span class="n">regressor</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">transformer</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="mf">1.0</span>
    <span class="p">[</span><span class="mf">2.</span><span class="p">]</span>
</pre></div>
</div>
<p>See example <a class="reference internal" href="../auto_examples/plot_sklearn_transformed_target.html#l-sklearn-transformed-target"><span class="std std-ref">Transformed Target</span></a> for a more complete example.</p>
<p>The class holds two attributes <cite>regressor_</cite>, the fitted regressor,
<cite>transformer_</cite> transformer used in <code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">predict</span></code>,
<code class="docutils literal notranslate"><span class="pre">decision_function</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetRegressor2.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits the model according to the given training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – {array-like, sparse matrix}, shape (n_samples, n_features)
Training vector, where n_samples is the number of samples and
n_features is the number of features.</p></li>
<li><p><strong>y</strong> – array-like, shape (n_samples,)
Target values.</p></li>
<li><p><strong>sample_weight</strong> – array-like, shape (n_samples,) optional
Array of weights that are assigned to individual samples.
If not provided, then each sample is given unit weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self, object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetRegressor2.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predicts using the base regressor, applying inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – {array-like, sparse matrix}, shape = (n_samples, n_features)
Samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y_hat : array, shape = (n_samples,)
Predicted values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/target_predictors.html#TransformedTargetRegressor2.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.score" title="Link to this definition">¶</a></dt>
<dd><p>Scores the model with
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/metrics.r2_score.html">sklearn.metrics.r2_score</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2" title="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2"><span class="pre">TransformedTargetRegressor2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id41">
<h4>Parameters<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id42">
<h4>Returns<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2" title="mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2"><span class="pre">TransformedTargetRegressor2</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id43">
<h4>Parameters<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</section>
<section id="id44">
<h4>Returns<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="transforms">
<h2>Transforms<a class="headerlink" href="#transforms" title="Link to this heading">¶</a></h2>
<section id="ngramsmixin">
<h3>NGramsMixin<a class="headerlink" href="#ngramsmixin" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_text.NGramsMixin">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_text.</span></span><span class="sig-name descname"><span class="pre">NGramsMixin</span></span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_text.html#NGramsMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_text.NGramsMixin" title="Link to this definition">¶</a></dt>
<dd><p>Overloads method <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/feature_extraction/text.py#L148">_word_ngrams</a>
to get tuples instead of string in member <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">vocabulary_</a>.
of <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">TfidfVectorizer</a> or <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>.
It contains the list of n-grams used to process documents.
See <a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.TraceableCountVectorizer" title="mlinsights.mlmodel.sklearn_text.TraceableCountVectorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraceableCountVectorizer</span></code></a> and <a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer" title="mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraceableTfidfVectorizer</span></code></a>
for example.</p>
</dd></dl>

</section>
<section id="basereciprocaltransformer">
<h3>BaseReciprocalTransformer<a class="headerlink" href="#basereciprocaltransformer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_transform_inv.</span></span><span class="sig-name descname"><span class="pre">BaseReciprocalTransformer</span></span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv.html#BaseReciprocalTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer" title="Link to this definition">¶</a></dt>
<dd><p>Base for transform which transforms the features
and the targets at the same time. It must also
return another transform which transforms the target
back to what it was.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.get_fct_inv">
<span class="sig-name descname"><span class="pre">get_fct_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv.html#BaseReciprocalTransformer.get_fct_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.get_fct_inv" title="Link to this definition">¶</a></dt>
<dd><p>Returns a trained transform which reverse the target
after a predictor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv.html#BaseReciprocalTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms <em>X</em> and <em>y</em>.
Returns transformed <em>X</em> and <em>y</em>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="categoriestointegers">
<h3>CategoriesToIntegers<a class="headerlink" href="#categoriestointegers" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.categories_to_integers.</span></span><span class="sig-name descname"><span class="pre">CategoriesToIntegers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/categories_to_integers.html#CategoriesToIntegers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers" title="Link to this definition">¶</a></dt>
<dd><p>Does something similar to what
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.DictVectorizer.html">DictVectorizer</a>
does but in a transformer. The method <em>fit</em> retains all categories,
the method <em>transform</em> transforms categories into integers.
Categories are sorted by columns. If the method <em>transform</em> tries to convert
a categories which was not seen by method <em>fit</em>, it can raise an exception
or ignore it and replace it by zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – specify a columns selection</p></li>
<li><p><strong>remove</strong> – modalities to remove</p></li>
<li><p><strong>skip_errors</strong> – skip when a new categories appear (no 1)</p></li>
<li><p><strong>single</strong> – use a single column per category, do not multiply them for each value</p></li>
</ul>
</dd>
</dl>
<p>The logging function displays a message when a new dense and big matrix
is created when it should be sparse. A sparse matrix should be allocated instead.</p>
<div class="admonition-exref admonition" id="indexexref-sklearn0">
<p class="admonition-title">DictVectorizer or CategoriesToIntegers</p>
<p>Example which transforms text into integers:</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">CategoriesToIntegers</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s2">&quot;cat&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cat&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">}])</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">CategoriesToIntegers</span><span class="p">()</span>
<span class="n">trans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">newdf</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newdf</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="n">cat</span><span class="o">=</span><span class="n">a</span>  <span class="n">cat</span><span class="o">=</span><span class="n">b</span>
    <span class="mi">0</span>    <span class="mf">1.0</span>    <span class="n">NaN</span>
    <span class="mi">1</span>    <span class="n">NaN</span>    <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/categories_to_integers.html#CategoriesToIntegers.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit" title="Link to this definition">¶</a></dt>
<dd><p>Makes the list of all categories in input <em>X</em>.
<em>X</em> must be a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – iterable
Training data</p></li>
<li><p><strong>y</strong> – iterable, default=None
Training targets.</p></li>
<li><p><strong>fit_params</strong> – additional fit params</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/categories_to_integers.html#CategoriesToIntegers.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit_transform" title="Link to this definition">¶</a></dt>
<dd><p>Fits and transforms categories in numerical features based on the list
of categories found by method <em>fit</em>.
<em>X</em> must be a dataframe. The function does not preserve
the order of the columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – iterable
Training data</p></li>
<li><p><strong>y</strong> – iterable, default=None
Training targets.</p></li>
<li><p><strong>fit_params</strong> – additional fitting parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe, <em>X</em> with categories.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/categories_to_integers.html#CategoriesToIntegers.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms categories in numerical features based on the list
of categories found by method <em>fit</em>.
<em>X</em> must be a dataframe. The function does not preserve
the order of the columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – iterable
Training data</p></li>
<li><p><strong>y</strong> – iterable, default=None
Training targets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame, <em>X</em> with categories.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="extendedfeatures">
<h3>ExtendedFeatures<a class="headerlink" href="#extendedfeatures" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.extended_features.ExtendedFeatures">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.extended_features.</span></span><span class="sig-name descname"><span class="pre">ExtendedFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'poly'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_interaction_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_include_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/extended_features.html#ExtendedFeatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures" title="Link to this definition">¶</a></dt>
<dd><p>Generates extended features such as polynomial features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> – string
<code class="docutils literal notranslate"><span class="pre">'poly'</span></code> for polynomial features,
<code class="docutils literal notranslate"><span class="pre">'poly-slow'</span></code> for polynomial features in <em>scikit-learn 0.20.2</em></p></li>
<li><p><strong>poly_degree</strong> – integer
The degree of the polynomial features. Default = 2.</p></li>
<li><p><strong>poly_interaction_only</strong> – boolean
If true, only interaction features are produced: features that
are products of at most degree distinct input features
(so not <code class="docutils literal notranslate"><span class="pre">x[1]</span> <span class="pre">**</span> <span class="pre">2,</span> <span class="pre">x[0]</span> <span class="pre">*</span> <span class="pre">x[2]</span> <span class="pre">**</span> <span class="pre">3</span></code>, etc.).</p></li>
<li><p><strong>poly_include_bias</strong> – boolean
If True (default), then include a bias column, the feature in
which all polynomial powers are zero (i.e. a column of ones -
acts as an intercept term in a linear model).</p></li>
</ul>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>n_input_features_</cite>: int</dt><dd><p>The total number of input features.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>n_output_features_</cite>: int</dt><dd><p>The total number of polynomial output features. The number of output
features is computed by iterating over all suitably sized combinations
of input features.</p>
</dd>
</dl>
</li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.extended_features.ExtendedFeatures.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/extended_features.html#ExtendedFeatures.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.fit" title="Link to this definition">¶</a></dt>
<dd><p>Compute number of output features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – array-like, shape (n_samples, n_features)
The data.</p></li>
<li><p><strong>y</strong> – targets</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self : instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.extended_features.ExtendedFeatures.get_feature_names_out">
<span class="sig-name descname"><span class="pre">get_feature_names_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/extended_features.html#ExtendedFeatures.get_feature_names_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.get_feature_names_out" title="Link to this definition">¶</a></dt>
<dd><p>Returns feature names for output features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_features</strong> – list of string, length n_features, optional
String names for input features if available. By default,
“x0”, “x1”, … “xn_features” is used.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output_feature_names : list of string, length n_output_features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.extended_features.ExtendedFeatures.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/extended_features.html#ExtendedFeatures.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms data to extended features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – array-like, shape [n_samples, n_features]
The data to transform, row by row.
rns</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="functionreciprocaltransformer">
<h3>FunctionReciprocalTransformer<a class="headerlink" href="#functionreciprocaltransformer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_transform_inv_fct.</span></span><span class="sig-name descname"><span class="pre">FunctionReciprocalTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fct_inv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#FunctionReciprocalTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer" title="Link to this definition">¶</a></dt>
<dd><p>The transform is used to apply a function on a the target,
predict, then transform the target back before scoring.
The transforms implements a series of predefined functions:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fct</strong> – function name of numerical function</p></li>
<li><p><strong>fct_inv</strong> – optional if <em>fct</em> is a function name,
reciprocal function otherwise</p></li>
</ul>
</dd>
</dl>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel.sklearn_transform_inv_fct</span><span class="w"> </span><span class="kn">import</span> <span class="n">FunctionReciprocalTransformer</span>

<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">FunctionReciprocalTransformer</span><span class="o">.</span><span class="n">available_fcts</span><span class="p">())</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span><span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">ufunc</span> <span class="s1">&#39;exp&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">),</span>
     <span class="s1">&#39;exp(x)-1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">FunctionReciprocalTransformer</span><span class="o">.</span><span class="n">available_fcts</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x744b82c76a20</span><span class="o">&gt;</span><span class="p">,</span>
                  <span class="s1">&#39;log&#39;</span><span class="p">),</span>
     <span class="s1">&#39;expm1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">ufunc</span> <span class="s1">&#39;expm1&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;log1p&#39;</span><span class="p">),</span>
     <span class="s1">&#39;log&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">ufunc</span> <span class="s1">&#39;log&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">),</span>
     <span class="s1">&#39;log(1+x)&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">FunctionReciprocalTransformer</span><span class="o">.</span><span class="n">available_fcts</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x744b82c76ca0</span><span class="o">&gt;</span><span class="p">,</span>
                  <span class="s1">&#39;exp(x)-1&#39;</span><span class="p">),</span>
     <span class="s1">&#39;log1p&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">ufunc</span> <span class="s1">&#39;log1p&#39;</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;expm1&#39;</span><span class="p">)}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.available_fcts">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">available_fcts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#FunctionReciprocalTransformer.available_fcts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.available_fcts" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of predefined functions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#FunctionReciprocalTransformer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.fit" title="Link to this definition">¶</a></dt>
<dd><p>Just defines <em>fct</em> and <em>fct_inv</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.get_fct_inv">
<span class="sig-name descname"><span class="pre">get_fct_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#FunctionReciprocalTransformer.get_fct_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.get_fct_inv" title="Link to this definition">¶</a></dt>
<dd><p>Returns a trained transform which reverse the target
after a predictor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer" title="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer"><span class="pre">FunctionReciprocalTransformer</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id45">
<h4>Parameters<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id46">
<h4>Returns<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#FunctionReciprocalTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms <em>X</em> and <em>y</em>.
Returns transformed <em>X</em> and <em>y</em>.
If <em>y</em> is None, the returned value for <em>y</em>
is None as well.</p>
</dd></dl>

</dd></dl>

</section>
<section id="permutationreciprocaltransformer">
<h3>PermutationReciprocalTransformer<a class="headerlink" href="#permutationreciprocaltransformer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_transform_inv_fct.</span></span><span class="sig-name descname"><span class="pre">PermutationReciprocalTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#PermutationReciprocalTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer" title="Link to this definition">¶</a></dt>
<dd><p>The transform is used to permute targets,
predict, then permute the target back before scoring.
nan values remain nan values. Once fitted, the transform
has attribute <code class="docutils literal notranslate"><span class="pre">permutation_</span></code> which keeps
track of the permutation to apply.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>random_state</strong> – random state</p></li>
<li><p><strong>closest</strong> – if True, finds the closest permuted element</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#PermutationReciprocalTransformer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.fit" title="Link to this definition">¶</a></dt>
<dd><p>Defines a random permutation over the targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.get_fct_inv">
<span class="sig-name descname"><span class="pre">get_fct_inv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#PermutationReciprocalTransformer.get_fct_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.get_fct_inv" title="Link to this definition">¶</a></dt>
<dd><p>Returns a trained transform which reverse the target
after a predictor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer" title="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer"><span class="pre">PermutationReciprocalTransformer</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id47">
<h4>Parameters<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id48">
<h4>Returns<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_transform_inv_fct.html#PermutationReciprocalTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transforms <em>X</em> and <em>y</em>.
Returns transformed <em>X</em> and <em>y</em>.
If <em>y</em> is None, the returned value for <em>y</em>
is None as well.</p>
</dd></dl>

</dd></dl>

</section>
<section id="predictabletsne">
<h3>PredictableTSNE<a class="headerlink" href="#predictabletsne" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.predictable_tsne.PredictableTSNE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.predictable_tsne.</span></span><span class="sig-name descname"><span class="pre">PredictableTSNE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_tsne_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/predictable_tsne.html#PredictableTSNE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://lvdmaaten.github.io/tsne/">t-SNE</a> is an interesting
transform which can only be used to study data as there is no
way to reproduce the result once it was fitted. That’s why
the class <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">TSNE</a> does not have any method <em>transform</em>, only
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html#sklearn.manifold.TSNE.fit_transform">fit_transform</a>.
This example proposes a way to train a machine learned model
which approximates the outputs of a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">TSNE</a> transformer.
Example <a class="reference internal" href="../auto_examples/plot_predictable_tsne.html#l-predictable-tsne-example"><span class="std std-ref">Predictable t-SNE</span></a> gives an example on how to
use this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalizer</strong> – None by default</p></li>
<li><p><strong>transformer</strong> – <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/manifold.TSNE.html">sklearn.manifold.TSNE</a> by default</p></li>
<li><p><strong>estimator</strong> – <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/neural_network.MLPRegressor.html">sklearn.neural_network.MLPRegressor</a> by default</p></li>
<li><p><strong>normalize</strong> – normalizes the outputs, centers and normalizes
the output of the <em>t-SNE</em> and applies that same
normalization to he prediction of the estimator</p></li>
<li><p><strong>keep_tsne_outputs</strong> – if True, keep raw outputs of
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">TSNE</a> is stored in member <cite>tsne_outputs_</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.predictable_tsne.PredictableTSNE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/predictable_tsne.html#PredictableTSNE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.fit" title="Link to this definition">¶</a></dt>
<dd><p>Trains a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">TSNE</a> then trains an estimator
to approximate its outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – numpy array or sparse matrix of shape [n_samples,n_features]
Training data</p></li>
<li><p><strong>y</strong> – numpy array of shape [n_samples, n_targets]
Target values. Will be cast to X’s dtype if necessary</p></li>
<li><p><strong>sample_weight</strong> – numpy array of shape [n_samples]
Individual weights for each sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self, returns an instance of self.</p>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><p><cite>normalizer_</cite>: trained normalier</p></li>
<li><p><cite>transformer_</cite>: trained transformeer</p></li>
<li><p><cite>estimator_</cite>: trained regressor</p></li>
<li><p><cite>tsne_outputs_</cite>: t-SNE outputs if <em>keep_tsne_outputs</em> is True</p></li>
<li><p><cite>mean_</cite>: average of the <em>t-SNE</em> output on each dimension</p></li>
<li><p><cite>inv_std_</cite>: inverse of the standard deviation of the <em>t-SNE</em>
output on each dimension</p></li>
<li><p><cite>loss_</cite>: loss (<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/metrics.mean_squared_error.html">sklearn.metrics.mean_squared_error</a>)
between the predictions
and the outputs of t-SNE</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.predictable_tsne.PredictableTSNE.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE" title="mlinsights.mlmodel.predictable_tsne.PredictableTSNE"><span class="pre">PredictableTSNE</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id49">
<h4>Parameters<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id50">
<h4>Returns<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.predictable_tsne.PredictableTSNE.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/predictable_tsne.html#PredictableTSNE.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.transform" title="Link to this definition">¶</a></dt>
<dd><p>Runs the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – numpy array or sparse matrix of shape [n_samples,n_features]
Training data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tranformed <em>X</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="transfertransformer">
<h3>TransferTransformer<a class="headerlink" href="#transfertransformer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.transfer_transformer.TransferTransformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.transfer_transformer.</span></span><span class="sig-name descname"><span class="pre">TransferTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/transfer_transformer.html#TransferTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer" title="Link to this definition">¶</a></dt>
<dd><p>Wraps a predictor or a transformer in a transformer.
This model is frozen: it cannot be trained and only
computes the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimator</strong> – estimator to wrap in a transformer, it is clone
with the training data (deep copy) when fitted</p></li>
<li><p><strong>method</strong> – if None, guess what method should be called,
<em>transform</em> for a transformer,
<em>predict_proba</em> for a classifier,
<em>decision_function</em> if found,
<em>predict</em> otherwiser</p></li>
<li><p><strong>copy_estimator</strong> – copy the model instead of taking a reference</p></li>
<li><p><strong>trainable</strong> – the transfered model must be trained</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.transfer_transformer.TransferTransformer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/transfer_transformer.html#TransferTransformer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.fit" title="Link to this definition">¶</a></dt>
<dd><p>The function does nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – unused</p></li>
<li><p><strong>y</strong> – unused</p></li>
<li><p><strong>sample_weight</strong> – unused</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>self: returns an instance of self.</p>
</dd>
</dl>
<p>Fitted attributes:</p>
<ul class="simple">
<li><p><cite>estimator_</cite>: already trained estimator</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.transfer_transformer.TransferTransformer.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer" title="mlinsights.mlmodel.transfer_transformer.TransferTransformer"><span class="pre">TransferTransformer</span></a></span></span><a class="headerlink" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Configure whether metadata should be requested to be passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant when this estimator is used as a
sub-estimator within a <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-meta-estimator" title="(in scikit-learn v1.7)"><span class="xref std std-term">meta-estimator</span></a> and metadata routing is enabled
with <code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="(in scikit-learn v1.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code></a>).
Please check the <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html#metadata-routing" title="(in scikit-learn v1.7)"><span class="xref std std-ref">User Guide</span></a> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<section id="id51">
<h4>Parameters<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sample_weight<span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</section>
<section id="id52">
<h4>Returns<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>self<span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlinsights.mlmodel.transfer_transformer.TransferTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/transfer_transformer.html#TransferTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.transform" title="Link to this definition">¶</a></dt>
<dd><p>Runs the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – numpy array or sparse matrix of shape [n_samples,n_features]
Training data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tranformed <em>X</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="traceablecountvectorizer">
<h3>TraceableCountVectorizer<a class="headerlink" href="#traceablecountvectorizer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_text.TraceableCountVectorizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_text.</span></span><span class="sig-name descname"><span class="pre">TraceableCountVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input='content'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding='utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_error='strict'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strip_accents=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowercase=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessor=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_words=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_pattern='(?u)\\b\\w\\w+\\b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range=(1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyzer='word'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_df=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_df=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.int64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_text.html#TraceableCountVectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_text.TraceableCountVectorizer" title="Link to this definition">¶</a></dt>
<dd><p>Inherits from <a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.NGramsMixin" title="mlinsights.mlmodel.sklearn_text.NGramsMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">NGramsMixin</span></code></a>
which overloads method <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/feature_extraction/text.py#L148">_word_ngrams</a>
to keep more information about n-grams but still produces the same
outputs than <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html">CountVectorizer</a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel.sklearn_text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TraceableCountVectorizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pformat</span>

<span class="n">corpus</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="s2">&quot;This is the first document.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;This document is the second document.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Is this the first document?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CountVectorizer from scikit-learn&quot;</span><span class="p">)</span>
<span class="n">mod1</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">mod1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod1</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()[:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">mod1</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)[:</span><span class="mi">100</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TraceableCountVectorizer from scikit-learn&quot;</span><span class="p">)</span>
<span class="n">mod2</span> <span class="o">=</span> <span class="n">TraceableCountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">mod2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod2</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()[:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">mod2</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">CountVectorizer</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scikit</span><span class="o">-</span><span class="n">learn</span>
    <span class="p">[[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
     <span class="p">[</span><span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]]</span>
    <span class="p">{</span><span class="s1">&#39;document&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s1">&#39;document is&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s1">&#39;first document&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
     <span class="s1">&#39;is&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s1">&#39;is the&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
     <span class="s1">&#39;is t</span>
    <span class="n">TraceableCountVectorizer</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scikit</span><span class="o">-</span><span class="n">learn</span>
    <span class="p">[[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
     <span class="p">[</span><span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]]</span>
    <span class="p">{(</span><span class="s1">&#39;document&#39;</span><span class="p">,):</span> <span class="mi">0</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,):</span> <span class="mi">2</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;document&#39;</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39;is&#39;</span><span class="p">,):</span> <span class="mi">4</span><span class="p">,</span>
</pre></div>
</div>
<p>A weirder example with
<a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer" title="mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TraceableTfidfVectorizer</span></code></a> shows more differences.</p>
</dd></dl>

</section>
<section id="traceabletfidfvectorizer">
<h3>TraceableTfidfVectorizer<a class="headerlink" href="#traceabletfidfvectorizer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.sklearn_text.</span></span><span class="sig-name descname"><span class="pre">TraceableTfidfVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input='content'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding='utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_error='strict'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strip_accents=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowercase=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessor=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyzer='word'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_words=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_pattern='(?u)\\b\\w\\w+\\b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range=(1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_df=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_df=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm='l2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_idf=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_idf=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublinear_tf=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/sklearn_text.html#TraceableTfidfVectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer" title="Link to this definition">¶</a></dt>
<dd><p>Inherits from <a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.NGramsMixin" title="mlinsights.mlmodel.sklearn_text.NGramsMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">NGramsMixin</span></code></a>
which overloads method <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/feature_extraction/text.py#L148">_word_ngrams</a>
to keep more information about n-grams but still produces the same
outputs than <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">TfidfVectorizer</a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlinsights.mlmodel.sklearn_text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TraceableTfidfVectorizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pformat</span>

<span class="n">corpus</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="s2">&quot;This is the first document.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;This document is the second document.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Is this the first document?&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TfidfVectorizer from scikit-learn&quot;</span><span class="p">)</span>
<span class="n">mod1</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">token_pattern</span><span class="o">=</span><span class="s2">&quot;[a-zA-Z ]{1,4}&quot;</span><span class="p">)</span>
<span class="n">mod1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod1</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()[:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">mod1</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)[:</span><span class="mi">100</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TraceableTfidfVectorizer from scikit-learn&quot;</span><span class="p">)</span>
<span class="n">mod2</span> <span class="o">=</span> <span class="n">TraceableTfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">token_pattern</span><span class="o">=</span><span class="s2">&quot;[a-zA-Z ]{1,4}&quot;</span><span class="p">)</span>
<span class="n">mod2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod2</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()[:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">mod2</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">TfidfVectorizer</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scikit</span><span class="o">-</span><span class="n">learn</span>
    <span class="p">[[</span><span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.329</span> <span class="mf">0.329</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>
      <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>
      <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.329</span> <span class="mf">0.</span>    <span class="mf">0.</span>   <span class="p">]</span>
     <span class="p">[</span><span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span>
      <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>
      <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.193</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span><span class="p">]]</span>
    <span class="p">{</span><span class="s1">&#39; doc&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s1">&#39; doc umen&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s1">&#39; is &#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s1">&#39; is  the &#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
     <span class="s1">&#39; sec&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s1">&#39; sec ond &#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
     <span class="s1">&#39; the&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
     
    <span class="n">TraceableTfidfVectorizer</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scikit</span><span class="o">-</span><span class="n">learn</span>
    <span class="p">[[</span><span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.329</span> <span class="mf">0.329</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>
      <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>
      <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.26</span>  <span class="mf">0.</span>    <span class="mf">0.329</span> <span class="mf">0.</span>    <span class="mf">0.</span>   <span class="p">]</span>
     <span class="p">[</span><span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span>
      <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>
      <span class="mf">0.245</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.</span>    <span class="mf">0.193</span> <span class="mf">0.245</span> <span class="mf">0.</span>    <span class="mf">0.245</span> <span class="mf">0.245</span><span class="p">]]</span>
    <span class="p">{(</span><span class="s1">&#39; doc&#39;</span><span class="p">,):</span> <span class="mi">0</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39; doc&#39;</span><span class="p">,</span> <span class="s1">&#39;umen&#39;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39; is &#39;</span><span class="p">,):</span> <span class="mi">2</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39; is &#39;</span><span class="p">,</span> <span class="s1">&#39;the &#39;</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39; sec&#39;</span><span class="p">,):</span> <span class="mi">4</span><span class="p">,</span>
     <span class="p">(</span><span class="s1">&#39; sec&#39;</span><span class="p">,</span> <span class="s1">&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="exploration-in-c">
<h2>Exploration in C<a class="headerlink" href="#exploration-in-c" title="Link to this heading">¶</a></h2>
<section id="losses">
<h3>Losses<a class="headerlink" href="#losses" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="mlinsights.mlmodel.quantile_mlpregressor.absolute_loss">
<span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel.quantile_mlpregressor.</span></span><span class="sig-name descname"><span class="pre">absolute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/quantile_mlpregressor.html#absolute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel.quantile_mlpregressor.absolute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Computes the absolute loss for regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> – array-like or label indicator matrix
Ground truth (correct) values.</p></li>
<li><p><strong>y_pred</strong> – array-like or label indicator matrix
Predicted values, as returned by a regression estimator.</p></li>
<li><p><strong>sample_weight</strong> – sample weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>loss, float
The degree to which the samples are correctly predicted.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="hidden-api">
<h2>Hidden API<a class="headerlink" href="#hidden-api" title="Link to this heading">¶</a></h2>
<section id="switch-clusters">
<h3>_switch_clusters<a class="headerlink" href="#switch-clusters" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="mlinsights.mlmodel._kmeans_constraint_._switch_clusters">
<span class="sig-prename descclassname"><span class="pre">mlinsights.mlmodel._kmeans_constraint_.</span></span><span class="sig-name descname"><span class="pre">_switch_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlinsights/mlmodel/_kmeans_constraint_.html#_switch_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlinsights.mlmodel._kmeans_constraint_._switch_clusters" title="Link to this definition">¶</a></dt>
<dd><p>Tries to switch clusters.
Modifies <em>labels</em> inplace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – labels</p></li>
<li><p><strong>distances</strong> – distances</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="mlmodel_tree.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">mlinsights.mlmodel (trees)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="batch.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">mlinsights.mlbatch</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2024, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">mlinsights.mlmodel</a><ul>
<li><a class="reference internal" href="#helpers">Helpers</a><ul>
<li><a class="reference internal" href="#model-featurizer">model_featurizer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.ml_featurizer.model_featurizer"><code class="docutils literal notranslate"><span class="pre">model_featurizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#clustering">Clustering</a><ul>
<li><a class="reference internal" href="#constraintkmeans">ConstraintKMeans</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.cluster_edges"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.cluster_edges()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.constraint_kmeans"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.constraint_kmeans()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.fit"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.predict"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.score"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.score()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_fit_request"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.set_score_request"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.set_score_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_constraint.ConstraintKMeans.transform"><code class="docutils literal notranslate"><span class="pre">ConstraintKMeans.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#kmeansl1l2">KMeansL1L2</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.fit"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.predict"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_fit_request"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_predict_request"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.set_predict_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.set_score_request"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.set_score_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.kmeans_l1.KMeansL1L2.transform"><code class="docutils literal notranslate"><span class="pre">KMeansL1L2.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#trainers">Trainers</a><ul>
<li><a class="reference internal" href="#classifierafterkmeans">ClassifierAfterKMeans</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.decision_function"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.decision_function()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.fit"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.get_params"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.get_params()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.predict_proba"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.predict_proba()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_fit_request"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_params"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.set_params()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.set_score_request"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.set_score_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.classification_kmeans.ClassifierAfterKMeans.transform_features"><code class="docutils literal notranslate"><span class="pre">ClassifierAfterKMeans.transform_features()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#customizedmultilayerperceptron">CustomizedMultilayerPerceptron</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron"><code class="docutils literal notranslate"><span class="pre">CustomizedMultilayerPerceptron</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.CustomizedMultilayerPerceptron.set_fit_request"><code class="docutils literal notranslate"><span class="pre">CustomizedMultilayerPerceptron.set_fit_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#intervalregressor">IntervalRegressor</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.fit"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.n_estimators_"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.n_estimators_</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_all"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.predict_all()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.predict_sorted"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.predict_sorted()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_fit_request"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.interval_regressor.IntervalRegressor.set_score_request"><code class="docutils literal notranslate"><span class="pre">IntervalRegressor.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#approximatenmfpredictor">ApproximateNMFPredictor</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor"><code class="docutils literal notranslate"><span class="pre">ApproximateNMFPredictor</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.fit"><code class="docutils literal notranslate"><span class="pre">ApproximateNMFPredictor.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.get_params"><code class="docutils literal notranslate"><span class="pre">ApproximateNMFPredictor.get_params()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.predict"><code class="docutils literal notranslate"><span class="pre">ApproximateNMFPredictor.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.anmf_predictor.ApproximateNMFPredictor.set_score_request"><code class="docutils literal notranslate"><span class="pre">ApproximateNMFPredictor.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#piecewiseclassifier">PiecewiseClassifier</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.decision_function"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier.decision_function()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier.predict_proba()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_fit_request"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseClassifier.set_score_request"><code class="docutils literal notranslate"><span class="pre">PiecewiseClassifier.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#piecewiseregressor">PiecewiseRegressor</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor"><code class="docutils literal notranslate"><span class="pre">PiecewiseRegressor</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.predict"><code class="docutils literal notranslate"><span class="pre">PiecewiseRegressor.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_fit_request"><code class="docutils literal notranslate"><span class="pre">PiecewiseRegressor.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.piecewise_estimator.PiecewiseRegressor.set_score_request"><code class="docutils literal notranslate"><span class="pre">PiecewiseRegressor.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#quantilemlpregressor">QuantileMLPRegressor</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor"><code class="docutils literal notranslate"><span class="pre">QuantileMLPRegressor</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.predict"><code class="docutils literal notranslate"><span class="pre">QuantileMLPRegressor.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.score"><code class="docutils literal notranslate"><span class="pre">QuantileMLPRegressor.score()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_fit_request"><code class="docutils literal notranslate"><span class="pre">QuantileMLPRegressor.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.QuantileMLPRegressor.set_score_request"><code class="docutils literal notranslate"><span class="pre">QuantileMLPRegressor.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#quantilelinearregression">QuantileLinearRegression</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression"><code class="docutils literal notranslate"><span class="pre">QuantileLinearRegression</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.fit"><code class="docutils literal notranslate"><span class="pre">QuantileLinearRegression.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.score"><code class="docutils literal notranslate"><span class="pre">QuantileLinearRegression.score()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_fit_request"><code class="docutils literal notranslate"><span class="pre">QuantileLinearRegression.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_regression.QuantileLinearRegression.set_score_request"><code class="docutils literal notranslate"><span class="pre">QuantileLinearRegression.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#transformedtargetclassifier2">TransformedTargetClassifier2</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.classes_"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.classes_</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.decision_function"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.decision_function()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.fit"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.predict_proba"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.predict_proba()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.score"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.score()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_fit_request"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetClassifier2.set_score_request"><code class="docutils literal notranslate"><span class="pre">TransformedTargetClassifier2.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#transformedtargetregressor2">TransformedTargetRegressor2</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.fit"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.predict"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2.predict()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.score"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2.score()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_fit_request"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.target_predictors.TransformedTargetRegressor2.set_score_request"><code class="docutils literal notranslate"><span class="pre">TransformedTargetRegressor2.set_score_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#transforms">Transforms</a><ul>
<li><a class="reference internal" href="#ngramsmixin">NGramsMixin</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.NGramsMixin"><code class="docutils literal notranslate"><span class="pre">NGramsMixin</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#basereciprocaltransformer">BaseReciprocalTransformer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer"><code class="docutils literal notranslate"><span class="pre">BaseReciprocalTransformer</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.get_fct_inv"><code class="docutils literal notranslate"><span class="pre">BaseReciprocalTransformer.get_fct_inv()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv.BaseReciprocalTransformer.transform"><code class="docutils literal notranslate"><span class="pre">BaseReciprocalTransformer.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#categoriestointegers">CategoriesToIntegers</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers"><code class="docutils literal notranslate"><span class="pre">CategoriesToIntegers</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit"><code class="docutils literal notranslate"><span class="pre">CategoriesToIntegers.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.fit_transform"><code class="docutils literal notranslate"><span class="pre">CategoriesToIntegers.fit_transform()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.categories_to_integers.CategoriesToIntegers.transform"><code class="docutils literal notranslate"><span class="pre">CategoriesToIntegers.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#extendedfeatures">ExtendedFeatures</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures"><code class="docutils literal notranslate"><span class="pre">ExtendedFeatures</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.fit"><code class="docutils literal notranslate"><span class="pre">ExtendedFeatures.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.get_feature_names_out"><code class="docutils literal notranslate"><span class="pre">ExtendedFeatures.get_feature_names_out()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.extended_features.ExtendedFeatures.transform"><code class="docutils literal notranslate"><span class="pre">ExtendedFeatures.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#functionreciprocaltransformer">FunctionReciprocalTransformer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.available_fcts"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer.available_fcts()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.fit"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.get_fct_inv"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer.get_fct_inv()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.set_fit_request"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.FunctionReciprocalTransformer.transform"><code class="docutils literal notranslate"><span class="pre">FunctionReciprocalTransformer.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#permutationreciprocaltransformer">PermutationReciprocalTransformer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer"><code class="docutils literal notranslate"><span class="pre">PermutationReciprocalTransformer</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.fit"><code class="docutils literal notranslate"><span class="pre">PermutationReciprocalTransformer.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.get_fct_inv"><code class="docutils literal notranslate"><span class="pre">PermutationReciprocalTransformer.get_fct_inv()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.set_fit_request"><code class="docutils literal notranslate"><span class="pre">PermutationReciprocalTransformer.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_transform_inv_fct.PermutationReciprocalTransformer.transform"><code class="docutils literal notranslate"><span class="pre">PermutationReciprocalTransformer.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#predictabletsne">PredictableTSNE</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE"><code class="docutils literal notranslate"><span class="pre">PredictableTSNE</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.fit"><code class="docutils literal notranslate"><span class="pre">PredictableTSNE.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.set_fit_request"><code class="docutils literal notranslate"><span class="pre">PredictableTSNE.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.predictable_tsne.PredictableTSNE.transform"><code class="docutils literal notranslate"><span class="pre">PredictableTSNE.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#transfertransformer">TransferTransformer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer"><code class="docutils literal notranslate"><span class="pre">TransferTransformer</span></code></a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.fit"><code class="docutils literal notranslate"><span class="pre">TransferTransformer.fit()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.set_fit_request"><code class="docutils literal notranslate"><span class="pre">TransferTransformer.set_fit_request()</span></code></a></li>
<li><a class="reference internal" href="#mlinsights.mlmodel.transfer_transformer.TransferTransformer.transform"><code class="docutils literal notranslate"><span class="pre">TransferTransformer.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#traceablecountvectorizer">TraceableCountVectorizer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.TraceableCountVectorizer"><code class="docutils literal notranslate"><span class="pre">TraceableCountVectorizer</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#traceabletfidfvectorizer">TraceableTfidfVectorizer</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.sklearn_text.TraceableTfidfVectorizer"><code class="docutils literal notranslate"><span class="pre">TraceableTfidfVectorizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#exploration-in-c">Exploration in C</a><ul>
<li><a class="reference internal" href="#losses">Losses</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel.quantile_mlpregressor.absolute_loss"><code class="docutils literal notranslate"><span class="pre">absolute_loss()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#hidden-api">Hidden API</a><ul>
<li><a class="reference internal" href="#switch-clusters">_switch_clusters</a><ul>
<li><a class="reference internal" href="#mlinsights.mlmodel._kmeans_constraint_._switch_clusters"><code class="docutils literal notranslate"><span class="pre">_switch_clusters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=f39d245f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>