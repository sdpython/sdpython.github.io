<!doctype html>
<html class="no-js" lang="fr" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Recherche" href="../../search.html" /><link rel="next" title="Interfaces graphiques" href="../c_gui/index.html" /><link rel="prev" title="Parallélisation" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Threads - Documentation teachpyx 0.4.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Documentation teachpyx 0.4.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation teachpyx 0.4.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Le langage Python</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Le langage Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_lang/index.html">Variables et fonctions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Variables et fonctions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/types.html">Types et variables du langage python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/syntaxe.html">Syntaxe du langage Python (boucles, tests, fonctions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/constructions.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/collections.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/dates.html">Dates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_lang/encoding.html">Encoding et jeux de caractères</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_classes/index.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_classes/classes.html">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_classes/questions.html">Questions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_exception/index.html">Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Exceptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_exception/exception.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_exception/exception_ext.html">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_exception/warning.html">Warning et logging</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_module/index.html">Entrées, Sorties, Modules</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Entrées, Sorties, Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_module/files.html">Fichiers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../c_module/serialization.html">Sérialisation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Sérialisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../c_module/module.html">Module ou extension</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_regex/index.html">Expressions régulières</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Expressions régulières</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_regex/regex.html">Expressions régulières</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Parallélisation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parallélisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Threads</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_gui/index.html">Interfaces graphiques</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Interfaces graphiques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_gui/tkinter.html">tkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_data/index.html">Matrices et DataFrames</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Matrices et DataFrames</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/matrices.html">Calcul matriciel</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Calcul matriciel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_array.html">Calcul Matriciel, Optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_numpy.html">Calcul matriciel avec numpy (exercices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/numpy_broadcast.html">Numpy et tableau de contingence</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/dataframes.html">Dataframes</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Dataframes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_dataframe.html">DataFrame et Graphes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_pandas.html">Manipulation de données avec pandas (exercices)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/graphes.html">Graphes</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Graphes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/enedis_cartes.html">Tracer une carte en Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_ml/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_ml/rappel.html">Quelques rappels</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_resume/index.html">Précis</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Précis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_resume/python_sheet.html">Cheat sheet: Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_resume/conseil_programmes.html">Quelques conseils pour écrire un programme</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_resume/cheat_sheet.html">Cheat Sheets</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Cheat Sheets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/git.html">Cheat Sheet on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/linux.html">Cheat Sheet on Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/jenkins.html">Cheat Sheet on Jenkins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../articles/index.html">Collections d’articles périssables</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Collections d’articles périssables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023-11-31-route2023.html">2023-11-31 : rappel feuille de route 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023-09-06-ensae.html">2023-09-06 : ENSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023-08-09-hermionne.html">2023-08-09 : l’énigme d’Hermionne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023-08-03-code-jam.html">2023-08-03 : Code Jam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022-11-31-route2022.html">2022-11-31 : rappel feuille de route 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022-12-07-cartopy.html">2022-12-07 : Utilisation de cartopy sous Windows (sous WSL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022-01-01-assurance.html">Assurance auto</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exercices</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/index_python.html">Exercices sur le langage python</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Exercices sur le langage python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/code_liste_tuple.html">Liste, tuple, ensemble, dictionnaire, liste chaînée, coût des opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/nbheap.html">Heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/structures_donnees_conversion.html">D’une structure de données à l’autre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/recherche_dichotomique.html">Recherche dichotomique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/exercice_hash.html">Répartition, table de hashage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classes_metro.html">Un bref aperçu des classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classes_2048.html">2048 et les classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classe_de.html">Jeu de dé, rotation sur un circuit (classes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classe_permutation.html">Classe Permutation et décomposition en transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classe_tree.html">Une classe pour représenter un arbre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classe_iterateur.html">Itérateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/classe_user_p.html">Classe, Héritage, calcule d’une distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/pivot_gauss.html">Pivot de gauss avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/coloriage_carre.html">Jeux de coloriage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/code_multinomial.html">Simuler une loi multinomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/tableau_contingence.html">Calculer un chi 2 sur un tableau de contingence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/tri_nlnd.html">Tri plus rapide que prévu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/histogramme_rapide.html">Histogramme et dictionnaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/exercice_pi.html">Calculs de surface et autres calculs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/de_rotation.html">Jeu de dé, rotation sur un circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/profiling_example.html">Exemple de profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/profile_gini.html">Profiling la fonction Gini</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/profiling_conv.html">Profiling, application à la convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/exercice_regex.html">Expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/exercice_json_xml.html">JSON - XML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/exercice_serialisation_json.html">Sérialisation avec JSON, XML, pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/tests_unitaires.html">Tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/py-base/scrapping.html">Web-Scraping - pokemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/premiers_pas.html">Premiers pas en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/variable_boucle_tests.html">Variables, boucles, tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/dictionnaire_vigenere.html">Dictionnaires, fonctions, code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/module_file_regex.html">Modules, fichiers, expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/integrale_rectangle.html">Intégrale et la méthode des rectangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/j2048.html">2048 - stratégie gagnante</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/texte_langue.html">Deviner la langue d’un texte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/pyramide_bigarree.html">Tracer une pyramide bigarrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/classes_carre_magique.html">Classes, méthodes, attributs, opérateurs et carré magique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/classes_heritage.html">Classes, héritage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/trie.html">Arbre et Trie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/premiers_pas_correction.html">Premiers pas en Python (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/variable_boucle_tests_correction.html">Variables, boucles, tests (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/dictionnaire_vigenere_correction.html">Dictionnaires, fonctions, code de Vigenère (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/module_file_regex_correction.html">Modules, fichiers, expressions régulières (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/integrale_rectangle_correction.html">Intégrale et la méthode des rectangles - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/j2048_correction.html">2048 - stratégie gagnante - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/texte_langue_correction.html">Deviner la langue d’un texte (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/pyramide_bigarree_correction.html">Tracer une pyramide bigarrée - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/classes_carre_magique_correction.html">Classes, méthodes, attributs, opérateurs et carré magique (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/classes_heritage_correction.html">Classes, héritage (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-base/trie_correction.html">Arbre et Trie (correction)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/index_algo.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/matrix_dictionary.html">Produit matriciel avec une matrice creuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_echelle.html">Calculer le nombre de façons de monter une échelle.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_plus_grande_somme.html">La sous-séquence de plus grande somme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_xn.html">Calculer x**n le plus rapidement possible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_topk.html">Les k premiers éléments (top k)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_suffix.html">Jeux de dictionnaires, plus grand suffixe commun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/BJKST.html">Algorithmes de streaming, BJKST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_editdist.html">Distance entre deux mots de même longueur et tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_ordonnancement.html">Problème d’ordonnancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_tsp.html">TSP - Traveling Salesman Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/tsp_simplifie.html">Plus court chemin passant par tous les noeuds d’un graphe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/tsp_aparte.html">Aparté sur le voyageur de commerce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_compose_connexe.html">Graphe et Composantes connexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_random_graph.html">Graphes aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_simulation_covid_simple.html">Modèle épidémiologique (SIRD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-base/exercice_simulation_covid.html">Simulation COVID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-compose/paris_parcours.html">Parcourir les rues de Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-compose/vigenere.html">Casser le code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/algo-compose/exercice_morse.html">Décoder du Morse sans espaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/gentry_integer_encryption.html">Cryptage homomorphic de Craig Gentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/knn_high_dimension.html">Plus proches voisins en grande dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/puzzle_algo_1.html">Puzzles algorithmiques (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/puzzle_algo_2.html">Puzzles algorithmiques (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/plus_court_chemin.html">Programmation dynamique et plus court chemin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/decorrelation.html">Décorrélation de variables aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/graph_spectral_clustering.html">Spectral Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/gentry_integer_encryption_correction.html">Cryptage homomorphic de Craig Gentry - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/knn_high_dimension_correction.html">Plus proches voisins en grande dimension - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/puzzle_algo_1_correction.html">Puzzles algorithmes (1) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/puzzle_algo_2_correction.html">Puzzles algorithmes (2) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/plus_court_chemin_correction.html">Programmation dynamique et plus court chemin (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/decorrelation_correction.html">Décorrélation de variables aléatoires - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/tds-algo/graph_spectral_clustering_correction.html">Spectral Clustering - correction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/index_exam.html">Séances minutées</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Séances minutées</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../practice/exams.html">Exercices minutés</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Exercices minutés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2013_coloriage_correction.html">1A.e - TD noté, 27 novembre 2012 (coloriage, correction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2013_bout_de_code_coloriage.html">1A.e - TD noté, 27 novembre 2012 (éléments de code pour le coloriage)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2015.html">1A.e - TD noté, 5 décembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2015_rattrapage_enonce.html">1A.e - TD noté 2015 rattrapage (énoncé, écrit et oral)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2016.html">1A.e - TD noté, 11 décembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2017.html">1A.e - TD noté, 16 décembre 2016</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2017_2.html">1A.e - TD noté, 21 février 2017</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2018_1.html">1A.e - Enoncé 12 décembre 2017 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2018_2.html">1A.e - Enoncé 12 décembre 2017 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2019_1.html">1A.e - Enoncé 23 octobre 2018 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2019_2.html">1A.e - Enoncé 23 octobre 2018 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2020_1.html">1A.e - Enoncé 22 octobre 2019 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2020_2.html">1A.e - Enoncé 22 octobre 2019 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2021.html">1A - Enoncé 24 novembre 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2022.html">1A - Enoncé 3 novembre 2021</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2022_rattrapage.html">1A - Enoncé 15 novembre 2021 - rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2022_rattrapage2.html">1A - Enoncé 3 mars 2022- rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2023.html">1A - Enoncé 26 octobre 2022</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/td_note_2023-2024.html">1A - Enoncé 8 novembre 2023-2024</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2014_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2014_10.html">1A.e - Correction de l’interrogation écrite du 10 octobre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2014_11.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2014_12.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2015_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/exams/interro_rapide_20_minutes_2015_11.html">1A.e - Correction de l’interrogation écrite du 6 novembre 2015</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/index_data.html">Numpy / Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Numpy / Pandas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/index_ml.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/ml/winesr_reg.html">Prédiction de la note des vins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practice/ml/winesc_color.html">Régression logistique et courbe ROC</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compléments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../practice/years/index.html">Notebooks écrits durant les séances</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Notebooks écrits durant les séances</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../practice/years/2023/index.html">2023</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../practice/years/2023/editdist.html">Distance d’édition (4 octobre)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/years/2023/pivot_gauss.html">Pivot de Gauss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/years/2023/prefix_search.html">Recherche de préfixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../practice/years/2023/bareme_note_optimisation.html">Optimiser la note moyenne</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm_culture.html">Survol algorithmique</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_expose/index.html">Exposés</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Exposés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/finance/finance_autostrat.html">Stratégie automatique de trading en finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/tsp/tsp_kohonen.html">Circuit hamiltonien et Kohonen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/tsp/tsp_kruskal.html">Circuit hamiltonien et Kruskal</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../i_index.html">En diagonal</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of En diagonal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebook_gallery.html">Tous les notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/index.html">Gallerie d’exemples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/index.html#gallerie-d-exemples-sur-le-machine-learning">Gallerie d’exemples sur le machine learning</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../auto_examples/index.html#gallerie-d-exemples-sur-la-programmation">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../auto_examples/ml/index.html">Gallerie d’exemples sur le machine learning</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur le machine learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../auto_examples/prog/index.html">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index.html">Code inclus dans cette librairie</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Code inclus dans cette librairie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/classique.html">examples.construction_classique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/datasets.html">Jeux de données</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tools.html">tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/rues_paris.html">teachpyx.practice.rues_paris</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_bresenham.html">teachpyx.practice.tsp_bresenham</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_kohonen.html">teachpyx.practice.tsp_kohonen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_kruskal.html">teachpyx.practice.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/video/tsp_kohonen.html">teachpyx.video.tsp_kohonen_pygame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/video/tsp_kruskal.html">teachpyx.video.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/numpysex.html">examples.numpysex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/faqs.html">faq</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../i_ex.html">Syntaxes et définitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../i_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOGS.html">Change Logs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="threads">
<span id="l-thread"></span><h1>Threads<a class="headerlink" href="#threads" title="Link to this heading">#</a></h1>
<p id="index-0">Jusqu’aux années 2003-2004, l’évolution des microprocesseurs
était une course vers une augmentation de la puissance, autant en terme
de nombre de transistors qu’en fréquence de fonctionnement. Arrivant
aux limites de la technologie actuelle, cette évolution s’est tournée
maintenant vers la construction de processeurs multicoeurs, c’est-à-dire des
machines capables d’exécuter des programmes simultanément, de maintenir
plusieurs <em>fils d’exécution</em> en parallèle.</p>
<p>Les <a class="reference external" href="https://fr.wikipedia.org/wiki/Thread_(informatique)">threads</a>
ou fils d’exécution ont trois usages principaux. Le premier est
relié au <a class="reference external" href="https://fr.wikipedia.org/wiki/Calcul_distribu%C3%A9">calcul distribué</a> ou calcul parallèle.
Par exemple, le calcul d’une intégrale sur un intervalle peut être effectué sur
deux intervalles disjoints. Le résultat final est la somme des
deux résultats sur chacun des intervalles. De plus, ces deux calculs
sont indépendants et peuvent être menés de front. Le calcul intégral
sera donc deux fois plus rapide puisque les deux intervalles seront
traités en même temps. C’est la parallélisation des calculs : les deux calculs
sur chaque intervalle seront affectés à deux threads simultanés.</p>
<p>Le second usage est couplé aux interfaces graphiques. Lorsque
l’utilisateur entame un processus long après avoir cliqué sur un bouton,
l’interface graphique ne réagit plus jusqu’à ce que ce processus s’achève.
Afin d’éviter cet inconvénient, l’interface graphique va commencer un
thread qui va exécuter ce processus. L’interface graphique n’a plus
qu’à attendre la fin du thread, et pendant tout ce temps, elle sera
également capable de traiter tout autre événement provenant de l’utilisateur.</p>
<p>Le dernier usage concerne la communication entre ordinateurs ou plus généralement
la communication Internet. C’est une communication
<a class="reference external" href="https://fr.wikipedia.org/wiki/Asynchronisme">asynchrone</a> :
l’ordinateur effectue des tâches en même temps qu’il écoute
un <a class="reference external" href="https://fr.wikipedia.org/wiki/Port_(logiciel)">port</a>
par lequel d’autres ordinateurs communiquent avec lui. Plus précisément,
le programme suit deux fils d’exécution : le fil principal et un
thread qui ne fait qu’attendre et traiter les messages qu’il
reçoit via un port.</p>
<p>La synchronisation est un point commun à ces trois usages. Ce terme
désigne la dépendance entre les threads. Lors d’un calcul distribué,
le résultat final dépend des résultats retournés par chaque thread,
il faut donc attendre que les deux fils d’exécution aient produit
le résultat attendu : il faut que les deux fils d’exécution se synchronisent.</p>
<section id="premier-thread">
<h2>Premier thread<a class="headerlink" href="#premier-thread" title="Link to this heading">#</a></h2>
<p>Le premier exemple consiste à exécuter un thread uniquement
destiné à faire des affichages. Deux fils d’exécution vont être
lancés en parallèle affichant chacun un message différent.
Les affichages vont s’entremêler. Il existe plusieurs manières
d’exécuter un thread, une seule sera présentée en utilisant la
classe <code class="docutils literal notranslate"><span class="pre">Thread</span></code> du module <code class="docutils literal notranslate"><span class="pre">threading</span></code>.
Pour créer un thread, il suffit de surcharger la méthode <code class="docutils literal notranslate"><span class="pre">run</span></code> de la classe
<code class="docutils literal notranslate"><span class="pre">Thread</span></code>. Si le thread a besoin de données lors de son exécution,
il faut surcharger son constructeur sans oublier d’appeler le
constructeur de la classe mère. L’exécution de thread commence par
la création d’une instance et l’appel à la méthode <code class="docutils literal notranslate"><span class="pre">start</span></code>.
En résumé, il faut retenir les éléments suivants :</p>
<ol class="arabic simple">
<li><p>surcharger la classe <code class="docutils literal notranslate"><span class="pre">threading.Thread</span></code>,</p></li>
<li><p>surcharger le constructeur sans oublier d’appeler le constructeur
<code class="docutils literal notranslate"><span class="pre">threading.Thread.__init__</span></code>,</p></li>
<li><p>surcharger la méthode <code class="docutils literal notranslate"><span class="pre">run</span></code>, c’est le code que devra exécuter le thread,</p></li>
<li><p>créer une instance de la nouvelle classe et appeler la méthode
<code class="docutils literal notranslate"><span class="pre">start</span></code> pour lancer le thread secondaire qui formera le second fil d’exécution.</p></li>
</ol>
<p>Le programme principal est appelé le thread principal. Voici ce que cela donne dans un exemple :</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MonThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jusqua</span><span class="p">):</span>  <span class="c1"># jusqua = donnée supplémentaire</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># ne pas oublier cette ligne</span>
        <span class="c1"># (appel au constructeur de la classe mère)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span> <span class="o">=</span> <span class="n">jusqua</span>  <span class="c1"># donnée supplémentaire ajoutée à la classe</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;thread &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.08</span><span class="p">)</span>  <span class="c1"># attend 100 millisecondes sans rien faire</span>
            <span class="c1"># facilite la lecture de l&#39;affichage</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">MonThread</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># crée le thread</span>
<span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># démarre le thread,</span>
<span class="c1"># l&#39;instruction est exécutée en quelques millisecondes</span>
<span class="c1"># quelque soit la durée du thread</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;programme &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># attend 100 millisecondes sans rien faire</span>
    <span class="c1"># facilite la lecture de l&#39;affichage</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">thread</span>  <span class="mi">0</span>
    <span class="n">programme</span>  <span class="mi">0</span>
    <span class="n">thread</span>  <span class="mi">1</span>
    <span class="n">programme</span>  <span class="mi">1</span>
    <span class="n">thread</span>  <span class="mi">2</span>
    <span class="n">programme</span>  <span class="mi">2</span>
    <span class="n">thread</span>  <span class="mi">3</span>
    <span class="n">programme</span>  <span class="mi">3</span>
    <span class="n">thread</span>  <span class="mi">4</span>
    <span class="n">thread</span>  <span class="mi">5</span>
    <span class="n">programme</span>  <span class="mi">4</span>
    <span class="n">thread</span>  <span class="mi">6</span>
    <span class="n">programme</span>  <span class="mi">5</span>
    <span class="n">thread</span>  <span class="mi">7</span>
    <span class="n">programme</span>  <span class="mi">6</span>
    <span class="n">thread</span>  <span class="mi">8</span>
    <span class="n">programme</span>  <span class="mi">7</span>
    <span class="n">thread</span>  <span class="mi">9</span>
    <span class="n">programme</span>  <span class="mi">8</span>
    <span class="n">programme</span>  <span class="mi">9</span>
</pre></div>
</div>
<p>Le programme affiche des lignes qui proviennent du thread principal et du
thread secondaire dont les affichages diffèrent.</p>
<p>Le précédent programme a été adapté pour lancer deux threads secondaires
en plus du thread principal. Les lignes modifiées
par rapport au programme précédent sont commentées.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MonThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jusqua</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span> <span class="o">=</span> <span class="n">jusqua</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;thread &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot; : &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.09</span><span class="p">)</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">MonThread</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">m2</span> <span class="o">=</span> <span class="n">MonThread</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">)</span>  <span class="c1"># crée un second thread</span>
<span class="n">m2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># démarre le thread,</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;programme &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">0</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">0</span>
    <span class="n">programme</span>  <span class="mi">0</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">1</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">1</span>
    <span class="n">programme</span>  <span class="mi">1</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">2</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">2</span>
    <span class="n">programme</span>  <span class="mi">2</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">3</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">3</span>
    <span class="n">programme</span>  <span class="mi">3</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">4</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">4</span>
    <span class="n">programme</span>  <span class="mi">4</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">5</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">5</span>
    <span class="n">programme</span>  <span class="mi">5</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">6</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">6</span>
    <span class="n">programme</span>  <span class="mi">6</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">7</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">7</span>
    <span class="n">programme</span>  <span class="mi">7</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">8</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">8</span>
    <span class="n">programme</span>  <span class="mi">8</span>
    <span class="n">thread</span>  <span class="n">A</span>  <span class="p">:</span>  <span class="mi">9</span>
    <span class="n">thread</span>  <span class="n">B</span>  <span class="p">:</span>  <span class="mi">9</span>
    <span class="n">programme</span>  <span class="mi">9</span>
</pre></div>
</div>
<p>Tous les exemples présentés dans ce chapitre font souvent intervenir
l’instruction <a class="reference external" href="https://docs.python.org/3/library/time.html#time.sleep">time.sleep(…)</a>.
A moins que ce ne soit explicitement précisé, elle sert la plupart du
temps à ralentir l’exécution du programme cité en exemple afin que celle-ci
soit humainement observable ou pour exagérer un défaut de synchronisation.
Cette fonction est d’ordinaire beaucoup moins fréquente.</p>
</section>
<section id="synchronisation">
<h2>Synchronisation<a class="headerlink" href="#synchronisation" title="Link to this heading">#</a></h2>
<section id="attente">
<h3>Attente<a class="headerlink" href="#attente" title="Link to this heading">#</a></h3>
<p>La première situation dans laquelle on a besoin de synchroniser
deux threads est l’attente d’un thread secondaire par le thread principal.
Et pour ce faire, on a besoin de l’accès par les deux fils d’exécution
à une même variable qui indiquera l’état du thread. Dans le programme suivant,
on ajoute l’attribut <code class="docutils literal notranslate"><span class="pre">etat</span></code> à la classe <code class="docutils literal notranslate"><span class="pre">MonThread</span></code> qui va indiquer l’état du thread :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> pour en marche</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> pour à l’arrêt</p></li>
</ul>
<p>Le thread principal va simplement vérifier l’état du thread
de temps en temps. Le premier point important est tout d’abord
d’attendre que le thread se lance car sans la première boucle,
le thread pourrait passer à l’état <code class="docutils literal notranslate"><span class="pre">True</span></code> après être passé dans la
seconde boucle d’attente.
Le second point important est de ne pas oublier d’insérer la fonction
<a class="reference external" href="https://docs.python.org/3/library/time.html#time.sleep">sleep</a> afin de permettre au thread principal de temporiser.
Dans le cas contraire, le thread principal passe l’essentiel de son temps à
vérifier l’état du thread secondaire, ce faisant, il ralentit
l’ordinateur par la répétition inutile de la même action un trop grand nombre
de fois. Ici, le thread principal vérifie l’état du thread secondaire
tous les 100 millisecondes. Cette durée dépend de ce que fait le thread secondaire.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MonThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jusqua</span><span class="p">):</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span> <span class="o">=</span> <span class="n">jusqua</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etat</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># l&#39;état du thread est soit False (à l&#39;arrêt)</span>
        <span class="c1"># soit True (en marche)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etat</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># on passe en mode marche</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;thread itération &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etat</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># on revient en mode arrêt</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">MonThread</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># crée un thread</span>
<span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># démarre le thread,</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;début&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">m</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
    <span class="c1"># on attend que le thread démarre</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># voir remarque ci-dessous</span>

<span class="k">while</span> <span class="n">m</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># on attend que le thread s&#39;arrête</span>
    <span class="c1"># il faut introduire l&#39;instruction time.sleep pour temporiser, il n&#39;est pas</span>
    <span class="c1"># nécessaire de vérifier sans cesse que le thread est toujours en marche</span>
    <span class="c1"># il suffit de le vérifier tous les 100 millisecondes</span>
    <span class="c1"># dans le cas contraire, la machine passe son temps à vérifier au lieu</span>
    <span class="c1"># de se consacrer à l&#39;exécution du thread</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fin&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">0</span>
    <span class="n">début</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">1</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">2</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">3</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">4</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">5</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">6</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">7</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">8</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">9</span>
    <span class="n">fin</span>
</pre></div>
</div>
<p id="index-2">Ce mécanisme d’attente peut également être codé en utilisation les
objets <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=condition#threading.Condition">Condition</a>
et <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=event#threading.Event">Event</a>.
Ces deux objets permettent d’éviter l’utilisation de la méthode <a class="reference external" href="https://docs.python.org/3/library/time.html#time.sleep">sleep</a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MonThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jusqua</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>  <span class="c1"># event = objet Event</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1">#       = donnée supplémentaire</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span> <span class="o">=</span> <span class="n">jusqua</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">event</span>  <span class="c1"># on garde un accès à l&#39;objet Event</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jusqua</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;thread itération &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>  <span class="c1"># on indique qu&#39;on a fini :</span>
        <span class="c1"># on active l&#39;object self.event</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;début&quot;</span><span class="p">)</span>

<span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>  <span class="c1"># on crée un objet de type Event</span>
<span class="n">event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># on désactive l&#39;ojet Event</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MonThread</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>  <span class="c1"># crée un thread</span>
<span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># démarre le thread,</span>
<span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c1"># on attend jusqu&#39;à ce que l&#39;objet soit activé</span>
<span class="c1"># event.wait (0.1) : n&#39;attend qu&#39;un</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fin&quot;</span><span class="p">)</span>  <span class="c1"># seulement 1 dizième de seconde</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">début</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">0</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">1</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">2</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">3</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">4</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">5</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">6</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">7</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">8</span>
    <span class="n">thread</span> <span class="n">itération</span>  <span class="mi">9</span>
    <span class="n">fin</span>
</pre></div>
</div>
<p>La méthode <a class="reference external" href="https://docs.python.org/3.5/library/threading.html?highlight=condition#threading.Event.wait">wait</a>
de l’objet <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=event#threading.Event">Event</a> attend que l’objet soit activé. Elle peut attendre
indéfiniment ou attendre pendant une durée donnée seulement.
Pour afficher la durée d’attente, on pourrait utiliser une boucle comme la suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="p">()</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;j&#39;attends&quot;</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">wait</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fin&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>La méthode <a class="reference external" href="https://docs.python.org/3.5/library/threading.html?highlight=condition#threading.Event.is_set">is_set</a>
permet de savoir si l’événement est bloquant ou non. Le programme affiche
<code class="docutils literal notranslate"><span class="pre">&quot;j'attends&quot;</span></code> puis attend le thread un dixième de secondes.
Au delà de cette durée, il vérifie l’état de l’événement puis recommence si le thread n’est pas fini.</p>
<p>Ces objets de synchronisation sont plus efficaces que le mécanisme décrit
dans le premier programme car il fait appel aux fonctions du système d’exploitation.</p>
</section>
<section id="partage-d-informations">
<h3>Partage d’informations<a class="headerlink" href="#partage-d-informations" title="Link to this heading">#</a></h3>
<p>La seconde situation dans laquelle on a besoin de synchroniser est
l’accès par deux fils d’exécution aux mêmes informations ou plutôt
aux mêmes variables. Un problème survient quand parfois un thread lit
ou modifie en même temps qu’un autre modifie la même variable.
Le second cas de synchronisation est l’ajout de verrous qui permettent
de protéger une partie du code d’un programme contre plusieurs accès
simultanés.indexfrr{thread}{verrou} Ce verrou est également un objet du module
<code class="docutils literal notranslate"><span class="pre">threading</span></code> : <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=condition#threading.Lock">Lock</a>.</p>
<p>Dans cet exemple, l’information partagée est la chaîne de caractères
<code class="docutils literal notranslate"><span class="pre">message</span></code>, le verrou sert à protéger la fonction <code class="docutils literal notranslate"><span class="pre">ajoute</span></code> contre des
ajouts simultanés. Si les deux threads veulent modifier <code class="docutils literal notranslate"><span class="pre">message</span></code> en même temps,
un thread va entrer dans la fonction <code class="docutils literal notranslate"><span class="pre">ajoute</span></code> alors que l’autre n’en est
pas encore sorti. Les résultats seraient imprévisibles car cette fonction
modifie la variable qu’ils utilisent. On aboutit à l’exemple suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">début</span>
    <span class="n">longueur</span>  <span class="mi">20</span>
    <span class="n">message</span> <span class="o">=</span>  <span class="mi">11111111112222222222</span>
</pre></div>
</div>
<p>Les trois instructions protégées pourraient être résumées en une seule :
<code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">+=</span> <span class="pre">c</span></code> ; le résultat resterait inchangé.
En revanche, en commentant les instructions
<a class="reference external" href="https://docs.python.org/3.5/library/threading.html?highlight=condition#threading.Lock.acquire">verrou.acquire()</a>
et <a class="reference external" href="https://docs.python.org/3.5/library/threading.html?highlight=condition#threading.Lock.release">verrou.release()</a>
de ce programme (marquées d’une étoile).
La longueur du résultat final <code class="docutils literal notranslate"><span class="pre">message</span></code> est variable alors qu’elle devrait être de 20
puisque les deux threads appellent chacun 10 fois dans la fonction
<code class="docutils literal notranslate"><span class="pre">ajoute</span></code>. Le tableau suivant montre l’évolution des variables
<code class="docutils literal notranslate"><span class="pre">message</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code> durant deux premiers appels qui s’entremêlent.
Le résultat devrait être <code class="docutils literal notranslate"><span class="pre">&quot;12&quot;</span></code> pour message mais un caractère a été perdu.
Il faut retenir que si la variable <code class="docutils literal notranslate"><span class="pre">message</span></code> est globale,
les deux autres <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code> sont locales et donc différentes pour les deux threads.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ordre</p></th>
<th class="head"><p>thread 1</p></th>
<th class="head"><p>thread 2</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">c</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">s</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">message</span> <span class="pre">+</span> <span class="pre">c</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">message</span> <span class="pre">+</span> <span class="pre">c</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">time.sleep</span> <span class="pre">(0.001)</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">time.sleep</span> <span class="pre">(0.001)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">=</span> <span class="pre">s</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">=</span> <span class="pre">s</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Le verrou empêche d’exécuter une même portion de code en même temps,
un code qui modifie des données partagées. C’est pourquoi le verrou
est souvent déclaré au même endroit que les données qu’il protège.
Le verrou de type <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=condition#threading.Lock">Lock</a> n’autorise qu’un seul thread à la fois à
l’intérieur de la portion de code protégée ce qui aboutit au schéma suivant :</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
<col style="width: 16.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ordre</p></th>
<th class="head"><p>thread 1</p></th>
<th class="head"><p>thread 2</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">c</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">s</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">message</span> <span class="pre">+</span> <span class="pre">c</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">time.sleep</span> <span class="pre">(0.001)</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">=</span> <span class="pre">s</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">message</span> <span class="pre">+</span> <span class="pre">c</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;12&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">time.sleep</span> <span class="pre">(0.001)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;12&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">=</span> <span class="pre">s</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;12&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;12&quot;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Le verrou de type <a class="reference external" href="https://docs.python.org/3.5/library/threading.html?highlight=condition#threading.Semaphore">Semaphore</a>
autorise un nombre maximal de thread à parcourir le même code. Ce procédé est parfois utile si
le code en question permet d’imprimer un document. Cela permet de limiter sans
interdire les accès simultanés aux ressources de l’ordinateur.</p>
<p>Ce mécanisme de verrou peut aboutir à des blocages avec deux threads et
deux portions de code protégées. Chaque thread est « coincé » dans une section
attendant que l’autre libère la sienne. Dans ce cas de figure, il est conseillé d’utiliser
le même verrou pour protéger les deux sections. Ainsi, chaque thread ne pourra pas entrer dans
l’une ou l’autre des portions de code protégées tant que l’une d’entre
elles est visitée par l’autre thread.</p>
</section>
</section>
<section id="interface-graphique">
<span id="thread-interface-graphique"></span><h2>Interface graphique<a class="headerlink" href="#interface-graphique" title="Link to this heading">#</a></h2>
<p>Un programme bâti autour d’une interface graphique inclut nécessairement une
boucle de message. Celle-ci attend les messages en provenance de l’interface.
Lorsqu’un de ceux-ci lui commande de lancer un traitement long, l’interface
graphique n’est plus en mesure de réagir aux événements qui lui viennent pendant ce temps.
Afin de remédier cela, il suffit d’insérer le traitement dans un thread.
A la fin de ce dernier, un événement sera envoyé à l’interface afin de lui signifier
la fin du traitement.</p>
<p>Le paragraphe <a class="reference internal" href="../c_gui/tkinter.html#parag-graph-bind"><span class="std std-ref">Associer n’importe quel événement à un objet</span></a> a montré comment associer un événement
particulier à une fenêtre. La différence ici est que l’événement accroché à la
fenêtre n’est pas prédéfini par le module
<a class="reference external" href="https://docs.python.org/3.5/library/tkinter.html?highlight=tkinter#module-tkinter">Tkinter</a>
mais par le programme lui-même - dans cet exemple <code class="docutils literal notranslate"><span class="pre">&lt;&lt;thread_fini&gt;&gt;</span></code> -.
Les symboles <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&gt;&gt;</span></code> au début et à la fin du nom de l’événement sont la seule contrainte.
La méthode <code class="docutils literal notranslate"><span class="pre">event_generate</span></code> permet d’insérer un message dans la boucle de
messages de façon à ce que celui-ci soit traité au même titre qu’un clic de souris, la pression d’une touche, …</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">copy</span>

<span class="c1"># définition du thread</span>
<span class="k">class</span> <span class="nc">MonThread</span> <span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win</span> <span class="o">=</span> <span class="n">win</span>  <span class="c1"># on mémorise une référence sur la fenêtre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">run</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;thread &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

          <span class="c1"># afin que le thread retourne un résultat</span>
          <span class="c1"># self.res désigne thread_resultat qui reçoit un nombre de plus</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">h</span><span class="p">)</span>

          <span class="c1"># on lance un événement &lt;&lt;thread_fini&gt;&gt; à la fenêtre principale</span>
          <span class="c1"># pour lui dire que le thread est fini, l&#39;événement est ensuite</span>
          <span class="c1"># géré par la boucle principale de messages</span>
          <span class="c1"># on peut transmettre également le résultat lors de l&#39;envoi du message</span>
          <span class="c1"># en utilisant un attribut de la classe Event pour son propre compte</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="o">.</span><span class="n">event_generate</span> <span class="p">(</span><span class="s2">&quot;&lt;&lt;thread_fini&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">h</span><span class="p">)</span>

<span class="n">thread_resultat</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">lance_thread</span> <span class="p">()</span> <span class="p">:</span>
    <span class="k">global</span> <span class="n">thread_resultat</span>
      <span class="c1"># fonction appelée lors de la pression du bouton</span>
      <span class="c1"># on change la légnde de la zone de texte</span>
    <span class="n">text</span> <span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thread démarré&quot;</span><span class="p">)</span>
    <span class="n">text2</span><span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thread démarré&quot;</span><span class="p">)</span>
      <span class="c1"># on désactive le bouton pour éviter de lancer deux threads en même temps</span>
    <span class="n">bouton</span><span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">DISABLED</span><span class="p">)</span>
      <span class="c1"># on lance le thread</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MonThread</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">thread_resultat</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="p">()</span>

<span class="k">def</span> <span class="nf">thread_fini_fonction</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">global</span> <span class="n">thread_resultat</span>
      <span class="c1"># fonction appelée lorsque le thread est fini</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;la fenêtre sait que le thread est fini&quot;</span><span class="p">)</span>
      <span class="c1"># on change la légende de la zone de texte</span>
    <span class="n">text</span> <span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thread fini + résultat &quot;</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">thread_resultat</span><span class="p">))</span>
    <span class="n">text2</span><span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thread fini + résultat (e.x) &quot;</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
      <span class="c1"># on réactive le bouton de façon à pouvoir lancer un autre thread</span>
    <span class="n">bouton</span><span class="o">.</span><span class="n">config</span> <span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">TK</span>

<span class="c1"># on crée la fenêtre</span>
<span class="n">root</span>   <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">Tk</span> <span class="p">()</span>
<span class="n">bouton</span> <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">Button</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thread départ&quot;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">lance_thread</span><span class="p">)</span>
<span class="n">text</span>   <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">Label</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;rien&quot;</span><span class="p">)</span>
<span class="n">text2</span>  <span class="o">=</span> <span class="n">TK</span><span class="o">.</span><span class="n">Label</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;rien&quot;</span><span class="p">)</span>
<span class="n">bouton</span><span class="o">.</span><span class="n">pack</span> <span class="p">()</span>
<span class="n">text</span><span class="o">.</span><span class="n">pack</span> <span class="p">()</span>
<span class="n">text2</span><span class="o">.</span><span class="n">pack</span> <span class="p">()</span>

<span class="c1"># on associe une fonction à un événement &lt;&lt;thread_fini&gt;&gt; propre au programme</span>
<span class="n">root</span><span class="o">.</span><span class="n">bind</span> <span class="p">(</span><span class="s2">&quot;&lt;&lt;thread_fini&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">thread_fini_fonction</span><span class="p">)</span>

<span class="c1"># on active la boucle principale de message</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span> <span class="p">()</span>
</pre></div>
</div>
<p>L’image suivante est la fenêtre affichée par le programme
lorsqu’elle attend la pression du bouton qui lance le thread
et lorsqu’elle attend la fin de l’exécution de ce thread.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="../../_images/threadim1.png" src="../../_images/threadim1.png" />
</td>
<td><img alt="../../_images/threadim2.png" src="../../_images/threadim2.png" />
</td>
</tr>
</tbody>
</table>
</div>
<p>Le programme précédent utilise une astuce pour retourner un résultat
autrement qu’un utilisant un paramètre global. On peut
adjoindre lors de l’appel à la méthode <code class="docutils literal notranslate"><span class="pre">event_generate</span></code>
quelques informations supplémentaires attachées à l’événement
en utilisant les attributs prédéfinis de la classe <a class="reference external" href="https://docs.python.org/3/library/threading.html?highlight=event#threading.Event">Event</a>.
Dans cet exemple, on utilise l’attribut <code class="docutils literal notranslate"><span class="pre">x</span></code> pour retourner
le dernier entier tiré aléatoirement.</p>
<p>La première image est la fenêtre après trois exécutions du thread.
La liste <code class="docutils literal notranslate"><span class="pre">thread_resultat</span></code> contient
trois nombres. Une fois l’unique bouton pressé, la fenêtre change d’aspect pour devenir comme la seconde image.
Cette transition est assurée par la fonction <code class="docutils literal notranslate"><span class="pre">lance_thread</span></code> reliée au bouton.
La transition inverse est assurée par la fonction <code class="docutils literal notranslate"><span class="pre">thread_fini_fonction</span></code>
qui est reliée à l’événement que génère le thread lorsqu’il a terminé.</p>
</section>
<section id="files-de-messages">
<h2>Files de messages<a class="headerlink" href="#files-de-messages" title="Link to this heading">#</a></h2>
<p>Les trois usages principaux des threads sont le calcul distribué,
la conception d’une interface graphique réactive et l’attente
permanente d’événements. En ce qui concernent les deux premiers usages,
on peut considérer qu’il existe un thread principal qui lance
et attend l’exécution de threads secondaires. Les échanges
d’informations ont lieu au début et à la fin de chaque thread.
Il n’est pas toujours nécessaire de partager des variables en cours
d’exécution : l’usage de verrous est peu fréquent pour ces deux schémas
sauf pour partager des informations en cours d’exécution. Ils ralentissent
considérablement l’exécution d’un programme.</p>
<p>En ce qui concerne le troisième usage, c’est un cas où tout au long
du programme, il y a constamment au moins deux threads actifs :
un thread principal et un thread qui attend. Dans ce cas,
l’échange et la synchronisation d’informations est inévitable et
il est souvent fastidieux de concevoir la synchronisation.
C’est pourquoi on la conçoit presque toujours sous forme de messages
que les threads s’envoient.</p>
<p>Il existe un objet <a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Queue">Queue</a>
qui facilite cet aspect. C’est une liste qui possède son propre
verrou de sorte que n’importe quel thread peut ajouter ou retirer
des éléments de cette liste. Elle est utilisée principalement
via quatre méthodes. Deux méthodes
<a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Queue.get">get</a>
sont utilisées au sein du thread qui possède la pile.
Deux méthodes <a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Queue.put">put</a>
sont appelées par des threads étrangers.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get([timeout=...]</span></code></p></td>
<td><p>Retourne un élément de la liste ou attend qu’il y en ait un,
le supprime si elle en trouve un. Si <code class="docutils literal notranslate"><span class="pre">timeout</span></code> est renseigné,
la fonction attend au plus <code class="docutils literal notranslate"><span class="pre">timeout</span></code> secondes, sinon,
elle déclenche l’exception <a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Empty">Empty</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_nowait()</span></code></p></td>
<td><p>Retourne un élément de la liste s’il y a en un, dans ce cas,
cet élément est supprimé. Dans le cas contraire, la méthode déclenche
l’exception <a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Empty">Empty</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">put(e[,timeout=...])</span></code></p></td>
<td><p>Ajoute l’élément <code class="docutils literal notranslate"><span class="pre">e</span></code> à la liste ou attend qu’une place se
libère si la liste est pleine. Si <code class="docutils literal notranslate"><span class="pre">timeout</span></code> est renseigné,
la fonction attend au plus <code class="docutils literal notranslate"><span class="pre">timeout</span></code> secondes, sinon,
elle déclenche l’exception
<a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Full">Full</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">put_nowait(e)</span></code></p></td>
<td><p>Ajoute l’élément <code class="docutils literal notranslate"><span class="pre">e</span></code> à la liste ou déclenche l’exception
<a class="reference external" href="https://docs.python.org/3.5/library/queue.html?highlight=queu#queue.Full">Full</a> si la liste est pleine.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qsize()</span></code></p></td>
<td><p>Retourne la taille de la pile.</p></td>
</tr>
</tbody>
</table>
</div>
<p id="index-4">Cette pile est utilisée dans l’exemple qui suit pour simuler deux joueurs
qui essaye de découvrir le nombre que l’autre joueur a tiré au hasard.
A chaque essai, un joueur envoie un message de type <code class="docutils literal notranslate"><span class="pre">(&quot;essai&quot;,</span> <span class="pre">n)</span></code>
à l’autre joueur pour dire qu’il joue le nombre <code class="docutils literal notranslate"><span class="pre">n</span></code>. Ce joueur lui répond
avec des messages de type <code class="docutils literal notranslate"><span class="pre">(&quot;dessous&quot;,</span> <span class="pre">n)</span></code>, <code class="docutils literal notranslate"><span class="pre">(&quot;dessus&quot;,</span> <span class="pre">n)</span></code>, <code class="docutils literal notranslate"><span class="pre">(&quot;gagne&quot;,</span> <span class="pre">n)</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">A</span>  <span class="p">:</span> <span class="n">je</span> <span class="n">joue</span> <span class="p">(</span> <span class="mi">7</span> <span class="p">)</span>
    <span class="n">B</span>  <span class="p">:</span> <span class="n">je</span> <span class="n">joue</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="n">A</span>  <span class="p">:</span> <span class="n">je</span> <span class="n">tente</span>  <span class="mi">6</span>  <span class="n">écart</span>  <span class="mi">10</span>  <span class="n">à</span> <span class="n">traiter</span>  <span class="mi">0</span>
    <span class="n">A</span>  <span class="p">:</span> <span class="n">je</span> <span class="n">tente</span>  <span class="mi">10</span>  <span class="n">écart</span>  <span class="mi">10</span>  <span class="n">à</span> <span class="n">traiter</span>  <span class="mi">0</span>
    <span class="n">B</span>  <span class="p">:</span> <span class="n">je</span> <span class="n">tente</span>  <span class="mi">7</span>  <span class="n">écart</span>  <span class="mi">10</span>  <span class="n">à</span> <span class="n">traiter</span>  <span class="mi">1</span>
    <span class="n">A</span>  <span class="p">:</span> <span class="n">j</span><span class="s1">&#39;ai perdu après  2  essais</span>
    <span class="n">A</span>  <span class="p">:</span> <span class="n">j</span><span class="s1">&#39;arrête</span>
    <span class="n">B</span>  <span class="p">:</span> <span class="n">j</span><span class="s1">&#39;ai gagné en  1  essais, solution  7</span>
    <span class="n">B</span>  <span class="p">:</span> <span class="n">j</span><span class="s1">&#39;arrête</span>
</pre></div>
</div>
<p>Les affichages se chevauchent parfois, il faudrait pour éviter cela synchroniser
l’affichage à l’aide d’un verrou.</p>
</section>
<section id="multithreading-plus-simple">
<h2>Multithreading plus simple<a class="headerlink" href="#multithreading-plus-simple" title="Link to this heading">#</a></h2>
<p>Le module <a class="reference external" href="https://docs.python.org/3/library/threading.html">threading</a>
a beaucoup été utilisé mais d’autres modules ont été ajoutés à la
distribution standard de python.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#module-concurrent.futures" title="(disponible dans Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.futures</span></code></a> :
le module propose une interface similaire pour paralléliser avec des threads ou des processus.
La création des threads s’écrit plus rapidement.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio" title="(disponible dans Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a> : ce module fonctionne avec les mots-clés
<a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#example-hello-world-coroutine">async, await</a>
et il est particulièrement adapté à la parallélisation à des accès aux ressources.</p></li>
</ul>
<p>Le premier module est plus adapté à la parallélisation des calculs,
le second est particulière utile pour écrire des applications non bloquantes
qui gère pas mal d’accès à Internet.</p>
<section id="concurrent-futures">
<h3>concurrent.futures<a class="headerlink" href="#concurrent-futures" title="Link to this heading">#</a></h3>
<p>Le module <a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#module-concurrent.futures" title="(disponible dans Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.futures</span></code></a>
implémente une classe <a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Executor" title="(disponible dans Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.Executor</span></code></a>
qui définit une interface pour l’exécution en parallèle. On peut soit :</p>
<ul class="simple">
<li><p>soumettre l’exécution d’une fonction avec
<a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Executor.submit" title="(disponible dans Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concurrent.futures.Executor.submit()</span></code></a></p></li>
<li><p>ou soumettre l’exécution de la même fonction appliquée à séquence de jeux de paramètres
avec <a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Executor.map" title="(disponible dans Python v3.12)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concurrent.futures.Executor.map()</span></code></a></p></li>
</ul>
<p>Cette classe est dérivée en un
<a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor" title="(disponible dans Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor</span></code></a>
dont le principal argument <em>max_works</em> définit le nombre de threads à exécuter en parallèle.
Je reproduis ici l”<a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor-example">exemple</a>
de la documentation de <em>Python</em> qui détermine si un nombre est premier.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">concurrent.futures</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">PRIMES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">112582705942171</span><span class="p">,</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">115280095190773</span><span class="p">,</span>
    <span class="mi">115797848077099</span><span class="p">,</span>
    <span class="mi">1099726899285419</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">sqrt_n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sqrt_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">PRIMES</span><span class="p">,</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">is_prime</span><span class="p">,</span> <span class="n">PRIMES</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> is prime: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">prime</span><span class="p">))</span>


<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">112582705942171</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">115280095190773</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">115797848077099</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">1099726899285419</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Débugger un programme en parallèle n’est pas chose facile car les exécutions s’entremêlent
et les instructions <em>print</em> si elles sont insérées dans la fonction parallélisée produisent
des résultats indéchiffrables.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">concurrent.futures</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">PRIMES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">112582705942171</span><span class="p">,</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">115280095190773</span><span class="p">,</span>
    <span class="mi">115797848077099</span><span class="p">,</span>
    <span class="mi">1099726899285419</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">sqrt_n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sqrt_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">PRIMES</span><span class="p">,</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">is_prime</span><span class="p">,</span> <span class="n">PRIMES</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> is prime: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">prime</span><span class="p">))</span>


<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">start</span> <span class="mi">112272535095293</span> <span class="o">*</span>
    <span class="n">start</span> <span class="mi">112582705942171</span> <span class="o">*</span>
    <span class="n">end</span> <span class="mi">112272535095293</span> <span class="c1">#</span>
    <span class="n">start</span> <span class="mi">112272535095293</span> <span class="o">*</span>
    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">end</span> <span class="mi">112582705942171</span> <span class="c1">#</span>
    <span class="n">start</span> <span class="mi">115280095190773</span> <span class="o">*</span>
    <span class="mi">112582705942171</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">end</span> <span class="mi">112272535095293</span> <span class="c1">#</span>
    <span class="n">start</span> <span class="mi">115797848077099</span> <span class="o">*</span>
    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">end</span> <span class="mi">115280095190773</span> <span class="c1">#</span>
    <span class="n">start</span> <span class="mi">1099726899285419</span> <span class="o">*</span>
    <span class="mi">115280095190773</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">end</span> <span class="mi">115797848077099</span> <span class="c1">#</span>
    <span class="mi">115797848077099</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">1099726899285419</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Pour débugger, il faut utiliser le module <a class="reference external" href="https://docs.python.org/3/library/logging.html#module-logging">logging</a>
(voir aussi <a class="reference external" href="http://sametmax.com/ecrire-des-logs-en-python/">Ecrire des logs en Python</a>).
L’exemple suivant construit un <em>logger</em> par thread</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">concurrent.futures</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="n">loggers</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">def</span> <span class="nf">get_logger</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">loggers</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">loggers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(threadName)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>

    <span class="c1"># Pour un affiche sur la sortie standard mais cela s&#39;entremêle parfois.</span>
    <span class="c1"># ch = logging.StreamHandler(sys.stdout)</span>
    <span class="c1"># ch.setFormatter(formatter)</span>
    <span class="c1"># logger.addHandler(ch)</span>

    <span class="c1"># Pour une sortie dans un fichier.</span>
    <span class="c1"># Le mode &quot;w&quot; signifie que les logs de l&#39;exécution précédente</span>
    <span class="c1"># seront effacés.</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.log&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

    <span class="n">loggers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">logger</span>
    <span class="k">return</span> <span class="n">loggers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>


<span class="n">PRIMES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">112582705942171</span><span class="p">,</span>
    <span class="mi">112272535095293</span><span class="p">,</span>
    <span class="mi">115280095190773</span><span class="p">,</span>
    <span class="mi">115797848077099</span><span class="p">,</span>
    <span class="mi">1099726899285419</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;start </span><span class="si">{}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;end1 </span><span class="si">{}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">sqrt_n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sqrt_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;end2 </span><span class="si">{}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;end3 </span><span class="si">{}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;thread&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">PRIMES</span><span class="p">,</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">is_prime</span><span class="p">,</span> <span class="n">PRIMES</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> is prime: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">prime</span><span class="p">))</span>


<span class="n">main</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;thread_0.log&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;thread_1.log&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">112582705942171</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">112272535095293</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">115280095190773</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">115797848077099</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">True</span>
    <span class="mi">1099726899285419</span> <span class="ow">is</span> <span class="n">prime</span><span class="p">:</span> <span class="kc">False</span>
    <span class="o">-----</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span><span class="mi">141</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">112272535095293</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">040</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end3</span> <span class="mi">112272535095293</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">046</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">112272535095293</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">902</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end3</span> <span class="mi">112272535095293</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">902</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">115797848077099</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">478</span> <span class="o">-</span> <span class="n">thread_0</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end3</span> <span class="mi">115797848077099</span><span class="o">*</span>
    
    <span class="o">-----</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span><span class="mi">146</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">112582705942171</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">052</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end3</span> <span class="mi">112582705942171</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">053</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">115280095190773</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">942</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end3</span> <span class="mi">115280095190773</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">57</span><span class="p">,</span><span class="mi">942</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">start</span> <span class="mi">1099726899285419</span><span class="o">*</span>
    <span class="mi">2024</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">13</span> <span class="mi">13</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">209</span> <span class="o">-</span> <span class="n">thread_1</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">end2</span> <span class="mi">1099726899285419</span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="notion-de-futures">
<h3>Notion de futures<a class="headerlink" href="#notion-de-futures" title="Link to this heading">#</a></h3>
<p id="index-5">Ce concept est apparu récemment dans les langages de programmation, non pas
qu’il n’est jamais été utilisé avant l’an 2000 mais l’usage de plus en plus
fréquent de la programmation parallélisée fait que certains concept sont
nommés et intègres les langages.
Les <a class="reference external" href="https://fr.wikipedia.org/wiki/Futures_(informatique)">futures ou promesses</a>
font référence à un résultat dont le calcul est géré par un autre thread ou
processus. Le résultat n’est pas prêt au moment où ce second thread démarre mais il
le sera bientôt d’où son nom. On les retrouve en C#
<a class="reference external" href="https://msdn.microsoft.com/fr-fr/library/hh191443(v=vs.120).aspx">Programmation asynchrone avec Async et Await</a>
ou C++ <a class="reference external" href="http://en.cppreference.com/w/cpp/thread/async">std::async</a>.
Il y a deux objets <em>futures</em> en Python qui sont produits par différents
jeux de fonctions. On ne créé jamais un <em>futures</em>, c’est toujours une fonction
qui le fait.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Future" title="(disponible dans Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.Future</span></code></a> : ils sont créés par le module <a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#module-concurrent.futures" title="(disponible dans Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">concurrent.futures</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#future">asyncio.future</a> :
ils sont créés par le module <a class="reference external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio" title="(disponible dans Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>.</p></li>
</ul>
<p>Les deux objets possèdent la même interface et sont presque compatibles.
Cela dit, il vaut mieux éviter de les mélanger. Je cite la documentation :</p>
<blockquote>
<div><p>This class is not compatible with the
<a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.wait">wait()</a> and
<a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.as_completed">as_completed()</a>
functions in the concurrent.futures package.</p>
</div></blockquote>
<p>Distribuer l’exécution d’une fonction est relativement facile. Les choses se compliquent
quand il s’agit de distribuer un calcul qui dépend d’un autre calcul distribué.
Il faut enchaîner ces fonctions qu’on dit
<a class="reference external" href="https://en.wikipedia.org/wiki/Synchronous_programming_language">asynchrones</a>
puisque leur exécution n’est plus inscrite dans une seule et même séquence
mais dans plusieurs fils d’exécution parallèles.</p>
</section>
<section id="un-probleme-de-blocage">
<h3>Un problème de blocage<a class="headerlink" href="#un-probleme-de-blocage" title="Link to this heading">#</a></h3>
<p>La fonction distribue le calcul de la somme des éléments d’un tableau.
et elle est récursive.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">concurrent.futures</span> <span class="k">as</span> <span class="nn">cf</span>


<span class="k">def</span> <span class="nf">parallel_numpy_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">cf</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="n">va</span><span class="p">[:</span><span class="n">m</span><span class="p">],</span> <span class="n">vb</span><span class="p">[:</span><span class="n">m</span><span class="p">])</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="n">va</span><span class="p">[</span><span class="n">m</span><span class="p">:],</span> <span class="n">vb</span><span class="p">[</span><span class="n">m</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">f1</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="o">+</span> <span class="n">f2</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>


<span class="n">va</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">vb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parallel_numpy_dot</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">vb</span><span class="p">))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mf">9.54150786477814</span>
</pre></div>
</div>
<p>Il faut voir l’objet <em>executor</em> comme un objet qui empile les fonctions
à exécuter. Le problème dans l’exemple précédent est que la fonction
<em>distribute_sum</em> est déjà dans la pile d’exécution et attend l’exécution
de deux autres appels à la même fonction placée après elle dans la pile d’exécution.</p>
<img alt="../../_images/pool.png" src="../../_images/pool.png" />
<p>Si chaque appel à la fonction était effectué sur un thread différent,
cela pourrait fonctionner. Mais ce n’est pas le cas pour cette implémentation.
L’appel 1 attend la fin de 2 et 3 qui ne peuvent pas être exécutés tant
que 1 n’est pas fini. Pour résoudre le problème dans ce cas ci, il faut
remplacer le commentaire par la ligne suivante :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">executor</span> <span class="o">=</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="async-await-asyncio">
<h3>async - await - asyncio<a class="headerlink" href="#async-await-asyncio" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://docs.python.org/3/library/asyncio.html">asyncio</a> a fait émerger
les mots-clés <a class="reference external" href="https://docs.python.org/3/whatsnew/3.5.html?highlight=async#whatsnew-pep-492">async and await</a>
qui font partie du langage depuis la version 3.5 tout comme elles font partie
d’autres langages comme <a class="reference external" href="https://docs.microsoft.com/en-us/dotnet/csharp/async">C#/async</a>
ou <a class="reference external" href="http://www.cplusplus.com/reference/future/async/">C++</a>.</p>
<p>Concrètement, ce n’est pas si difficile d’écrire une fonction
qui a vocation à être parallélisée. Ce qui devient compliqué est d’avoir
à sa disposition plein de fonctions à paralléliser. Il faut
synchroniser. Ces deux mots-clés permettent de définir une fonction
à vocation parallèle (<code class="docutils literal notranslate"><span class="pre">async</span></code>) et une façon d’attendre
qu’elles aient retourné un résultat (<code class="docutils literal notranslate"><span class="pre">await</span></code>).
Ces deux mots-clés sont une façon élégant de créer
des assemblages de fonctions indépendantes et parallélisées.</p>
<p>Les interfaces graphiques ne contiennent qu’un seul <em>await</em>
ou une seule boucle de messages qui attend inlassablement que
quelque chose se passe. Le mot-clé <em>async</em> agit comme un aiguillage.
Une action est enclenchée. Elle signalera sa fin et son résultat plus tard.</p>
<img alt="../../_images/asyncapi.png" src="../../_images/asyncapi.png" />
<p>Le mot-clés <em>await</em> sert à chaîner les fonctions parallélisées.</p>
</section>
</section>
<section id="gil-global-interpreter-lock">
<h2>GIL - Global Interpreter Lock<a class="headerlink" href="#gil-global-interpreter-lock" title="Link to this heading">#</a></h2>
<p>Le <a class="reference external" href="https://en.wikipedia.org/wiki/Global_interpreter_lock">Global Interpreter Lock</a>
est un verrou qui évite à plusieurs threads de modifier le même objet en même temps.
Dans les langages bas niveau, on fait la distrinction entre un tableau ou une liste
qui supporte les accès concurrentiels ou non. Si elle ne les supporte pas, les accès
sont plus rapides mais suppose que le dévelopeur s’occupe de gérer les problèmes
de synchronisation si besoin.</p>
<p>Le langage Python protège listes et dictionnaires par l’intermédiaire de ce verrou
qui est unique pour toutes les listes afin de pouvoir gérer efficacement le
<a class="reference external" href="https://fr.wikipedia.org/wiki/Ramasse-miettes_(informatique)">garbage collector</a>
(voir module <a class="reference external" href="https://docs.python.org/3/library/gc.html">gc</a>). En conséquence,
si le langage Python est multithread par design, dans les faits, il ne l’est presque
pas car le <em>GIL</em> est sans cesse utilisé. Le notebook <a class="reference internal" href="../../auto_examples/prog/plot_gil_example.html#gilexamplerst"><span class="std std-ref">Le GIL</span></a> finira
de vous convaincre.</p>
<section id="cython-un-melange-de-python-et-c">
<h3>cython : un mélange de python et C<a class="headerlink" href="#cython-un-melange-de-python-et-c" title="Link to this heading">#</a></h3>
<p>Tout est possible avec le langage C même si
<a class="reference external" href="http://cython.org/">cython</a>
est un mélange des de <em>python</em> et <em>C</em>. Le contexte
<a class="reference external" href="http://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#releasing-the-gil">nogil</a>
permet de relâcher la contrainte sur GIL pour une fonction ou une partie de code.
Plus de liberté veut dire aussi plus d’attention à apporter au code.
La page <a class="reference external" href="http://cython.readthedocs.io/en/latest/src/userguide/parallelism.html?highlight=nogil#using-parallelism">Using parallelism</a>
donne quelques exemples simples de parallélisation.
Il est plus facile de paralléliser Python avec un autre langage
(voir aussi <a class="reference external" href="https://gist.github.com/perrygeo/2f1b52149f285c00c500">Parallelizing numpy array loops with Cython and OpenMP</a>).</p>
</section>
<section id="c-java">
<h3>C#, Java<a class="headerlink" href="#c-java" title="Link to this heading">#</a></h3>
<p>L’intégration de langage C est supportée par Python car l’interpéteur
est implémenté en C. Utiliser d’autres langages peut se faire via une
interface en C et celle-ci existe pour certains langages.
C’est le cas du <a class="reference external" href="https://fr.wikipedia.org/wiki/C_sharp">C#</a>
qui peut être utilisé via le module
<a class="reference external" href="https://github.com/pythonnet/pythonnet">pythonnet</a> ou encore
<a class="reference external" href="https://fr.wikipedia.org/wiki/Java">Java</a> via
<a class="reference external" href="https://www.py4j.org/">py4j</a>,
<a class="reference external" href="https://github.com/kivy/pyjnius">pyjnius</a>.
Les threads sont plus faciles à implémenter dans ces langages
même si le <a class="reference external" href="https://fr.wikipedia.org/wiki/Ramasse-miettes_(informatique)">garbage collector</a>
peut nuire aux performances.</p>
</section>
</section>
<section id="bibliographie">
<h2>Bibliographie<a class="headerlink" href="#bibliographie" title="Link to this heading">#</a></h2>
<p><em>articles</em></p>
<ul class="simple">
<li><p><a class="reference external" href="https://stevedower.id.au/blog/async-api-for-python">Async API for Python</a></p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../c_gui/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Interfaces graphiques</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Parallélisation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2024, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Threads</a><ul>
<li><a class="reference internal" href="#premier-thread">Premier thread</a></li>
<li><a class="reference internal" href="#synchronisation">Synchronisation</a><ul>
<li><a class="reference internal" href="#attente">Attente</a></li>
<li><a class="reference internal" href="#partage-d-informations">Partage d’informations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#interface-graphique">Interface graphique</a></li>
<li><a class="reference internal" href="#files-de-messages">Files de messages</a></li>
<li><a class="reference internal" href="#multithreading-plus-simple">Multithreading plus simple</a><ul>
<li><a class="reference internal" href="#concurrent-futures">concurrent.futures</a></li>
<li><a class="reference internal" href="#notion-de-futures">Notion de futures</a></li>
<li><a class="reference internal" href="#un-probleme-de-blocage">Un problème de blocage</a></li>
<li><a class="reference internal" href="#async-await-asyncio">async - await - asyncio</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gil-global-interpreter-lock">GIL - Global Interpreter Lock</a><ul>
<li><a class="reference internal" href="#cython-un-melange-de-python-et-c">cython : un mélange de python et C</a></li>
<li><a class="reference internal" href="#c-java">C#, Java</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bibliographie">Bibliographie</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=f45c5ce7"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>