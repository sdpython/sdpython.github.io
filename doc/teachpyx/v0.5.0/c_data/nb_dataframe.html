<!doctype html>
<html class="no-js" lang="fr" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Recherche" href="../search.html" /><link rel="next" title="Manipulation de données avec pandas (exercices)" href="nb_pandas.html" /><link rel="prev" title="Dataframes" href="dataframes.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>DataFrame et Graphes - Documentation teachpyx 0.5.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation teachpyx 0.5.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation teachpyx 0.5.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../py/index.html">Le langage Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Le langage Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_lang/index.html">Variables et fonctions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Variables et fonctions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/types.html">Types et variables du langage python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/syntaxe.html">Syntaxe du langage Python (boucles, tests, fonctions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/constructions.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/collections.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/dates.html">Dates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/encoding.html">Encoding et jeux de caractères</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_classes/index.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_classes/classes.html">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_classes/questions.html">Questions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_exception/index.html">Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Exceptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/exception.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/exception_ext.html">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/warning.html">Warning et logging</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_module/index.html">Entrées, Sorties, Modules</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Entrées, Sorties, Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_module/files.html">Fichiers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../py/c_module/serialization.html">Sérialisation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Sérialisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_module/module.html">Module ou extension</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_regex/index.html">Expressions régulières</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Expressions régulières</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_regex/regex.html">Expressions régulières</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_parallelisation/index.html">Parallélisation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parallélisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_parallelisation/thread.html">Threads</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_gui/index.html">Interfaces graphiques</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Interfaces graphiques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_gui/tkinter.html">tkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Matrices et DataFrames</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Matrices et DataFrames</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="matrices.html">Calcul matriciel</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Calcul matriciel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="nb_array.html">Calcul Matriciel, Optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="nb_numpy.html">Calcul matriciel avec numpy (exercices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="numpy_broadcast.html">Numpy et tableau de contingence</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="dataframes.html">Dataframes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Dataframes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">DataFrame et Graphes</a></li>
<li class="toctree-l3"><a class="reference internal" href="nb_pandas.html">Manipulation de données avec pandas (exercices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nb_dataframe_matrix_speed.html">Mesures de vitesse sur les dataframes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="graphes.html">Graphes</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Graphes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="enedis_cartes.html">Tracer une carte en Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_ml/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_ml/rappel.html">Quelques rappels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_ml/regclass.html">Classification et régression</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_resume/index.html">Précis</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Précis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_resume/python_sheet.html">Cheat sheet: Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_resume/conseil_programmes.html">Quelques conseils pour écrire un programme</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_resume/cheat_sheet.html">Cheat Sheets</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Cheat Sheets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/git.html">Cheat Sheet on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/linux.html">Cheat Sheet on Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/jenkins.html">Cheat Sheet on Jenkins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../articles/index.html">Collections d’articles périssables</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Collections d’articles périssables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../articles/2024/2024-03-01-route2024.html">2024-03-01 : feuille de route 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2024/2024-01-18-wsl.html">2024-01-18 : WSL - nettoyage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023/2023-11-31-route2023.html">2023-11-31 : rappel feuille de route 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023/2023-09-06-ensae.html">2023-09-06 : ENSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023/2023-08-09-hermionne.html">2023-08-09 : l’énigme d’Hermionne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023/2023-08-03-code-jam.html">2023-08-03 : Code Jam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2022/2022-12-07-cartopy.html">2022-12-07 : Utilisation de cartopy sous Windows (sous WSL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2022/2022-11-31-route2022.html">2022-11-31 : rappel feuille de route 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2022/2022-01-01-assurance.html">Assurance auto</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exercices</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_python.html">Exercices sur le langage python</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Exercices sur le langage python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/code_liste_tuple.html">Liste, tuple, ensemble, dictionnaire, liste chaînée, coût des opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/nbheap.html">Heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/structures_donnees_conversion.html">D’une structure de données à l’autre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/recherche_dichotomique.html">Recherche dichotomique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_hash.html">Répartition, table de hashage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classes_metro.html">Un bref aperçu des classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classes_2048.html">2048 et les classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_de.html">Jeu de dé, rotation sur un circuit (classes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_permutation.html">Classe Permutation et décomposition en transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_tree.html">Une classe pour représenter un arbre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_iterateur.html">Itérateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_user_p.html">Classe, Héritage, calcule d’une distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/pivot_gauss.html">Pivot de gauss avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/coloriage_carre.html">Jeux de coloriage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/code_multinomial.html">Simuler une loi multinomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tableau_contingence.html">Calculer un chi 2 sur un tableau de contingence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tri_nlnd.html">Tri plus rapide que prévu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/histogramme_rapide.html">Histogramme et dictionnaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_pi.html">Calculs de surface et autres calculs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/de_rotation.html">Jeu de dé, rotation sur un circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profiling_example.html">Exemple de profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profile_gini.html">Profiling la fonction Gini</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profiling_conv.html">Profiling, application à la convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_regex.html">Expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_json_xml.html">JSON - XML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_serialisation_json.html">Sérialisation avec JSON, XML, pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tests_unitaires.html">Tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/scrapping.html">Web-Scraping - pokemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/premiers_pas.html">Premiers pas en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/variable_boucle_tests.html">Variables, boucles, tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/dictionnaire_vigenere.html">Dictionnaires, fonctions, code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/module_file_regex.html">Modules, fichiers, expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/integrale_rectangle.html">Intégrale et la méthode des rectangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/j2048.html">2048 - stratégie gagnante</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/texte_langue.html">Deviner la langue d’un texte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/pyramide_bigarree.html">Tracer une pyramide bigarrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_carre_magique.html">Classes, méthodes, attributs, opérateurs et carré magique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_heritage.html">Classes, héritage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/trie.html">Arbre et Trie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/premiers_pas_correction.html">Premiers pas en Python (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/variable_boucle_tests_correction.html">Variables, boucles, tests (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/dictionnaire_vigenere_correction.html">Dictionnaires, fonctions, code de Vigenère (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/module_file_regex_correction.html">Modules, fichiers, expressions régulières (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/integrale_rectangle_correction.html">Intégrale et la méthode des rectangles - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/j2048_correction.html">2048 - stratégie gagnante - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/texte_langue_correction.html">Deviner la langue d’un texte (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/pyramide_bigarree_correction.html">Tracer une pyramide bigarrée - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_carre_magique_correction.html">Classes, méthodes, attributs, opérateurs et carré magique (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_heritage_correction.html">Classes, héritage (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/trie_correction.html">Arbre et Trie (correction)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_algo.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/matrix_dictionary.html">Produit matriciel avec une matrice creuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_echelle.html">Calculer le nombre de façons de monter une échelle.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_plus_grande_somme.html">La sous-séquence de plus grande somme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_xn.html">Calculer x**n le plus rapidement possible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_topk.html">Les k premiers éléments (top k)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_suffix.html">Jeux de dictionnaires, plus grand suffixe commun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/BJKST.html">Algorithmes de streaming, BJKST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_editdist.html">Distance entre deux mots de même longueur et tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_ordonnancement.html">Problème d’ordonnancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_tsp.html">TSP - Traveling Salesman Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/tsp_simplifie.html">Plus court chemin passant par tous les noeuds d’un graphe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/tsp_aparte.html">Aparté sur le voyageur de commerce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_compose_connexe.html">Graphe et Composantes connexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_random_graph.html">Graphes aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_simulation_covid_simple.html">Modèle épidémiologique (SIRD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_simulation_covid.html">Simulation COVID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/paris_parcours.html">Parcourir les rues de Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/vigenere.html">Casser le code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/exercice_morse.html">Décoder du Morse sans espaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/gentry_integer_encryption.html">Cryptage homomorphic de Craig Gentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/knn_high_dimension.html">Plus proches voisins en grande dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_1.html">Puzzles algorithmiques (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_2.html">Puzzles algorithmiques (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/plus_court_chemin.html">Programmation dynamique et plus court chemin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/decorrelation.html">Décorrélation de variables aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/graph_spectral_clustering.html">Spectral Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/gentry_integer_encryption_correction.html">Cryptage homomorphic de Craig Gentry - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/knn_high_dimension_correction.html">Plus proches voisins en grande dimension - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_1_correction.html">Puzzles algorithmes (1) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_2_correction.html">Puzzles algorithmes (2) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/plus_court_chemin_correction.html">Programmation dynamique et plus court chemin (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/decorrelation_correction.html">Décorrélation de variables aléatoires - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/graph_spectral_clustering_correction.html">Spectral Clustering - correction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_exam.html">Séances minutées</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Séances minutées</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../practice/exams.html">Exercices minutés</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Exercices minutés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2013_coloriage_correction.html">1A.e - TD noté, 27 novembre 2012 (coloriage, correction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2013_bout_de_code_coloriage.html">1A.e - TD noté, 27 novembre 2012 (éléments de code pour le coloriage)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2015.html">1A.e - TD noté, 5 décembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2015_rattrapage_enonce.html">1A.e - TD noté 2015 rattrapage (énoncé, écrit et oral)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2016.html">1A.e - TD noté, 11 décembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2017.html">1A.e - TD noté, 16 décembre 2016</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2017_2.html">1A.e - TD noté, 21 février 2017</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2018_1.html">1A.e - Enoncé 12 décembre 2017 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2018_2.html">1A.e - Enoncé 12 décembre 2017 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2019_1.html">1A.e - Enoncé 23 octobre 2018 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2019_2.html">1A.e - Enoncé 23 octobre 2018 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2020_1.html">1A.e - Enoncé 22 octobre 2019 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2020_2.html">1A.e - Enoncé 22 octobre 2019 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2021.html">1A - Enoncé 24 novembre 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022.html">1A - Enoncé 3 novembre 2021</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022_rattrapage.html">1A - Enoncé 15 novembre 2021 - rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022_rattrapage2.html">1A - Enoncé 3 mars 2022- rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2023.html">1A - Enoncé 26 octobre 2022</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2023-2024.html">1A - Enoncé 8 novembre 2023-2024</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_10.html">1A.e - Correction de l’interrogation écrite du 10 octobre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_11.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_12.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2015_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2015_11.html">1A.e - Correction de l’interrogation écrite du 6 novembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/enonce_ml_2017.html">Evaluation Python / Machine Learning année 2017 - énoncé</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/enonce_ml_2017_correction.html">Evaluation Python / Machine Learning année 2017 - solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_data.html">Numpy / Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Numpy / Pandas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_ml.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/ml_features_model.html">Features ou modèle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/wines_acp.html">ACP - projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn_split.html">Base d’apprentissage et de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn_split_strat.html">Découpage stratifié apprentissage / test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn_cross_val.html">Validation croisée (cross-validation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn_hyper.html">Sélection des hyper-paramètres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/ml_a_tree_overfitting.html">Tree, hyperparamètres, overfitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/gradient_boosting.html">Gradient Boosting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/ridge_lasso.html">Régression Ridge, Lasso et nouvel estimateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_reg.html">Prédiction de la note des vins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_reg_poly.html">Régression polynômiale et pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn.html">Plus proches voisins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesr_knn_eval.html">Plus proches voisins - évaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_color.html">Régression logistique et courbe ROC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_color_line.html">Régression logistique en 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_color_linear.html">Plusieurs modèles, données disjointes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_color_roc.html">Classifications et courbes ROC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_multi.html">Classification multi-classe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/winesc_multi_stacking.html">Classification multi-classe et stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/artificiel_multiclass.html">Classification multi-classe et jeu mal balancé</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/ml/timeseries_ssa.html">Single Spectrum Analysis (SSA)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compléments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/years/index.html">Notebooks écrits durant les séances</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Notebooks écrits durant les séances</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../practice/years/2023/index.html">2023</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/editdist.html">Distance d’édition (4 octobre)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/pivot_gauss.html">Pivot de Gauss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/prefix_search.html">Recherche de préfixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/bareme_note_optimisation.html">Optimiser la note moyenne</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm_culture.html">Survol algorithmique</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_expose/index.html">Exposés</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Exposés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/finance/finance_autostrat.html">Stratégie automatique de trading en finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/tsp/tsp_kohonen.html">Circuit hamiltonien et Kohonen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/tsp/tsp_kruskal.html">Circuit hamiltonien et Kruskal</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../i_index.html">En diagonal</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of En diagonal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebook_gallery.html">Tous les notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/index.html">Gallerie d’exemples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/index.html#gallerie-d-exemples-sur-le-machine-learning">Gallerie d’exemples sur le machine learning</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/index.html#gallerie-d-exemples-sur-la-programmation">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../auto_examples/ml/index.html">Gallerie d’exemples sur le machine learning</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur le machine learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../auto_examples/prog/index.html">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index.html">Code inclus dans cette librairie</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Code inclus dans cette librairie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/classique.html">examples.construction_classique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/datasets.html">Jeux de données</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tools.html">tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/rues_paris.html">teachpyx.practice.rues_paris</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_bresenham.html">teachpyx.practice.tsp_bresenham</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_kohonen.html">teachpyx.practice.tsp_kohonen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_kruskal.html">teachpyx.practice.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/video/tsp_kohonen.html">teachpyx.video.tsp_kohonen_pygame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/video/tsp_kruskal.html">teachpyx.video.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/numpysex.html">examples.numpysex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/faqs.html">faq</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../i_ex.html">Syntaxes et définitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="DataFrame-et-Graphes">
<h1>DataFrame et Graphes<a class="headerlink" href="#DataFrame-et-Graphes" title="Link to this heading">#</a></h1>
<p>Les <a class="reference external" href="https://fr.wikipedia.org/wiki/Pandas">Dataframe</a> se sont imposés pour manipuler les données. Avec cette façon de représenter les données, associée à des méthodes couramment utilisées, ce qu’on faisait en une ou deux boucles se fait maintenant en une seule fonction. Le module <a class="reference external" href="http://pandas.pydata.org/">pandas</a> est très utilisé, il existe de nombreux <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/tutorials.html">tutoriels</a>, ou page de recettes pour les usages les plus fréquents :
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html#cookbook">cookbook</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>%matplotlib inline
# Cette première instruction indique à Jupyter d&#39;insérer les graphiques
# dans le notebook plutôt que dans une fenêtre externe.
import matplotlib.pyplot as plt
</pre></div>
</div>
</div>
<p>La première instruction <code class="docutils literal notranslate"><span class="pre">%matplotlib</span></code> est spécifique aux notebooks. Sans cela, les graphiques ne sont pas insérées dans la page elle-même mais cela ne s’applique qu’aux notebooks et provoquera une erreur sur <a class="reference external" href="https://github.com/spyder-ide/spyder">Spyder</a> par exemple.</p>
<section id="DataFrame">
<h2>DataFrame<a class="headerlink" href="#DataFrame" title="Link to this heading">#</a></h2>
<p>Pour faire court, c’est l’équivalent d’une feuille Excel ou d’une table SQL.</p>
<p><strong>Taille de DataFrame</strong></p>
<p>Les DataFrame en Python sont assez rapides lorsqu’il y a moins de 10 millions d’observations et que le fichier texte qui décrit les données n’est pas plus gros que 10 Mo. Au delà, il faut soit être patient, soit être astucieux, utiliser sqllite et passer au SQL ou parcourir les données en streaming.</p>
<p><strong>Valeurs manquantes</strong></p>
<p>Lorsqu’on récupère des données, il peut arriver qu’une valeur soit manquante (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/missing_data.html">Working with missing data</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from IPython.display import Image

Image(&quot;td2df.png&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_4_0.png" src="../_images/c_data_nb_dataframe_4_0.png" />
</div>
</div>
<p>Pour manipuler les dataframe, on utilise le module <a class="reference external" href="http://pandas.pydata.org/">pandas</a>. Il est prévu pour manipuler les données d’une table par <strong>bloc</strong> (une sous-table). Tant qu’on manipule des blocs, le module est rapide.</p>
<section id="Series">
<h3>Series<a class="headerlink" href="#Series" title="Link to this heading">#</a></h3>
<p>Une <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> est un objet uni-dimensionnel similaire à un tableau, une liste ou une colonne d’une table. Chaque valeur est associée à un <strong>index</strong> qui est par défaut les entiers de 0 à <img class="math" src="../_images/math/5b7182a9e61cfdfecb16e3e366844540f84a51c9.svg" alt="N-1"/> (avec <img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/> la longueur de la <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas
from pandas import Series
import numpy

s = Series([42, &quot;Hello World!&quot;, 3.14, -5, None, numpy.nan])
s.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0              42
1    Hello World!
2            3.14
3              -5
4            None
dtype: object
</pre></div></div>
</div>
<p>On peut aussi préciser les indices lors de la création, ou construire la <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> à partir d’un dictionnaire si on fournit un index avec un dictionnaire, les index qui ne sont pas des clés du dictionnaire seront des valeurs manquantes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>s2 = Series(
    [42, &quot;Hello World!&quot;, 3.14, -5, None, numpy.nan],
    index=[&quot;int&quot;, &quot;string&quot;, &quot;pi&quot;, &quot;neg&quot;, &quot;missing1&quot;, &quot;missing2&quot;],
)
city2cp_dict = {&quot;Paris14&quot;: 75014, &quot;Paris18&quot;: 75018, &quot;Malakoff&quot;: 92240, &quot;Nice&quot;: 6300}
cities = Series(city2cp_dict)
cities
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Paris14     75014
Paris18     75018
Malakoff    92240
Nice         6300
dtype: int64
</pre></div></div>
</div>
<p>Quelques liens pour comprendre le code suivant : <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isnull.html">Series.isnull</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.notnull.html">Series.notnull</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>cities_list = [&quot;Paris12&quot;] + list(city2cp_dict.keys()) + [&quot;Vanves&quot;]
cities2 = Series(city2cp_dict, index=cities_list)
pandas.isnull(cities2)  # same as cities2.isnull()
pandas.notnull(cities2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Paris12     False
Paris14      True
Paris18      True
Malakoff     True
Nice         True
Vanves      False
dtype: bool
</pre></div></div>
</div>
<p>On peut se servir de l’index pour sélectionner une ou plusieurs valeurs de la <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a>, éventuellement pour en changer la valeur. On peut aussi appliquer des opérations mathématiques, filtrer avec un booléen, ou encore tester la présence d’un élement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>cities2[&quot;Nice&quot;]  # renvoie un scalaire
cities2[[&quot;Malakoff&quot;, &quot;Paris14&quot;]]  # renvoie une Series
cities2[&quot;Paris12&quot;] = 75012
dep = cities2 // 1000  # // pour une division entière
dep
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Paris12     75.0
Paris14     75.0
Paris18     75.0
Malakoff    92.0
Nice         6.0
Vanves       NaN
dtype: float64
</pre></div></div>
</div>
<p><a class="reference external" href="http://pandas.pydata.org/">pandas</a> aligne automatiquement les données en utilisant l’index des <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> lorsqu’on fait une opération sur des series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>cities2[dep == 75]

print(&quot;Paris14&quot;, &quot;Paris14&quot; in cities2)
print(&quot;Paris13&quot;, &quot;Paris13&quot; in cities2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Paris14 True
Paris13 False
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># print(cities)
# print(cities2)
cities + cities2
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Malakoff    184480.0
Nice         12600.0
Paris12          NaN
Paris14     150028.0
Paris18     150036.0
Vanves           NaN
dtype: float64
</pre></div></div>
</div>
<p><em>pandas</em> garde les lignes communes aux deux tables et additionnent les colonnes portant le même nom. On peut nommer la <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a>, ses index et même assigner un nouvel index à une <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> existante.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>cities2.name = &quot;Code Postal&quot;
cities2.index.name = &quot;Ville&quot;
print(cities2)
print(&quot;-------------&quot;)
s2.index = range(6)
print(s2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ville
Paris12     75012.0
Paris14     75014.0
Paris18     75018.0
Malakoff    92240.0
Nice         6300.0
Vanves          NaN
Name: Code Postal, dtype: float64
-------------
0              42
1    Hello World!
2            3.14
3              -5
4            None
5             NaN
dtype: object
</pre></div></div>
</div>
</section>
</section>
<section id="DataFrame-(pandas)">
<h2>DataFrame (pandas)<a class="headerlink" href="#DataFrame-(pandas)" title="Link to this heading">#</a></h2>
<p><strong>Quelques liens :</strong> <a class="reference external" href="http://synesthesiam.com/posts/an-introduction-to-pandas.html">An Introduction to Pandas</a></p>
<p>Un <a class="reference external" href="http://en.wikipedia.org/wiki/Data_frame">DataFrame</a> est un objet qui est présent dans la plupart des logiciels de traitements de données, c’est une <strong>matrice</strong>, chaque colonne est une <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> et est de même type (nombre, date, texte), elle peut contenir des valeurs manquantes (<a class="reference external" href="http://docs.scipy.org/doc/numpy/user/misc.html">nan</a>). On peut considérer chaque colonne comme les variables d’une table
(<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.html">pandas.Dataframe</a> - cette page contient toutes les méthodes de la classe).</p>
<p>Un <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.html">Dataframe</a> représente une table de données, i.e. une collection ordonnées de colonnes. Ces colonnes/lignes peuvent avoir des types différents (numérique, string, boolean). Cela est très similaire aux <a class="reference external" href="http://www.r-tutor.com/r-introduction/data-frame">DataFrame</a> du langage R (en apparence…), avec un traitement plus symétrique des lignes et des colonnes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

l = [
    {&quot;date&quot;: &quot;2014-06-22&quot;, &quot;prix&quot;: 220.0, &quot;devise&quot;: &quot;euros&quot;},
    {&quot;date&quot;: &quot;2014-06-23&quot;, &quot;prix&quot;: 221.0, &quot;devise&quot;: &quot;euros&quot;},
]
df = pandas.DataFrame(l)
df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>prix</th>
      <th>devise</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-06-22</td>
      <td>220.0</td>
      <td>euros</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-06-23</td>
      <td>221.0</td>
      <td>euros</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Avec une valeur manquante :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>l = [
    {&quot;date&quot;: &quot;2014-06-22&quot;, &quot;prix&quot;: 220.0, &quot;devise&quot;: &quot;euros&quot;},
    {&quot;date&quot;: &quot;2014-06-23&quot;, &quot;devise&quot;: &quot;euros&quot;},
]
df = pandas.DataFrame(l)
df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>prix</th>
      <th>devise</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-06-22</td>
      <td>220.0</td>
      <td>euros</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-06-23</td>
      <td>NaN</td>
      <td>euros</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html#numpy.isnan">NaN</a> est une convention pour une valeur manquante. On extrait la variable <code class="docutils literal notranslate"><span class="pre">prix</span></code> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.prix
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    220.0
1      NaN
Name: prix, dtype: float64
</pre></div></div>
</div>
<p>Ou :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;prix&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    220.0
1      NaN
Name: prix, dtype: float64
</pre></div></div>
</div>
<p>Pour extraire plusieurs colonnes :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[[&quot;date&quot;, &quot;prix&quot;]]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>prix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-06-22</td>
      <td>220.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-06-23</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Pour prendre la transposée (voir aussi <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.transpose.html">DataFrame.transpose</a>) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.T
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>date</th>
      <td>2014-06-22</td>
      <td>2014-06-23</td>
    </tr>
    <tr>
      <th>prix</th>
      <td>220.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>devise</th>
      <td>euros</td>
      <td>euros</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="Lecture-et-écriture-de-DataFrame">
<h3>Lecture et écriture de DataFrame<a class="headerlink" href="#Lecture-et-écriture-de-DataFrame" title="Link to this heading">#</a></h3>
<p>Aujourd’hui, on n’a plus besoin de réécrire soi-même une fonction de lecture ou d’écriture de données présentées sous forme de tables. Il existe des fonctions plus génériques qui gère un grand nombre de cas. Cette section présente brièvement les fonctions qui permettent de lire/écrire un <a class="reference external" href="http://en.wikipedia.org/wiki/Data_frame">DataFrame</a> aux formats <a class="reference external" href="http://fr.wikipedia.org/wiki/Fichier_texte">texte</a>/<a class="reference external" href="http://fr.wikipedia.org/wiki/Microsoft_Excel">Excel</a>. On reprend l’exemple de
section précédente. L’instruction <code class="docutils literal notranslate"><span class="pre">encoding=utf-8</span></code> n’est pas obligatoire mais conseillée lorsque les données contiennent des accents (voir <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

l = [
    {&quot;date&quot;: &quot;2014-06-22&quot;, &quot;prix&quot;: 220.0, &quot;devise&quot;: &quot;euros&quot;},
    {&quot;date&quot;: &quot;2014-06-23&quot;, &quot;prix&quot;: 221.0, &quot;devise&quot;: &quot;euros&quot;},
]
df = pandas.DataFrame(l)

# écriture au format texte
df.to_csv(&quot;exemple.txt&quot;, sep=&quot;\t&quot;, encoding=&quot;utf-8&quot;, index=False)

# on regarde ce qui a été enregistré
with open(&quot;exemple.txt&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
    text = f.read()
print(text)

# on enregistre au format Excel
df.to_excel(&quot;exemple.xlsx&quot;, index=False)

# special jupyter - notebook
%system &quot;exemple.xlsx&quot;
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
date    prix    devise
2014-06-22      220.0   euros
2014-06-23      221.0   euros

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;/bin/bash: line 1: exemple.xlsx: command not found&#39;]
</pre></div></div>
</div>
<p>On peut récupérer des données directement depuis Internet ou une chaîne de caractères et afficher le début (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.head.html">head</a>) ou la fin (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.tail.html">tail</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

df = df_marathon = pandas.read_csv(
    &quot;https://github.com/sdpython/teachpyx/raw/main/_data/marathon.txt&quot;,
    sep=&quot;\t&quot;,
    names=[&quot;ville&quot;, &quot;annee&quot;, &quot;temps&quot;, &quot;secondes&quot;],
)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PARIS</td>
      <td>2010</td>
      <td>02:06:41</td>
      <td>7601</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PARIS</td>
      <td>2009</td>
      <td>02:05:47</td>
      <td>7547</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PARIS</td>
      <td>2008</td>
      <td>02:06:40</td>
      <td>7600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>2007</td>
      <td>02:07:17</td>
      <td>7637</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>La fonction <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html">describe</a> permet d’en savoir un peu plus sur les colonnes numériques de cette table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.describe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>annee</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>359.000000</td>
      <td>359.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1989.754875</td>
      <td>7933.660167</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.028545</td>
      <td>385.289830</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1947.000000</td>
      <td>7382.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1981.000000</td>
      <td>7698.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1991.000000</td>
      <td>7820.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2001.000000</td>
      <td>8046.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2011.000000</td>
      <td>10028.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="DataFrame-et-Index">
<h3>DataFrame et Index<a class="headerlink" href="#DataFrame-et-Index" title="Link to this heading">#</a></h3>
<p>On désigne généralement une colonne ou <em>variable</em> par son nom. Les lignes peuvent être désignées par un entier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

l = [
    {&quot;date&quot;: &quot;2014-06-22&quot;, &quot;prix&quot;: 220.0, &quot;devise&quot;: &quot;euros&quot;},
    {&quot;date&quot;: &quot;2014-06-23&quot;, &quot;prix&quot;: 221.0, &quot;devise&quot;: &quot;euros&quot;},
]
df = pandas.DataFrame(l)
df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>prix</th>
      <th>devise</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-06-22</td>
      <td>220.0</td>
      <td>euros</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-06-23</td>
      <td>221.0</td>
      <td>euros</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On extrait une ligne avec (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.iloc.html">iloc</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.iloc[1]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
date      2014-06-23
prix           221.0
devise         euros
Name: 1, dtype: object
</pre></div></div>
</div>
<p>On extrait une colonne avec [loc]( ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html">iloc</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.loc[1]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
date      2014-06-23
prix           221.0
devise         euros
Name: 1, dtype: object
</pre></div></div>
</div>
<p>On extrait une valeur en indiquant sa position dans la table avec des entiers :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.iloc[1, 2]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;euros&#39;
</pre></div></div>
</div>
<p>Avec <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html">loc</a>, il faut préciser le nombre de la colonne.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.columns
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;date&#39;, &#39;prix&#39;, &#39;devise&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.loc[1, &quot;prix&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
221.0
</pre></div></div>
</div>
<p>Mais il est possible d’utiliser une colonne ou plusieurs colonnes comme index (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html">set_index</a>) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>dfi = df.set_index(&quot;date&quot;)
dfi
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>prix</th>
      <th>devise</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-06-22</th>
      <td>220.0</td>
      <td>euros</td>
    </tr>
    <tr>
      <th>2014-06-23</th>
      <td>221.0</td>
      <td>euros</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On peut maintenant désigner une ligne par une date avec <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html">loc</a> (mais pas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iloc.html">iloc</a> car <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iloc.html">iloc</a> n’accepte que des entiers qui se réfère aux index de chaque dimension).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>dfi.loc[&quot;2014-06-23&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
prix      221.0
devise    euros
Name: 2014-06-23, dtype: object
</pre></div></div>
</div>
<p>Il est possible d’utiliser plusieurs colonnes comme <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/indexing.html">index</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df = pandas.DataFrame(
    [
        {&quot;prénom&quot;: &quot;xavier&quot;, &quot;nom&quot;: &quot;dupré&quot;, &quot;arrondissement&quot;: 18},
        {&quot;prénom&quot;: &quot;clémence&quot;, &quot;nom&quot;: &quot;dupré&quot;, &quot;arrondissement&quot;: 15},
    ]
)
dfi = df.set_index([&quot;nom&quot;, &quot;prénom&quot;])
dfi.loc[&quot;dupré&quot;, &quot;xavier&quot;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
arrondissement    18
Name: (dupré, xavier), dtype: int64
</pre></div></div>
</div>
<p>Si on veut changer l’index ou le supprimer (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reset_index.html">reset_index</a>) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>dfi.reset_index(drop=False, inplace=True)
# le mot-clé drop pour garder ou non les colonnes servant d&#39;index
# inplace signifie qu&#39;on modifie l&#39;instance et non qu&#39;une copie est modifiée
# donc on peut aussi écrire dfi2 = dfi.reset_index(drop=False)
dfi.set_index([&quot;nom&quot;, &quot;arrondissement&quot;], inplace=True)
dfi
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>prénom</th>
    </tr>
    <tr>
      <th>nom</th>
      <th>arrondissement</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">dupré</th>
      <th>18</th>
      <td>xavier</td>
    </tr>
    <tr>
      <th>15</th>
      <td>clémence</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Les index sont particulièrement utiles lorsqu’il s’agit de fusionner deux tables. Pour des petites tables, la plupart du temps, il est plus facile de s’en passer.</p>
</section>
<section id="Notation-avec-le-symbole-:">
<h3>Notation avec le symbole <code class="docutils literal notranslate"><span class="pre">:</span></code><a class="headerlink" href="#Notation-avec-le-symbole-:" title="Link to this heading">#</a></h3>
<p>Le symbole <code class="docutils literal notranslate"><span class="pre">:</span></code> désigne une plage de valeurs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas, urllib.request

df = df_marathon
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PARIS</td>
      <td>2010</td>
      <td>02:06:41</td>
      <td>7601</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PARIS</td>
      <td>2009</td>
      <td>02:05:47</td>
      <td>7547</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PARIS</td>
      <td>2008</td>
      <td>02:06:40</td>
      <td>7600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>2007</td>
      <td>02:07:17</td>
      <td>7637</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On peut sélectionner un sous-ensemble de lignes :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[3:6]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>PARIS</td>
      <td>2008</td>
      <td>02:06:40</td>
      <td>7600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>2007</td>
      <td>02:07:17</td>
      <td>7637</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PARIS</td>
      <td>2006</td>
      <td>02:08:03</td>
      <td>7683</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On extrait la même plage mais avec deux colonnes seulement :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.loc[3:6, [&quot;annee&quot;, &quot;temps&quot;]]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>annee</th>
      <th>temps</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2008</td>
      <td>02:06:40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2007</td>
      <td>02:07:17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2006</td>
      <td>02:08:03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2005</td>
      <td>02:08:02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Le même code pour lequel on renomme les colonnes extraites :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>sub = df.loc[3:6, [&quot;annee&quot;, &quot;temps&quot;]]
sub.columns = [&quot;year&quot;, &quot;time&quot;]
sub
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2008</td>
      <td>02:06:40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2007</td>
      <td>02:07:17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2006</td>
      <td>02:08:03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2005</td>
      <td>02:08:02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Exercice-1-:-créer-un-fichier-Excel">
<h3>Exercice 1 : créer un fichier Excel<a class="headerlink" href="#Exercice-1-:-créer-un-fichier-Excel" title="Link to this heading">#</a></h3>
<p>On souhaite récupérer les données <a class="reference external" href="https://github.com/sdpython/teachpyx/raw/main/_data/donnees_enquete_2003_television.txt">donnees_enquete_2003_television.txt</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">POIDSLOG</span></code> : Pondération individuelle relative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POIDSF</span></code> : Variable de pondération individuelle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cLT1FREQ</span></code> : Nombre d’heures en moyenne passées à regarder la télévision</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cLT2FREQ</span></code> : Unité de temps utilisée pour compter le nombre d’heures passées à regarder la télévision, cette unité est représentée par les quatre valeurs suivantes</p>
<ul>
<li><p>0 : non concerné</p></li>
<li><p>1 : jour</p></li>
<li><p>2 : semaine</p></li>
<li><p>3 : mois</p></li>
</ul>
</li>
</ul>
<p>Ensuite, on veut :</p>
<ol class="arabic simple">
<li><p>Supprimer les colonnes vides</p></li>
<li><p>Obtenir les valeurs distinctes pour la colonne <code class="docutils literal notranslate"><span class="pre">cLT2FREQ</span></code></p></li>
<li><p>Modifier la matrice pour enlever les lignes pour lesquelles l’unité de temps (cLT2FREQ) n’est pas renseignée ou égale à zéro.</p></li>
<li><p>Sauver le résultat au format Excel.</p></li>
</ol>
<p>Vous aurez peut-être besoin des fonctions suivantes :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.isnan.html">numpy.isnan</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html">DataFrame.apply</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html">DataFrame.fillna</a> ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isnull.html">DataFrame.isnull</a> ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.notnull.html">DataFrame.notnull</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.copy.html">DataFrame.copy</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas, io

# ...
</pre></div>
</div>
</div>
</section>
</section>
<section id="Manipuler-un-DataFrame">
<h2>Manipuler un DataFrame<a class="headerlink" href="#Manipuler-un-DataFrame" title="Link to this heading">#</a></h2>
<p>Si la structure <em>DataFrame</em> s’est imposée, c’est parce qu’on effectue toujours les mêmes opérations. Chaque fonction cache une boucle ou deux dont le coût est précisé en fin de ligne :</p>
<ul class="simple">
<li><p><strong>filter</strong> : on sélectionne un sous-ensemble de lignes qui vérifie une condition <img class="math" src="../_images/math/f95fc14850902a138c1b465fdf0745ccdb26a690.svg" alt="\rightarrow O(n)"/></p></li>
<li><p><strong>union</strong> : concaténation de deux jeux de données <img class="math" src="../_images/math/ba9e7096fb58e187dbf39147aea760ea3ff11c65.svg" alt="\rightarrow O(n_1 + n_2)"/></p></li>
<li><p><strong>sort</strong> : tri <img class="math" src="../_images/math/a4a3fa0eb48d327977e1afd9fbb911285da0d457.svg" alt="\rightarrow O(n \ln n)"/></p></li>
<li><p><strong>group by</strong> : grouper des lignes qui partagent une valeur commune <img class="math" src="../_images/math/f95fc14850902a138c1b465fdf0745ccdb26a690.svg" alt="\rightarrow O(n)"/></p></li>
<li><p><strong>join</strong> : fusionner deux jeux de données en associant les lignes qui partagent une valeur commune <img class="math" src="../_images/math/1942b3bf8ec31ae0bedba80daafaf1d9b1a4e4ab.svg" alt="\rightarrow \in [O(n_1 + n_2), O(n_1 n_2)]"/></p></li>
<li><p><strong>pivot</strong> : utiliser des valeurs présentes dans colonne comme noms de colonnes <img class="math" src="../_images/math/f95fc14850902a138c1b465fdf0745ccdb26a690.svg" alt="\rightarrow O(n)"/></p></li>
</ul>
<p>Les 5 premières opérations sont issues de la logique de manipulation des données avec le langage <a class="reference external" href="http://fr.wikipedia.org/wiki/Structured_Query_Language">SQL</a> (ou le logiciel <a class="reference external" href="http://www.sas.com">SAS</a>). La dernière correspond à un <a class="reference external" href="http://fr.wikipedia.org/wiki/Tableau_crois%C3%A9_dynamique">tableau croisé dynamique</a>. Pour illustrer ces opérations, on prendre le <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a> suivant :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

df = df_marathon
print(df.columns)
print(&quot;villes&quot;, set(df.ville))
print(&quot;annee&quot;, list(set(df.annee))[:10], &quot;...&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;ville&#39;, &#39;annee&#39;, &#39;temps&#39;, &#39;secondes&#39;], dtype=&#39;object&#39;)
villes {&#39;BOSTON&#39;, &#39;FUKUOKA&#39;, &#39;CHICAGO&#39;, &#39;STOCKOLM&#39;, &#39;NEW YORK&#39;, &#39;LONDON&#39;, &#39;PARIS&#39;, &#39;BERLIN&#39;, &#39;AMSTERDAM&#39;}
annee [1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956] ...
</pre></div></div>
</div>
<section id="6-opérations-:-filtrer,-union,-sort,-group-by,-join,-pivot">
<h3>6 opérations : filtrer, union, sort, group by, join, pivot<a class="headerlink" href="#6-opérations-:-filtrer,-union,-sort,-group-by,-join,-pivot" title="Link to this heading">#</a></h3>
<section id="filter">
<h4>filter<a class="headerlink" href="#filter" title="Link to this heading">#</a></h4>
<p>Filter consiste à sélectionner un sous-ensemble de lignes du dataframe. Pour filter sur plusieurs conditions, il faut utiliser les opérateurs logique &amp; (et), | (ou), ~ (non) (voir <a class="reference external" href="https://docs.python.org/3.4/library/operator.html#mapping-operators-to-functions">Mapping Operators to Functions</a>).</p>
<ul class="simple">
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.filter.html">filter</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.mask.html">mask</a>,<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.where.html">where</a></p></li>
<li><p><a class="reference external" href="http://stackoverflow.com/questions/11869910/pandas-filter-rows-of-dataframe-with-operator-chaining">pandas: filter rows of DataFrame with operator chaining</a></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/indexing.html">Indexing and Selecting Data</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>subset = df[df.annee == 1971]
subset.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>112</th>
      <td>FUKUOKA</td>
      <td>1971</td>
      <td>02:12:51</td>
      <td>7971</td>
    </tr>
    <tr>
      <th>204</th>
      <td>NEW YORK</td>
      <td>1971</td>
      <td>02:22:54</td>
      <td>8574</td>
    </tr>
    <tr>
      <th>285</th>
      <td>BOSTON</td>
      <td>1971</td>
      <td>02:18:45</td>
      <td>8325</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>subset = df[(df.annee == 1971) &amp; (df.ville == &quot;BOSTON&quot;)]
subset.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>285</th>
      <td>BOSTON</td>
      <td>1971</td>
      <td>02:18:45</td>
      <td>8325</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Les dernières versions de pandas ont introduit la méthode <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html">query</a> qui permet de réduire encore l’écriture :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>subset = df.query(&#39;(annee == 1971) &amp; (ville == &quot;BOSTON&quot;)&#39;)
subset.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>285</th>
      <td>BOSTON</td>
      <td>1971</td>
      <td>02:18:45</td>
      <td>8325</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="union">
<h4>union<a class="headerlink" href="#union" title="Link to this heading">#</a></h4>
<p>union = concaténation de deux <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a> (qui n’ont pas nécessairement les mêmes colonnes). On peut concaténer les lignes ou les colonnes.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html">concat</a></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/merging.html">Merge, join, and concatenate</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>concat_ligne = pandas.concat((df, df))
df.shape, concat_ligne.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((359, 4), (718, 4))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>concat_col = pandas.concat((df, df), axis=1)
df.shape, concat_col.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((359, 4), (359, 8))
</pre></div></div>
</div>
</section>
<section id="sort">
<h4>sort<a class="headerlink" href="#sort" title="Link to this heading">#</a></h4>
<p>Sort = trier</p>
<ul class="simple">
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sort_values.html">sort</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>tri = df.sort_values([&quot;annee&quot;, &quot;ville&quot;], ascending=[0, 1])
tri.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>BERLIN</td>
      <td>2011</td>
      <td>02:03:38</td>
      <td>7418</td>
    </tr>
    <tr>
      <th>325</th>
      <td>BOSTON</td>
      <td>2011</td>
      <td>02:03:02</td>
      <td>7382</td>
    </tr>
    <tr>
      <th>202</th>
      <td>LONDON</td>
      <td>2011</td>
      <td>02:04:40</td>
      <td>7480</td>
    </tr>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
    </tr>
    <tr>
      <th>276</th>
      <td>STOCKOLM</td>
      <td>2011</td>
      <td>02:14:07</td>
      <td>8047</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="group-by">
<h4>group by<a class="headerlink" href="#group-by" title="Link to this heading">#</a></h4>
<p>Cette opération consiste à grouper les lignes qui partagent une caractéristique commune (une valeur dans une colonne ou plusieurs valeurs dans plusieurs colonnes). On peut conserver chaque groupe, ou calculer une somme, une moyenne, prendre la ou meilleures valeurs (top <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> per group)…</p>
<ul class="simple">
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html">groupby</a></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sum.html">sum</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.cumsum.html">cumsum</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.mean.html">mean</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.count.html">count</a></p></li>
<li><p><a class="reference external" href="http://sql.sh/cours/group-by">SQL GROUP BY</a></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/groupby.html">Group By: split-apply-combine</a></p></li>
<li><p><a class="reference external" href="http://stackoverflow.com/questions/15322632/python-pandas-df-groupby-agg-column-reference-in-agg">group by customisé</a></p></li>
<li><p><a class="reference external" href="http://stackoverflow.com/questions/32188867/fast-way-to-get-index-of-top-k-elements-of-every-column-in-a-pandas-dataframe">fast way to get index of top-k elements of every column in a pandas dataframe</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>gr = df.groupby(&quot;annee&quot;)
gr
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fd034df94b0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>nb = df.groupby(&quot;annee&quot;).count()
nb.sort_index(ascending=False).head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>nb = df[[&quot;annee&quot;, &quot;secondes&quot;]].groupby(&quot;annee&quot;).sum()
nb.sort_index(ascending=False).head(n=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>secondes</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011</th>
      <td>37916</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>68673</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>nb = df[[&quot;annee&quot;, &quot;secondes&quot;]].groupby(&quot;annee&quot;).mean()
nb.sort_index(ascending=False).head(n=3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>secondes</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011</th>
      <td>7583.200000</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>7630.333333</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>7652.555556</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Si les nom des colonnes utilisées lors de l’opération ne sont pas mentionnés, implicitement, c’est l’index qui sera choisi. On peut aussi aggréger les informations avec une fonction personnalisée.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>def max_entier(x):
    return int(max(x))


nb = df[[&quot;annee&quot;, &quot;secondes&quot;]].groupby(&quot;annee&quot;).agg(max_entier).reset_index()
nb.tail(n=3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>annee</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>62</th>
      <td>2009</td>
      <td>8134</td>
    </tr>
    <tr>
      <th>63</th>
      <td>2010</td>
      <td>7968</td>
    </tr>
    <tr>
      <th>64</th>
      <td>2011</td>
      <td>8047</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Ou encore considérer des aggrégations différentes pour chaque colonne :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>nb = (
    df[[&quot;annee&quot;, &quot;ville&quot;, &quot;secondes&quot;]]
    .groupby(&quot;annee&quot;)
    .agg({&quot;ville&quot;: len, &quot;secondes&quot;: max_entier})
)
nb.tail(n=3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>secondes</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009</th>
      <td>9</td>
      <td>8134</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>9</td>
      <td>7968</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>5</td>
      <td>8047</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On veut extraire les deux meilleurs temps par ville :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>series = df.groupby([&quot;ville&quot;]).apply(lambda r: r[&quot;secondes&quot;].nsmallest(2))
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>indices = [t[1] for t in series.index]
indices
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[171,
 170,
 35,
 38,
 325,
 324,
 357,
 347,
 74,
 75,
 202,
 200,
 234,
 222,
 2,
 0,
 248,
 251]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.loc[indices]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171</th>
      <td>AMSTERDAM</td>
      <td>2010</td>
      <td>02:05:44</td>
      <td>7544</td>
    </tr>
    <tr>
      <th>170</th>
      <td>AMSTERDAM</td>
      <td>2009</td>
      <td>02:06:18</td>
      <td>7578</td>
    </tr>
    <tr>
      <th>35</th>
      <td>BERLIN</td>
      <td>2011</td>
      <td>02:03:38</td>
      <td>7418</td>
    </tr>
    <tr>
      <th>38</th>
      <td>BERLIN</td>
      <td>2008</td>
      <td>02:03:59</td>
      <td>7439</td>
    </tr>
    <tr>
      <th>325</th>
      <td>BOSTON</td>
      <td>2011</td>
      <td>02:03:02</td>
      <td>7382</td>
    </tr>
    <tr>
      <th>324</th>
      <td>BOSTON</td>
      <td>2010</td>
      <td>02:05:52</td>
      <td>7552</td>
    </tr>
    <tr>
      <th>357</th>
      <td>CHICAGO</td>
      <td>2009</td>
      <td>02:05:41</td>
      <td>7541</td>
    </tr>
    <tr>
      <th>347</th>
      <td>CHICAGO</td>
      <td>1999</td>
      <td>02:05:42</td>
      <td>7542</td>
    </tr>
    <tr>
      <th>74</th>
      <td>FUKUOKA</td>
      <td>2009</td>
      <td>02:05:18</td>
      <td>7518</td>
    </tr>
    <tr>
      <th>75</th>
      <td>FUKUOKA</td>
      <td>2008</td>
      <td>02:06:10</td>
      <td>7570</td>
    </tr>
    <tr>
      <th>202</th>
      <td>LONDON</td>
      <td>2011</td>
      <td>02:04:40</td>
      <td>7480</td>
    </tr>
    <tr>
      <th>200</th>
      <td>LONDON</td>
      <td>2009</td>
      <td>02:05:10</td>
      <td>7510</td>
    </tr>
    <tr>
      <th>234</th>
      <td>NEW YORK</td>
      <td>2001</td>
      <td>02:07:43</td>
      <td>7663</td>
    </tr>
    <tr>
      <th>222</th>
      <td>NEW YORK</td>
      <td>1989</td>
      <td>02:08:01</td>
      <td>7681</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PARIS</td>
      <td>2009</td>
      <td>02:05:47</td>
      <td>7547</td>
    </tr>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
    </tr>
    <tr>
      <th>248</th>
      <td>STOCKOLM</td>
      <td>1983</td>
      <td>02:11:37</td>
      <td>7897</td>
    </tr>
    <tr>
      <th>251</th>
      <td>STOCKOLM</td>
      <td>1986</td>
      <td>02:12:33</td>
      <td>7953</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="join-(merge-ou-fusion)">
<h4>join (<em>merge</em> ou fusion)<a class="headerlink" href="#join-(merge-ou-fusion)" title="Link to this heading">#</a></h4>
<p>Fusionner deux tables consiste à apparier les lignes de la première table avec celle de la seconde si certaines colonnes de ces lignes partagent les mêmes valeurs. On distingue quatre cas :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INNER</span> <span class="pre">JOIN</span></code> - <strong>inner</strong> : on garde tous les appariements réussis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> - <strong>left</strong> : on garde tous les appariements réussis et les lignes non appariées de la table de gauche</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RIGHT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> - <strong>right</strong> : on garde tous les appariements réussis et les lignes non appariées de la table de droite</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FULL</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> - <strong>outer</strong> : on garde tous les appariements réussis et les lignes non appariées des deux tables</p></li>
</ul>
<p>Exemples et documentation : * <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html#merging">merging, joining</a> * <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join">join</a> * <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html">merge</a> ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge">DataFrame.merge</a> * <a class="reference external" href="http://sql.sh/cours/jointures">jointures
SQL</a> - illustrations avec graphiques en patates</p>
<p>Si les noms des colonnes utilisées lors de la fusion ne sont pas mentionnés, implicitement, c’est l’index qui sera choisi. Pour les grandes tables (&gt; 1.000.000 lignes), il est fortement recommandé d’ajouter un index s’il n’existe pas avant de fusionner. <strong>A quoi correspondent les quatre cas suivants (LEFT ou FULL ou RIGHT ou INNER) ?</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from IPython.display import Image

Image(&quot;patates.png&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_94_0.png" src="../_images/c_data_nb_dataframe_94_0.png" />
</div>
</div>
<p>On souhaite ajouter une colonne pays aux marathons se déroulant dans les villes suivantes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>values = [
    {&quot;V&quot;: &quot;BOSTON&quot;, &quot;C&quot;: &quot;USA&quot;},
    {&quot;V&quot;: &quot;NEW YORK&quot;, &quot;C&quot;: &quot;USA&quot;},
    {&quot;V&quot;: &quot;BERLIN&quot;, &quot;C&quot;: &quot;Germany&quot;},
    {&quot;V&quot;: &quot;LONDON&quot;, &quot;C&quot;: &quot;UK&quot;},
    {&quot;V&quot;: &quot;PARIS&quot;, &quot;C&quot;: &quot;France&quot;},
]
pays = pandas.DataFrame(values)
pays
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>V</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BOSTON</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NEW YORK</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BERLIN</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>3</th>
      <td>LONDON</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>France</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>dfavecpays = df.merge(pays, left_on=&quot;ville&quot;, right_on=&quot;V&quot;)
pandas.concat([dfavecpays.head(n=2), dfavecpays.tail(n=2)])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
      <th>V</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
      <td>PARIS</td>
      <td>France</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PARIS</td>
      <td>2010</td>
      <td>02:06:41</td>
      <td>7601</td>
      <td>PARIS</td>
      <td>France</td>
    </tr>
    <tr>
      <th>192</th>
      <td>BOSTON</td>
      <td>2010</td>
      <td>02:05:52</td>
      <td>7552</td>
      <td>BOSTON</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>193</th>
      <td>BOSTON</td>
      <td>2011</td>
      <td>02:03:02</td>
      <td>7382</td>
      <td>BOSTON</td>
      <td>USA</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Question :</strong></p>
<ul class="simple">
<li><p><strong>Que changerait l’ajout du paramètre ``how=”outer”`` dans ce cas ?</strong></p></li>
<li><p><strong>On cherche à joindre deux tables A,B qui ont chacune trois clés distinctes : :math:`c_1, c_2, c_3`. Il y a respectivement dans chaque table :math:`A_i` et :math:`B_i` lignes pour la clé :math:`c_i`. Combien la table finale issue de la fusion des deux tables contiendra-t-elle de lignes ?</strong></p></li>
</ul>
</section>
<section id="pivot-(tableau-croisé-dynamique)">
<h4>pivot (tableau croisé dynamique)<a class="headerlink" href="#pivot-(tableau-croisé-dynamique)" title="Link to this heading">#</a></h4>
<p>Cette opération consiste à créer une seconde table en utilisant utiliser les valeurs d’une colonne comme nom de colonnes.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A1</p></td>
<td><p>B1</p></td>
<td><p>C1</p></td>
</tr>
<tr class="row-odd"><td><p>A1</p></td>
<td><p>B2</p></td>
<td><p>C2</p></td>
</tr>
<tr class="row-even"><td><p>A2</p></td>
<td><p>B1</p></td>
<td><p>C3</p></td>
</tr>
<tr class="row-odd"><td><p>A2</p></td>
<td><p>B2</p></td>
<td><p>C4</p></td>
</tr>
<tr class="row-even"><td><p>A2</p></td>
<td><p>B3</p></td>
<td><p>C5</p></td>
</tr>
</tbody>
</table>
</div>
<p>L’opération <code class="docutils literal notranslate"><span class="pre">pivot(A,B,C)</span></code> donnera :</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B1</p></th>
<th class="head"><p>B2</p></th>
<th class="head"><p>B3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A1</p></td>
<td><p>C1</p></td>
<td><p>C2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>A2</p></td>
<td><p>C3</p></td>
<td><p>C4</p></td>
<td><p>C5</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html">pivot</a>, <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.tools.pivot.pivot_table.html">pivot_table</a></p></li>
<li><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reshaping.html">Reshaping and Pivot Tables</a></p></li>
<li><p><a class="reference external" href="http://fr.wikipedia.org/wiki/Tableau_crois%C3%A9_dynamique">Tableau croisé dynamique - wikipédia</a></p></li>
</ul>
<p>On applique cela aux marathons où on veut avoir les villes comme noms de colonnes et une année par ligne.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>piv = df.pivot(index=&quot;annee&quot;, columns=&quot;ville&quot;, values=&quot;temps&quot;)
pandas.concat([piv[20:23], piv[40:43], piv.tail(n=3)])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ville</th>
      <th>AMSTERDAM</th>
      <th>BERLIN</th>
      <th>BOSTON</th>
      <th>CHICAGO</th>
      <th>FUKUOKA</th>
      <th>LONDON</th>
      <th>NEW YORK</th>
      <th>PARIS</th>
      <th>STOCKOLM</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1967</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>02:15:45</td>
      <td>NaN</td>
      <td>02:09:37</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1968</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>02:22:17</td>
      <td>NaN</td>
      <td>02:10:48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1969</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>02:13:49</td>
      <td>NaN</td>
      <td>02:11:13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>02:12:40</td>
      <td>02:11:11</td>
      <td>02:11:50</td>
      <td>NaN</td>
      <td>02:08:18</td>
      <td>02:09:50</td>
      <td>02:11:01</td>
      <td>02:11:09</td>
      <td>02:13:52</td>
    </tr>
    <tr>
      <th>1988</th>
      <td>02:12:38</td>
      <td>02:11:45</td>
      <td>02:08:43</td>
      <td>02:08:57</td>
      <td>02:11:04</td>
      <td>02:10:20</td>
      <td>02:08:20</td>
      <td>02:13:53</td>
      <td>02:14:26</td>
    </tr>
    <tr>
      <th>1989</th>
      <td>02:13:52</td>
      <td>02:10:11</td>
      <td>02:09:06</td>
      <td>02:11:25</td>
      <td>02:12:54</td>
      <td>02:09:03</td>
      <td>02:08:01</td>
      <td>02:13:03</td>
      <td>02:13:34</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>02:06:18</td>
      <td>02:06:08</td>
      <td>02:08:42</td>
      <td>02:05:41</td>
      <td>02:05:18</td>
      <td>02:05:10</td>
      <td>02:09:15</td>
      <td>02:05:47</td>
      <td>02:15:34</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>02:05:44</td>
      <td>02:05:08</td>
      <td>02:05:52</td>
      <td>02:06:23</td>
      <td>02:08:24</td>
      <td>02:05:19</td>
      <td>02:08:14</td>
      <td>02:06:41</td>
      <td>02:12:48</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>NaN</td>
      <td>02:03:38</td>
      <td>02:03:02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>02:04:40</td>
      <td>NaN</td>
      <td>02:06:29</td>
      <td>02:14:07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Il existe une méthode qui effectue l’opération inverse : <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.stack.html">Dataframe.stack</a>.</p>
</section>
</section>
<section id="Lambda-fonctions">
<h3>Lambda fonctions<a class="headerlink" href="#Lambda-fonctions" title="Link to this heading">#</a></h3>
<p>Les <a class="reference external" href="https://docs.python.org/3.4/tutorial/controlflow.html#lambda-expressions">lambda expressions</a> permettent une syntaxe plus légère (syntactic sugar) pour déclarer une fonction simple. Cela est très utile pour passer une fonction en argument notamment. Par exemple pour trier sur le 2ème element d’un tuple.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>pairs = [(1, &quot;one&quot;), (2, &quot;two&quot;), (3, &quot;three&quot;), (4, &quot;four&quot;)]
pairs.sort(key=lambda pair: pair[1])
print(pairs)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(4, &#39;four&#39;), (1, &#39;one&#39;), (3, &#39;three&#39;), (2, &#39;two&#39;)]
</pre></div></div>
</div>
<p>On peut réécrire le groupby aggrégé par <code class="docutils literal notranslate"><span class="pre">max_entier</span></code> en utilisant une fonction lambda</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>def max_entier(x):
    return int(max(x))


nb = df[[&quot;annee&quot;, &quot;secondes&quot;]].groupby(&quot;annee&quot;).agg(max_entier).reset_index()
nb.tail(n=3)
# same as:
nb = df[[&quot;annee&quot;, &quot;secondes&quot;]].groupby(&quot;annee&quot;).agg(lambda x: int(max(x))).reset_index()
nb.tail(n=3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>annee</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>62</th>
      <td>2009</td>
      <td>8134</td>
    </tr>
    <tr>
      <th>63</th>
      <td>2010</td>
      <td>7968</td>
    </tr>
    <tr>
      <th>64</th>
      <td>2011</td>
      <td>8047</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Exercice-2-:-lambda-fonction">
<h3>Exercice 2 : lambda fonction<a class="headerlink" href="#Exercice-2-:-lambda-fonction" title="Link to this heading">#</a></h3>
<p>Ecrire une lambda fonction qui prend deux paramètres et qui est équivalente à la fonction suivante :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>def delta(x, y):
    return max(x, y) - min(x, y)
</pre></div>
</div>
</div>
<p>On utilise beaucoup les lambda fonctions lorsqu’une fonction prend une fonction en argument :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>def riemann(a, b, f, n):
    return sum(f(a + (b - a) * i / n) for i in range(0, n)) / n


riemann(0, 1, lambda x: x**2, 1000)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3328334999999999
</pre></div></div>
</div>
<p>Ensuite, il faut utiliser une lambda fonction et la fonction <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html">apply</a> pour tirer un échantillon aléatoire</p>
</section>
<section id="Exercice-3-:-moyennes-par-groupes">
<h3>Exercice 3 : moyennes par groupes<a class="headerlink" href="#Exercice-3-:-moyennes-par-groupes" title="Link to this heading">#</a></h3>
<p>Toujours avec le même jeu de données (<a class="reference external" href="https://github.com/sdpython/teachpyx/raw/main/_data/marathon.txt">marathon.txt</a>), on veut ajouter une ligne à la fin du tableau croisé dynamique contenant la moyenne en secondes des temps des marathons pour chaque ville.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Avec-ou-sans-index">
<h3>Avec ou sans index<a class="headerlink" href="#Avec-ou-sans-index" title="Link to this heading">#</a></h3>
<p>Une façon naïve de faire une jointure entre deux tables de taille <img class="math" src="../_images/math/435b11e0dbea2eaa16cbb0b93b9266e88b4a5b4c.svg" alt="m"/> et <img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> et de regarder toutes les <img class="math" src="../_images/math/b689bc570606881e252aa30f7bfa8a3f6cfc0cb7.svg" alt="mn"/> combinaisons possibles. La taille de la table résultante dépend du type de jointure (<code class="docutils literal notranslate"><span class="pre">inner</span></code>, <code class="docutils literal notranslate"><span class="pre">outer</span></code>) et de l’unicité des clés utilisées pour la jointure. Si les clés sont uniques, la table finale aura au plus <img class="math" src="../_images/math/4c5cd3f19c354dfb4e4c028034e59ef70b088fbb.svg" alt="m+n"/> lignes (une par clé).</p>
<p>Dans la plupart des cas, <img class="math" src="../_images/math/5330328616340a9a56864adc669bbe596d6213e9.svg" alt="O(mn)"/> opérations est beaucoup trop long. On peut faire plus rapide en triant chacune des tables d’abord et en les fusionnant : <img class="math" src="../_images/math/c0266be19801f56e14ecd1161eed34eee57f59ff.svg" alt="O(n \ln n) + O(m \ln m) + O(n+m)"/>. Si <img class="math" src="../_images/math/58abd600b78c357f84b504bbf0d4e710d22d4f22.svg" alt="m=n"/>, il est évident que cette façon de faire est plus rapide. C’est une des choses que fait <a class="reference external" href="http://fr.slideshare.net/wesm/a-look-at-pandas-design-and-development">pandas (présentation)</a> (voir aussi <a class="reference external" href="https://github.com/attractivechaos/klib">klib</a>).</p>
<p>On peut trier une table selon une clé ou encore utiliser une <a class="reference external" href="https://fr.wikipedia.org/wiki/Table_de_hachage">table de hachage</a>), il est alors très rapide de retrouver la ligne ou les lignes qui partagent cette clé. On dit que la table est <strong>indexée</strong> selon cette clé. Indexer selon une ou plusieurs colonnes une table accélère toute opération s’appuyant sur ces colonnes comme la recherche d’un élément.</p>
<p>On veut comparer le temps nécessaire pour une recherche. Pour cela on utilise la <code class="docutils literal notranslate"><span class="pre">%magic</span></code> function <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> (ou <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code> si on veut l”<a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">appliquer à la cellule</a>) de Jupyter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas, random

big_df = pandas.DataFrame(
    {
        &quot;cle1&quot;: random.randint(1, 100),
        &quot;cle2&quot;: random.randint(1, 100),
        &quot;autre&quot;: random.randint(1, 10),
    }
    for i in range(0, 100000)
)
big_df.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(100000, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>%timeit big_df[(big_df.cle1 == 1) &amp; (big_df.cle2 == 1)]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
784 µs ± 33.5 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div></div>
</div>
<p>Et la version indexée :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>big_dfi = big_df.set_index([&quot;cle1&quot;, &quot;cle2&quot;])
big_dfi = big_dfi.sort_index()  # Il ne faut oublier de trier.

%timeit big_dfi.loc[(1,1), :]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
310 µs ± 8.6 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>big_dfi.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>autre</th>
    </tr>
    <tr>
      <th>cle1</th>
      <th>cle2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th>1</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Plus la table est grande, plus le gain est important.</strong></p>
</section>
<section id="Dates">
<h3>Dates<a class="headerlink" href="#Dates" title="Link to this heading">#</a></h3>
<p>Les dates sont souvent compliquées à gérer car on n’utilise pas le mêmes format dans tous les pays. Pour faire simple, je recommande deux options :</p>
<ul class="simple">
<li><p>Soit convertir les dates/heures au format chaînes de caractères <code class="docutils literal notranslate"><span class="pre">AAAA-MM-JJ</span> <span class="pre">hh:mm:ss:ms</span></code> qui permet de trier les dates par ordre croissant.</p></li>
<li><p>Soit convertir les dates/heures au format <a class="reference external" href="https://docs.python.org/3/library/datetime.html">datetime</a> (date) ou <a class="reference external" href="https://docs.python.org/3/library/datetime.html#timedelta-objects">timedelta</a> (durée), voir <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">format de date/heure</a>).</p></li>
</ul>
<p>Par exemple, voici le code qui a permis de générer la colonne seconde de la table marathon :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from datetime import datetime, time

df = df_marathon
df = df[[&quot;ville&quot;, &quot;annee&quot;, &quot;temps&quot;]]  # on enlève la colonne secondes pour la recréer
df[&quot;secondes&quot;] = df.apply(
    lambda r: (
        datetime.strptime(r.temps, &quot;%H:%M:%S&quot;) - datetime(1900, 1, 1)
    ).total_seconds(),
    axis=1,
)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PARIS</td>
      <td>2010</td>
      <td>02:06:41</td>
      <td>7601.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PARIS</td>
      <td>2009</td>
      <td>02:05:47</td>
      <td>7547.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PARIS</td>
      <td>2008</td>
      <td>02:06:40</td>
      <td>7600.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>2007</td>
      <td>02:07:17</td>
      <td>7637.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Plot(s)">
<h2>Plot(s)<a class="headerlink" href="#Plot(s)" title="Link to this heading">#</a></h2>
<section id="Récupération-des-données">
<h3>Récupération des données<a class="headerlink" href="#Récupération-des-données" title="Link to this heading">#</a></h3>
<p>On récupère les données disponibles sur le site de l’INSEE : <a class="reference external" href="https://www.insee.fr/fr/statistiques/2407910?sommaire=2117120">Naissance, décès, mariages 2012</a>. Il s’agit de récupérer la liste des mariages de l’année 2012. On souhaite représenter le graphe du nombre de mariages en fonction de l’écart entre les mariés.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import urllib.request
import zipfile
import http.client


def download_and_save(name, root_url):
    try:
        response = urllib.request.urlopen(root_url + name)
    except (TimeoutError, urllib.request.URLError, http.client.BadStatusLine):
        # back up plan
        root_url = (
            &quot;https://github.com/sdpython/teachdata/raw/main/naissance_deces_mariage/&quot;
        )
        response = urllib.request.urlopen(root_url + name)
    with open(name, &quot;wb&quot;) as outfile:
        outfile.write(response.read())


def unzip(name):
    with zipfile.ZipFile(name, &quot;r&quot;) as z:
        z.extractall(&quot;.&quot;)


filenames = [
    &quot;etatcivil2012_mar2012_dbase.zip&quot;,
    &quot;etatcivil2012_nais2012_dbase.zip&quot;,
    &quot;etatcivil2012_dec2012_dbase.zip&quot;,
]
root_url = &quot;https://www.insee.fr/fr/statistiques/fichier/2407910/&quot;

for filename in filenames:
    download_and_save(filename, root_url)
    unzip(filename)
    print(&quot;Download of {}: DONE!&quot;.format(filename))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Download of etatcivil2012_mar2012_dbase.zip: DONE!
Download of etatcivil2012_nais2012_dbase.zip: DONE!
Download of etatcivil2012_dec2012_dbase.zip: DONE!
</pre></div></div>
</div>
<p>L’exemple suivant pourrait ne pas marcher si le module <a class="reference external" href="https://github.com/olemb/dbfread/">dbfread</a> n’est pas installé. Si tel est le cas, le programme utilisera une version des données après utilisation de ce module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas
from dbfread import DBF


def dBase2df(dbase_filename):
    table = DBF(dbase_filename, load=True, encoding=&quot;cp437&quot;)
    return pandas.DataFrame(table.records)


df = df_civil = dBase2df(&quot;mar2012.dbf&quot;)
# df.to_csv(&quot;mar2012.txt&quot;, sep=&quot;\t&quot;, encoding=&quot;utf8&quot;, index=False)

df.shape, df.columns
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[64], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">pandas</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">dbfread</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> DBF
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">dBase2df</span>(dbase_filename):
<span class="ansi-green-intense-fg ansi-bold">      6</span>     table <span style="color: rgb(98,98,98)">=</span> DBF(dbase_filename, load<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, encoding<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">cp437</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;dbfread&#39;
</pre></div></div>
</div>
<p>L”<a class="reference external" href="http://fr.wikipedia.org/wiki/Codage_des_caract%C3%A8res">encoding</a> est une façon de représenter les caractères spéciaux (comme les caractères accentuées). L’encoding le plus répandu est <code class="docutils literal notranslate"><span class="pre">utf-8</span></code>. Sans la mention <code class="docutils literal notranslate"><span class="pre">encoding=&quot;cp437&quot;</span></code>, la fonction qui lit le fichier fait des erreurs lors de la lecture car elle ne sait pas comment interpréter certains caractères spéciaux. On récupère de la même manière la signification des variables :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>vardf = dBase2df(&quot;varlist_mariages.dbf&quot;)
print(vardf.shape, vardf.columns)
vardf
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(16, 4) Index([&#39;VARIABLE&#39;, &#39;LIBELLE&#39;, &#39;TYPE&#39;, &#39;LONGUEUR&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VARIABLE</th>
      <th>LIBELLE</th>
      <th>TYPE</th>
      <th>LONGUEUR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AMAR</td>
      <td>Année du mariage</td>
      <td>CHAR</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ANAISF</td>
      <td>Année de naissance de l'épouse</td>
      <td>CHAR</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ANAISH</td>
      <td>Année de naissance de l'époux</td>
      <td>CHAR</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>DEPDOM</td>
      <td>Département de domicile après le mariage</td>
      <td>CHAR</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>DEPMAR</td>
      <td>Département de mariage</td>
      <td>CHAR</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>DEPNAISF</td>
      <td>Département de naissance de l'épouse</td>
      <td>CHAR</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DEPNAISH</td>
      <td>Département de naissance de l'époux</td>
      <td>CHAR</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ETAMATF</td>
      <td>État matrimonial antérieur de l'épouse</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ETAMATH</td>
      <td>État matrimonial antérieur de l'époux</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>INDNATF</td>
      <td>Indicateur de nationalité de l'épouse</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>INDNATH</td>
      <td>Indicateur de nationalité de l'époux</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>JSEMAINE</td>
      <td>Jour du mariage dans la semaine</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>MMAR</td>
      <td>Mois du mariage</td>
      <td>CHAR</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NBENFCOM</td>
      <td>Enfants en commun avant le mariage</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>TUCOM</td>
      <td>Tranche de commune du lieu de domicile des époux</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>TUDOM</td>
      <td>Tranche d'unité urbaine du lieu de domicile de...</td>
      <td>CHAR</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Exercice-4-:-nuage-de-points">
<h3>Exercice 4 : nuage de points<a class="headerlink" href="#Exercice-4-:-nuage-de-points" title="Link to this heading">#</a></h3>
<p>On veut tracer un nuage de points avec en abscisse l’âge du mari, en ordonnée, l’âge de la femme. Il faudra peut-être jeter un coup d’oeil sur la documentation de la méthode <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.plot.html">plot</a>. Etant donné le nombre d’observations, ce graphe risque d’être moins lisible qu’une <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/visualization.html#visualization-hexbin">heatmap</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># df.plot(...)
</pre></div>
</div>
</div>
</section>
<section id="Exercice-5-:-graphe-d'une-distribution-avec-pandas">
<h3>Exercice 5 : graphe d’une distribution avec pandas<a class="headerlink" href="#Exercice-5-:-graphe-d'une-distribution-avec-pandas" title="Link to this heading">#</a></h3>
<p>En ajoutant une colonne et en utilisant l’opération <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/groupby.html">group by</a>, on veut obtenir la distribution du nombre de mariages en fonction de l’écart entre les mariés. Au besoin, on changera le type d’une colone ou deux. Le module <code class="docutils literal notranslate"><span class="pre">pandas</span></code> propose un panel de graphiques standard faciles à obtenir. On souhaite représenter la distribution sous forme d’histogramme. A vous de choisir le meilleure graphique depuis la page
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/visualization.html">Visualization</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># df[&quot;colonne&quot;] = df.apply(lambda r: int(r[&quot;colonne&quot;]), axis=1)  # pour changer de type
# df[&quot;difference&quot;] = ...
</pre></div>
</div>
</div>
</section>
<section id="matplotlib">
<h3>matplotlib<a class="headerlink" href="#matplotlib" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="http://matplotlib.org/">matplotlib</a> est le module qu’utilise <a class="reference external" href="http://pandas.pydata.org/">pandas</a>. Ainsi, la méthode <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.plot.html">plot</a> retourne un objet de type <a class="reference external" href="http://matplotlib.org/api/axes_api.html#module-matplotlib.axes">Axes</a> qu’on peut modifier par la suite via les <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">méthodes suivantes</a>. On peut ajouter un titre avec
<a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.set_title">set_title</a> ou ajouter une grille avec <a class="reference external" href="http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.grid">grid</a>. On peut également superposer <a class="reference external" href="http://stackoverflow.com/questions/19941685/how-to-show-a-bar-and-line-graph-on-the-same-plot">deux courbes sur le même graphique</a>, ou <a class="reference external" href="http://stackoverflow.com/questions/12444716/how-do-i-set-figure-title-and-axes-labels-font-size-in-matplotlib">changer de taille de
caractères</a>. Le code suivant trace le nombre de mariages par département.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;nb&quot;] = 1
dep = (
    df[[&quot;DEPMAR&quot;, &quot;nb&quot;]]
    .groupby(&quot;DEPMAR&quot;, as_index=False)
    .sum()
    .sort_values(&quot;nb&quot;, ascending=False)
)
ax = dep.plot(kind=&quot;bar&quot;, figsize=(18, 6))
ax.set_xlabel(&quot;départements&quot;, fontsize=16)
ax.set_title(&quot;nombre de mariages par départements&quot;, fontsize=16)
ax.legend().set_visible(False)  # on supprime la légende
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_134_0.png" src="../_images/c_data_nb_dataframe_134_0.png" />
</div>
</div>
<p>Quand on ne sait pas, le plus simple est d’utiliser un moteur de recherche avec un requête du type : <code class="docutils literal notranslate"><span class="pre">matplotlib</span> <span class="pre">+</span> <span class="pre">requête</span></code>. Pour créer un graphique, le plus courant est de choisir le graphique le plus ressemblant d’une <a class="reference external" href="http://matplotlib.org/gallery.html">gallerie de graphes</a> puis de l’adapter à vos données.</p>
</section>
<section id="Exercice-6-:-distribution-des-mariages-par-jour">
<h3>Exercice 6 : distribution des mariages par jour<a class="headerlink" href="#Exercice-6-:-distribution-des-mariages-par-jour" title="Link to this heading">#</a></h3>
<p>On veut obtenir un graphe qui contient l’histogramme de la distribution du nombre de mariages par jour de la semaine et d’ajouter une seconde courbe correspond avec un second axe à la répartition cumulée.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Annexes">
<h2>Annexes<a class="headerlink" href="#Annexes" title="Link to this heading">#</a></h2>
<section id="Créer-un-fichier-Excel-avec-plusieurs-feuilles">
<h3>Créer un fichier Excel avec plusieurs feuilles<a class="headerlink" href="#Créer-un-fichier-Excel-avec-plusieurs-feuilles" title="Link to this heading">#</a></h3>
<p>La page <a class="reference external" href="https://github.com/pydata/pandas/issues/3441">Allow ExcelWriter() to add sheets to existing workbook</a> donne plusieurs exemples d’écriture. On diminue la taille du document Excel à écrire.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df1000 = df[:1000]
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

writer = pandas.ExcelWriter(&quot;ton_example100.xlsx&quot;)
df1000.to_excel(writer, &quot;Data 0&quot;)
df1000.to_excel(writer, &quot;Data 1&quot;)
writer.close()
</pre></div>
</div>
</div>
</section>
</section>
<section id="Eléments-de-réponses-pour-les-exercices">
<h2>Eléments de réponses pour les exercices<a class="headerlink" href="#Eléments-de-réponses-pour-les-exercices" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Exercice 1 : créer un fichier Excel<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>On souhaite récupérer les données <a class="reference external" href="https://github.com/sdpython/teachpyx/raw/main/_data/donnees_enquete_2003_television.txt">donnees_enquete_2003_television.txt</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">POIDSLOG</span></code> : Pondération individuelle relative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POIDSF</span></code> : Variable de pondération individuelle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cLT1FREQ</span></code> : Nombre d’heures en moyenne passées à regarder la télévision</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cLT2FREQ</span></code> : Unité de temps utilisée pour compter le nombre d’heures passées à regarder la télévision, cette unité est représentée par les quatre valeurs suivantes</p>
<ul>
<li><p>0 : non concerné</p></li>
<li><p>1 : jour</p></li>
<li><p>2 : semaine</p></li>
<li><p>3 : mois</p></li>
</ul>
</li>
</ul>
<p>Ensuite, on veut :</p>
<ol class="arabic simple">
<li><p>Supprimer les colonnes vides</p></li>
<li><p>Obtenir les valeurs distinctes pour la colonne <code class="docutils literal notranslate"><span class="pre">cLT2FREQ</span></code></p></li>
<li><p>Modifier la matrice pour enlever les lignes pour lesquelles l’unité de temps (cLT2FREQ) n’est pas renseignée ou égale à zéro.</p></li>
<li><p>Sauver le résultat au format Excel.</p></li>
</ol>
<p>Vous aurez peut-être besoin des fonctions suivantes :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.isnan.html">numpy.isnan</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html">DataFrame.apply</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html">DataFrame.fillna</a> ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isnull.html">DataFrame.isnull</a> ou <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.notnull.html">DataFrame.notnull</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.copy.html">DataFrame.copy</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df = pandas.read_csv(
    &quot;https://github.com/sdpython/teachpyx/raw/main/_data/donnees_enquete_2003_television.txt&quot;,
    sep=&quot;\t&quot;,
)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>POIDLOG</th>
      <th>POIDSF</th>
      <th>cLT1FREQ</th>
      <th>cLT2FREQ</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
      <th>...</th>
      <th>Unnamed: 22</th>
      <th>Unnamed: 23</th>
      <th>Unnamed: 24</th>
      <th>Unnamed: 25</th>
      <th>Unnamed: 26</th>
      <th>Unnamed: 27</th>
      <th>Unnamed: 28</th>
      <th>Unnamed: 29</th>
      <th>Unnamed: 30</th>
      <th>Unnamed: 31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.889422</td>
      <td>4766.865201</td>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.310209</td>
      <td>12381.589746</td>
      <td>30</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.740070</td>
      <td>14685.431344</td>
      <td>6</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.775545</td>
      <td>9516.049939</td>
      <td>1</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.732512</td>
      <td>3925.907588</td>
      <td>3</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 32 columns</p>
</div></div>
</div>
<p>On enlève les colonnes vides :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df = df[[c for c in df.columns if &quot;Unnamed&quot; not in c]]
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>POIDLOG</th>
      <th>POIDSF</th>
      <th>cLT1FREQ</th>
      <th>cLT2FREQ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.889422</td>
      <td>4766.865201</td>
      <td>2</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.310209</td>
      <td>12381.589746</td>
      <td>30</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.740070</td>
      <td>14685.431344</td>
      <td>6</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.775545</td>
      <td>9516.049939</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.732512</td>
      <td>3925.907588</td>
      <td>3</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>notnull = df[~df.cLT2FREQ.isnull()]  # équivalent )  df [ df.cLT2FREQ.notnull() ]
print(len(df), len(notnull))
notnull.tail()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8403 7386
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>POIDLOG</th>
      <th>POIDSF</th>
      <th>cLT1FREQ</th>
      <th>cLT2FREQ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8397</th>
      <td>0.502091</td>
      <td>2690.961176</td>
      <td>3</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8398</th>
      <td>0.306852</td>
      <td>1644.574141</td>
      <td>6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8399</th>
      <td>2.501181</td>
      <td>13405.104689</td>
      <td>6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8400</th>
      <td>1.382758</td>
      <td>7410.905653</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8401</th>
      <td>0.343340</td>
      <td>1840.132652</td>
      <td>3</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>notnull.to_excel(&quot;data.xlsx&quot;)  # question 4
</pre></div>
</div>
</div>
<p><strong>Questions</strong></p>
<ul class="simple">
<li><p>Que changerait l’ajout du paramètre <code class="docutils literal notranslate"><span class="pre">how='outer'</span></code> dans ce cas ?</p></li>
<li><p>On cherche à joindre deux tables A,B qui ont chacune trois clés distinctes : <img class="math" src="../_images/math/48135ae7d11b1d754eb2fe297768063719898f60.svg" alt="c_1, c_2, c_3"/>. Il y a respectivement dans chaque table <img class="math" src="../_images/math/b17601b9927788a9c3f97add13dc96da39ce04f3.svg" alt="A_i"/> et <img class="math" src="../_images/math/d2b100e8cb992470dc4fbff1d3f16e0f304aed86.svg" alt="B_i"/> lignes pour la clé <img class="math" src="../_images/math/fa4ae29716395f8ebb2444ec26b1c6da2f3b53db.svg" alt="c_i"/>. Combien la table finale issue de la fusion des deux tables contiendra-t-elle de lignes ?</p></li>
</ul>
<p>L’ajout du paramètres <code class="docutils literal notranslate"><span class="pre">how='outer'</span></code> ne changerait rien dans ce cas car les deux tables fusionnées contiennent exactement les mêmes clés.</p>
<p>Le nombre de lignes obtenus serait <img class="math" src="../_images/math/24dc25c79386ea60518bf9aa644f2bbd9072bd74.svg" alt="\sum_{i=1}^{3} A_i B_i"/>. Il y a trois clés, chaque ligne de la table A doit être associée à toutes les lignes de la table B partageant la même clé.</p>
</section>
<section id="Exercice-2-:-lambda-function">
<h3>Exercice 2 : lambda function<a class="headerlink" href="#Exercice-2-:-lambda-function" title="Link to this heading">#</a></h3>
<p>Ecrire une <em>lambda function</em> qui prend deux paramètres et qui est équivalente à la fonction suivante</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>def delta(x, y):
    return max(x, y) - min(x, y)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>delta = lambda x, y: max(x, y) - min(x, y)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>delta(4, 5)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import random

df[&quot;select&quot;] = df.apply(lambda row: random.randint(1, 10), axis=1)
echantillon = df[df[&quot;select&quot;] == 1]
echantillon.shape, df.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((830, 5), (8403, 5))
</pre></div></div>
</div>
</section>
<section id="id2">
<h3>Exercice 3 : moyennes par groupes<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Toujours avec le même jeu de données, on veut ajouter une ligne à la fin du tableau croisé dynamique contenant la moyenne en secondes des temps des marathons pour chaque ville.</p>
<p>La solution requiert trois étapes.</p>
<ol class="arabic simple">
<li><p>Pour avoir la moyenne par villes, il faut grouper les lignes associées à la même villes.</p></li>
<li><p>Ensuite, il faut introduire ces moyennes dans la table initiale : on fusionne.</p></li>
<li><p>On effectue le même pivot que dans l’énoncé.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># étape 1
# par défaut, la méthode groupby utilise la clé de group comme index
# pour ne pas le faire, il faut préciser as_index = False
df = df_marathon
gr = df[[&quot;ville&quot;, &quot;secondes&quot;]].groupby(&quot;ville&quot;, as_index=False).mean()
gr.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>secondes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AMSTERDAM</td>
      <td>7883.371429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BERLIN</td>
      <td>7922.315789</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BOSTON</td>
      <td>7891.061224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CHICAGO</td>
      <td>7815.909091</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FUKUOKA</td>
      <td>8075.187500</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># étape 2 - on ajoute une colonne
tout = df.merge(gr, on=&quot;ville&quot;)
tout.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ville</th>
      <th>annee</th>
      <th>temps</th>
      <th>secondes_x</th>
      <th>secondes_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PARIS</td>
      <td>2011</td>
      <td>02:06:29</td>
      <td>7589</td>
      <td>7937.028571</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PARIS</td>
      <td>2010</td>
      <td>02:06:41</td>
      <td>7601</td>
      <td>7937.028571</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PARIS</td>
      <td>2009</td>
      <td>02:05:47</td>
      <td>7547</td>
      <td>7937.028571</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PARIS</td>
      <td>2008</td>
      <td>02:06:40</td>
      <td>7600</td>
      <td>7937.028571</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PARIS</td>
      <td>2007</td>
      <td>02:07:17</td>
      <td>7637</td>
      <td>7937.028571</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span># étape 3
piv = tout.pivot(index=&quot;annee&quot;, columns=&quot;ville&quot;, values=&quot;secondes_x&quot;)
piv.tail()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ville</th>
      <th>AMSTERDAM</th>
      <th>BERLIN</th>
      <th>BOSTON</th>
      <th>CHICAGO</th>
      <th>FUKUOKA</th>
      <th>LONDON</th>
      <th>NEW YORK</th>
      <th>PARIS</th>
      <th>STOCKOLM</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2007</th>
      <td>7589.0</td>
      <td>7466.0</td>
      <td>8053.0</td>
      <td>7871.0</td>
      <td>7599.0</td>
      <td>7661.0</td>
      <td>7744.0</td>
      <td>7637.0</td>
      <td>8456.0</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>7672.0</td>
      <td>7439.0</td>
      <td>7665.0</td>
      <td>7585.0</td>
      <td>7570.0</td>
      <td>7515.0</td>
      <td>7723.0</td>
      <td>7600.0</td>
      <td>8163.0</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>7578.0</td>
      <td>7568.0</td>
      <td>7722.0</td>
      <td>7541.0</td>
      <td>7518.0</td>
      <td>7510.0</td>
      <td>7755.0</td>
      <td>7547.0</td>
      <td>8134.0</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>7544.0</td>
      <td>7508.0</td>
      <td>7552.0</td>
      <td>7583.0</td>
      <td>7704.0</td>
      <td>7519.0</td>
      <td>7694.0</td>
      <td>7601.0</td>
      <td>7968.0</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>NaN</td>
      <td>7418.0</td>
      <td>7382.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7480.0</td>
      <td>NaN</td>
      <td>7589.0</td>
      <td>8047.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>A partir de là, on ne voit pas trop comment s’en sortir. Voici ce que je propose :</p>
<ol class="arabic simple">
<li><p>On effectue un pivot sur la petite matrice des moyennes.</p></li>
<li><p>On ajoute ce second pivot avec le premier (celui de l’énoncé).</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>gr[&quot;annee&quot;] = &quot;moyenne&quot;
pivmean = gr.pivot(index=&quot;annee&quot;, values=&quot;ville&quot;, columns=&quot;secondes&quot;)
pivmean
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>secondes</th>
      <th>7695.161290</th>
      <th>7815.909091</th>
      <th>7883.371429</th>
      <th>7891.061224</th>
      <th>7922.315789</th>
      <th>7928.560976</th>
      <th>7937.028571</th>
      <th>8075.187500</th>
      <th>8133.393939</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>moyenne</th>
      <td>LONDON</td>
      <td>CHICAGO</td>
      <td>AMSTERDAM</td>
      <td>BOSTON</td>
      <td>BERLIN</td>
      <td>NEW YORK</td>
      <td>PARIS</td>
      <td>FUKUOKA</td>
      <td>STOCKOLM</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>piv = df.pivot(index=&quot;annee&quot;, columns=&quot;ville&quot;, values=&quot;secondes&quot;)
pandas.concat([piv, pivmean]).tail()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AMSTERDAM</th>
      <th>BERLIN</th>
      <th>BOSTON</th>
      <th>CHICAGO</th>
      <th>FUKUOKA</th>
      <th>LONDON</th>
      <th>NEW YORK</th>
      <th>PARIS</th>
      <th>STOCKOLM</th>
      <th>7695.1612903225805</th>
      <th>7815.909090909091</th>
      <th>7883.371428571429</th>
      <th>7891.061224489796</th>
      <th>7922.315789473684</th>
      <th>7928.5609756097565</th>
      <th>7937.028571428571</th>
      <th>8075.1875</th>
      <th>8133.393939393939</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2008</th>
      <td>7672.0</td>
      <td>7439.0</td>
      <td>7665.0</td>
      <td>7585.0</td>
      <td>7570.0</td>
      <td>7515.0</td>
      <td>7723.0</td>
      <td>7600.0</td>
      <td>8163.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>7578.0</td>
      <td>7568.0</td>
      <td>7722.0</td>
      <td>7541.0</td>
      <td>7518.0</td>
      <td>7510.0</td>
      <td>7755.0</td>
      <td>7547.0</td>
      <td>8134.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>7544.0</td>
      <td>7508.0</td>
      <td>7552.0</td>
      <td>7583.0</td>
      <td>7704.0</td>
      <td>7519.0</td>
      <td>7694.0</td>
      <td>7601.0</td>
      <td>7968.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>NaN</td>
      <td>7418.0</td>
      <td>7382.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7480.0</td>
      <td>NaN</td>
      <td>7589.0</td>
      <td>8047.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>moyenne</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LONDON</td>
      <td>CHICAGO</td>
      <td>AMSTERDAM</td>
      <td>BOSTON</td>
      <td>BERLIN</td>
      <td>NEW YORK</td>
      <td>PARIS</td>
      <td>FUKUOKA</td>
      <td>STOCKOLM</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>En résumé, cela donne (j’ajoute aussi le nombre de marathons courus) :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>piv = df.pivot(index=&quot;annee&quot;, columns=&quot;ville&quot;, values=&quot;secondes&quot;)
gr = df[[&quot;ville&quot;, &quot;secondes&quot;]].groupby(&quot;ville&quot;, as_index=False).mean()
gr[&quot;annee&quot;] = &quot;moyenne&quot;
pivmean = gr.pivot(index=&quot;annee&quot;, columns=&quot;ville&quot;, values=&quot;secondes&quot;)

pandas.concat([piv, pivmean]).tail()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ville</th>
      <th>AMSTERDAM</th>
      <th>BERLIN</th>
      <th>BOSTON</th>
      <th>CHICAGO</th>
      <th>FUKUOKA</th>
      <th>LONDON</th>
      <th>NEW YORK</th>
      <th>PARIS</th>
      <th>STOCKOLM</th>
    </tr>
    <tr>
      <th>annee</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2008</th>
      <td>7672.000000</td>
      <td>7439.000000</td>
      <td>7665.000000</td>
      <td>7585.000000</td>
      <td>7570.0000</td>
      <td>7515.00000</td>
      <td>7723.000000</td>
      <td>7600.000000</td>
      <td>8163.000000</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>7578.000000</td>
      <td>7568.000000</td>
      <td>7722.000000</td>
      <td>7541.000000</td>
      <td>7518.0000</td>
      <td>7510.00000</td>
      <td>7755.000000</td>
      <td>7547.000000</td>
      <td>8134.000000</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>7544.000000</td>
      <td>7508.000000</td>
      <td>7552.000000</td>
      <td>7583.000000</td>
      <td>7704.0000</td>
      <td>7519.00000</td>
      <td>7694.000000</td>
      <td>7601.000000</td>
      <td>7968.000000</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>NaN</td>
      <td>7418.000000</td>
      <td>7382.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7480.00000</td>
      <td>NaN</td>
      <td>7589.000000</td>
      <td>8047.000000</td>
    </tr>
    <tr>
      <th>moyenne</th>
      <td>7883.371429</td>
      <td>7922.315789</td>
      <td>7891.061224</td>
      <td>7815.909091</td>
      <td>8075.1875</td>
      <td>7695.16129</td>
      <td>7928.560976</td>
      <td>7937.028571</td>
      <td>8133.393939</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Exercice-4-:-écart-entre-les-mariés">
<h3>Exercice 4 : écart entre les mariés<a class="headerlink" href="#Exercice-4-:-écart-entre-les-mariés" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>En ajoutant une colonne et en utilisant l’opération <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">group by</a>, on veut obtenir la distribution du nombre de mariages en fonction de l’écart entre les mariés. Au besoin, on changera le type d’une colone ou deux.</p></li>
<li><p>On veut tracer un nuage de points avec en abscisse l’âge du mari, en ordonnée, l’âge de la femme. Il faudra peut-être jeter un coup d’oeil sur la documentation de la méthode <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.html#pandas.DataFrame.plot">plot</a>.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df = df_civil  # on récupère le dataframe déjà construit
print(df.shape, df.columns)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(246123, 17) Index([&#39;ANAISH&#39;, &#39;DEPNAISH&#39;, &#39;INDNATH&#39;, &#39;ETAMATH&#39;, &#39;ANAISF&#39;, &#39;DEPNAISF&#39;,
       &#39;INDNATF&#39;, &#39;ETAMATF&#39;, &#39;AMAR&#39;, &#39;MMAR&#39;, &#39;JSEMAINE&#39;, &#39;DEPMAR&#39;, &#39;DEPDOM&#39;,
       &#39;TUDOM&#39;, &#39;TUCOM&#39;, &#39;NBENFCOM&#39;, &#39;nb&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ANAISH</th>
      <th>DEPNAISH</th>
      <th>INDNATH</th>
      <th>ETAMATH</th>
      <th>ANAISF</th>
      <th>DEPNAISF</th>
      <th>INDNATF</th>
      <th>ETAMATF</th>
      <th>AMAR</th>
      <th>MMAR</th>
      <th>JSEMAINE</th>
      <th>DEPMAR</th>
      <th>DEPDOM</th>
      <th>TUDOM</th>
      <th>TUCOM</th>
      <th>NBENFCOM</th>
      <th>nb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1982</td>
      <td>75</td>
      <td>1</td>
      <td>1</td>
      <td>1984</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>1</td>
      <td>29</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1956</td>
      <td>69</td>
      <td>2</td>
      <td>4</td>
      <td>1969</td>
      <td>99</td>
      <td>2</td>
      <td>4</td>
      <td>2012</td>
      <td>01</td>
      <td>3</td>
      <td>75</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1982</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1992</td>
      <td>99</td>
      <td>1</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>5</td>
      <td>34</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1987</td>
      <td>84</td>
      <td>1</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>4</td>
      <td>13</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1968</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1963</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>6</td>
      <td>26</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;ageH&quot;] = df.apply(lambda r: 2014 - int(r[&quot;ANAISH&quot;]), axis=1)
df[&quot;ageF&quot;] = df.apply(lambda r: 2014 - int(r[&quot;ANAISF&quot;]), axis=1)
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ANAISH</th>
      <th>DEPNAISH</th>
      <th>INDNATH</th>
      <th>ETAMATH</th>
      <th>ANAISF</th>
      <th>DEPNAISF</th>
      <th>INDNATF</th>
      <th>ETAMATF</th>
      <th>AMAR</th>
      <th>MMAR</th>
      <th>JSEMAINE</th>
      <th>DEPMAR</th>
      <th>DEPDOM</th>
      <th>TUDOM</th>
      <th>TUCOM</th>
      <th>NBENFCOM</th>
      <th>nb</th>
      <th>ageH</th>
      <th>ageF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1982</td>
      <td>75</td>
      <td>1</td>
      <td>1</td>
      <td>1984</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>1</td>
      <td>29</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
      <td>32</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1956</td>
      <td>69</td>
      <td>2</td>
      <td>4</td>
      <td>1969</td>
      <td>99</td>
      <td>2</td>
      <td>4</td>
      <td>2012</td>
      <td>01</td>
      <td>3</td>
      <td>75</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
      <td>58</td>
      <td>45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1982</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1992</td>
      <td>99</td>
      <td>1</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>5</td>
      <td>34</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
      <td>32</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1987</td>
      <td>84</td>
      <td>1</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>4</td>
      <td>13</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
      <td>29</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1968</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>1963</td>
      <td>99</td>
      <td>2</td>
      <td>1</td>
      <td>2012</td>
      <td>01</td>
      <td>6</td>
      <td>26</td>
      <td>99</td>
      <td>9</td>
      <td></td>
      <td>N</td>
      <td>1</td>
      <td>46</td>
      <td>51</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.plot(x=&quot;ageH&quot;, y=&quot;ageF&quot;, kind=&quot;scatter&quot;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_169_0.png" src="../_images/c_data_nb_dataframe_169_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df.plot(x=&quot;ageH&quot;, y=&quot;ageF&quot;, kind=&quot;hexbin&quot;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_170_0.png" src="../_images/c_data_nb_dataframe_170_0.png" />
</div>
</div>
</section>
<section id="Exercice-5-:-graphe-de-la-distribution-avec-pandas">
<h3>Exercice 5 : graphe de la distribution avec pandas<a class="headerlink" href="#Exercice-5-:-graphe-de-la-distribution-avec-pandas" title="Link to this heading">#</a></h3>
<p>Le module <code class="docutils literal notranslate"><span class="pre">pandas</span></code> propose un panel de graphiques standard faciles à obtenir. On souhaite représenter la distribution sous forme d’histogramme. A vous de choisir le meilleure graphique depuis la page <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html">Visualization</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;ANAISH&quot;] = df.apply(lambda r: int(r[&quot;ANAISH&quot;]), axis=1)
df[&quot;ANAISF&quot;] = df.apply(lambda r: int(r[&quot;ANAISF&quot;]), axis=1)
df[&quot;differenceHF&quot;] = df.ANAISH - df.ANAISF
df[&quot;nb&quot;] = 1
dist = df[[&quot;nb&quot;, &quot;differenceHF&quot;]].groupby(&quot;differenceHF&quot;, as_index=False).count()
df[&quot;differenceHF&quot;].hist(figsize=(16, 6), bins=50);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_172_0.png" src="../_images/c_data_nb_dataframe_172_0.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Exercice 6 : distribution des mariages par jour<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>On veut obtenir un graphe qui contient l’histogramme de la distribution du nombre de mariages par jour de la semaine et d’ajouter une seconde courbe correspond avec un second axe à la répartition cumulée.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;nb&quot;] = 1
dissem = df[[&quot;JSEMAINE&quot;, &quot;nb&quot;]].groupby(&quot;JSEMAINE&quot;, as_index=False).sum()
total = dissem[&quot;nb&quot;].sum()
repsem = dissem.cumsum()
repsem[&quot;nb&quot;] /= total

ax = dissem[&quot;nb&quot;].plot(kind=&quot;bar&quot;)
repsem[&quot;nb&quot;].plot(ax=ax, secondary_y=True)
ax.set_title(&quot;distribution des mariages par jour de la semaine&quot;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_dataframe_174_0.png" src="../_images/c_data_nb_dataframe_174_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<p><a class="reference external" href="https://github.com/sdpython/teachpyx/tree/main/_doc/c_data/nb_dataframe.ipynb">Notebook on github</a></p>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="nb_pandas.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Manipulation de données avec pandas (exercices)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="dataframes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Dataframes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2024, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">DataFrame et Graphes</a><ul>
<li><a class="reference internal" href="#DataFrame">DataFrame</a><ul>
<li><a class="reference internal" href="#Series">Series</a></li>
</ul>
</li>
<li><a class="reference internal" href="#DataFrame-(pandas)">DataFrame (pandas)</a><ul>
<li><a class="reference internal" href="#Lecture-et-écriture-de-DataFrame">Lecture et écriture de DataFrame</a></li>
<li><a class="reference internal" href="#DataFrame-et-Index">DataFrame et Index</a></li>
<li><a class="reference internal" href="#Notation-avec-le-symbole-:">Notation avec le symbole <code class="docutils literal notranslate"><span class="pre">:</span></code></a></li>
<li><a class="reference internal" href="#Exercice-1-:-créer-un-fichier-Excel">Exercice 1 : créer un fichier Excel</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Manipuler-un-DataFrame">Manipuler un DataFrame</a><ul>
<li><a class="reference internal" href="#6-opérations-:-filtrer,-union,-sort,-group-by,-join,-pivot">6 opérations : filtrer, union, sort, group by, join, pivot</a><ul>
<li><a class="reference internal" href="#filter">filter</a></li>
<li><a class="reference internal" href="#union">union</a></li>
<li><a class="reference internal" href="#sort">sort</a></li>
<li><a class="reference internal" href="#group-by">group by</a></li>
<li><a class="reference internal" href="#join-(merge-ou-fusion)">join (<em>merge</em> ou fusion)</a></li>
<li><a class="reference internal" href="#pivot-(tableau-croisé-dynamique)">pivot (tableau croisé dynamique)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Lambda-fonctions">Lambda fonctions</a></li>
<li><a class="reference internal" href="#Exercice-2-:-lambda-fonction">Exercice 2 : lambda fonction</a></li>
<li><a class="reference internal" href="#Exercice-3-:-moyennes-par-groupes">Exercice 3 : moyennes par groupes</a></li>
<li><a class="reference internal" href="#Avec-ou-sans-index">Avec ou sans index</a></li>
<li><a class="reference internal" href="#Dates">Dates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Plot(s)">Plot(s)</a><ul>
<li><a class="reference internal" href="#Récupération-des-données">Récupération des données</a></li>
<li><a class="reference internal" href="#Exercice-4-:-nuage-de-points">Exercice 4 : nuage de points</a></li>
<li><a class="reference internal" href="#Exercice-5-:-graphe-d'une-distribution-avec-pandas">Exercice 5 : graphe d’une distribution avec pandas</a></li>
<li><a class="reference internal" href="#matplotlib">matplotlib</a></li>
<li><a class="reference internal" href="#Exercice-6-:-distribution-des-mariages-par-jour">Exercice 6 : distribution des mariages par jour</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Annexes">Annexes</a><ul>
<li><a class="reference internal" href="#Créer-un-fichier-Excel-avec-plusieurs-feuilles">Créer un fichier Excel avec plusieurs feuilles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Eléments-de-réponses-pour-les-exercices">Eléments de réponses pour les exercices</a><ul>
<li><a class="reference internal" href="#id1">Exercice 1 : créer un fichier Excel</a></li>
<li><a class="reference internal" href="#Exercice-2-:-lambda-function">Exercice 2 : lambda function</a></li>
<li><a class="reference internal" href="#id2">Exercice 3 : moyennes par groupes</a></li>
<li><a class="reference internal" href="#Exercice-4-:-écart-entre-les-mariés">Exercice 4 : écart entre les mariés</a></li>
<li><a class="reference internal" href="#Exercice-5-:-graphe-de-la-distribution-avec-pandas">Exercice 5 : graphe de la distribution avec pandas</a></li>
<li><a class="reference internal" href="#id3">Exercice 6 : distribution des mariages par jour</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=0886690b"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>