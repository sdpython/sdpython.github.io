<!doctype html>
<html class="no-js" lang="fr" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Recherche" href="../../search.html" /><link rel="next" title="Numpy / Pandas" href="../index_data.html" /><link rel="prev" title="Evaluation Python / Machine Learning année 2017 - énoncé" href="enonce_ml_2017.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Evaluation Python / Machine Learning année 2017 - solution - Documentation teachpyx 0.5.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Documentation teachpyx 0.5.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation teachpyx 0.5.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../py/index.html">Le langage Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Le langage Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_lang/index.html">Variables et fonctions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Variables et fonctions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/types.html">Types et variables du langage python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/syntaxe.html">Syntaxe du langage Python (boucles, tests, fonctions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/constructions.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/collections.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/dates.html">Dates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_lang/encoding.html">Encoding et jeux de caractères</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_classes/index.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_classes/classes.html">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_classes/questions.html">Questions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_exception/index.html">Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Exceptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_exception/exception.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_exception/exception_ext.html">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_exception/warning.html">Warning et logging</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_module/index.html">Entrées, Sorties, Modules</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Entrées, Sorties, Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_module/files.html">Fichiers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../py/c_module/serialization.html">Sérialisation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Sérialisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_module/module.html">Module ou extension</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_regex/index.html">Expressions régulières</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Expressions régulières</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_regex/regex.html">Expressions régulières</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_parallelisation/index.html">Parallélisation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parallélisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_parallelisation/thread.html">Threads</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../py/c_gui/index.html">Interfaces graphiques</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Interfaces graphiques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../py/c_gui/tkinter.html">tkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_data/index.html">Matrices et DataFrames</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Matrices et DataFrames</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/matrices.html">Calcul matriciel</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Calcul matriciel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_array.html">Calcul Matriciel, Optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_numpy.html">Calcul matriciel avec numpy (exercices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/numpy_broadcast.html">Numpy et tableau de contingence</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/dataframes.html">Dataframes</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Dataframes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_dataframe.html">DataFrame et Graphes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_pandas.html">Manipulation de données avec pandas (exercices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/nb_dataframe_matrix_speed.html">Mesures de vitesse sur les dataframes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_data/graphes.html">Graphes</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Graphes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_data/enedis_cartes.html">Tracer une carte en Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_ml/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_ml/rappel.html">Quelques rappels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_ml/regclass.html">Classification et régression</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_resume/index.html">Précis</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Précis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_resume/python_sheet.html">Cheat sheet: Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_resume/conseil_programmes.html">Quelques conseils pour écrire un programme</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../c_resume/cheat_sheet.html">Cheat Sheets</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Cheat Sheets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/git.html">Cheat Sheet on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/linux.html">Cheat Sheet on Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../c_resume/jenkins.html">Cheat Sheet on Jenkins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../articles/index.html">Collections d’articles périssables</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Collections d’articles périssables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2024/2024-03-01-route2024.html">2024-03-01 : feuille de route 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2024/2024-01-18-wsl.html">2024-01-18 : WSL - nettoyage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023/2023-11-31-route2023.html">2023-11-31 : rappel feuille de route 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023/2023-09-06-ensae.html">2023-09-06 : ENSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023/2023-08-09-hermionne.html">2023-08-09 : l’énigme d’Hermionne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2023/2023-08-03-code-jam.html">2023-08-03 : Code Jam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022/2022-12-07-cartopy.html">2022-12-07 : Utilisation de cartopy sous Windows (sous WSL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022/2022-11-31-route2022.html">2022-11-31 : rappel feuille de route 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../articles/2022/2022-01-01-assurance.html">Assurance auto</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exercices</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../index_python.html">Exercices sur le langage python</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Exercices sur le langage python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../py-base/code_liste_tuple.html">Liste, tuple, ensemble, dictionnaire, liste chaînée, coût des opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/nbheap.html">Heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/structures_donnees_conversion.html">D’une structure de données à l’autre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/recherche_dichotomique.html">Recherche dichotomique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/exercice_hash.html">Répartition, table de hashage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classes_metro.html">Un bref aperçu des classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classes_2048.html">2048 et les classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classe_de.html">Jeu de dé, rotation sur un circuit (classes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classe_permutation.html">Classe Permutation et décomposition en transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classe_tree.html">Une classe pour représenter un arbre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classe_iterateur.html">Itérateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/classe_user_p.html">Classe, Héritage, calcule d’une distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/pivot_gauss.html">Pivot de gauss avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/coloriage_carre.html">Jeux de coloriage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/code_multinomial.html">Simuler une loi multinomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/tableau_contingence.html">Calculer un chi 2 sur un tableau de contingence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/tri_nlnd.html">Tri plus rapide que prévu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/histogramme_rapide.html">Histogramme et dictionnaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/exercice_pi.html">Calculs de surface et autres calculs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/de_rotation.html">Jeu de dé, rotation sur un circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/profiling_example.html">Exemple de profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/profile_gini.html">Profiling la fonction Gini</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/profiling_conv.html">Profiling, application à la convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/exercice_regex.html">Expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/exercice_json_xml.html">JSON - XML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/exercice_serialisation_json.html">Sérialisation avec JSON, XML, pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/tests_unitaires.html">Tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-base/scrapping.html">Web-Scraping - pokemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/premiers_pas.html">Premiers pas en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/variable_boucle_tests.html">Variables, boucles, tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/dictionnaire_vigenere.html">Dictionnaires, fonctions, code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/module_file_regex.html">Modules, fichiers, expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/integrale_rectangle.html">Intégrale et la méthode des rectangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/j2048.html">2048 - stratégie gagnante</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/texte_langue.html">Deviner la langue d’un texte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/pyramide_bigarree.html">Tracer une pyramide bigarrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/classes_carre_magique.html">Classes, méthodes, attributs, opérateurs et carré magique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/classes_heritage.html">Classes, héritage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/trie.html">Arbre et Trie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/premiers_pas_correction.html">Premiers pas en Python (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/variable_boucle_tests_correction.html">Variables, boucles, tests (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/dictionnaire_vigenere_correction.html">Dictionnaires, fonctions, code de Vigenère (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/module_file_regex_correction.html">Modules, fichiers, expressions régulières (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/integrale_rectangle_correction.html">Intégrale et la méthode des rectangles - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/j2048_correction.html">2048 - stratégie gagnante - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/texte_langue_correction.html">Deviner la langue d’un texte (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/pyramide_bigarree_correction.html">Tracer une pyramide bigarrée - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/classes_carre_magique_correction.html">Classes, méthodes, attributs, opérateurs et carré magique (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/classes_heritage_correction.html">Classes, héritage (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-base/trie_correction.html">Arbre et Trie (correction)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index_algo.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/matrix_dictionary.html">Produit matriciel avec une matrice creuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_echelle.html">Calculer le nombre de façons de monter une échelle.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_plus_grande_somme.html">La sous-séquence de plus grande somme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_xn.html">Calculer x**n le plus rapidement possible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_topk.html">Les k premiers éléments (top k)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_suffix.html">Jeux de dictionnaires, plus grand suffixe commun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/BJKST.html">Algorithmes de streaming, BJKST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_editdist.html">Distance entre deux mots de même longueur et tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_ordonnancement.html">Problème d’ordonnancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_tsp.html">TSP - Traveling Salesman Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/tsp_simplifie.html">Plus court chemin passant par tous les noeuds d’un graphe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/tsp_aparte.html">Aparté sur le voyageur de commerce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_compose_connexe.html">Graphe et Composantes connexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_random_graph.html">Graphes aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_simulation_covid_simple.html">Modèle épidémiologique (SIRD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-base/exercice_simulation_covid.html">Simulation COVID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-compose/paris_parcours.html">Parcourir les rues de Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-compose/vigenere.html">Casser le code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algo-compose/exercice_morse.html">Décoder du Morse sans espaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/gentry_integer_encryption.html">Cryptage homomorphic de Craig Gentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/knn_high_dimension.html">Plus proches voisins en grande dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/puzzle_algo_1.html">Puzzles algorithmiques (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/puzzle_algo_2.html">Puzzles algorithmiques (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/plus_court_chemin.html">Programmation dynamique et plus court chemin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/decorrelation.html">Décorrélation de variables aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/graph_spectral_clustering.html">Spectral Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/gentry_integer_encryption_correction.html">Cryptage homomorphic de Craig Gentry - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/knn_high_dimension_correction.html">Plus proches voisins en grande dimension - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/puzzle_algo_1_correction.html">Puzzles algorithmes (1) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/puzzle_algo_2_correction.html">Puzzles algorithmes (2) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/plus_court_chemin_correction.html">Programmation dynamique et plus court chemin (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/decorrelation_correction.html">Décorrélation de variables aléatoires - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tds-algo/graph_spectral_clustering_correction.html">Spectral Clustering - correction</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index_exam.html">Séances minutées</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Séances minutées</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../exams.html">Exercices minutés</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Exercices minutés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="td_note_2013_coloriage_correction.html">1A.e - TD noté, 27 novembre 2012 (coloriage, correction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2013_bout_de_code_coloriage.html">1A.e - TD noté, 27 novembre 2012 (éléments de code pour le coloriage)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2015.html">1A.e - TD noté, 5 décembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2015_rattrapage_enonce.html">1A.e - TD noté 2015 rattrapage (énoncé, écrit et oral)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2016.html">1A.e - TD noté, 11 décembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2017.html">1A.e - TD noté, 16 décembre 2016</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2017_2.html">1A.e - TD noté, 21 février 2017</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2018_1.html">1A.e - Enoncé 12 décembre 2017 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2018_2.html">1A.e - Enoncé 12 décembre 2017 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2019_1.html">1A.e - Enoncé 23 octobre 2018 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2019_2.html">1A.e - Enoncé 23 octobre 2018 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2020_1.html">1A.e - Enoncé 22 octobre 2019 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2020_2.html">1A.e - Enoncé 22 octobre 2019 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2021.html">1A - Enoncé 24 novembre 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2022.html">1A - Enoncé 3 novembre 2021</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2022_rattrapage.html">1A - Enoncé 15 novembre 2021 - rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2022_rattrapage2.html">1A - Enoncé 3 mars 2022- rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2023.html">1A - Enoncé 26 octobre 2022</a></li>
<li class="toctree-l3"><a class="reference internal" href="td_note_2023-2024.html">1A - Enoncé 8 novembre 2023-2024</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2014_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2014_10.html">1A.e - Correction de l’interrogation écrite du 10 octobre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2014_11.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2014_12.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2015_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="interro_rapide_20_minutes_2015_11.html">1A.e - Correction de l’interrogation écrite du 6 novembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="enonce_ml_2017.html">Evaluation Python / Machine Learning année 2017 - énoncé</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Evaluation Python / Machine Learning année 2017 - solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index_data.html">Numpy / Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Numpy / Pandas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index_ml.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/ml_features_model.html">Features ou modèle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/wines_acp.html">ACP - projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn_split.html">Base d’apprentissage et de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn_split_strat.html">Découpage stratifié apprentissage / test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn_cross_val.html">Validation croisée (cross-validation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn_hyper.html">Sélection des hyper-paramètres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/ml_a_tree_overfitting.html">Tree, hyperparamètres, overfitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/gradient_boosting.html">Gradient Boosting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/ridge_lasso.html">Régression Ridge, Lasso et nouvel estimateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_reg.html">Prédiction de la note des vins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_reg_poly.html">Régression polynômiale et pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn.html">Plus proches voisins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesr_knn_eval.html">Plus proches voisins - évaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_color.html">Régression logistique et courbe ROC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_color_line.html">Régression logistique en 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_color_linear.html">Plusieurs modèles, données disjointes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_color_roc.html">Classifications et courbes ROC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_multi.html">Classification multi-classe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/winesc_multi_stacking.html">Classification multi-classe et stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/artificiel_multiclass.html">Classification multi-classe et jeu mal balancé</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml/timeseries_ssa.html">Single Spectrum Analysis (SSA)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compléments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../years/index.html">Notebooks écrits durant les séances</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Notebooks écrits durant les séances</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../years/2023/index.html">2023</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../years/2023/editdist.html">Distance d’édition (4 octobre)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../years/2023/pivot_gauss.html">Pivot de Gauss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../years/2023/prefix_search.html">Recherche de préfixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../years/2023/bareme_note_optimisation.html">Optimiser la note moyenne</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm_culture.html">Survol algorithmique</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../c_expose/index.html">Exposés</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Exposés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/finance/finance_autostrat.html">Stratégie automatique de trading en finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/tsp/tsp_kohonen.html">Circuit hamiltonien et Kohonen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c_expose/tsp/tsp_kruskal.html">Circuit hamiltonien et Kruskal</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../i_index.html">En diagonal</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of En diagonal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebook_gallery.html">Tous les notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/index.html">Gallerie d’exemples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/index.html#gallerie-d-exemples-sur-le-machine-learning">Gallerie d’exemples sur le machine learning</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../auto_examples/index.html#gallerie-d-exemples-sur-la-programmation">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../auto_examples/ml/index.html">Gallerie d’exemples sur le machine learning</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur le machine learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/ml/plot_correlations.html">Corrélations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/ml/plot_roc.html">Receiver Operating Characteristic (ROC)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../auto_examples/prog/index.html">Gallerie d’exemples sur la programmation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples sur la programmation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_pandas_groupby.html">Pandas et groupby</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../auto_examples/prog/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index.html">Code inclus dans cette librairie</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Code inclus dans cette librairie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/classique.html">examples.construction_classique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/datasets.html">Jeux de données</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tools.html">tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/rues_paris.html">teachpyx.practice.rues_paris</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_bresenham.html">teachpyx.practice.tsp_bresenham</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_kohonen.html">teachpyx.practice.tsp_kohonen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/practice/tsp_kruskal.html">teachpyx.practice.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/video/tsp_kohonen.html">teachpyx.video.tsp_kohonen_pygame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/video/tsp_kruskal.html">teachpyx.video.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/numpysex.html">examples.numpysex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/faqs.html">faq</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../i_ex.html">Syntaxes et définitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../i_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOGS.html">Change Logs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Evaluation-Python-/-Machine-Learning-année-2017---solution">
<h1>Evaluation Python / Machine Learning année 2017 - solution<a class="headerlink" href="#Evaluation-Python-/-Machine-Learning-année-2017---solution" title="Link to this heading">#</a></h1>
<p>Le répertoire <a class="reference external" href="https://github.com/sdpython/teachpyx/tree/main/_data/2017">_data/2017</a> contient deux fichiers csv simulés aléatoirement dont il faudra se servir pour répondre aux 10 questions qui suivent. Chaque question vaut deux points. Le travail est à rendre pour le lundi 20 février sous la forme d’un notebook envoyé en pièce jointe d’un mail.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>%matplotlib inline
</pre></div>
</div>
</div>
<section id="1">
<h2>1<a class="headerlink" href="#1" title="Link to this heading">#</a></h2>
<p><em>Deux fichiers sont extraits de la base de données d’un médecin. Un fichier contient des informations sur des personnes, un autre sur les rendez-vous pris par ces personnes. Quels sont-ils ?</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas

persons = pandas.read_csv(
    &quot;https://raw.githubusercontent.com/sdpython/teachpyx/main/_data/2017/persons.txt&quot;,
    sep=&quot;\t&quot;,
)
persons.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>idc</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>Cendrillon</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41</td>
      <td>0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>Cendrillon</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>1</td>
      <td>304895f0-f686-4b0e-8854-a705bb5a6982</td>
      <td>Balthazar</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42</td>
      <td>1</td>
      <td>3f0d31d2-0ef4-4e7e-b876-07d10225cc8c</td>
      <td>Balthazar</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>1</td>
      <td>f29273f4-a76c-4158-b5f5-b3e5a080a0c7</td>
      <td>Balthazar</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend = pandas.read_csv(
    &quot;https://raw.githubusercontent.com/sdpython/teachpyx/main/_data/2017/rendezvous.txt&quot;,
    sep=&quot;\t&quot;,
)
rend.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>a65f721a-de11-4a01-be71-b26e2da3ac00</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-12-07 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>644b1236-b9ee-4ef5-8ca7-d1adadb547c8</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-12-17 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>aff6ac9e-5dd0-434e-9888-f724f6d40969</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-01-07 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>9ca87507-aa95-49a9-88b3-86ec9fbc44d6</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>persons.shape, rend.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((1000, 4), (2537, 4))
</pre></div></div>
</div>
<p>Le second fichier est plus volumineux et contient une variable <em>price</em> qui ne peut pas être reliée aux personnes. Le premier fichier est celui des personnes, le second celui des rendez-vous. La variable <em>idc</em> est présente dans les deux tables. C’est elle qui identifie les personnes dans les deux tables.</p>
</section>
<section id="2">
<h2>2<a class="headerlink" href="#2" title="Link to this heading">#</a></h2>
<p><em>On souhaite étudier la relation entre le prix moyen payé par une personne, son âge et son genre. Calculer le prix moyen payé par une personne ?</em></p>
<p>La table des rendez-vous contient toutes l’information nécessaire. La question était un peu ambiguë. On peut déterminer le prix moyen payé par personne, ou le prix moyen des prix moyens… On va répondre à la première option car la seconde n’a pas beaucoup d’intérêt et c’est très proche du prix moyen par rendez-vous, ce que la question aurait sans doute formulé dans ce sens si telle avait été son intention. On groupe par <em>idc</em> et on fait la moyenne.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>gr = rend[[&quot;idc&quot;, &quot;price&quot;]].groupby(&quot;idc&quot;).mean()
gr.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
    </tr>
    <tr>
      <th>idc</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>003b0195-2acb-4f46-b7fa-28cf266a8f60</th>
      <td>80.0</td>
    </tr>
    <tr>
      <th>009e689c-51a1-4cef-99ca-a4ba364eba8d</th>
      <td>80.0</td>
    </tr>
    <tr>
      <th>00a213c2-1174-4359-8a67-fe710ec1b439</th>
      <td>70.0</td>
    </tr>
    <tr>
      <th>00e42818-aade-4758-a5f6-c78a6f235ea5</th>
      <td>70.0</td>
    </tr>
    <tr>
      <th>0153b785-9acd-4d28-aad1-62f8bf2faea3</th>
      <td>75.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="3">
<h2>3<a class="headerlink" href="#3" title="Link to this heading">#</a></h2>
<p><em>Faire la jointure entre les deux tables.</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join = persons.merge(gr.reset_index(), on=&quot;idc&quot;)
join.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>idc</th>
      <th>name</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>Cendrillon</td>
      <td>70.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41</td>
      <td>0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>Cendrillon</td>
      <td>78.333333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>1</td>
      <td>304895f0-f686-4b0e-8854-a705bb5a6982</td>
      <td>Balthazar</td>
      <td>75.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42</td>
      <td>1</td>
      <td>3f0d31d2-0ef4-4e7e-b876-07d10225cc8c</td>
      <td>Balthazar</td>
      <td>95.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>1</td>
      <td>f29273f4-a76c-4158-b5f5-b3e5a080a0c7</td>
      <td>Balthazar</td>
      <td>90.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Cette jointure est assez simple puisque la colonne partagée porte le même nom dans les deux tables. On peut néanmoins se poser la question de savoir s’il y a des personnes qui n’ont pas de rendez-vous associé et réciproquement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000, 5)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join = persons.merge(gr.reset_index(), on=&quot;idc&quot;, how=&quot;outer&quot;)
join.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000, 5)
</pre></div></div>
</div>
<p>Visiblement, ce n’est pas le cas puisqu’une jointure incluant les éléments sans correspondances dans les deux tables n’ajoute pas plus d’éléments à la jointure.</p>
</section>
<section id="4">
<h2>4<a class="headerlink" href="#4" title="Link to this heading">#</a></h2>
<p><em>Tracer deux nuages de points (age, prix moyen) et (genre, prix moyen) ?</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join.plot(x=&quot;age&quot;, y=&quot;price&quot;, kind=&quot;scatter&quot;, title=&quot;age / price&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;age / price&#39;}, xlabel=&#39;age&#39;, ylabel=&#39;price&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_16_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_16_1.png" />
</div>
</div>
<p>On peut aussi utiliser un module comme <a class="reference external" href="http://seaborn.pydata.org/">seaborn</a> qui propose des dessins intéressants pour un statisticatien.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import seaborn

g = seaborn.jointplot(join, x=&quot;age&quot;, y=&quot;price&quot;, kind=&quot;reg&quot;, scatter_kws={&quot;s&quot;: 10})
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_18_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_18_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join.plot(x=&quot;gender&quot;, y=&quot;price&quot;, kind=&quot;scatter&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;gender&#39;, ylabel=&#39;price&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_19_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_19_1.png" />
</div>
</div>
<p>On ne voit pas grand chose sur ce second graphe. Une option est d’ajouter un bruit aléatoire sur le genre pour éclater le nuage.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy

bruit = join.copy()
bruit[&quot;gx&quot;] = bruit.gender + numpy.random.random(bruit.shape[0]) / 3
bruit.plot(x=&quot;gx&quot;, y=&quot;price&quot;, kind=&quot;scatter&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;gx&#39;, ylabel=&#39;price&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_21_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_21_1.png" />
</div>
</div>
<p>Il n’y a rien de flagrant. On peut faire un graphe moustache.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join[[&quot;price&quot;, &quot;gender&quot;]].boxplot(by=&quot;gender&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;price&#39;}, xlabel=&#39;[gender]&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_23_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_23_1.png" />
</div>
</div>
<p>C’est mieux. Un dernier. Le diagramme violon, plus complet que le précédent.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>seaborn.violinplot(x=&quot;gender&quot;, y=&quot;price&quot;, data=join, inner=&quot;quart&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;gender&#39;, ylabel=&#39;price&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_25_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_25_1.png" />
</div>
</div>
</section>
<section id="5">
<h2>5<a class="headerlink" href="#5" title="Link to this heading">#</a></h2>
<p><em>Calculer les coefficients de la régression</em> <img class="math" src="../../_images/math/8cf758b0dba93ddd29fa413c946f8bde5c173666.svg" alt="prix\_moyen \sim age + genre"/>.</p>
<p>Une régression. Le premier réflexe est <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.linear_model import LinearRegression

lr = LinearRegression()
lr.fit(join[[&quot;age&quot;, &quot;gender&quot;]], join[&quot;price&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearRegression()</pre></div> </div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr.coef_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.52440734, -4.36373925])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr.intercept_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
61.05057671902867
</pre></div></div>
</div>
<p>On utilise maintenant <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a> qui est plus complet pour toute ce qui est un modèle linéaire.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from statsmodels.formula.api import ols

lr = ols(&quot;price ~ age + gender&quot;, data=join)
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.579</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.579</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   686.6</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>3.25e-188</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:12:30</td>     <th>  Log-Likelihood:    </th> <td> -3149.8</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1000</td>      <th>  AIC:               </th> <td>   6306.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   997</td>      <th>  BIC:               </th> <td>   6320.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th> <td>   61.0506</td> <td>    0.640</td> <td>   95.432</td> <td> 0.000</td> <td>   59.795</td> <td>   62.306</td>
</tr>
<tr>
  <th>age</th>       <td>    0.5244</td> <td>    0.015</td> <td>   35.302</td> <td> 0.000</td> <td>    0.495</td> <td>    0.554</td>
</tr>
<tr>
  <th>gender</th>    <td>   -4.3637</td> <td>    0.358</td> <td>  -12.194</td> <td> 0.000</td> <td>   -5.066</td> <td>   -3.662</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>300.096</td> <th>  Durbin-Watson:     </th> <td>   1.999</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 719.506</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.618</td>  <th>  Prob(JB):          </th> <td>5.77e-157</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.608</td>  <th>  Cond. No.          </th> <td>    151.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div>
</div>
<p>Ou encore (après avoir ajouté une constante).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from statsmodels.api import OLS

join2 = join.copy()
join2[&quot;cst&quot;] = 1
lr = OLS(join2[&quot;price&quot;], join2[[&quot;age&quot;, &quot;gender&quot;, &quot;cst&quot;]])
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.579</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.579</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   686.6</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th> <td>3.25e-188</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:12:33</td>     <th>  Log-Likelihood:    </th> <td> -3149.8</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1000</td>      <th>  AIC:               </th> <td>   6306.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   997</td>      <th>  BIC:               </th> <td>   6320.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>age</th>    <td>    0.5244</td> <td>    0.015</td> <td>   35.302</td> <td> 0.000</td> <td>    0.495</td> <td>    0.554</td>
</tr>
<tr>
  <th>gender</th> <td>   -4.3637</td> <td>    0.358</td> <td>  -12.194</td> <td> 0.000</td> <td>   -5.066</td> <td>   -3.662</td>
</tr>
<tr>
  <th>cst</th>    <td>   61.0506</td> <td>    0.640</td> <td>   95.432</td> <td> 0.000</td> <td>   59.795</td> <td>   62.306</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>300.096</td> <th>  Durbin-Watson:     </th> <td>   1.999</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 719.506</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.618</td>  <th>  Prob(JB):          </th> <td>5.77e-157</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 5.608</td>  <th>  Cond. No.          </th> <td>    151.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div>
</div>
<p>On peut aussi définir la régression sous la forme de formule avec le module <a class="reference external" href="http://patsy.readthedocs.io/en/latest/index.html">patsy</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from patsy import dmatrices

y, X = dmatrices(&quot;price ~ age + gender&quot;, join, return_type=&quot;matrix&quot;)
y = numpy.ravel(y)
lr = LinearRegression(fit_intercept=False)
lr.fit(X, y)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression(fit_intercept=False)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearRegression(fit_intercept=False)</pre></div> </div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr.coef_, lr.intercept_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([61.05057672,  0.52440734, -4.36373925]), 0.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>X[:2]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1., 37.,  0.],
       [ 1., 41.,  0.]])
</pre></div></div>
</div>
</section>
<section id="6">
<h2>6<a class="headerlink" href="#6" title="Link to this heading">#</a></h2>
<p><em>On souhaite étudier le prix d’une consultation en fonction du jour de la semaine. Ajouter une colonne dans la table de votre choix avec le jour de la semaine.</em></p>
<p>On convertit d’abord la colonne date (chaîne de caractères au format date) avec la fonction <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.to_datetime.html">to_datetime</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend[&quot;date2&quot;] = pandas.to_datetime(rend.date)
rend.dtypes
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
date             object
idc              object
idr              object
price           float64
date2    datetime64[ns]
dtype: object
</pre></div></div>
</div>
<p>Et on récupère le jour de la semaine avec <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.weekday.html">weekday</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend[&quot;weekday&quot;] = rend.date2.dt.weekday
rend.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>a65f721a-de11-4a01-be71-b26e2da3ac00</td>
      <td>65.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-12-07 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>644b1236-b9ee-4ef5-8ca7-d1adadb547c8</td>
      <td>75.0</td>
      <td>2016-12-07 19:47:45.068274</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-12-17 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>aff6ac9e-5dd0-434e-9888-f724f6d40969</td>
      <td>80.0</td>
      <td>2016-12-17 19:47:45.068274</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-01-07 19:47:45.068274</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>9ca87507-aa95-49a9-88b3-86ec9fbc44d6</td>
      <td>80.0</td>
      <td>2017-01-07 19:47:45.068274</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="7">
<h2>7<a class="headerlink" href="#7" title="Link to this heading">#</a></h2>
<p><em>Créer un graphe moustache qui permet de vérifier cette hypothèse.</em></p>
<p>On réutilise le code d’une question précédente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend[[&quot;price&quot;, &quot;weekday&quot;]].boxplot(by=&quot;weekday&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;price&#39;}, xlabel=&#39;[weekday]&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_43_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_43_1.png" />
</div>
</div>
<p>C’est clairement plus cher le dimanche.</p>
</section>
<section id="8">
<h2>8<a class="headerlink" href="#8" title="Link to this heading">#</a></h2>
<p><em>Ajouter une colonne dans la table de votre choix qui contient 365 si c’est le premier rendez-vous, le nombre de jour écoulés depuis le précédent rendez-vous. On appelle cette colonne :math:`delay`. On ajoute également la colonne</em> <img class="math" src="../../_images/math/e18ef8ad88c30b9355311e2b8d1b45924ca2a190.svg" alt="1/delay"/>.</p>
<p>Pour commencer, on convertit la date en nombre de jours depuis la première date.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend[&quot;constant&quot;] = rend[&quot;date2&quot;].min()
rend[&quot;jour&quot;] = rend[&quot;date2&quot;] - rend[&quot;constant&quot;]
rend.head(n=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
      <th>constant</th>
      <th>jour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>a65f721a-de11-4a01-be71-b26e2da3ac00</td>
      <td>65.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On convertit en entier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend[&quot;jouri&quot;] = rend.jour.apply(lambda d: d.days)
rend.head(n=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
      <th>constant</th>
      <th>jour</th>
      <th>jouri</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>a65f721a-de11-4a01-be71-b26e2da3ac00</td>
      <td>65.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On trie par patient et jour puis on effectue la différence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>diff = rend.sort_values([&quot;idc&quot;, &quot;jouri&quot;])[&quot;jouri&quot;].diff()
rend[&quot;diff&quot;] = diff
rend.head(n=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
      <th>constant</th>
      <th>jour</th>
      <th>jouri</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
      <td>-26.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>a65f721a-de11-4a01-be71-b26e2da3ac00</td>
      <td>65.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Il reste à traiter le premier jour ou plutôt le premier rendez-vous. On le récupère pour chaque patient.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>first = rend[[&quot;idc&quot;, &quot;date&quot;]].groupby(&quot;idc&quot;, as_index=False).min()
first[&quot;j365&quot;] = 365
first.head(n=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>idc</th>
      <th>date</th>
      <th>j365</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>003b0195-2acb-4f46-b7fa-28cf266a8f60</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>365</td>
    </tr>
    <tr>
      <th>1</th>
      <td>009e689c-51a1-4cef-99ca-a4ba364eba8d</td>
      <td>2016-11-26 19:47:45.068274</td>
      <td>365</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Puis on fait une jointure.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>tout = rend.merge(first, on=[&quot;idc&quot;, &quot;date&quot;], how=&quot;outer&quot;)
tout[[&quot;idc&quot;, &quot;jouri&quot;, &quot;date&quot;, &quot;j365&quot;]].head(n=5)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>idc</th>
      <th>jouri</th>
      <th>date</th>
      <th>j365</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>14</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>14</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>19</td>
      <td>2016-12-07 19:47:45.068274</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>29</td>
      <td>2016-12-17 19:47:45.068274</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>50</td>
      <td>2017-01-07 19:47:45.068274</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Il ne reste plus qu’à remplacer les NaN par <em>jouri</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>tout[&quot;delay&quot;] = tout.j365.fillna(tout.jouri)
tout[[&quot;idc&quot;, &quot;jouri&quot;, &quot;date&quot;, &quot;j365&quot;, &quot;delay&quot;]].head(n=8)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>idc</th>
      <th>jouri</th>
      <th>date</th>
      <th>j365</th>
      <th>delay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>14</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>14</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>19</td>
      <td>2016-12-07 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>29</td>
      <td>2016-12-17 19:47:45.068274</td>
      <td>NaN</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>50</td>
      <td>2017-01-07 19:47:45.068274</td>
      <td>NaN</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>304895f0-f686-4b0e-8854-a705bb5a6982</td>
      <td>1</td>
      <td>2016-11-19 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3f0d31d2-0ef4-4e7e-b876-07d10225cc8c</td>
      <td>30</td>
      <td>2016-12-18 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>f29273f4-a76c-4158-b5f5-b3e5a080a0c7</td>
      <td>2</td>
      <td>2016-11-20 19:47:45.068274</td>
      <td>365.0</td>
      <td>365.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Finalement, il faut ajouter une colonne <img class="math" src="../../_images/math/e18ef8ad88c30b9355311e2b8d1b45924ca2a190.svg" alt="1/delay"/>. Comme des patients ont parfois deux rendez-vous le même jour, pour éviter les valeurs nulles, on ajoute la colonne <img class="math" src="../../_images/math/3ba855ee8e8faa64d5b9582a5f622060af3ebf33.svg" alt="1/(1+delay)"/>. On aurait pu également pour éviter les valeurs nulles considérer le temps en secondes et non en jour entre deux rendez-vous.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>tout[&quot;delay1&quot;] = 1 / (tout[&quot;delay&quot;] + 1)
tout[[&quot;delay&quot;, &quot;delay1&quot;]].head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>delay</th>
      <th>delay1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>365.0</td>
      <td>0.002732</td>
    </tr>
    <tr>
      <th>1</th>
      <td>365.0</td>
      <td>0.002732</td>
    </tr>
    <tr>
      <th>2</th>
      <td>365.0</td>
      <td>0.002732</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29.0</td>
      <td>0.033333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50.0</td>
      <td>0.019608</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="8---réponse-plus-courte">
<h2>8 - réponse plus courte<a class="headerlink" href="#8---réponse-plus-courte" title="Link to this heading">#</a></h2>
<p>On garde l’idée de la fonction <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.diff.html">diff</a> et on ajoute la fonction <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.shift.html">shift</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>rend2 = rend.sort_values([&quot;idc&quot;, &quot;jouri&quot;]).reset_index(drop=True).copy()
rend2[&quot;diff&quot;] = rend2[&quot;jouri&quot;].diff()
rend2.loc[rend2.idc != rend2.idc.shift(1), &quot;diff&quot;] = 365
rend2.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
      <th>constant</th>
      <th>jour</th>
      <th>jouri</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>003b0195-2acb-4f46-b7fa-28cf266a8f60</td>
      <td>6d65b2b5-f34d-4440-8442-679175554db4</td>
      <td>80.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-11-26 19:47:45.068274</td>
      <td>009e689c-51a1-4cef-99ca-a4ba364eba8d</td>
      <td>065474ed-6ba3-4ee1-aa83-b89e97d5a2aa</td>
      <td>80.0</td>
      <td>2016-11-26 19:47:45.068274</td>
      <td>5</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>8 days</td>
      <td>8</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-12-20 19:47:45.068274</td>
      <td>009e689c-51a1-4cef-99ca-a4ba364eba8d</td>
      <td>38a02a6a-8c04-4630-aaa6-2077077a9f87</td>
      <td>80.0</td>
      <td>2016-12-20 19:47:45.068274</td>
      <td>1</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>32 days</td>
      <td>32</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-01-12 19:47:45.068274</td>
      <td>009e689c-51a1-4cef-99ca-a4ba364eba8d</td>
      <td>f4cf0df4-0b6a-4b0f-93c7-d12499026fab</td>
      <td>80.0</td>
      <td>2017-01-12 19:47:45.068274</td>
      <td>3</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>55 days</td>
      <td>55</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>00a213c2-1174-4359-8a67-fe710ec1b439</td>
      <td>c1b3381b-9663-429d-a8fb-3b24c20a125b</td>
      <td>70.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
      <td>365.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="9">
<h2>9<a class="headerlink" href="#9" title="Link to this heading">#</a></h2>
<p><em>Calculer les coefficients de la régression</em> <img class="math" src="../../_images/math/5ac426cb20b991ed021c25332e79a01ac03bbdae.svg" alt="prix \sim age + genre + delay + 1/delay + jour\_semaine"/>.</p>
<p>L’âge ne fait pas partie de la table <em>tout</em>. Il faut faire une jointure pour le récupérer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>mat = tout.merge(persons, on=&quot;idc&quot;)
</pre></div>
</div>
</div>
<p>Ensuite retour à <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> et plutôt le second <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a> pour effectuer des tests sur les coefficients du modèle. On regarde d’abord les corrélations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;, &quot;price&quot;]].corr()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>delay</th>
      <th>delay1</th>
      <th>weekday</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>age</th>
      <td>1.000000</td>
      <td>0.030852</td>
      <td>-0.010694</td>
      <td>-0.023011</td>
      <td>0.032413</td>
      <td>0.614708</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>0.030852</td>
      <td>1.000000</td>
      <td>0.008700</td>
      <td>-0.026779</td>
      <td>-0.000064</td>
      <td>-0.198835</td>
    </tr>
    <tr>
      <th>delay</th>
      <td>-0.010694</td>
      <td>0.008700</td>
      <td>1.000000</td>
      <td>-0.616038</td>
      <td>0.039766</td>
      <td>0.049796</td>
    </tr>
    <tr>
      <th>delay1</th>
      <td>-0.023011</td>
      <td>-0.026779</td>
      <td>-0.616038</td>
      <td>1.000000</td>
      <td>0.025400</td>
      <td>-0.054954</td>
    </tr>
    <tr>
      <th>weekday</th>
      <td>0.032413</td>
      <td>-0.000064</td>
      <td>0.039766</td>
      <td>0.025400</td>
      <td>1.000000</td>
      <td>0.448584</td>
    </tr>
    <tr>
      <th>price</th>
      <td>0.614708</td>
      <td>-0.198835</td>
      <td>0.049796</td>
      <td>-0.054954</td>
      <td>0.448584</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>seaborn.clustermap(
    mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;, &quot;price&quot;]].corr(), figsize=(5, 5)
)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.matrix.ClusterGrid at 0x7fb3214280d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_65_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_65_1.png" />
</div>
</div>
<p>Si le jeu de données n’est pas trop volumineux.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>seaborn.pairplot(
    mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;, &quot;price&quot;]], plot_kws={&quot;s&quot;: 10}
)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x7fb3029bf820&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_67_2.png" src="../../_images/practice_exams_enonce_ml_2017_correction_67_2.png" />
</div>
</div>
<p>Un dernier pour la route.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>feat = mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;, &quot;price&quot;]]
g = seaborn.PairGrid(
    feat.sort_values(&quot;price&quot;, ascending=False),
    x_vars=feat.columns[:-1],
    y_vars=[&quot;price&quot;],
)
g.map(seaborn.stripplot, size=3, orient=&quot;h&quot;, palette=&quot;Reds_r&quot;, edgecolor=&quot;gray&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/xadupre/.local/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x7fb2fad7ac20&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_69_2.png" src="../../_images/practice_exams_enonce_ml_2017_correction_69_2.png" />
</div>
</div>
<p>Régression</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr = LinearRegression()
lr.fit(mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;]], mat[&quot;price&quot;])
lr.coef_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 5.08109837e-01, -4.41245429e+00,  5.42852787e-04, -1.60797483e+01,
        2.12155016e+00])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from statsmodels.formula.api import ols

lr = ols(&quot;price ~ age + gender + delay + delay1 + weekday&quot;, data=mat)
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.612</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.612</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   800.0</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:15:05</td>     <th>  Log-Likelihood:    </th> <td> -8257.2</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2537</td>      <th>  AIC:               </th> <td>1.653e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2531</td>      <th>  BIC:               </th> <td>1.656e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th> <td>   55.4146</td> <td>    0.545</td> <td>  101.618</td> <td> 0.000</td> <td>   54.345</td> <td>   56.484</td>
</tr>
<tr>
  <th>age</th>       <td>    0.5081</td> <td>    0.010</td> <td>   48.918</td> <td> 0.000</td> <td>    0.488</td> <td>    0.528</td>
</tr>
<tr>
  <th>gender</th>    <td>   -4.4125</td> <td>    0.250</td> <td>  -17.683</td> <td> 0.000</td> <td>   -4.902</td> <td>   -3.923</td>
</tr>
<tr>
  <th>delay</th>     <td>    0.0005</td> <td>    0.001</td> <td>    0.562</td> <td> 0.574</td> <td>   -0.001</td> <td>    0.002</td>
</tr>
<tr>
  <th>delay1</th>    <td>  -16.0797</td> <td>    4.842</td> <td>   -3.321</td> <td> 0.001</td> <td>  -25.575</td> <td>   -6.585</td>
</tr>
<tr>
  <th>weekday</th>   <td>    2.1216</td> <td>    0.061</td> <td>   34.623</td> <td> 0.000</td> <td>    2.001</td> <td>    2.242</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>55.147</td> <th>  Durbin-Watson:     </th> <td>   1.969</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  57.558</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.358</td> <th>  Prob(JB):          </th> <td>3.17e-13</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.823</td> <th>  Cond. No.          </th> <td>9.20e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 9.2e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div>
</div>
</section>
<section id="10">
<h2>10<a class="headerlink" href="#10" title="Link to this heading">#</a></h2>
<p><em>Comment comparer ce modèle avec le précédent ? Implémentez le calcul qui vous permet de répondre à cette question.</em></p>
<p>Nous pourrions comparer les coefficients <img class="math" src="../../_images/math/a8daffb4a324830d6527f2af583a712b1d98e24b.svg" alt="R^2"/> (0.57, 0.61) des régressions pour savoir quelle est la meilleur excepté que celle-ci ne sont pas calculées sur les mêmes données. La comparaison n’a pas de sens et il serait dangeraux d’en tirer des conclusions. Les valeurs sont de plus très proches. Il faut comparer les prédictions. Dans le premier cas, on prédit le prix moyen. Dans le second, on prédit le prix d’une consultation. Il est alors possible de calculer une prédiction moyenne par
patient et de comparer les erreurs de prédiction du prix moyen. D’un côté, la prédiction du prix moyen, de l’autre la prédiction du prix d’une consultation agrégé par patient.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr_moy = LinearRegression()
lr_moy.fit(join[[&quot;age&quot;, &quot;gender&quot;]], join[&quot;price&quot;])
lr_moy.coef_, lr_moy.intercept_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 0.52440734, -4.36373925]), 61.05057671902867)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>pred_moy = lr_moy.predict(join[[&quot;age&quot;, &quot;gender&quot;]])
join[&quot;pred_moy&quot;] = pred_moy
join.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>idc</th>
      <th>name</th>
      <th>price</th>
      <th>pred_moy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>Cendrillon</td>
      <td>70.000000</td>
      <td>80.453648</td>
    </tr>
    <tr>
      <th>1</th>
      <td>41</td>
      <td>0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>Cendrillon</td>
      <td>78.333333</td>
      <td>82.551278</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>1</td>
      <td>304895f0-f686-4b0e-8854-a705bb5a6982</td>
      <td>Balthazar</td>
      <td>75.000000</td>
      <td>80.809575</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42</td>
      <td>1</td>
      <td>3f0d31d2-0ef4-4e7e-b876-07d10225cc8c</td>
      <td>Balthazar</td>
      <td>95.000000</td>
      <td>78.711946</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>1</td>
      <td>f29273f4-a76c-4158-b5f5-b3e5a080a0c7</td>
      <td>Balthazar</td>
      <td>90.000000</td>
      <td>78.187538</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On calcule l’erreur.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>err1 = ((join.pred_moy - join.price) ** 2).sum() / join.shape[0]
err1
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
31.874448844571756
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>join.plot(x=&quot;price&quot;, y=&quot;pred_moy&quot;, kind=&quot;scatter&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;price&#39;, ylabel=&#39;pred_moy&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_78_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_78_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lrc = LinearRegression()
feat = mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;, &quot;price&quot;, &quot;idc&quot;]].copy()
lrc.fit(feat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;]], feat[&quot;price&quot;])
lrc.coef_, lrc.intercept_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 5.08109837e-01, -4.41245429e+00,  5.42852787e-04, -1.60797483e+01,
         2.12155016e+00]),
 55.41460950333407)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>predc = lrc.predict(feat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;weekday&quot;]])
feat[&quot;predc&quot;] = predc
feat.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>delay</th>
      <th>delay1</th>
      <th>weekday</th>
      <th>price</th>
      <th>idc</th>
      <th>predc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>4</td>
      <td>75.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>82.855082</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>4</td>
      <td>65.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>82.855082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>2</td>
      <td>75.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>80.644421</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41</td>
      <td>0</td>
      <td>29.0</td>
      <td>0.033333</td>
      <td>5</td>
      <td>80.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>86.334615</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>0</td>
      <td>50.0</td>
      <td>0.019608</td>
      <td>5</td>
      <td>80.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>86.566717</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On agrège les secondes prédictions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>agg = feat[[&quot;idc&quot;, &quot;predc&quot;, &quot;price&quot;]].groupby(&quot;idc&quot;).mean()
agg.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>predc</th>
      <th>price</th>
    </tr>
    <tr>
      <th>idc</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>003b0195-2acb-4f46-b7fa-28cf266a8f60</th>
      <td>85.048055</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>009e689c-51a1-4cef-99ca-a4ba364eba8d</th>
      <td>83.945104</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>00a213c2-1174-4359-8a67-fe710ec1b439</th>
      <td>72.345309</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>00e42818-aade-4758-a5f6-c78a6f235ea5</th>
      <td>65.277461</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>0153b785-9acd-4d28-aad1-62f8bf2faea3</th>
      <td>79.298313</td>
      <td>75.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>err2 = ((agg.predc - agg.price) ** 2).sum() / agg.shape[0]
err2
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
20.697836056479865
</pre></div></div>
</div>
<p>Le second modèle est clairement meilleur.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>agg.plot(x=&quot;price&quot;, y=&quot;predc&quot;, kind=&quot;scatter&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;price&#39;, ylabel=&#39;predc&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_85_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_85_1.png" />
</div>
</div>
<p>La seconde régression utilise une information dont on ne dispose pas au niveau agrégé : le jour de la semaine et un précédent graphe a clairement montré que c’était une variable importante. Un dernier graphe pour comparer les deux prédictions en montrant les prédictions triées par prix à prédire.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>temp = join.sort_values(&quot;price&quot;).reset_index(drop=True).reset_index(drop=False)
temp.head(n=1)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>age</th>
      <th>gender</th>
      <th>idc</th>
      <th>name</th>
      <th>price</th>
      <th>pred_moy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>18</td>
      <td>1</td>
      <td>6423a722-4769-4a7c-8d1d-266538c2a07a</td>
      <td>Balthazar</td>
      <td>60.0</td>
      <td>66.12617</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>temp.plot(x=&quot;index&quot;, y=[&quot;price&quot;, &quot;pred_moy&quot;])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;index&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_88_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_88_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>temp2 = agg.sort_values(&quot;price&quot;).reset_index(drop=True).reset_index(drop=False)
temp2.head(n=1)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>predc</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>64.54544</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>ax = temp.plot(x=&quot;index&quot;, y=&quot;price&quot;, figsize=(14, 4), ylim=[60, 120])
temp.plot(x=&quot;index&quot;, y=&quot;pred_moy&quot;, linewidth=1, ax=ax, ylim=[60, 120])
temp2.plot(x=&quot;index&quot;, y=&quot;predc&quot;, ax=ax, linewidth=0.6, ylim=[60, 120])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;index&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_90_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_90_1.png" />
</div>
</div>
<p>C’est finalement un peu plus visible sur le graphe précédent (nuage de points) mais aussi un peu trompeur du fait de la superposition des points. Une dernière remarque. En machine learning, nous avons l’habitude d’apprendre un modèle sur une base d’apprentissage et de tester les prédictions sur une autre. Dans notre cas, nous avons appris et prédit sur la même base. Ce type de tester est évidemment plus fiable. Mais nous avons comparé ici deux erreurs d’apprentissage moyennes et c’est exactement
ce que l’on fait lorsqu’on compare deux coefficients <img class="math" src="../../_images/math/a8daffb4a324830d6527f2af583a712b1d98e24b.svg" alt="R^2"/>.</p>
<p>Un dernier graphe pour la route obtenu en triant les erreurs par ordre croissant.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>temp[&quot;erreur&quot;] = temp.pred_moy - temp.price
temp2[&quot;erreur2&quot;] = temp2.predc - temp2.price
ax = temp[[&quot;erreur&quot;]].sort_values(&quot;erreur&quot;).reset_index(drop=True).plot()
temp2[[&quot;erreur2&quot;]].sort_values(&quot;erreur2&quot;).reset_index(drop=True).plot(ax=ax)
ax.plot([0, 1000], [0, 0], &quot;r--&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fb2fa805210&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_92_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_92_1.png" />
</div>
</div>
<p>Le second modèle fait des erreurs moins importantes surtout côté négatif. Il sous-estime moins la bonne valeur.</p>
</section>
<section id="Traitement-spécifique-de-la-variable-catégorielle-weekday">
<h2>Traitement spécifique de la variable catégorielle weekday<a class="headerlink" href="#Traitement-spécifique-de-la-variable-catégorielle-weekday" title="Link to this heading">#</a></h2>
<p>Le second modèle ne prend pas en compte le dimanche comme jour de la semaine. <em>weekday</em> est une variable catégorielle. Contrairment au genre, elle possède plus de deux modalités. Il serait intéressant de la traiter comme un ensemble de variable binaire et non une colonne de type entier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>dummies = pandas.get_dummies(mat.weekday)
dummies.columns = [&quot;lu&quot;, &quot;ma&quot;, &quot;me&quot;, &quot;je&quot;, &quot;ve&quot;, &quot;sa&quot;, &quot;di&quot;]
dummies.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lu</th>
      <th>ma</th>
      <th>me</th>
      <th>je</th>
      <th>ve</th>
      <th>sa</th>
      <th>di</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On supprime une modalité pour éviter d’avoir une matrice corrélée avec la constante et on ajoute des variables au modèle de régression.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>mat2 = pandas.concat([mat, dummies.drop(&quot;lu&quot;, axis=1)], axis=1)
mat2.head(n=1)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>idc</th>
      <th>idr</th>
      <th>price</th>
      <th>date2</th>
      <th>weekday</th>
      <th>constant</th>
      <th>jour</th>
      <th>jouri</th>
      <th>diff</th>
      <th>...</th>
      <th>delay1</th>
      <th>age</th>
      <th>gender</th>
      <th>name</th>
      <th>ma</th>
      <th>me</th>
      <th>je</th>
      <th>ve</th>
      <th>sa</th>
      <th>di</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>b7db0ac9-86a1-46f9-98ac-f1f8eb54072d</td>
      <td>75.0</td>
      <td>2016-12-02 19:47:45.068274</td>
      <td>4</td>
      <td>2016-11-18 19:47:45.068274</td>
      <td>14 days</td>
      <td>14</td>
      <td>-26.0</td>
      <td>...</td>
      <td>0.002732</td>
      <td>37</td>
      <td>0</td>
      <td>Cendrillon</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 22 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr = ols(
    &quot;price ~ age + gender + delay + delay1 + ma + me + je + ve + sa + di&quot;, data=mat2
)
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.918</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.917</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   2812.</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:15:41</td>     <th>  Log-Likelihood:    </th> <td> -6293.7</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2537</td>      <th>  AIC:               </th> <td>1.261e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2526</td>      <th>  BIC:               </th> <td>1.267e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>    10</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th>  <td>   59.0371</td> <td>    0.272</td> <td>  217.342</td> <td> 0.000</td> <td>   58.504</td> <td>   59.570</td>
</tr>
<tr>
  <th>ma[T.True]</th> <td>   -0.0840</td> <td>    0.208</td> <td>   -0.405</td> <td> 0.686</td> <td>   -0.491</td> <td>    0.323</td>
</tr>
<tr>
  <th>me[T.True]</th> <td>    0.3003</td> <td>    0.216</td> <td>    1.392</td> <td> 0.164</td> <td>   -0.123</td> <td>    0.723</td>
</tr>
<tr>
  <th>je[T.True]</th> <td>    0.1607</td> <td>    0.219</td> <td>    0.735</td> <td> 0.463</td> <td>   -0.268</td> <td>    0.590</td>
</tr>
<tr>
  <th>ve[T.True]</th> <td>   -0.1748</td> <td>    0.212</td> <td>   -0.825</td> <td> 0.409</td> <td>   -0.590</td> <td>    0.240</td>
</tr>
<tr>
  <th>sa[T.True]</th> <td>    0.1849</td> <td>    0.210</td> <td>    0.879</td> <td> 0.379</td> <td>   -0.227</td> <td>    0.597</td>
</tr>
<tr>
  <th>di[T.True]</th> <td>   20.0978</td> <td>    0.211</td> <td>   95.203</td> <td> 0.000</td> <td>   19.684</td> <td>   20.512</td>
</tr>
<tr>
  <th>age</th>        <td>    0.5005</td> <td>    0.005</td> <td>  104.318</td> <td> 0.000</td> <td>    0.491</td> <td>    0.510</td>
</tr>
<tr>
  <th>gender</th>     <td>   -4.0722</td> <td>    0.115</td> <td>  -35.321</td> <td> 0.000</td> <td>   -4.298</td> <td>   -3.846</td>
</tr>
<tr>
  <th>delay</th>      <td>    0.0003</td> <td>    0.000</td> <td>    0.661</td> <td> 0.509</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>delay1</th>     <td>  -20.7385</td> <td>    2.236</td> <td>   -9.275</td> <td> 0.000</td> <td>  -25.123</td> <td>  -16.354</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>257.849</td> <th>  Durbin-Watson:     </th> <td>   2.034</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 484.437</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.672</td>  <th>  Prob(JB):          </th> <td>6.40e-106</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.666</td>  <th>  Cond. No.          </th> <td>9.20e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 9.2e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div>
</div>
<p>On vérifie que le coefficient pour dimanche n’est clairement significatif contrairement aux autres dont la probabilité d’être nul est élevée. Le médecin appliquerait une majoration de 20 euros le dimanche. Le coefficient <img class="math" src="../../_images/math/a8daffb4a324830d6527f2af583a712b1d98e24b.svg" alt="R^2"/> est aussi nettement plus élevé. On construit les prédictions d’un second modèle en ne tenant compte que de la variable dimanche.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lrc = LinearRegression()
feat2 = mat2[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;price&quot;, &quot;idc&quot;, &quot;di&quot;]].copy()
lrc.fit(feat2[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;di&quot;]], feat2[&quot;price&quot;])
lrc.coef_, lrc.intercept_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 5.00892234e-01, -4.07229120e+00,  2.97614199e-04, -2.07004497e+01,
         2.00395644e+01]),
 59.07951294272968)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>predc = lrc.predict(feat2[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;di&quot;]])
feat2[&quot;predc&quot;] = predc
feat2.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>delay</th>
      <th>delay1</th>
      <th>price</th>
      <th>idc</th>
      <th>di</th>
      <th>predc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>75.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>False</td>
      <td>77.664596</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>65.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>False</td>
      <td>77.664596</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>75.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>False</td>
      <td>79.668165</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41</td>
      <td>0</td>
      <td>29.0</td>
      <td>0.033333</td>
      <td>80.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>False</td>
      <td>78.934710</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>0</td>
      <td>50.0</td>
      <td>0.019608</td>
      <td>80.0</td>
      <td>f44b004b-b01e-4835-b86d-1a42846c6d93</td>
      <td>False</td>
      <td>79.225084</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>agg2 = feat2[[&quot;idc&quot;, &quot;predc&quot;, &quot;price&quot;]].groupby(&quot;idc&quot;).mean()
agg2.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>predc</th>
      <th>price</th>
    </tr>
    <tr>
      <th>idc</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>003b0195-2acb-4f46-b7fa-28cf266a8f60</th>
      <td>80.103904</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>009e689c-51a1-4cef-99ca-a4ba364eba8d</th>
      <td>80.812446</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>00a213c2-1174-4359-8a67-fe710ec1b439</th>
      <td>67.581598</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>00e42818-aade-4758-a5f6-c78a6f235ea5</th>
      <td>66.890947</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>0153b785-9acd-4d28-aad1-62f8bf2faea3</th>
      <td>74.158351</td>
      <td>75.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>err2d = ((agg2.predc - agg2.price) ** 2).sum() / agg2.shape[0]
err2d
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.626505427547838
</pre></div></div>
</div>
<p>Nettement, nettement mieux.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>agg2.plot(x=&quot;price&quot;, y=&quot;predc&quot;, kind=&quot;scatter&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;price&#39;, ylabel=&#39;predc&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_105_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_105_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>temp2 = agg2.sort_values(&quot;price&quot;).reset_index(drop=True).reset_index(drop=False)
ax = temp2.plot(x=&quot;index&quot;, y=&quot;price&quot;, figsize=(14, 4), ylim=[60, 120])
temp2.plot(x=&quot;index&quot;, y=&quot;predc&quot;, linewidth=1, ax=ax, ylim=[60, 120])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: xlabel=&#39;index&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/practice_exams_enonce_ml_2017_correction_106_1.png" src="../../_images/practice_exams_enonce_ml_2017_correction_106_1.png" />
</div>
</div>
</section>
<section id="Une-variable-catégorielle-en-une-seule-colonne-?">
<h2>Une variable catégorielle en une seule colonne ?<a class="headerlink" href="#Une-variable-catégorielle-en-une-seule-colonne-?" title="Link to this heading">#</a></h2>
<p>Un jeu de données peut rapidement croître s’il est étendu pour chaque variable catégorielle. On peut utiliser le module <a class="reference external" href="https://github.com/scikit-learn-contrib/categorical-encoding/tree/master/category_encoders">category_encoders</a> ou <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>from category_encoders import PolynomialEncoder

encoder = PolynomialEncoder(cols=[&quot;weekday&quot;])
encoder.fit(rend[[&quot;weekday&quot;]], rend[&quot;price&quot;])
pred = encoder.transform(rend[[&quot;weekday&quot;]])
conc = pandas.concat([rend[[&quot;weekday&quot;]], pred], axis=1)
conc.head()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/xadupre/.local/lib/python3.10/site-packages/category_encoders/base_contrast_encoder.py:126: FutureWarning: Intercept column might not be added anymore in future releases (c.f. issue #370)
  warnings.warn(&#34;Intercept column might not be added anymore in future releases (c.f. issue #370)&#34;,
/home/xadupre/.local/lib/python3.10/site-packages/category_encoders/base_contrast_encoder.py:126: FutureWarning: Intercept column might not be added anymore in future releases (c.f. issue #370)
  warnings.warn(&#34;Intercept column might not be added anymore in future releases (c.f. issue #370)&#34;,
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weekday</th>
      <th>intercept</th>
      <th>weekday_0</th>
      <th>weekday_1</th>
      <th>weekday_2</th>
      <th>weekday_3</th>
      <th>weekday_4</th>
      <th>weekday_5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>1</td>
      <td>-0.566947</td>
      <td>0.545545</td>
      <td>-0.408248</td>
      <td>0.241747</td>
      <td>-0.109109</td>
      <td>0.032898</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>1</td>
      <td>-0.566947</td>
      <td>0.545545</td>
      <td>-0.408248</td>
      <td>0.241747</td>
      <td>-0.109109</td>
      <td>0.032898</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>-0.377964</td>
      <td>0.000000</td>
      <td>0.408248</td>
      <td>-0.564076</td>
      <td>0.436436</td>
      <td>-0.197386</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>1</td>
      <td>-0.188982</td>
      <td>-0.327327</td>
      <td>0.408248</td>
      <td>0.080582</td>
      <td>-0.545545</td>
      <td>0.493464</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>-0.188982</td>
      <td>-0.327327</td>
      <td>0.408248</td>
      <td>0.080582</td>
      <td>-0.545545</td>
      <td>0.493464</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Ou associer la valeur de la cible à prédire pour chaque jour de la semaine.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>copy = rend[[&quot;weekday&quot;, &quot;price&quot;]].copy()
gr = copy.groupby(&quot;weekday&quot;, as_index=False).mean()
gr
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weekday</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>76.112532</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>76.195373</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>77.047478</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>76.677116</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>76.049724</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>76.630728</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>97.078804</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>feat3 = mat[[&quot;age&quot;, &quot;gender&quot;, &quot;delay&quot;, &quot;delay1&quot;, &quot;price&quot;, &quot;idc&quot;, &quot;weekday&quot;]]
feat3 = feat3.merge(gr, on=&quot;weekday&quot;, suffixes=(&quot;&quot;, &quot;_label&quot;))
feat3.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>delay</th>
      <th>delay1</th>
      <th>price</th>
      <th>idc</th>
      <th>weekday</th>
      <th>price_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>75.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>4</td>
      <td>76.049724</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>65.0</td>
      <td>4ba0b473-f8ca-4466-a65b-40e9b8ba5029</td>
      <td>4</td>
      <td>76.049724</td>
    </tr>
    <tr>
      <th>2</th>
      <td>57</td>
      <td>1</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>85.0</td>
      <td>7ffb8a8b-a829-41f1-9572-2985ee9ba05e</td>
      <td>4</td>
      <td>76.049724</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
      <td>0</td>
      <td>365.0</td>
      <td>0.002732</td>
      <td>75.0</td>
      <td>0153b785-9acd-4d28-aad1-62f8bf2faea3</td>
      <td>4</td>
      <td>76.049724</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>1</td>
      <td>28.0</td>
      <td>0.034483</td>
      <td>70.0</td>
      <td>47e415f0-f4e9-40c5-a59d-adc4c0621c8a</td>
      <td>4</td>
      <td>76.049724</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>On apprend avec la variable <em>weekday</em> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr = ols(&quot;price ~ age + gender + delay + delay1 + weekday&quot;, data=feat3)
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.612</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.612</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   800.0</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:15:56</td>     <th>  Log-Likelihood:    </th> <td> -8257.2</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2537</td>      <th>  AIC:               </th> <td>1.653e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2531</td>      <th>  BIC:               </th> <td>1.656e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th> <td>   55.4146</td> <td>    0.545</td> <td>  101.618</td> <td> 0.000</td> <td>   54.345</td> <td>   56.484</td>
</tr>
<tr>
  <th>age</th>       <td>    0.5081</td> <td>    0.010</td> <td>   48.918</td> <td> 0.000</td> <td>    0.488</td> <td>    0.528</td>
</tr>
<tr>
  <th>gender</th>    <td>   -4.4125</td> <td>    0.250</td> <td>  -17.683</td> <td> 0.000</td> <td>   -4.902</td> <td>   -3.923</td>
</tr>
<tr>
  <th>delay</th>     <td>    0.0005</td> <td>    0.001</td> <td>    0.562</td> <td> 0.574</td> <td>   -0.001</td> <td>    0.002</td>
</tr>
<tr>
  <th>delay1</th>    <td>  -16.0797</td> <td>    4.842</td> <td>   -3.321</td> <td> 0.001</td> <td>  -25.575</td> <td>   -6.585</td>
</tr>
<tr>
  <th>weekday</th>   <td>    2.1216</td> <td>    0.061</td> <td>   34.623</td> <td> 0.000</td> <td>    2.001</td> <td>    2.242</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>55.147</td> <th>  Durbin-Watson:     </th> <td>   0.442</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  57.558</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.358</td> <th>  Prob(JB):          </th> <td>3.17e-13</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.823</td> <th>  Cond. No.          </th> <td>9.20e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 9.2e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div>
</div>
<p>Et on compare avec la variable <em>price_label</em> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>lr = ols(&quot;price ~ age + gender + delay + delay1 + price_label&quot;, data=feat3)
res = lr.fit()
res.summary()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>price</td>      <th>  R-squared:         </th> <td>   0.917</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.917</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   5611.</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 25 Jan 2024</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:15:58</td>     <th>  Log-Likelihood:    </th> <td> -6298.8</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2537</td>      <th>  AIC:               </th> <td>1.261e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2531</td>      <th>  BIC:               </th> <td>1.264e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th>   <td>  -14.9859</td> <td>    0.664</td> <td>  -22.576</td> <td> 0.000</td> <td>  -16.288</td> <td>  -13.684</td>
</tr>
<tr>
  <th>age</th>         <td>    0.5000</td> <td>    0.005</td> <td>  104.173</td> <td> 0.000</td> <td>    0.491</td> <td>    0.509</td>
</tr>
<tr>
  <th>gender</th>      <td>   -4.0767</td> <td>    0.115</td> <td>  -35.344</td> <td> 0.000</td> <td>   -4.303</td> <td>   -3.851</td>
</tr>
<tr>
  <th>delay</th>       <td>    0.0003</td> <td>    0.000</td> <td>    0.601</td> <td> 0.548</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>delay1</th>      <td>  -20.8060</td> <td>    2.237</td> <td>   -9.303</td> <td> 0.000</td> <td>  -25.192</td> <td>  -16.420</td>
</tr>
<tr>
  <th>price_label</th> <td>    0.9696</td> <td>    0.008</td> <td>  122.209</td> <td> 0.000</td> <td>    0.954</td> <td>    0.985</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>249.245</td> <th>  Durbin-Watson:     </th> <td>   2.035</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 459.156</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.660</td>  <th>  Prob(JB):          </th> <td>1.98e-100</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.613</td>  <th>  Cond. No.          </th> <td>9.47e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 9.47e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div>
</div>
<p>Aussi bien qu’avec la variable <em>dimanche</em>.</p>
</section>
</section>
<hr class="docutils" />
<p><a class="reference external" href="https://github.com/sdpython/teachpyx/tree/main/_doc/practice/exams/enonce_ml_2017_correction.ipynb">Notebook on github</a></p>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../index_data.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Numpy / Pandas</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="enonce_ml_2017.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Evaluation Python / Machine Learning année 2017 - énoncé</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2024, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Evaluation Python / Machine Learning année 2017 - solution</a><ul>
<li><a class="reference internal" href="#1">1</a></li>
<li><a class="reference internal" href="#2">2</a></li>
<li><a class="reference internal" href="#3">3</a></li>
<li><a class="reference internal" href="#4">4</a></li>
<li><a class="reference internal" href="#5">5</a></li>
<li><a class="reference internal" href="#6">6</a></li>
<li><a class="reference internal" href="#7">7</a></li>
<li><a class="reference internal" href="#8">8</a></li>
<li><a class="reference internal" href="#8---réponse-plus-courte">8 - réponse plus courte</a></li>
<li><a class="reference internal" href="#9">9</a></li>
<li><a class="reference internal" href="#10">10</a></li>
<li><a class="reference internal" href="#Traitement-spécifique-de-la-variable-catégorielle-weekday">Traitement spécifique de la variable catégorielle weekday</a></li>
<li><a class="reference internal" href="#Une-variable-catégorielle-en-une-seule-colonne-?">Une variable catégorielle en une seule colonne ?</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=0886690b"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>