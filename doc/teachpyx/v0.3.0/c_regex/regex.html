
<!DOCTYPE html>


<html lang="fr" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Expressions régulières &#8212; Documentation teachpyx 0.3.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=e5fbc548" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=83beb07c"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c_regex/regex';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Parallélisation" href="../c_parallelisation/index.html" />
    <link rel="prev" title="Expression régulières" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Passer au contenu principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/project_ico.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/project_ico.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_lang/index.html">
                        Variables et fonctions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_classes/index.html">
                        Classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_exception/index.html">
                        Exceptions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_module/index.html">
                        Entrées, Sorties, Modules
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Expression régulières
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_parallelisation/index.html">
                        Parallélisation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_gui/index.html">
                        Interfaces graphiques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_data/index.html">
                        Matrices et DataFrames
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_resume/index.html">
                        Précis
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        Code inclus dans cette librairie
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../articles/index.html">
                        Collections d’articles inclassables
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Exemples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Bouts de code à conserver
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Syntaxes, Définitions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../introduction.html">
                        Introduction
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_lang/index.html">
                        Variables et fonctions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_classes/index.html">
                        Classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_exception/index.html">
                        Exceptions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_module/index.html">
                        Entrées, Sorties, Modules
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Expression régulières
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_parallelisation/index.html">
                        Parallélisation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_gui/index.html">
                        Interfaces graphiques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_data/index.html">
                        Matrices et DataFrames
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_resume/index.html">
                        Précis
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        Code inclus dans cette librairie
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../articles/index.html">
                        Collections d’articles inclassables
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Exemples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Bouts de code à conserver
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Syntaxes, Définitions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Navigation de la section">
  <p class="bd-links__title" role="heading" aria-level="1">Navigation de la section</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Expressions régulières</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Fils d'Ariane">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Fil d'Ariane">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Acceuil">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Expression régulières</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Expressions régulières</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="expressions-regulieres">
<span id="l-regex"></span><h1>Expressions régulières<a class="headerlink" href="#expressions-regulieres" title="Lien permanent vers cette rubrique">#</a></h1>
<nav class="contents local" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#a-quoi-ca-sert" id="id1">A quoi ça sert ?</a></p></li>
<li><p><a class="reference internal" href="#syntaxe" id="id2">Syntaxe</a></p>
<ul>
<li><p><a class="reference internal" href="#les-ensembles-de-caracteres" id="id3">Les ensembles de caractères</a></p></li>
<li><p><a class="reference internal" href="#les-multiplicateurs" id="id4">Les multiplicateurs</a></p></li>
<li><p><a class="reference internal" href="#groupes" id="id5">Groupes</a></p></li>
<li><p><a class="reference internal" href="#assembler-les-caracteres" id="id6">Assembler les caractères</a></p></li>
<li><p><a class="reference internal" href="#fonctions" id="id7">Fonctions</a></p></li>
<li><p><a class="reference internal" href="#exemple-plus-complet" id="id8">Exemple plus complet</a></p></li>
<li><p><a class="reference internal" href="#groupes-nommes" id="id9">Groupes nommés</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="a-quoi-ca-sert">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">A quoi ça sert ?</a><a class="headerlink" href="#a-quoi-ca-sert" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Chercher un mot dans un texte est une tâche facile, c’est l’objectif
de la méthode <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str.find" title="(disponible dans Python v3.11)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">str.find()</span></code></a>
attachée aux chaînes de caractères, elle suffit encore lorsqu’on cherche
un mot au pluriel ou au singulier mais il faut l’appeler au moins
deux fois pour chercher ces deux formes. Pour des expressions plus
compliquées, il est conseillé d’utiliser une
<a class="reference external" href="https://fr.wikipedia.org/wiki/Expression_rationnelle">expression régulière</a>.
C’est une fonctionnalité qu’on retrouve dans beaucoup de langages.
C’est une forme de grammaire qui permet de rechercher des expressions.</p>
<p>Lorsqu’on remplit un formulaire, on voit souvent le format <code class="docutils literal notranslate"><span class="pre">&quot;MM/JJ/AAAA&quot;</span></code>
qui précise sous quelle forme on s’attend à ce qu’une date soit écrite.
Les expressions régulières permettent de définir également ce format
et de chercher dans un texte toutes les chaînes de caractères qui
sont conformes à ce format.</p>
<p>La liste qui suit contient des dates de naissance. On cherche à obtenir
toutes les dates de cet exemple sachant que les jours ou les mois
contiennent un ou deux chiffres, les années deux ou quatre.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;date 0 : 14/9/2000</span>
<span class="s2">date 1 : 20/04/1971     date 2 : 14/09/1913     date 3 : 2/3/1978</span>
<span class="s2">date 4 : 1/7/1986     date 5 : 7/3/47     date 6 : 15/10/1914</span>
<span class="s2">date 7 : 08/03/1941     date 8 : 8/1/1980     date 9 : 30/6/1976&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Le premier chiffre du jour est soit 0, 1, 2, ou 3 ; ceci se traduit par <code class="docutils literal notranslate"><span class="pre">[0-3]</span></code>.
Le second chiffre est compris entre 0 et 9, soit <code class="docutils literal notranslate"><span class="pre">[0-9]</span></code>.
Le format des jours est traduit par <code class="docutils literal notranslate"><span class="pre">[0-3][0-9]</span></code>. Mais le premier
jour est facultatif, ce qu’on précise avec le symbole <code class="docutils literal notranslate"><span class="pre">?</span></code> : <code class="docutils literal notranslate"><span class="pre">[0-3]?[0-9]</span></code>.
Les mois suivent le même principe : <code class="docutils literal notranslate"><span class="pre">[0-1]?[0-9]</span></code>. Pour les années,
ce sont les deux premiers chiffres qui sont facultatifs, le symbole <code class="docutils literal notranslate"><span class="pre">?</span></code>
s’appliquent sur les deux premiers chiffres,
ce qu’on précise avec des parenthèses :
<code class="docutils literal notranslate"><span class="pre">([0-2][0-9])?[0-9][0-9]</span></code>. Le format final d’une date devient :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[0-3]?[0-9]/[0-1]?[0-9]/([0-2][0-9])?[0-9][0-9]
</pre></div>
</div>
<p>Le module <a class="reference external" href="https://docs.python.org/3/library/re.html#module-re" title="(disponible dans Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>
gère les expressions régulières, celui-ci traite différemment les parties de l’expression
régulière qui sont entre parenthèses de celles qui ne le sont pas : c’est un moyen
de dire au module <a class="reference external" href="https://docs.python.org/3/library/re.html#module-re" title="(disponible dans Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>
que nous nous intéressons à telle partie de l’expression qui est signalée
entre parenthèses. Comme la partie qui nous intéresse - une date -
concerne l’intégralité de l’expression régulière,
il faut insérer celle-ci entre parenthèses.</p>
<p>La première étape consiste à construire l’expression régulière,
la seconde à rechercher toutes les fois qu’un morceau de la chaîne <code class="docutils literal notranslate"><span class="pre">s</span></code>
définie plus haut correspond à l’expression régulière.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;date 0 : 14/9/2000</span>
<span class="s2">    date 1 : 20/04/1971     date 2 : 14/09/1913     date 3 : 2/3/1978</span>
<span class="s2">    date 4 : 1/7/1986     date 5 : 7/3/47     date 6 : 15/10/1914</span>
<span class="s2">    date 7 : 08/03/1941     date 8 : 8/1/1980     date 9 : 30/6/1976&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># première étape : construction</span>
<span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;([0-3]?[0-9]/[0-1]?[0-9]/([0-2][0-9])?[0-9][0-9])&quot;</span><span class="p">)</span>
<span class="c1"># seconde étape : recherche</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[(</span><span class="s1">&#39;14/9/2000&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;20/04/1971&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;14/09/1913&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;2/3/1978&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;1/7/1986&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;7/3/47&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;15/10/1914&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;08/03/1941&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;8/1/1980&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;30/6/1976&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Le résultat une liste de couples dont chaque élément correspond
aux parties comprises entre parenthèses qu’on appelle des
<em>groupes</em>. Lorsque les expressions régulières sont utilisées,
on doit d’abord se demander comment définir ce qu’on cherche puis quelles
fonctions utiliser pour obtenir les résultats de cette recherche.
Les deux paragraphes qui suivent y répondent.</p>
</section>
<section id="syntaxe">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Syntaxe</a><a class="headerlink" href="#syntaxe" title="Lien permanent vers cette rubrique">#</a></h2>
<p>La syntaxe des expressions régulières est décrite sur le site
officiel de <em>python</em>. La page
<a class="reference external" href="https://docs.python.org/3/library/re.html?highlight=re#regular-expression-syntax">Regular Expression Syntax</a>
décrit comment se servir des expressions régulières, les deux pages
sont en anglais. Comme toute grammaire, celle des expressions
régulières est susceptible d’évoluer au fur et à mesure des
versions du langage <em>python</em>.</p>
<section id="les-ensembles-de-caracteres">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Les ensembles de caractères</a><a class="headerlink" href="#les-ensembles-de-caracteres" title="Lien permanent vers cette rubrique">#</a></h3>
<p>Lors d’une recherche, on s’intéresse aux caractères et souvent
aux classes de caractères : on cherche un chiffre, une lettre,
un caractère dans un ensemble précis ou un caractère qui n’appartient
pas à un ensemble précis. Certains ensembles sont prédéfinis,
d’autres doivent être définis à l’aide de crochets.</p>
<p>Pour définir un ensemble de caractères, il faut écrire cet ensemble entre crochets :
<code class="docutils literal notranslate"><span class="pre">[0123456789]</span></code> désigne un chiffre. Comme c’est une séquence de caractères
consécutifs, on peut résumer cette écriture en <code class="docutils literal notranslate"><span class="pre">[0-9]</span></code>. Pour inclure les symboles
<code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">+</span></code>, il suffit d’écrire : <code class="docutils literal notranslate"><span class="pre">[-0-9+]</span></code>. Il faut penser à mettre
le symbole <code class="docutils literal notranslate"><span class="pre">-</span></code> au début pour éviter qu’il ne désigne une séquence.</p>
<p>Le caractère  <code class="docutils literal notranslate"><span class="pre">^</span></code> inséré au début du groupe signifie que le caractère
cherché ne doit pas être un de ceux qui suivent. Le tableau suivant décrit
les ensembles prédéfinis et leur équivalent en terme d’ensemble de caractères :</p>
<table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.</span></code></p></td>
<td><p>désigne tout caractère non spécial quel qu’il soit</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\d</span></code></p></td>
<td><p>désigne tout chiffre, est équivalent à <code class="docutils literal notranslate"><span class="pre">[0-9]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\D</span></code></p></td>
<td><p>désigne tout caractère différent d’un chiffre, est équivalent à <code class="docutils literal notranslate"><span class="pre">[^0-9]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\s</span></code></p></td>
<td><p>désigne tout espace ou caractère approché, est équivalent à
<code class="docutils literal notranslate"><span class="pre">[\;</span> <span class="pre">\t\n\r\f\v]</span></code>. Ces caractères sont spéciaux, les plus utilisés sont
<code class="docutils literal notranslate"><span class="pre">\t</span></code> qui est une tabulation, <code class="docutils literal notranslate"><span class="pre">\n</span></code> qui est une fin de ligne et qui
<code class="docutils literal notranslate"><span class="pre">\r</span></code> qui est un retour à la ligne.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\S</span></code></p></td>
<td><p>désigne tout caractère différent d’un espace,
est équivalent à  <code class="docutils literal notranslate"><span class="pre">[^</span> <span class="pre">\t\n\r\f\v]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\w</span></code></p></td>
<td><p>désigne tout lettre ou chiffre, est équivalent à <code class="docutils literal notranslate"><span class="pre">[a-zA-Z0-9\_]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">\W</span></code></p></td>
<td><p>désigne tout caractère différent d’une lettre ou d’un chiffre,
est équivalent à <code class="docutils literal notranslate"><span class="pre">[^a-zA-Z0-9\_]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td><p>désigne le début d’un mot sauf s’il est placé entre crochets</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">$</span></code></p></td>
<td><p>désigne la fin d’un mot sauf s’il est placé entre crochets</p></td>
</tr>
</tbody>
</table>
<p>A l’instar des chaînes de caractères, comme le caractère <code class="docutils literal notranslate"><span class="pre">\</span></code> est un
caractère spécial, il faut le doubler : <code class="docutils literal notranslate"><span class="pre">[\\]</span></code>. Avec ce système, le mot
<em>« taxinomie »</em> qui accepte deux orthographes s’écrira : <code class="docutils literal notranslate"><span class="pre">tax[io]nomie</span></code>.</p>
<p>Le caractère <code class="docutils literal notranslate"><span class="pre">\</span></code> est déjà un caractère spécial pour les chaînes de caractères
en <em>python</em>, il faut donc le quadrupler pour l’insérer dans un expression
régulière. L’expression suivante filtre toutes les images dont
l’extension est <em>png</em> et qui sont enregistrées dans un
répertoire <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;something</span><span class="se">\\</span><span class="s2">support</span><span class="se">\\</span><span class="s2">vba</span><span class="se">\\</span><span class="s2">image/vbatd1_4.png&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;[</span><span class="se">\\\\</span><span class="s2">/]image[</span><span class="se">\\\\</span><span class="s2">/].*[.]png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>  <span class="c1"># résultat positif</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;[</span><span class="se">\\\\</span><span class="s2">/]image[</span><span class="se">\\\\</span><span class="s2">/].*[.]png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>  <span class="c1"># même résultat</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">&lt;</span><span class="n">re</span><span class="o">.</span><span class="n">Match</span> <span class="nb">object</span><span class="p">;</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">image/vbatd1_4.png&#39;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">re</span><span class="o">.</span><span class="n">Match</span> <span class="nb">object</span><span class="p">;</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">image/vbatd1_4.png&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="les-multiplicateurs">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Les multiplicateurs</a><a class="headerlink" href="#les-multiplicateurs" title="Lien permanent vers cette rubrique">#</a></h3>
<p>Les multiplicateurs permettent de définir des expressions régulières
comme : un mot entre six et huit lettres qu’on écrira <code class="docutils literal notranslate"><span class="pre">[\w]{6,8}</span></code>.
Le tableau suivant donne la liste des multiplicateurs principaux :</p>
<table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>présence de l’ensemble de caractères qui précède entre 0 fois et l’infini</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td><p>présence de l’ensemble de caractères qui précède entre 1 fois et l’infini</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">?</span></code></p></td>
<td><p>présence de l’ensemble de caractères qui précède entre 0 et 1 fois</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{m,n}</span></code></p></td>
<td><p>présence de l’ensemble de caractères qui précède entre <code class="docutils literal notranslate"><span class="pre">m</span></code> et <code class="docutils literal notranslate"><span class="pre">n</span></code> fois,
si <code class="docutils literal notranslate"><span class="pre">m=n</span></code>, cette expression peut être résumée par <code class="docutils literal notranslate"><span class="pre">{n}</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(?!(...))</span></code></p></td>
<td><p>absence du groupe désigné par les points de suspensions.</p></td>
</tr>
</tbody>
</table>
<p>L’algorithme des expressions régulières essaye toujours de faire correspondre
le plus grand morceau à l’expression régulière. Par exemple, dans la chaîne
<code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;mot&lt;/h1&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;.*&gt;</span></code> correspond avec <code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;/h1&gt;</span></code> ou encore
<code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;mot&lt;/h1&gt;</span></code>. Par conséquent, l’expression régulière correspond à trois
morceaux. Par défaut, il prendra le plus grand. Pour choisir les plus petits,
il faudra écrire les multiplicateurs comme ceci : <code class="docutils literal notranslate"><span class="pre">*?</span></code>, <code class="docutils literal notranslate"><span class="pre">+?</span></code>, <code class="docutils literal notranslate"><span class="pre">??</span></code>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&lt;h1&gt;mot&lt;/h1&gt;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(&lt;.*&gt;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>  <span class="c1"># (&#39;&lt;h1&gt;mot&lt;/h1&gt;&#39;,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(&lt;.*?&gt;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>  <span class="c1"># (&#39;&lt;h1&gt;&#39;,)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">(</span><span class="s1">&#39;&lt;h1&gt;mot&lt;/h1&gt;&#39;</span><span class="p">,)</span>
    <span class="p">(</span><span class="s1">&#39;&lt;h1&gt;&#39;</span><span class="p">,)</span>
</pre></div>
</div>
</section>
<section id="groupes">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Groupes</a><a class="headerlink" href="#groupes" title="Lien permanent vers cette rubrique">#</a></h3>
<p>Lorsqu’un multiplicateur s’applique sur plus d’un caractère,
il faut définir un groupe à l’aide de parenthèses. Par exemple,
le mot <code class="docutils literal notranslate"><span class="pre">yoyo</span></code> s’écrira : <code class="docutils literal notranslate"><span class="pre">(yo){2}</span></code>. Les parenthèses jouent un
rôle similaire à celui qu’elles jouent dans une expression numérique.
Tout ce qui est compris entre deux parenthèses est considéré
comme un groupe.</p>
</section>
<section id="assembler-les-caracteres">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Assembler les caractères</a><a class="headerlink" href="#assembler-les-caracteres" title="Lien permanent vers cette rubrique">#</a></h3>
<p>On peut assembler les groupes de caractères les uns à la suite des
autres. Dans ce cas, il suffit de les juxtaposer comme pour trouver
les mots commençant par <code class="docutils literal notranslate"><span class="pre">s</span></code> : <code class="docutils literal notranslate"><span class="pre">s[a-z]*</span></code>. On peut aussi chercher
une chaîne ou une autre grâce au symbole <code class="docutils literal notranslate"><span class="pre">|</span></code>. Chercher dans un texte
l’expression <em>Xavier Dupont</em> ou <em>M. Dupont</em> s’écrira : <code class="docutils literal notranslate"><span class="pre">(Xavier)|(M[.])</span> <span class="pre">Dupont</span></code>.</p>
</section>
<section id="fonctions">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Fonctions</a><a class="headerlink" href="#fonctions" title="Lien permanent vers cette rubrique">#</a></h3>
<p>La fonction <a class="reference external" href="https://docs.python.org/3/library/re.html#re.compile" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.compile()</span></code></a>
du module <a class="reference external" href="https://docs.python.org/3/library/re.html#module-re" title="(disponible dans Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>
permet de construire un objet « expression régulière ». A partir de cet objet,
on peut vérifier la correspondance entre une expression régulière et une chaîne
de caractères (méthode <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.match()</span></code></a>).
On peut chercher une expression régulière (méthode <a class="reference external" href="https://docs.python.org/3/library/re.html#re.search" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.search()</span></code></a>).
On peut aussi remplacer une expression régulière par une chaîne de caractères
(méthode <a class="reference external" href="https://docs.python.org/3/library/re.html#re.sub" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.sub()</span></code></a>).</p>
<table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">match(s[,</span> <span class="pre">pos[,</span> <span class="pre">end]])</span></code></p></td>
<td><p>Vérifie la correspondance entre l’expression régulière et la chaîne
<code class="docutils literal notranslate"><span class="pre">s</span></code>. Il est possible de n’effectuer cette vérification qu’entre
les caractères dont les positions sont <code class="docutils literal notranslate"><span class="pre">pos</span></code> et <code class="docutils literal notranslate"><span class="pre">end</span></code>.
La fonction retourne <code class="docutils literal notranslate"><span class="pre">None</span></code> s’il n’y a pas de correspondance et
sinon un objet de type <code class="docutils literal notranslate"><span class="pre">Match</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">search(s[,</span> <span class="pre">pos[,</span> <span class="pre">end]])</span></code></p></td>
<td><p>Fonction semblable à <code class="docutils literal notranslate"><span class="pre">match</span></code>, au lieu de vérifier la correspondance entre
toute la chaîne et l’expression régulière, cherche la première chaîne
de caractères extraite correspondant à l’expression régulière.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">split(s,</span> <span class="pre">maxsplit</span> <span class="pre">=</span> <span class="pre">0])</span></code></p></td>
<td><p>Recherche toutes les chaînes de caractères extraites qui vérifient
l’expression régulière puis découpe cette chaîne en fonction des expressions
trouvées. La méthode <code class="docutils literal notranslate"><span class="pre">split</span></code> d’une chaîne de caractère permet de découper
selon un séparateur. La méthode <code class="docutils literal notranslate"><span class="pre">split</span></code> d’une expression régulière permet de
découper selon plusieurs séparateurs. C’est pratique pour découper une chaîne
de caractères en colonnes séparées par <code class="docutils literal notranslate"><span class="pre">;</span></code> ou une tabulation.
<code class="docutils literal notranslate"><span class="pre">re.compile(&quot;[\t;]&quot;).split(&quot;a;b\tc;g&quot;)</span></code> donne <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">&quot;g&quot;]</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">findall(</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">s[,</span> <span class="pre">pos[,</span> <span class="pre">end]])</span></code></p></td>
<td><p>Identique à <code class="docutils literal notranslate"><span class="pre">split</span></code> mais ne retourne pas les morceaux entre les chaînes
extraites qui vérifient l’expression régulière.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sub(repl,</span> <span class="pre">s,</span> <span class="pre">count</span> <span class="pre">=</span> <span class="pre">0])</span></code></p></td>
<td><p>Remplace dans la chaîne <code class="docutils literal notranslate"><span class="pre">repl</span></code> les éléments <code class="docutils literal notranslate"><span class="pre">\1</span></code>, <code class="docutils literal notranslate"><span class="pre">\2</span></code>, …
par les parties de <code class="docutils literal notranslate"><span class="pre">s</span></code> qui valident l’expression régulière.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">flags</span></code></p></td>
<td><p>Mémorise les options de construction de l’expression régulière. C’est un attribut.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pattern</span></code> &amp;</p></td>
<td><p>Chaîne de caractères associée à l’expression régulière. C’est un attribut.</p></td>
</tr>
</tbody>
</table>
<p>Ces méthodes et attributs qui s’appliquent à un objet de type « expression régulière »
retourné par la fonction <a class="reference external" href="https://docs.python.org/3/library/re.html#re.compile" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.compile()</span></code></a>. Les méthodes <a class="reference external" href="https://docs.python.org/3/library/re.html#re.search" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.search()</span></code></a>
et <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.match()</span></code></a> retournent toutes des objets <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.match()</span></code></a> :</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;date 0 : 14/9/2000</span>
<span class="s2">date 1 : 20/04/1971     date 2 : 14/09/1913     date 3 : 2/3/1978</span>
<span class="s2">date 4 : 1/7/1986     date 5 : 7/3/47     date 6 : 15/10/1914</span>
<span class="s2">date 7 : 08/03/1941     date 8 : 8/1/1980     date 9 : 30/6/1976&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;([0-3]?[0-9]/[0-1]?[0-9]/([0-2][0-9])?[0-9][0-9])[^\d]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># affiche (&#39;14/9/2000&#39;, &#39;20&#39;)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># affiche (9, 18)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># affiche 14/9/2000</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">(</span><span class="s1">&#39;14/9/2000&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">)</span>
    <span class="mi">14</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2000</span>
</pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">group([g1,</span> <span class="pre">...])</span></code></p></td>
<td><p>Retourne la chaîne de caractères validée par les groupes <code class="docutils literal notranslate"><span class="pre">g1</span></code>…</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">groups([default])</span></code></p></td>
<td><p>Retourne la liste des chaînes de caractères qui ont été validées par chacun des groupes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">span([gr])</span></code></p></td>
<td><p>Retourne les positions dans la chaîne originale des chaînes extraites validées le groupe <code class="docutils literal notranslate"><span class="pre">gr</span></code>.</p></td>
</tr>
</tbody>
</table>
<p>Ces méthodes qui s’appliquent à un objet de type <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.match()</span></code></a>
qui est le résultat des méthodes <a class="reference external" href="https://docs.python.org/3/library/re.html#re.search" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.search()</span></code></a> et <a class="reference external" href="https://docs.python.org/3/library/re.html#re.match" title="(disponible dans Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.match()</span></code></a>.
Les groupes sont des sous-parties de l’expression régulière, chacune d’entre elles incluses
entre parenthèses. Le énième correspond au groupe qui suit la énième parenthèse ouvrante.
Le premier groupe a pour indice 1.</p>
</section>
<section id="exemple-plus-complet">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Exemple plus complet</a><a class="headerlink" href="#exemple-plus-complet" title="Lien permanent vers cette rubrique">#</a></h3>
<p>L’exemple suivant présente trois cas d’utilisation des expressions régulières.
On s’intéresse aux titres de chansons
<a class="reference external" href="https://fr.wikipedia.org/wiki/MPEG-1/2_Audio_Layer_III">MP3</a>
stockées dans un répertoire.
Le module <a class="reference external" href="https://pypi.python.org/pypi/mutagen">mutagen</a>
permet de récupérer certaines informations concernant un fichier <em>MP3</em>
dont le titre, l’auteur et la durée.</p>
<p>Le premier problème consiste à retrouver les chansons sans titre ou dont
le titre contient seulement son numéro : <em>track03</em>, <em>track - 03</em>, <em>audiotrack 03</em>,
<em>track 03</em>, <em>piste 03</em>, <em>piste - 03</em>, <em>audiopiste 03</em>, …
Ce titre indésirable doit valider l’expression régulière suivante :
<code class="docutils literal notranslate"><span class="pre">^(((audio)?track(</span> <span class="pre">)?(</span> <span class="pre">-</span> <span class="pre">)?[0-9]{1,2})|(piste</span> <span class="pre">[0-9]{1,2}))$</span></code>.</p>
<p>Le second problème consiste à retrouver toutes les chansons dont le titre contient le
mot <em>heart</em> mais ni <em>heartland</em> ni <em>heartache</em>. Ce titre doit valider
l’expression régulière : <code class="docutils literal notranslate"><span class="pre">((heart)(?!((ache)|(land))))</span></code>.</p>
<p>Le troisième problème consiste à compter le nombre de mots d’un titre.
Les mots sont séparés par l’ensemble de caractères <code class="docutils literal notranslate"><span class="pre">[-</span> <span class="pre">,;!'.?&amp;:]</span></code>.
On utilise la méthode <code class="docutils literal notranslate"><span class="pre">split</span></code> pour découper en mots.
Le résultat est illustré par le programme suivant.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">mutagen.mp3</span>
<span class="kn">import</span> <span class="nn">mutagen.easyid3</span>


<span class="k">def</span> <span class="nf">infoMP3</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;retourne des informations sur un fichier MP3 sous forme de</span>
<span class="sd">    dictionnaire (durée, titre, artiste, ...)&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">mutagen</span><span class="o">.</span><span class="n">mp3</span><span class="o">.</span><span class="n">MP3</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">mutagen</span><span class="o">.</span><span class="n">easyid3</span><span class="o">.</span><span class="n">EasyID3</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unable to read file &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">e</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;minutes&quot;</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">all_files</span><span class="p">(</span><span class="n">repertoire</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;.mp3$&quot;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;retourne les informations pour chaque fichier d&#39;un répertoire&quot;&quot;&quot;</span>
    <span class="nb">all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">repertoire</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">infoMP3</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;unable to process </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">all</span>


<span class="k">def</span> <span class="nf">heart_notitle_mots</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="n">avoid</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">heart</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;retourne trois résultats</span>
<span class="sd">    - les chansons dont le titre valide l&#39;expression régulière heart</span>
<span class="sd">    - les chansons dont le titre valide l&#39;expression régulière avoid</span>
<span class="sd">    - le nombre moyen de mots dans le titre d&#39;une chanson&quot;&quot;&quot;</span>
    <span class="n">liheart</span><span class="p">,</span> <span class="n">notitle</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">nbmot</span><span class="p">,</span> <span class="n">nbsong</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">all</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">notitle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">ti</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">avoid</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">ti</span><span class="p">):</span>
            <span class="n">notitle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">heart</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">ti</span><span class="p">):</span>
            <span class="n">liheart</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">nbsong</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">nbmot</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">([</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sep</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">nbsong</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nbsong</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">liheart</span><span class="p">,</span> <span class="n">notitle</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">nbmot</span><span class="p">)</span> <span class="o">/</span> <span class="n">nbsong</span>


<span class="n">tags</span> <span class="o">=</span> <span class="s2">&quot;title album artist genre tracknumber&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="nb">all</span> <span class="o">=</span> <span class="n">all_files</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;D:\musique&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>

<span class="n">avoid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^(((audio)?track( )?( - )?[0-9]{1,2})|(piste [0-9]{1,2}))$&quot;</span><span class="p">)</span>
<span class="n">sep</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;[- ,;!&#39;.?&amp;:]&quot;</span><span class="p">)</span>
<span class="n">heart</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;((heart)(?!((ache)|(land))))&quot;</span><span class="p">)</span>
<span class="n">liheart</span><span class="p">,</span> <span class="n">notitle</span><span class="p">,</span> <span class="n">moymot</span> <span class="o">=</span> <span class="n">heart_notitle_mots</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="n">avoid</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">heart</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nombre de mots moyen par titre &quot;</span><span class="p">,</span> <span class="n">moymot</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;somme des durée contenant heart &quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;minutes&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">liheart</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;chanson sans titre &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">notitle</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;liste des titres &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">liheart</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">nombre</span> <span class="n">de</span> <span class="n">mots</span> <span class="n">moyen</span> <span class="n">par</span> <span class="n">titre</span>  <span class="mf">0.0</span>
    <span class="n">somme</span> <span class="n">des</span> <span class="n">durée</span> <span class="n">contenant</span> <span class="n">heart</span>  <span class="mi">0</span>
    <span class="n">chanson</span> <span class="n">sans</span> <span class="n">titre</span>  <span class="mi">0</span>
    <span class="n">liste</span> <span class="n">des</span> <span class="n">titres</span>
</pre></div>
</div>
</section>
<section id="groupes-nommes">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Groupes nommés</a><a class="headerlink" href="#groupes-nommes" title="Lien permanent vers cette rubrique">#</a></h3>
<p>Une expression régulière ne sert pas seulement de filtre,
elle permet également d’extraire le texte qui correspond à
chaque groupe, à chaque expression entre parenthèses. L’exemple
suivant montre comment récupérer le jour, le mois, l’année à l’intérieur d’une date.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;05/22/2010&quot;</span>
<span class="n">exp</span> <span class="o">=</span> <span class="s2">&quot;([0-9]{1,2})/([0-9]{1,2})/(((19)|(20))[0-9]</span><span class="si">{2}</span><span class="s2">)&quot;</span>
<span class="n">com</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span>  <span class="c1"># (&#39;05&#39;, &#39;22&#39;, &#39;2010&#39;, &#39;20&#39;, None, &#39;20&#39;)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">(</span><span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Il n’est pas toujours évident de connaître le numéro du groupe qui
contient l’information à extraire. C’est pourquoi il paraît plus
simple de les nommer afin de les récupérer sous la forme d’un
dictionnaire et non plus sous forme de tableau. La syntaxe
<code class="docutils literal notranslate"><span class="pre">(?P&lt;nom_du_groupe&gt;expression)</span></code> permet de nommer un groupe.
Elle est appliquée à l’exemple précédent.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;05/22/2010&quot;</span>
<span class="n">exp</span> <span class="o">=</span> <span class="s2">&quot;(?P&lt;jj&gt;[0-9]{1,2})/(?P&lt;mm&gt;[0-9]{1,2})/(?P&lt;aa&gt;((19)|(20))[0-9]</span><span class="si">{2}</span><span class="s2">)&quot;</span>
<span class="n">com</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">com</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">groupdict</span><span class="p">())</span>  <span class="c1"># {&#39;mm&#39;: &#39;22&#39;, &#39;aa&#39;: &#39;2010&#39;, &#39;jj&#39;: &#39;05&#39;}</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span><span class="s1">&#39;jj&#39;</span><span class="p">:</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;mm&#39;</span><span class="p">:</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">:</span> <span class="s1">&#39;2010&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Le programme suivant est un exemple d’utilisation des expressions régulières
dont l’objectif est de détecter les fonctions définies dans un programme
mais jamais utilisées. Les expressions servent à détecter les définitions
de fonctions (d’après le mot-clé <code class="docutils literal notranslate"><span class="pre">def</span></code>) puis à détecter les appels.
On recoupe ensuite les informations en cherchant les fonctions définies mais
jamais appelées.</p>
<p>Il n’est pas toujours évident de construire une expression régulière qui
correspondent précisément à tous les cas qu’on veut détecter. Une stratégie
possible est de construire une expression régulière plus permissive
puis d’éliminer les cas indésirables à l’aide d’une seconde expression
régulière, c’est le cas ici pour détecter les appels.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;ce programme détermine toutes les fonctions définies dans</span>
<span class="sd">un programme et jamais appelées&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>


<span class="k">def</span> <span class="nf">trouve_toute_fonction</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">gr</span><span class="p">,</span> <span class="n">expm</span><span class="o">=</span><span class="s2">&quot;^$&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;à partir d&#39;une chaîne de caractères correspondant</span>
<span class="sd">     à un programme Python, cette fonction retourne</span>
<span class="sd">     une liste de 3-uples, chacun contient :</span>

<span class="sd">     - le nom de la fonction</span>
<span class="sd">     - (debut,fin) de l&#39;expression dans la chaîne</span>
<span class="sd">     - la ligne où elle a été trouvée</span>

<span class="sd">     Paramètres:</span>

<span class="sd">    - *s*: chaîne de caractères</span>
<span class="sd">    - *exp*: chaîne de caractères correspond à l&#39;expression</span>
<span class="sd">    - *gr*: numéro de groupe correspondant au nom de la fonction</span>
<span class="sd">    - *expm*: expression négative</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>  <span class="c1"># première recherche</span>
    <span class="k">while</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="n">gr</span><span class="p">],</span> <span class="n">r</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">gr</span><span class="p">),</span> <span class="n">r</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">gr</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">expm</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="c1"># l&#39;expression négative n&#39;est pas trouvé, on peut ajouter ce résultat</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="n">gr</span><span class="p">))</span>  <span class="c1"># recherche suivante</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">get_function_list_definition</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;trouve toutes les définitions de fonctions&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">trouve_toute_fonction</span><span class="p">(</span>
        <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">def[ ]+([a-zA-Z_][a-zA-Z_0-9]*)[ ]*[(].*[)][ ]*[:]&quot;</span><span class="p">,</span> <span class="mi">0</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_function_list_call</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;trouve tous les appels de fonctions&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">trouve_toute_fonction</span><span class="p">(</span>
        <span class="n">s</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">.*[=(,[{ .]([a-zA-Z_][a-zA-Z_0-9]*)(?![ ]?:)[ ]*[(].*[)]?&quot;</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;^</span><span class="se">\\</span><span class="s2">n[ ]*(class|def)[ ]+function.*$&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">detection_fonction_pas_appelee</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;retourne les couples de fonctions jamais appelées suivies</span>
<span class="sd">    du numéro de la ligne où elles sont définies&quot;&quot;&quot;</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">li</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">sfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>

    <span class="n">funcdef</span> <span class="o">=</span> <span class="n">get_function_list_definition</span><span class="p">(</span><span class="n">sfile</span><span class="p">)</span>
    <span class="n">funccal</span> <span class="o">=</span> <span class="n">get_function_list_call</span><span class="p">(</span><span class="n">sfile</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">funccal</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcdef</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f2</span><span class="p">:</span>
            <span class="n">ligne</span> <span class="o">=</span> <span class="n">sfile</span><span class="p">[:</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ligne</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">fonction_inutile</span><span class="p">():</span>  <span class="c1"># ligne 63</span>
    <span class="k">pass</span>


<span class="n">file</span> <span class="o">=</span> <span class="vm">__file__</span>
<span class="nb">print</span><span class="p">(</span><span class="n">detection_fonction_pas_appelee</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    
    <span class="p">[</span><span class="n">runpythonerror</span><span class="p">]</span>
    <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
      <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">75</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">56</span><span class="p">,</span> <span class="ow">in</span> <span class="n">detection_fonction_pas_appelee</span>
    <span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;&lt;stdin&gt;&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">Expression régulières</p>
      </div>
    </a>
    <a class="right-next"
       href="../c_parallelisation/index.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Parallélisation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sur cette page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quoi-ca-sert">A quoi ça sert ?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#syntaxe">Syntaxe</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#les-ensembles-de-caracteres">Les ensembles de caractères</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#les-multiplicateurs">Les multiplicateurs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#groupes">Groupes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assembler-les-caracteres">Assembler les caractères</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fonctions">Fonctions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exemple-plus-complet">Exemple plus complet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#groupes-nommes">Groupes nommés</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/c_regex/regex.rst">
      <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2016-2023, Xavier Dupré.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Construit avec le <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">Thème PyData Sphinx</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>