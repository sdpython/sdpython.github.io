<!doctype html>
<html class="no-js" lang="fr" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Recherche" href="../search.html" /><link rel="next" title="Calcul matriciel avec numpy (version courte)" href="nb_numpy.html" /><link rel="prev" title="Calcul matriciel" href="matrices.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>Calcul Matriciel, Optimisation - Documentation teachpyx 0.3.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation teachpyx 0.3.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation teachpyx 0.3.2</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../py/index.html">Le langage Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Le langage Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_lang/index.html">Variables et fonctions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Variables et fonctions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/types.html">Types et variables du langage python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/syntaxe.html">Syntaxe du langage Python (boucles, tests, fonctions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/constructions.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/collections.html">Constructions classiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/dates.html">Dates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_lang/encoding.html">Encoding et jeux de caractères</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_classes/index.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_classes/classes.html">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_classes/questions.html">Questions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_exception/index.html">Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Exceptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/exception.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/exception_ext.html">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_exception/warning.html">Warning et logging</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_module/index.html">Entrées, Sorties, Modules</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Entrées, Sorties, Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_module/files.html">Fichiers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../py/c_module/serialization.html">Sérialisation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Sérialisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../auto_examples/plot_serialisation_examples.html">Sérialisation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../py/c_module/module.html">Module ou extension</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_regex/index.html">Expressions régulières</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Expressions régulières</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_regex/regex.html">Expressions régulières</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_parallelisation/index.html">Parallélisation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parallélisation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_parallelisation/thread.html">Threads</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../py/c_gui/index.html">Interfaces graphiques</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Interfaces graphiques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../py/c_gui/tkinter.html">tkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Matrices et DataFrames</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Matrices et DataFrames</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="matrices.html">Calcul matriciel</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Calcul matriciel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Calcul Matriciel, Optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="nb_numpy.html">Calcul matriciel avec numpy (version courte)</a></li>
<li class="toctree-l3"><a class="reference internal" href="numpy_broadcast.html">Numpy et tableau de contingence</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="dataframes.html">Dataframes</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Dataframes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="nb_dataframe.html">DataFrame et Graphes</a></li>
<li class="toctree-l3"><a class="reference internal" href="nb_pandas.html">Manipulation de données avec pandas (version courte)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_resume/index.html">Précis</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Précis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_resume/python_sheet.html">Cheat sheet: Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_resume/conseil_programmes.html">Quelques conseils pour écrire un programme</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_resume/cheat_sheet.html">Cheat Sheets</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Cheat Sheets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/git.html">Cheat Sheet on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/linux.html">Cheat Sheet on Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_resume/jenkins.html">Cheat Sheet on Jenkins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../articles/index.html">Collections d’articles périssables</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Collections d’articles périssables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023-11-31-route2023.html">2023-11-31 : rappel feuille de route 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023-09-06-ensae.html">2023-09-06 : ENSAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023-08-09-hermionne.html">2023-08-09 : l’énigme d’Hermionne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2023-08-03-code-jam.html">2023-08-03 : Code Jam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2022-11-31-route2022.html">2022-11-31 : rappel feuille de route 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../articles/2022-12-07-cartopy.html">2022-12-07 : Utilisation de cartopy sous Windows (sous WSL)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exercices</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_python.html">Exercices sur le langage python</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Exercices sur le langage python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/code_liste_tuple.html">Liste, tuple, ensemble, dictionnaire, liste chaînée, coût des opérations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/nbheap.html">Heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/structures_donnees_conversion.html">D’une structure de données à l’autre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/recherche_dichotomique.html">Recherche dichotomique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_hash.html">Répartition, table de hashage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classes_metro.html">Un bref aperçu des classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classes_2048.html">2048 et les classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_de.html">Jeu de dé, rotation sur un circuit (classes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_permutation.html">Classe Permutation et décomposition en transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_tree.html">Une classe pour représenter un arbre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_iterateur.html">Itérateur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/classe_user_p.html">Classe, Héritage, calcule d’une distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/pivot_gauss.html">Pivot de gauss avec numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/coloriage_carre.html">Jeux de coloriage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/code_multinomial.html">Simuler une loi multinomiale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tableau_contingence.html">Calculer un chi 2 sur un tableau de contingence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tri_nlnd.html">Tri plus rapide que prévu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/histogramme_rapide.html">Histogramme et dictionnaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_pi.html">Calculs de surface et autres calculs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/de_rotation.html">Jeu de dé, rotation sur un circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profiling_example.html">Exemple de profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profile_gini.html">Profiling la fonction Gini</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/profiling_conv.html">Profiling, application à la convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_regex.html">Expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_json_xml.html">JSON - XML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/exercice_serialisation_json.html">Sérialisation avec JSON, XML, pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/tests_unitaires.html">Tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/py-base/scrapping.html">Web-Scraping - pokemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/premiers_pas.html">Premiers pas en Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/variable_boucle_tests.html">Variables, boucles, tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/dictionnaire_vigenere.html">Dictionnaires, fonctions, code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/module_file_regex.html">Modules, fichiers, expressions régulières</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/integrale_rectangle.html">Intégrale et la méthode des rectangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/j2048.html">2048 - stratégie gagnante</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/texte_langue.html">Deviner la langue d’un texte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/pyramide_bigarree.html">Tracer une pyramide bigarrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_carre_magique.html">Classes, méthodes, attributs, opérateurs et carré magique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_heritage.html">Classes, héritage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/premiers_pas_correction.html">Premiers pas en Python (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/variable_boucle_tests_correction.html">Variables, boucles, tests (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/dictionnaire_vigenere_correction.html">Dictionnaires, fonctions, code de Vigenère (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/module_file_regex_correction.html">Modules, fichiers, expressions régulières (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/integrale_rectangle_correction.html">Intégrale et la méthode des rectangles - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/j2048_correction.html">2048 - stratégie gagnante - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/texte_langue_correction.html">Deviner la langue d’un texte (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/pyramide_bigarree_correction.html">Tracer une pyramide bigarrée - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_carre_magique_correction.html">Classes, méthodes, attributs, opérateurs et carré magique (correction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-base/classes_heritage_correction.html">Classes, héritage (correction)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_algo.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/matrix_dictionary.html">Produit matriciel avec une matrice creuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_echelle.html">Calculer le nombre de façons de monter une échelle.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_plus_grande_somme.html">La sous-séquence de plus grande somme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_xn.html">Calculer x**n le plus rapidement possible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_topk.html">Les k premiers éléments (top k)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_suffix.html">Jeux de dictionnaires, plus grand suffixe commun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/BJKST.html">Algorithmes de streaming, BJKST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_editdist.html">Distance entre deux mots de même longueur et tests unitaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_ordonnancement.html">Problème d’ordonnancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_tsp.html">TSP - Traveling Salesman Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/tsp_simplifie.html">Plus court chemin passant par tous les noeuds d’un graphe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/tsp_aparte.html">Aparté sur le voyageur de commerce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_compose_connexe.html">Graphe et Composantes connexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_random_graph.html">Graphes aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_simulation_covid_simple.html">Modèle épidémiologique (SIRD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-base/exercice_simulation_covid.html">Simulation COVID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/paris_parcours.html">Parcourir les rues de Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/vigenere.html">Casser le code de Vigenère</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/algo-compose/exercice_morse.html">Décoder du Morse sans espaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/gentry_integer_encryption.html">Cryptage homomorphic de Craig Gentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/knn_high_dimension.html">Plus proches voisins en grande dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_1.html">Puzzles algorithmiques (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_2.html">Puzzles algorithmiques (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/plus_court_chemin.html">Programmation dynamique et plus court chemin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/gentry_integer_encryption_correction.html">Cryptage homomorphic de Craig Gentry - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/knn_high_dimension_correction.html">2A.algo - Plus proches voisins en grande dimension - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_1_correction.html">Puzzles algorithmes (1) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/puzzle_algo_2_correction.html">Puzzles algorithmes (2) - correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practice/tds-algo/plus_court_chemin_correction.html">Programmation dynamique et plus court chemin (correction)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/index_exam.html">Séances minutées</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Séances minutées</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../practice/exams.html">Exercices minutés</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Exercices minutés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2013_coloriage_correction.html">1A.e - TD noté, 27 novembre 2012 (coloriage, correction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2013_bout_de_code_coloriage.html">1A.e - TD noté, 27 novembre 2012 (éléments de code pour le coloriage)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2015.html">1A.e - TD noté, 5 décembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2015_rattrapage_enonce.html">1A.e - TD noté 2015 rattrapage (énoncé, écrit et oral)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2016.html">1A.e - TD noté, 11 décembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2017.html">1A.e - TD noté, 16 décembre 2016</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2017_2.html">1A.e - TD noté, 21 février 2017</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2017_2.html#Exercice-1">Exercice 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2018_1.html">1A.e - Enoncé 12 décembre 2017 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2018_2.html">1A.e - Enoncé 12 décembre 2017 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2019_1.html">1A.e - Enoncé 23 octobre 2018 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2019_2.html">1A.e - Enoncé 23 octobre 2018 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2020_1.html">1A.e - Enoncé 22 octobre 2019 (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2020_2.html">1A.e - Enoncé 22 octobre 2019 (2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2021.html">1A - Enoncé 24 novembre 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022.html">1A - Enoncé 3 novembre 2021</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022_rattrapage.html">1A - Enoncé 15 novembre 2021 - rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2022_rattrapage2.html">1A - Enoncé 3 mars 2022- rattrapage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2023.html">1A - Enoncé 26 octobre 2022</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/td_note_2023-2024.html">1A - Enoncé 8 novembre 2023</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_10.html">1A.e - Correction de l’interrogation écrite du 10 octobre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_11.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2014_12.html">1A.e - Correction de l’interrogation écrite du 14 novembre 2014</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2015_09.html">1A.e - Correction de l’interrogation écrite du 26 septembre 2015</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/exams/interro_rapide_20_minutes_2015_11.html">1A.e - Correction de l’interrogation écrite du 6 novembre 2015</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compléments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../practice/years/index.html">Notebooks écrits durant les séances</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Notebooks écrits durant les séances</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../practice/years/2023/index.html">2023</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/editdist.html">Distance d’édition (4 octobre)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/pivot_gauss.html">Pivot de Gauss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../practice/years/2023/prefix_search.html">Recherche de préfixes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm_culture.html">Survol algorithmique</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_expose/index.html">Exposés</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Exposés</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/finance/finance_autostrat.html">Stratégie automatique de trading en finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/tsp/tsp_kohonen.html">Circuit hamiltonien et Kohonen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_expose/tsp/tsp_kruskal.html">Circuit hamiltonien et Kruskal</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../i_index.html">En diagonal</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of En diagonal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebook_gallery.html">Tous les notebooks</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/index.html">Gallerie d’exemples</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Gallerie d’exemples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_pandas_groupby.html">Pandas et groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_numpy_tricks.html">Points d’implémentation avec numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_lambda_function.html">Astuces avec les lambda functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_gil_example.html">Le GIL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_matador.html">Mathador, énigme à 4 opérations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_serialisation_protobuf.html">Sérialisation avec protobuf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_float_and_double_rouding.html">Float Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_partie_dame.html">Parties de dames</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_hypercube.html">Hypercube et autres exercices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_serialisation_examples.html">Sérialisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_tarabiscote.html">Exercices expliqués de programmation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_tsp.html">Réflexions autour du voyage de commerce (TSP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/plot_einstein_riddle.html">L’énigme d’Einstein et sa résolution</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index.html">Code inclus dans cette librairie</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Code inclus dans cette librairie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/classique.html">examples.construction_classique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/tools.html">tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/rues_paris.html">teachpyx.practice.rues_paris</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_bresenham.html">teachpyx.practice.tsp_bresenham</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_kohonen.html">teachpyx.practice.tsp_kohonen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/practice/tsp_kruskal.html">teachpyx.practice.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/video/tsp_kohonen.html">teachpyx.video.tsp_kohonen_pygame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/video/tsp_kruskal.html">teachpyx.video.tsp_kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/numpysex.html">examples.numpysex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/faqs.html">faq</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../i_ex.html">Syntaxes et définitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i_faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Calcul-Matriciel,-Optimisation">
<h1>Calcul Matriciel, Optimisation<a class="headerlink" href="#Calcul-Matriciel,-Optimisation" title="Lien permanent vers cette rubrique">#</a></h1>
<p>Tous les programmes python faisant des calculs utilisent une librairie dédiée car python est trop lent. La plus simple des options est <a class="reference external" href="https://numpy.org/">numpy</a>. Avec l’avènement du deep learning, d’autres ont émergé offrant de faire des calculs dans des environnements plus variés (<a class="reference external" href="https://en.wikipedia.org/wiki/Central_processing_unit">CPU</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Graphics_processing_unit">GPU</a>, …). <a class="reference external" href="https://pytorch.org/">pytorch</a> est une des plus connues.</p>
<p>Avec l’émergence du deep learning en open source, l’usage de ces librairies s’est standardisé. Ce qui est vrai pour numpy l’est aussi pour pytorch. Les opérations ont le même sens, les fonctions ont presque toujours les mêmes noms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<section id="Numpy-arrays">
<h2>Numpy arrays<a class="headerlink" href="#Numpy-arrays" title="Lien permanent vers cette rubrique">#</a></h2>
<p>La convention d’import classique de numpy est la suivante:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Creation-d'un-array:-notion-de-datatype,-et-dimensions">
<h3>Creation d’un array: notion de datatype, et dimensions<a class="headerlink" href="#Creation-d'un-array:-notion-de-datatype,-et-dimensions" title="Lien permanent vers cette rubrique">#</a></h3>
<p>On part d’une liste python contenant des entiers. On peut créer un <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html">array</a> numpy à partir de cette liste. Cet array possède des attributs indiquant le data type, le nombre de dimensions de l’array, etc…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">18</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1 42 18]
int64
1
(3,)
3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 1, 42, 18])
</pre></div></div>
</div>
<p>On peut indiquer explicitement le <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.html">dtype</a> lors de la création de l’array. Sinon, Numpy sélectionne automatiquement le <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.html">dtype</a>. Numpy ajoute un grand nombre de <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.html">dtype</a> à ceux de Python. Allez jeter un oeil à la <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">liste</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1. 42. 18.]
float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bb</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 1. 42. 18.]
float64
</pre></div></div>
</div>
<p>Assigner un float dans un array de type int va caster le float en int, et ne modifie pas le <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.html">dtype</a> de l’array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 2, 42, 18])
</pre></div></div>
</div>
<p>On peut forcer le casting dans un autre type avec <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.astype.html">astype</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">aa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">aa</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 2.5, 42. , 18. ])
</pre></div></div>
</div>
<p>A partir d’une liste de listes, on obtient un array bi-dimmensionnel.</p>
<p>On peut le transposer ou encore l’aplatir en un array 1d</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ndim:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>  <span class="c1"># same as c.T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape transposed:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ndim flattened:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0 1 2 3 4]
 [5 6 7 8 9]
 [0 1 2 3 4]]
ndim:2
shape:(3, 5)
[[0 5 0]
 [1 6 1]
 [2 7 2]
 [3 8 3]
 [4 9 4]]
shape transposed:(5, 3)
[0 1 2 3 4 5 6 7 8 9 0 1 2 3 4]
ndim flattened:1
</pre></div></div>
</div>
<section id="Indexation,-Slicing,-Fancy-indexing">
<h4>Indexation, Slicing, Fancy indexing<a class="headerlink" href="#Indexation,-Slicing,-Fancy-indexing" title="Lien permanent vers cette rubrique">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0 1 2 3 4]
 [5 6 7 8 9]
 [0 1 2 3 4]]
</pre></div></div>
</div>
<p>L’indexation des array multidimensionnels fonctionne avec des tuples.</p>
<p>La syntaxe <code class="docutils literal notranslate"><span class="pre">':'</span></code> permet d’obtenir tous les éléments de la dimension.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8
[5 6 7]
[4 9 4]
</pre></div></div>
</div>
<p>Si on utilise pas un couple sur un array 2d on récupère un array 1d</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[5 6 7 8 9] (5,)
[5 6 7]
</pre></div></div>
</div>
<p>On peut aussi utiliser l’indexation par un array (ou une liste python) de booléens ou d’entiers (un mask). Cela s’appelle le fancy indexing. Un mask d’entiers permet de désigner les éléments que l’on souhaite extraire via la liste de leurs indices, on peut aussi répéter l’indice d’un élément pour répéter l’élement dans l’array que l’on extrait.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># arange est l&#39;equivalent de range mais retourne un numpy array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ar = &quot;</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;idx = &quot;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ar[idx] =&quot;</span><span class="p">,</span> <span class="n">ar</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;######&quot;</span><span class="p">)</span>
<span class="n">idx_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">idx_bool</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;idx_bool = &quot;</span><span class="p">,</span> <span class="n">idx_bool</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ar[idx_bool] = &quot;</span><span class="p">,</span> <span class="n">ar</span><span class="p">[</span><span class="n">idx_bool</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;######&quot;</span><span class="p">,</span> <span class="s2">&quot;Que se passe-t-il dans chacun des cas suivants?&quot;</span><span class="p">,</span> <span class="s2">&quot;######&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;ar[np.array([True, True, False, True])] = &quot;</span><span class="p">,</span>
        <span class="n">ar</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])],</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c1"># l&#39;expression ar[[True, True, False, True]] déclenche une erreur depuis numpy 1.13</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ar =  [1 2 3 4 5 6 7 8 9]
idx =  [1 4 3 2 1 7 3]
ar[idx] = [2 5 4 3 2 8 4]
######
idx_bool =  [ True False False False False  True  True False  True]
ar[idx_bool] =  [1 6 7 9]
###### Que se passe-t-il dans chacun des cas suivants? ######
Erreur boolean index did not match indexed array along dimension 0; dimension is 9 but corresponding boolean dimension is 4
</pre></div></div>
</div>
<p>Pourquoi parle-t-on de fancy indexing? Essayez d’indexer des listes python de la même manière…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_python</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">list_python</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>  <span class="c1"># déclenche une exception</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
range indices must be integers or slices, not list
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">list_python</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>  <span class="c1"># déclenche une exception</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
range indices must be integers or slices, not list
</pre></div></div>
</div>
</section>
<section id="View-contre-Copy">
<h4>View contre Copy<a class="headerlink" href="#View-contre-Copy" title="Lien permanent vers cette rubrique">#</a></h4>
<p>Créons un array <img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/>. En plus de renvoyer directement un array, la fonction <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html">arange</a> permet aussi d’utiliser un step flottant. (Essayer avec le range de python pour voir)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5, 5. , 5.5])
</pre></div></div>
</div>
<p>Un point important est que l’on ne recopie pas un array lorsqu’on effectue une assignation ou un slicing d’un array. On travaille dans ce cas avec une View sur l’array d’origine (shallow copy). Toute modification sur la View affecte l’array d’origine.</p>
<p>Dans l’exemple qui suit, <img class="math" src="../_images/math/a52a5cbf4e378c1f5b4401b55b3ed7cd1a281e1d.svg" alt="e"/> est une view sur <img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/>. Lorsqu’on modifie <img class="math" src="../_images/math/a52a5cbf4e378c1f5b4401b55b3ed7cd1a281e1d.svg" alt="e"/>, <img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/> aussi est modifié. (Remarquez au passage que numpy fournit quelques constantes bien pratiques….)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">d</span>
<span class="n">e</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">e</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-3.14159265,  1.5       , -3.14159265,  2.5       , -3.14159265,
        3.5       ,  4.        ,  4.5       ,  5.        ,  5.5       ])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-3.14159265,  1.5       , -3.14159265,  2.5       , -3.14159265,
        3.5       ,  4.        ,  4.5       ,  5.        ,  5.5       ])
</pre></div></div>
</div>
<p>Si on ne veut pas modifier <img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/> indirectement, il faut travailler sur une copie de <img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/> (<a class="reference external" href="https://docs.python.org/3.4/library/copy.html#copy.deepcopy">deep copy</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mi">10</span>
<span class="p">)</span>  <span class="c1"># Question subsidiaire: en quoi est-ce différent de np.arange avec un step float?</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">f</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">e</span>  <span class="c1"># il s&#39;agit du nombre d&#39;euler, pas de l&#39;array e ;)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-2.71828183 -2.71828183 -2.71828183 -2.71828183  3.          3.5
  4.          4.5         5.          5.5       ]
[1.  1.5 2.  2.5 3.  3.5 4.  4.5 5.  5.5]
</pre></div></div>
</div>
<p>Ce point est important car source classique d’erreurs silencieuses: les erreurs les plus vicieuses car l’output sera faux mais python ne râlera pas…</p>
<p>Il faut un peu de temps pour s’habituer mais on finit par savoir de manière naturelle quand on travaille sur une view, quand on a besoin de faire une copie explicitement, etc… En tout cas, vérifiez vos sorties, faites des tests de cohérence, cela ne nuit jamais.</p>
<p>Retenez par exemple que le <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing-and-indexing">slicing</a> vous renvoie une view sur l’array, alors que le <a class="reference external" href="https://scipy-lectures.github.io/intro/numpy/array_object.html#fancy-indexing">fancy indexing</a> effectue une copie.</p>
<p>(Au passage, remarquez le <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html">NaN</a> (=NotaNumber) déjà introduit lors de la séance 1 sur pandas qui est un module basé sur numpy)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;d = &quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="n">slice_of_d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">slice_of_d = &quot;</span><span class="p">,</span> <span class="n">slice_of_d</span><span class="p">)</span>
<span class="n">slice_of_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">d = &quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">fancy_indexed_subarray</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">fancy_indexed_subarray = &quot;</span><span class="p">,</span> <span class="n">fancy_indexed_subarray</span><span class="p">)</span>
<span class="n">fancy_indexed_subarray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">d = &quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
d =  [1.  1.5 2.  2.5 3.  3.5 4.  4.5 5.  5.5]

slice_of_d =  [2.  2.5 3. ]

d =  [1.  1.5 nan 2.5 3.  3.5 4.  4.5 5.  5.5]

fancy_indexed_subarray =  [nan 2.5 3. ]

d =  [1.  1.5 nan 2.5 3.  3.5 4.  4.5 5.  5.5]
</pre></div></div>
</div>
</section>
<section id="Manipulation-de-shape">
<h4>Manipulation de shape<a class="headerlink" href="#Manipulation-de-shape" title="Lien permanent vers cette rubrique">#</a></h4>
<p>La méthode reshape permet de changer la forme de l’array. Il existe de nombreuses <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html">manipulations possibles</a>.</p>
<p>On précise à <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html">reshape</a> la forme souhaitée: par un entier si on veut un array 1d de cette longueur, ou un couple pour un array 2d de cette forme.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 0  1  2  3  4  5  6  7  8  9 10 11]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0,  1,  2],
       [ 3,  4,  5],
       [ 6,  7,  8],
       [ 9, 10, 11]])
</pre></div></div>
</div>
<p>Par défaut, <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html">reshape</a> utilise l’énumération dans l’ordre du langage C (aussi appelé « row first » ), on peut préciser que l’on souhaite utiliser l’ordre de <a class="reference external" href="https://fr.wikipedia.org/wiki/Fortran">Fortran</a> (« column first »). Ceux qui connaissent Matlab et R sont habitués à l’ordre « column-first ». <a class="reference external" href="http://en.wikipedia.org/wiki/Row-major_order">Voir l’article wikipedia</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0,  4,  8],
       [ 1,  5,  9],
       [ 2,  6, 10],
       [ 3,  7, 11]])
</pre></div></div>
</div>
<p>On peut utiliser -1 sur une dimension, cela sert de joker: numpy infère la dimension nécessaire ! On peut créer directement des matrices de 0 et de 1 à la dimension d’un autre array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
</pre></div></div>
</div>
<p>On peut aussi concatener ou stacker <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.hstack.html">horizontalement</a>/<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.vstack.html">verticalement</a> différents arrays.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="p">)</span>  <span class="c1"># Attention à la syntaxe: le type d&#39;entrée est un tuple!</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmat</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">gmat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">gmat</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11],
       [ 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">gmat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">gmat</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,  1,  1,  1,  1,
         1,  1,  1,  1,  1,  1,  1,  1]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,  0,  1,  2,  3,  4,
        5,  6,  7,  8,  9, 10, 11])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11],
       [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11]])
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Exercice-1-:-Echiquier-et-Crible-d'Erathosthène">
<h2>Exercice 1 : Echiquier et Crible d’Erathosthène<a class="headerlink" href="#Exercice-1-:-Echiquier-et-Crible-d'Erathosthène" title="Lien permanent vers cette rubrique">#</a></h2>
<ul class="simple">
<li><p>Exercice 1-A Echiquier: Créer une matrice échiquier (des 1 et des 0 alternés) de taille 8x8, de deux façons différentes</p>
<ul>
<li><p>en vous servant de slices</p></li>
<li><p>en vous servant de la fonction <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.tile.html#numpy.tile">tile</a></p></li>
</ul>
</li>
<li><p>Exercice 1-B Piège lors d’une extraction 2d:</p>
<ul>
<li><p>Définir la matrice <img class="math" src="../_images/math/325859de3f420570f7dd8274c1850b1be67662e8.svg" alt="M = \left(\begin{array}{ccccc} 1 &amp; 5 &amp; 9 &amp; 13 &amp; 17 \\ 2 &amp; 6 &amp; 10 &amp; 14 &amp; 18 \\ 3 &amp; 7 &amp; 11 &amp; 15 &amp; 19 \\ 4 &amp; 8 &amp; 12 &amp; 16 &amp; 20 \\ \end{array}\right)"/></p></li>
<li><p>En <strong>extraire</strong> la matrice <img class="math" src="../_images/math/80578318d4c98528250cc211c10874d78fc3c09e.svg" alt="\left(\begin{array}{ccc} 6 &amp; 18 &amp; 10 \\ 7 &amp; 19 &amp; 11 \\ 5 &amp; 17 &amp; 9 \\ \end{array}\right)"/></p></li>
</ul>
</li>
<li><p>Exercice 1-C Crible d’Erathosthène: On souhaite implémenter un <a class="reference external" href="http://fr.wikipedia.org/wiki/Crible_d'%C3%89ratosth%C3%A8ne">crible d’Erathosthène</a> pour trouver les nombres premiers inférieurs à <img class="math" src="../_images/math/4ba6a210e4caef4658545e1b17ea0bad7da420a1.svg" alt="N=1000"/>.</p>
<ul>
<li><p>partir d’un array de booléens de taille N+1, tous égaux à True.</p></li>
<li><p>Mettre 0 et 1 à False car ils ne sont pas premiers</p></li>
<li><p>pour chaque entier <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> entre 2 et <img class="math" src="../_images/math/d946d5f0e84f3b2fea989764b1696e301d5af8d7.svg" alt="\sqrt{N}"/>:</p>
<ul>
<li><p>si <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> est premier: on passe ses multiples (entre <img class="math" src="../_images/math/86c742502944f9453297da2b6eccaf108a1f7a46.svg" alt="k^2"/> et <img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/>) à False</p></li>
</ul>
</li>
<li><p>on print la liste des entiers premiers</p></li>
</ul>
</li>
</ul>
</section>
<section id="Manipulation-et-Opérations-sur-les-arrays">
<h2>Manipulation et Opérations sur les arrays<a class="headerlink" href="#Manipulation-et-Opérations-sur-les-arrays" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Il existe un très grand nombre de <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.html">routines pour manipuler les arrays numpy</a>: Vous trouverez sans doute utiles les pages spécifiques aux routines de <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.statistics.html">stats</a> ou de <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.math.html">maths</a></p>
<section id="Opérations-élément-par-élément">
<h3>Opérations élément par élément<a class="headerlink" href="#Opérations-élément-par-élément" title="Lien permanent vers cette rubrique">#</a></h3>
<p>On déclare <img class="math" src="../_images/math/572741bd96a77a5e9be88fac9e2112044b64fc44.svg" alt="a"/> et <img class="math" src="../_images/math/85bff0a8f3a3d84c7bd09f610de6f10098f186d8.svg" alt="b"/> sur lesquelles nous allons illustrer quelques opérations</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 1.]
 [1. 1.]
 [1. 1.]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 1],
       [2, 3],
       [4, 5]])
</pre></div></div>
</div>
<p>Les opérations arithmétiques avec les scalaires, ou entre arrays s’effectuent élément par élément. Lorsque le dtype n’est pas le même (<img class="math" src="../_images/math/572741bd96a77a5e9be88fac9e2112044b64fc44.svg" alt="a"/> contient des float, <img class="math" src="../_images/math/85bff0a8f3a3d84c7bd09f610de6f10098f186d8.svg" alt="b"/> contient des int), numpy adopte le type le plus « grand » (au sens de l’inclusion).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1.  4.]
 [ 9. 16.]
 [25. 36.]]
[[3. 2.]
 [1. 0.]
 [1. 2.]]
[[ 0.36787944  1.        ]
 [ 2.71828183  7.3890561 ]
 [20.08553692 54.59815003]]
</pre></div></div>
</div>
<p>Remarquez que la division par zéro ne provoque pas d’erreur mais introduit la valeur <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.isinf.html">inf</a> :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 1],
       [2, 3],
       [4, 5]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">/</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_32095/2601360242.py:1: RuntimeWarning: divide by zero encountered in divide
  1 / b
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[       inf, 1.        ],
       [0.5       , 0.33333333],
       [0.25      , 0.2       ]])
</pre></div></div>
</div>
<section id="Broadcasting">
<h4>Broadcasting<a class="headerlink" href="#Broadcasting" title="Lien permanent vers cette rubrique">#</a></h4>
<p>Que se passe-t-il si les dimensions sont différentes?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1., 1., 1., 1., 1., 1.])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>  <span class="c1"># déclenche une exception</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
operands could not be broadcast together with shapes (3,2) (6,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0 1]
 [2 3]
 [4 5]]
[[0]
 [1]
 [2]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 1],
       [3, 4],
       [6, 7]])
</pre></div></div>
</div>
<p>L’opération précédente fonctionne car numpy effectue ce qu’on appelle un <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">broadcasting</a> de <code class="docutils literal notranslate"><span class="pre">c</span></code> : une dimension étant commune, tout se passe comme si on dupliquait c sur la dimension non-partagée avec b. (voir aussi <a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">Broadcasting</a>) :</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">a</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-1.  1.  2.]
 [-1.  1.  2.]
 [-1.  1.  2.]]
</pre></div></div>
</div>
<p>Par contre, il peut parfois être utile de préciser la dimension sur laquelle on souhaite broadcaster, on ajoute alors explicitement une dimension :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3,)
(3, 1)
(1, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-1.  1.  2.]
 [-1.  1.  2.]
 [-1.  1.  2.]]
[[-1.  0.  0.]
 [ 0.  1.  1.]
 [ 1.  2.  2.]]
[[0 1 2]
 [1 2 3]
 [2 3 4]]
[0 2 4]
</pre></div></div>
</div>
</section>
<section id="Réductions">
<h4>Réductions<a class="headerlink" href="#Réductions" title="Lien permanent vers cette rubrique">#</a></h4>
<p>On parle de réductions lorsque l’opération réduit la dimension de l’array. Il en existe un grand nombre. Elles existent souvent sous forme de fonction de numpy ou de méthodes d’un array numpy. On n’en présente que quelques unes, mais le principe est le même : par défaut elles opèrent sur toutes les dimensions, mais on peut via l’argument <em>axis</em> préciser la dimension selon laquelle on souhaite effectuer la réduction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Note: -1 is a joker!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0 1 2 3 4]
 [5 6 7 8 9]]
45
[ 5  7  9 11 13]
[10 35]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
0 9
[0 5]
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Algèbre-linéaire">
<h2>Algèbre linéaire<a class="headerlink" href="#Algèbre-linéaire" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Vous avez un éventail de fonctions pour faire de l’algèbre linéaire dans <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.linalg.html">numpy</a> ou dans <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html">scipy</a>. Cela peut vous servir si vous cherchez à faire une décomposition matricielle particulière (<a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.linalg.lu.html">LU</a>, <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.qr.html">QR</a>,
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.svd.html">SVD</a>,…), si vous vous intéressez aux valeurs propres d’une matrice, etc…</p>
<p>Commençons par construire deux arrays 2d correspondant à une matrice triangulaire inférieure et une matrice diagonale :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1., 0., 0.],
       [1., 1., 0.],
       [1., 1., 1.]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1, 0, 0],
       [0, 2, 0],
       [0, 0, 3]])
</pre></div></div>
</div>
<p>On a vu que les multiplications entre array s’effectuaient élément par élement. Si l’on souhaite faire des multiplications matricielles, il faut utiliser la fonction <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html">dot</a>. La version 3.5 introduit un nouvel opérateur [&#64;](<a class="reference external" href="https://docs.python.org/3.6/whatsnew/3.5.html#pep-465-a-dedicated-infix-operator-for-matrix-multiplication">https://docs.python.org/3.6/whatsnew/3.5.html#pep-465-a-dedicated-infix-operator-for-matrix-multiplication</a>) qui désigne explicitement la multiplication matricielle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0.]
 [1. 2. 0.]
 [1. 2. 3.]]
[[1. 0. 0.]
 [0. 2. 0.]
 [0. 0. 3.]]
[[1. 0. 0.]
 [2. 1. 0.]
 [3. 2. 1.]]
</pre></div></div>
</div>
<p>On peut calculer l’inverse ou le déterminant de <img class="math" src="../_images/math/5fdb7ef407cf673109e4443028c7e8898ee8c89e.svg" alt="A"/></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">inv_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inv_A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inv_A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
[[ 1.  0.  0.]
 [-1.  1.  0.]
 [ 0. -1.  1.]]
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
</pre></div></div>
</div>
<p>… résoudre des systèmes d’equations linéaires du type <img class="math" src="../_images/math/062cd03ece5d9309b2058ca7a300f889be179daf.svg" alt="Ax = b"/>…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1 2 3]
[1. 1. 1.]
[1. 2. 3.]
</pre></div></div>
</div>
<p>… ou encore obtenir les valeurs propres de <img class="math" src="../_images/math/5fdb7ef407cf673109e4443028c7e8898ee8c89e.svg" alt="A"/>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EigResult(eigenvalues=array([1., 1., 1.]), eigenvectors=array([[ 0.00000000e+00,  0.00000000e+00,  4.93038066e-32],
       [ 0.00000000e+00,  2.22044605e-16, -2.22044605e-16],
       [ 1.00000000e+00, -1.00000000e+00,  1.00000000e+00]]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1., 1., 1.])
</pre></div></div>
</div>
<p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.matrix.html">Matrix</a> est une sous classe spécialisée pour le calcul matriciel. Il s’agit d’un array numpy 2d qui conserve sa dimension 2d à travers les opérations. Pensez aux différences que cela implique… On peut les construire classiquement depuis les array ou les objets pythons, ou via une string à la Matlab ( où les points virgules indiquent les lignes).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s2">&quot; 1 2 3; 4 5 6; 7 8 9&quot;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1 2 3]
 [4 5 6]
 [7 8 9]]
[[1 2 3]
 [4 5 6]
 [7 8 9]]
[[1 2 3]] [1 2 3]
(1, 3) (3,)
</pre></div></div>
</div>
<p>Matrix surcharge par ailleurs les opérateurs * et ** pour remplacer les opérations élément par élément par les opérations matricielles. Enfin, une Matrix possède des attributs supplémentaires. Notamment, Matrix.I qui désigne l’inverse, Matrix.A l’array de base.</p>
<p><em>Il est probable que cela évolue puisque Python 3.5 a introduit le symbol ``&#64;`` pour la multiplication matricielle.</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">*</span> <span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
matrix([[ 30,  36,  42],
        [ 66,  81,  96],
        [102, 126, 150]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1,  4,  9],
       [16, 25, 36],
       [49, 64, 81]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">*</span> <span class="n">a</span>  <span class="c1"># La priorité des matrix est plus importantes que celles des arrays</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
matrix([[ 30,  36,  42],
        [ 66,  81,  96],
        [102, 126, 150]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 30  36  42]
 [ 66  81  96]
 [102 126 150]]
[[ 1  4  9]
 [16 25 36]
 [49 64 81]]
</pre></div></div>
</div>
<p>La syntaxe est plus légère pour effectuer du calcul matriciel</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;det&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;det&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
det 6.000000000000016 rank 3
[[ 1.00000000e+00 -2.22044605e-15 -3.77475828e-15]
 [ 0.00000000e+00  1.00000000e+00  7.10542736e-15]
 [ 8.88178420e-16  0.00000000e+00  1.00000000e+00]]
det 6.000000000000016 rank 3
[[ 1.00000000e+00  2.66453526e-15 -8.88178420e-16]
 [ 0.00000000e+00  1.00000000e+00  1.77635684e-15]
 [ 0.00000000e+00  8.88178420e-16  1.00000000e+00]]
</pre></div></div>
</div>
</section>
<section id="Génération-de-nombres-aléatoires-et-statistiques">
<h2>Génération de nombres aléatoires et statistiques<a class="headerlink" href="#Génération-de-nombres-aléatoires-et-statistiques" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Le module <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html">numpy.random</a> apporte à python la possibilité de générer un échantillon de taille <img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> directement, alors que le module natif de python ne produit des tirages que un par un. Le module <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html">https://numpy.org/doc/stable/reference/random/index.html#module-numpy.randomnumpy.random</a> est donc bien plus efficace si on veut tirer des échantillon conséquents. Par ailleurs,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html">scipy.stats</a> fournit des méthodes pour un très grand nombre de distributions et quelques fonctions classiques de statistiques.</p>
<p>Par exemple, on peut obtenir un array 4x3 de tirages gaussiens standard (soit en utilisant <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html">randn</a> ou <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal">normal</a>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1.64384465, -0.53378538,  0.814275  ],
       [ 0.07141651, -0.41805379,  0.68017065],
       [ 0.28194277,  1.09701434,  0.79203057],
       [ 1.04200712, -0.85210112,  0.179312  ]])
</pre></div></div>
</div>
<p>Pour se convaincre que <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> est plus efficace que le module <code class="docutils literal notranslate"><span class="pre">random</span></code> de base de python. On effectue un grand nombre de tirages gaussiens standard, en python pur et via numpy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">normalvariate</span>

<span class="o">%</span><span class="k">timeit</span> [normalvariate(0,1) for _ in range(N)]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
708 ms ± 20.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> np.random.randn(N)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
25 ms ± 1.46 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div></div>
</div>
</section>
<section id="Exercice-2-:-marches-aléatoires">
<h2>Exercice 2 : marches aléatoires<a class="headerlink" href="#Exercice-2-:-marches-aléatoires" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Simulez (<strong>en une seule fois!</strong>) 10000 marches aléatoires de taille 1000, partant de 0 et de pas +1 ou -1 équiprobables</p>
<ul class="simple">
<li><p>Faites un graphe représentant la racine de la moyenne des carrés des positions (=cumul des pas à un instant donné) en fonction du temps</p></li>
<li><p>Quels sont les amplitudes maximales et minimales atteintes parmi l’ensemble des marches aléatoires?</p></li>
<li><p>Combien de marches s’éloigne de plus de 50 de l’origine?</p></li>
<li><p>Parmi celles qui le font, quelle est la moyenne des temps de passage (i.e. le premier moment où ces marches dépassent +/-50)?</p></li>
</ul>
<p>Vous aurez peut-être besoin des fonctions suivantes: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.absolute.html">np.abs</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html">np.mean</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.max.html">np.max</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.where.html">np.where</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.argmax.html">np.argmax</a>,
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.any.html">np.any</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.cumsum.html">np.cumsum</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randint.html">np.random.randint</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Exercice-3-:-retrouver-la-série-aléatoire-à-partir-des-marches-aléatoires">
<h2>Exercice 3 : retrouver la série aléatoire à partir des marches aléatoires<a class="headerlink" href="#Exercice-3-:-retrouver-la-série-aléatoire-à-partir-des-marches-aléatoires" title="Lien permanent vers cette rubrique">#</a></h2>
<p>L’exercice précédent montre comment générer une marche aléatoire à partir d’une série temporelle aléatoire. Comment retrouver la série initiale à partir de la marche aléatoire ?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Optimisation-avec-scipy">
<h2>Optimisation avec scipy<a class="headerlink" href="#Optimisation-avec-scipy" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Le module <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/optimize.html">scipy.optimize</a> fournit un panel de méthodes d’optimisation. En fonction du problème que vous souhaitez résoudre, il vous faut choisir la méthode adéquate. Je vous conseille vivement la lecture de ce <a class="reference external" href="http://scipy-lectures.github.io/advanced/mathematical_optimization/index.html">tutoriel</a> sur l’optimisation numérique, écrit par Gaël Varoquaux.</p>
<p>Récemment, l’ensemble des solvers ont été regroupés sous deux interfaces, même si on peut toujours faire appel à chaque solver directement, ce qui n’est pas conseillé car les entrées sorties ne sont pas normalisées (par contre vous devrez sans doute aller voir l’aide de chaque méthode pour vous en servir):</p>
<ul class="simple">
<li><p>Pour minimiser une fonction scalaire d’une ou plusieurs variables:<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize">scipy.optimize.minimize</a></p></li>
<li><p>Pour minimiser une fonction scalaire d’une variable uniquement:<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar">scipy.optimize.minimize_scalar</a></p></li>
</ul>
<p>Vous obtiendrez en sortie un objet de type <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult">scipy.optimize.OptimizeResult</a>.</p>
<p>Dans la suite, je développe un petit exemple inspiré du <a class="reference external" href="https://fr.mathworks.com/help/optim/ug/unconstrained-nonlinear-optimization-algorithms.html">tutoriel</a> de la toolbox d’optimisation de Matlab. Par ailleurs, la documentation de cette toolbox est plutôt claire et peut toujours vous servir lorsque que vous avez besoin de vous rafraichir la mémoire sur l’optimisation numérique.</p>
<p>On commence par définir la fonction <em>bowl_peak</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bowl_peak</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
<p>On va ensuite chercher un exemple dans la gallerie matplotlib pour la représenter: <a class="reference external" href="http://matplotlib.org/examples/mplot3d/contour3d_demo3.html">contour3d_demo3</a>. On modifie légèrement le code pour l’utiliser avec <em>bowl_peak</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">axes3d</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>  <span class="c1"># colormaps</span>

<span class="n">min_val</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">bowl_peak</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="c1"># X, Y, Z = axes3d.get_test_data(0.05)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">max_val</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-0.5, 0.5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_array_124_1.png" src="../_images/c_data_nb_array_124_1.png" />
</div>
</div>
<p>On voit que le minimum se trouve près de <img class="math" src="../_images/math/2823b50d1f52f73ce72cf3261aaaa4c879bb7140.svg" alt="[-\frac{1}{2}, 0]"/>. On va utiliser ce point pour initialiser l’optimisation. On va tester différentes méthodes et comparer les sorties obtenues.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">bowl_peak</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nelder-Mead&quot;</span><span class="p">,</span> <span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="s2">&quot;BFGS&quot;</span><span class="p">,</span> <span class="s2">&quot;Powell&quot;</span><span class="p">,</span> <span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="n">optim_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">Method:</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">optim_res</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---
Method:Nelder-Mead
        message: Optimization terminated successfully.
       success: True
        status: 0
           fun: -0.4052368582391728
             x: [-6.690e-01 -1.446e-04]
           nit: 20
          nfev: 38
 final_simplex: (array([[-6.690e-01, -1.446e-04],
                       [-6.691e-01, -1.814e-04],
                       [-6.690e-01, -2.011e-04]]), array([-4.052e-01, -4.052e-01, -4.052e-01]))

---
Method:CG
  message: Optimization terminated successfully.
 success: True
  status: 0
     fun: -0.40523687026669025
       x: [-6.691e-01 -5.670e-09]
     nit: 2
     jac: [ 1.863e-08  0.000e+00]
    nfev: 24
    njev: 8

---
Method:BFGS
   message: Optimization terminated successfully.
  success: True
   status: 0
      fun: -0.40523687025688715
        x: [-6.691e-01 -7.451e-09]
      nit: 6
      jac: [-6.083e-06  0.000e+00]
 hess_inv: [[ 5.287e-01 -4.836e-24]
            [-4.836e-24  1.000e+00]]
     nfev: 21
     njev: 7

---
Method:Powell
  message: Optimization terminated successfully.
 success: True
  status: 0
     fun: -0.40523687026669025
       x: [-6.691e-01 -1.154e-08]
     nit: 2
   direc: [[ 0.000e+00  1.000e+00]
           [-6.854e-04 -4.670e-11]]
    nfev: 57

---
Method:COBYLA
  message: Optimization terminated successfully.
 success: True
  status: 1
     fun: -0.4052368678399868
       x: [-6.691e-01 -4.892e-05]
    nfev: 32
   maxcv: 0.0

---
Method:L-BFGS-B
   message: CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
  success: True
   status: 0
      fun: -0.4052368702662145
        x: [-6.691e-01 -8.828e-09]
      nit: 3
      jac: [ 1.360e-06  0.000e+00]
     nfev: 15
     njev: 5
 hess_inv: &lt;2x2 LbfgsInvHessProduct with dtype=float64&gt;

</pre></div></div>
</div>
<p>On trouve un minimum à <img class="math" src="../_images/math/6078dba6f28674e71bf39b8b7af7cb17f4c76e2b.svg" alt="-0.4052"/> en <img class="math" src="../_images/math/5672fbe21be300addae135627e4719e87422072f.svg" alt="[-0.669, 0.000]"/> pour toutes les méthodes qui convergent. Notez le message de sortie de “CG” qui signifie que le gradient ne varie plus assez. Personnellement, je ne trouve pas ce message de sortie très clair. Le point trouvé est bien l’optimum cherché pourtant. Notez aussi le nombre d’évaluations de la fonction (<em>nfev</em>) pour chaque méthode, et le nombre d’évaluation de gradient (<em>njev</em>) pour les méthodes qui reposent sur un calcul de gradient.</p>
<p>Remarquez aussi que si on relance <em>Anneal</em> plusieurs fois, on n’est pas assuré d’obtenir la même solution, puisqu’il s’agit d’une métaheuristique.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">optim_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">Method:</span><span class="si">{}</span><span class="s2"> - Test:</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">optim_res</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---
Method:L-BFGS-B - Test:0
   message: Optimization terminated successfully.
  success: True
   status: 0
      fun: -0.40523687025688715
        x: [-6.691e-01 -7.451e-09]
      nit: 6
      jac: [-6.083e-06  0.000e+00]
 hess_inv: [[ 5.287e-01 -4.836e-24]
            [-4.836e-24  1.000e+00]]
     nfev: 21
     njev: 7

---
Method:L-BFGS-B - Test:1
   message: Optimization terminated successfully.
  success: True
   status: 0
      fun: -0.40523687025688715
        x: [-6.691e-01 -7.451e-09]
      nit: 6
      jac: [-6.083e-06  0.000e+00]
 hess_inv: [[ 5.287e-01 -4.836e-24]
            [-4.836e-24  1.000e+00]]
     nfev: 21
     njev: 7

---
Method:L-BFGS-B - Test:2
   message: Optimization terminated successfully.
  success: True
   status: 0
      fun: -0.40523687025688715
        x: [-6.691e-01 -7.451e-09]
      nit: 6
      jac: [-6.083e-06  0.000e+00]
 hess_inv: [[ 5.287e-01 -4.836e-24]
            [-4.836e-24  1.000e+00]]
     nfev: 21
     njev: 7

---
Method:L-BFGS-B - Test:3
   message: Optimization terminated successfully.
  success: True
   status: 0
      fun: -0.40523687025688715
        x: [-6.691e-01 -7.451e-09]
      nit: 6
      jac: [-6.083e-06  0.000e+00]
 hess_inv: [[ 5.287e-01 -4.836e-24]
            [-4.836e-24  1.000e+00]]
     nfev: 21
     njev: 7

</pre></div></div>
</div>
<p>On va évaluer le temps de calcul nécessaire à chaque méthode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method:</span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
    <span class="o">%</span><span class="k">timeit</span> optim_res = optimize.minimize(fun, x0, method=m)
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;############&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Method:Nelder-Mead:
770 µs ± 77 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
Method:CG:
1.24 ms ± 45.9 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
Method:BFGS:
1.38 ms ± 89.1 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
Method:Powell:
871 µs ± 121 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
Method:COBYLA:
404 µs ± 65.1 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
Method:L-BFGS-B:
The slowest run took 5.91 times longer than the fastest. This could mean that an intermediate result is being cached.
2.12 ms ± 1.09 ms per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
############
</pre></div></div>
</div>
<p>On peut aussi fournir des arguments supplémentaires à la fonction qu’on optimise. Par exemple, les données lorsque vous maximisez une log-vraissemblance. En voici un exemple: on considère une version rescaled de la fonction <em>bowl_peak</em>. Vous pourriez aussi utiliser une lambda fonction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shifted_scaled_bowlpeak</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span> <span class="o">/</span> <span class="n">c</span>


<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">optim_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
    <span class="n">shifted_scaled_bowlpeak</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optim_res</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#######&quot;</span><span class="p">)</span>
<span class="n">optim_res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">shifted_scaled_bowlpeak</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">x0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optim_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  message: Optimization terminated successfully.
  success: True
   status: 0
      fun: 0.05000000677266441
        x: [ 2.500e+00 -1.229e+00]
      nit: 23
      jac: [-9.918e-06  5.635e-08]
 hess_inv: [[ 1.407e+00 -1.579e+02]
            [-1.579e+02  7.174e+05]]
     nfev: 72
     njev: 24
#######
  message: Optimization terminated successfully.
  success: True
   status: 0
      fun: 0.05000000677266441
        x: [ 2.500e+00 -1.229e+00]
      nit: 23
      jac: [-9.918e-06  5.635e-08]
 hess_inv: [[ 1.407e+00 -1.579e+02]
            [-1.579e+02  7.174e+05]]
     nfev: 72
     njev: 24
</pre></div></div>
</div>
<p>Vous pouvez continuer ce petit benchmark en ajoutant le gradient et la hessienne… les calculs seront plus précis et plus rapides.</p>
</section>
<section id="Exercice-4-:-simulation,-régression,-estimation-par-maximisation-de-la-vraisemblance">
<h2>Exercice 4 : simulation, régression, estimation par maximisation de la vraisemblance<a class="headerlink" href="#Exercice-4-:-simulation,-régression,-estimation-par-maximisation-de-la-vraisemblance" title="Lien permanent vers cette rubrique">#</a></h2>
<ul class="simple">
<li><p>On commence par simuler la variable <img class="math" src="../_images/math/40ea4993533a0f2d5988f3601ab43a488a27be9b.svg" alt="Y = 3 X_1 -2 X_2 +2 + \epsilon"/> où <img class="math" src="../_images/math/382268cfedff8e6d26f7a73da02e86bd079ad8b6.svg" alt="X_1,X_2,\epsilon \sim \mathcal{N}(0,1)"/></p></li>
<li><p>On souhaite ensuite retrouver les coefficients dans la <a class="reference external" href="http://fr.wikipedia.org/wiki/R%C3%A9gression_lin%C3%A9aire">régression linéaire</a> de <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> sur <img class="math" src="../_images/math/4bd4cb3c78851a33f8380b338de7ef126fb3c74d.svg" alt="X_1"/> et <img class="math" src="../_images/math/67272339af25058949d56a3a223501543e900227.svg" alt="X_2"/> dans un modèle avec constante, par la méthode des Moindres Carrés Ordinaires. On rappelle que la forme matricielle de l’estimateur des MCO est <img class="math" src="../_images/math/1c739387855e8132908303a020870e052cb805fb.svg" alt="\hat{\beta} = (X'X)^{-1}X'Y"/></p></li>
<li><p>Enfin, <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> étant normale, on souhaite estimer ses paramètres par maximisation de vraisemblance:</p>
<ul>
<li><p>La densité s’écrit: <img class="math" src="../_images/math/d9c2a09f35b6002c4faec8f6d202ca6bfea34109.svg" alt="f(x, \mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi} } e^{ -\frac{(x-\mu)^2}{2\sigma^2} }"/></p></li>
<li><p>La log-vraisemblance: <img class="math" src="../_images/math/5e0c22acb0881c1638e0dea43a5792b70042c936.svg" alt="\ln\mathcal{L}(\mu,\sigma^2) = \sum_{i=1}^n \ln f(x_i;\,\mu,\sigma^2) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln\sigma^2 - \frac{1}{2\sigma^2}\sum_{i=1}^n (x_i-\mu)^2"/>.</p></li>
<li><p>L’écriture des conditions au premier ordre donne une formule fermée pour les estimateurs du maximum de vraisemblance: <img class="math" src="../_images/math/1fe7b94f89d067a5a9af7c4c8d1ab55339a17f7d.svg" alt="\hat{\mu} = \overline{x} \equiv \frac{1}{n}\sum_{i=1}^n x_i"/>, <img class="math" src="../_images/math/9e4d10882b86c888dba94ab69dfbf1ec16577f5f.svg" alt="\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \overline{x})^2"/>.</p></li>
<li><p>Vérifiez en les implémentant directement que vous trouvez bien la même solution que le minimum obtenu en utilisant <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a> pour minimiser l’opposé de la log-vraissemblance.</p></li>
</ul>
</li>
</ul>
</section>
<section id="Références">
<h2>Références<a class="headerlink" href="#Références" title="Lien permanent vers cette rubrique">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.loria.fr/~rougier/teaching/numpy.100/">100 numpy exercises</a></p></li>
<li><p><a class="reference external" href="http://gael-varoquaux.info/scipy-lecture-notes/intro/numpy/index.html">Un tutoriel bien fait et très complet sur numpy</a>. L’un des auteurs n’est autre que Gaël Varoquaux qui sera présent pour la séance 3. Voir aussi la <a class="reference external" href="http://gael-varoquaux.info/scipy-lecture-notes/advanced/mathematical_optimization/index.html">partie optimisation</a></p></li>
</ul>
</section>
<section id="Eléments-de-réponses-pour-les-exercices">
<h2>Eléments de réponses pour les exercices<a class="headerlink" href="#Eléments-de-réponses-pour-les-exercices" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Réponses partielles.</p>
<ul class="simple">
<li><p>Exercice 1-A Echiquier: Créer une matrice échiquier (des 1 et des 0 alternés) de taille 8x8, de deux façons différentes</p>
<ul>
<li><p>en vous servant de slices</p></li>
<li><p>en vous servant de la fonction <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.tile.html#numpy.tile">tile</a></p></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Exo1a-1:</span>
<span class="n">chess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">chess</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">chess</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chess</span><span class="p">)</span>

<span class="c1"># Exo1a-2:</span>
<span class="n">chess2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chess2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]]
[[1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]
 [1 0 1 0 1 0 1 0]
 [0 1 0 1 0 1 0 1]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>Exercice 1-B Piège lors d’une extraction 2d:</p>
<ul>
<li><p>Définir la matrice <img class="math" src="../_images/math/325859de3f420570f7dd8274c1850b1be67662e8.svg" alt="M = \left(\begin{array}{ccccc} 1 &amp; 5 &amp; 9 &amp; 13 &amp; 17 \\ 2 &amp; 6 &amp; 10 &amp; 14 &amp; 18 \\ 3 &amp; 7 &amp; 11 &amp; 15 &amp; 19 \\ 4 &amp; 8 &amp; 12 &amp; 16 &amp; 20 \\ \end{array}\right)"/></p></li>
<li><p>En <strong>extraire</strong> la matrice <img class="math" src="../_images/math/80578318d4c98528250cc211c10874d78fc3c09e.svg" alt="\left(\begin{array}{ccc} 6 &amp; 18 &amp; 10 \\ 7 &amp; 19 &amp; 11 \\ 5 &amp; 17 &amp; 9 \\ \end{array}\right)"/></p></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exo1B:</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">idx_row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">idx_col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="c1"># the following line is wrong: it create couples from the two lists</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WRONG:&quot;</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="n">idx_row</span><span class="p">,</span> <span class="n">idx_col</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;########&quot;</span><span class="p">)</span>
<span class="c1"># first correct way:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">idx_row</span><span class="p">][:,</span> <span class="n">idx_col</span><span class="p">])</span>
<span class="c1"># we can also use broadcasted indices to create all the couples we want:</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx_row</span><span class="p">,</span> <span class="n">idx_col</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1  5  9 13 17]
 [ 2  6 10 14 18]
 [ 3  7 11 15 19]
 [ 4  8 12 16 20]]
WRONG: [ 6 19  9]
########
[[ 6 18 10]
 [ 7 19 11]
 [ 5 17  9]]
(array([[1],
       [2],
       [0]]), array([[1, 4, 2]]))
[[ 6 18 10]
 [ 7 19 11]
 [ 5 17  9]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>Exercice 1-C Crible d’Erathosthene: On souhaite implémenter un <a class="reference external" href="http://fr.wikipedia.org/wiki/Crible_d'%C3%89ratosth%C3%A8ne">crible d’Erathosthène</a> pour trouver les nombres premiers inférieurs à <img class="math" src="../_images/math/4ba6a210e4caef4658545e1b17ea0bad7da420a1.svg" alt="N=1000"/>.</p>
<ul>
<li><p>partir d’un array de booléens de taille N+1, tous égaux à True.</p></li>
<li><p>Mettre 0 et 1 à False car ils ne sont pas premiers</p></li>
<li><p>pour chaque entier <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> entre 2 et <img class="math" src="../_images/math/d946d5f0e84f3b2fea989764b1696e301d5af8d7.svg" alt="\sqrt{N}"/>:</p>
<ul>
<li><p>si <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> est premier: on passe ses multiples (entre <img class="math" src="../_images/math/86c742502944f9453297da2b6eccaf108a1f7a46.svg" alt="k^2"/> et <img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/>) à False</p></li>
</ul>
</li>
<li><p>on print la liste des entiers premiers</p></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exo1c</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">is_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">is_prime</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">is_prime</span><span class="p">[</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span> <span class="p">::</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="n">is_prime</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  2   3   5   7  11  13  17  19  23  29  31  37  41  43  47  53  59  61
  67  71  73  79  83  89  97 101 103 107 109 113 127 131 137 139 149 151
 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251
 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359
 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463
 467 479 487 491 499 503 509 521 523 541 547 557 563 569 571 577 587 593
 599 601 607 613 617 619 631 641 643 647 653 659 661 673 677 683 691 701
 709 719 727 733 739 743 751 757 761 769 773 787 797 809 811 821 823 827
 829 839 853 857 859 863 877 881 883 887 907 911 919 929 937 941 947 953
 967 971 977 983 991 997]
</pre></div></div>
</div>
<p>On remarque que le nombre 6 est barré deux fois car il est multiple de 3 et de 2. Cela signifie que le nombre 6 est barré durant les deux premières itérations. En fait chaque nombre <code class="docutils literal notranslate"><span class="pre">k*i</span></code> est nécessaire barré dans une précédente itération si <code class="docutils literal notranslate"><span class="pre">i&lt;k</span></code>. On remplace donc <code class="docutils literal notranslate"><span class="pre">k*i</span></code> par <code class="docutils literal notranslate"><span class="pre">k*k</span></code> ou <code class="docutils literal notranslate"><span class="pre">k**2</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exo1c</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">is_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">is_prime</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))):</span>
    <span class="n">is_prime</span><span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">k</span> <span class="p">::</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="n">is_prime</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  2   3   5   7  11  13  17  19  23  29  31  37  41  43  47  53  59  61
  67  71  73  79  83  89  97 101 103 107 109 113 127 131 137 139 149 151
 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251
 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359
 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463
 467 479 487 491 499 503 509 521 523 541 547 557 563 569 571 577 587 593
 599 601 607 613 617 619 631 641 643 647 653 659 661 673 677 683 691 701
 709 719 727 733 739 743 751 757 761 769 773 787 797 809 811 821 823 827
 829 839 853 857 859 863 877 881 883 887 907 911 919 929 937 941 947 953
 961 967 971 977 983 991 997]
</pre></div></div>
</div>
<p>Simulez (<strong>en une seule fois!</strong>) 10000 marches aléatoires de taille 1000, partant de 0 et de pas +1 ou -1 équiprobables</p>
<ul class="simple">
<li><p>Faites un graphe représentant la racine de la moyenne des carrés des positions (=cumul des pas à un instant donné) en fonction du temps</p></li>
<li><p>Quels sont les amplitudes maximales et minimales atteintes parmi l’ensemble des marches aléatoires?</p></li>
<li><p>Combien de marches s’éloigne de plus de 50 de l’origine?</p></li>
<li><p>Parmi celles qui le font, quelle est la moyenne des temps de passage (i.e. le premier moment où ces marches dépassent +/-50)?</p></li>
</ul>
<p>Vous aurez peut-être besoin des fonctions suivantes: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.absolute.html">np.abs</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html">np.mean</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.max.html">np.max</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.where.html">np.where</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.argmax.html">np.argmax</a>,
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.any.html">np.any</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.cumsum.html">np.cumsum</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randint.html">np.random.randint</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n_walks</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">n_walks</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">))</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">walks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># on affiche le premier carré 10x10</span>
<span class="n">walks</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-1,  0,  1,  2,  1,  2,  1,  0, -1, -2],
       [ 1,  2,  1,  2,  1,  2,  3,  2,  1,  2],
       [-1,  0,  1,  0, -1, -2, -1,  0,  1,  2],
       [ 1,  2,  1,  2,  1,  2,  3,  4,  3,  4],
       [ 1,  0,  1,  2,  3,  4,  5,  6,  5,  6],
       [-1,  0,  1,  0,  1,  0,  1,  0,  1,  2],
       [ 1,  2,  3,  4,  5,  4,  5,  4,  5,  6],
       [-1,  0, -1,  0, -1, -2, -3, -4, -5, -4],
       [-1,  0,  1,  2,  3,  2,  3,  2,  3,  2],
       [ 1,  2,  1,  0, -1, -2, -1, -2, -3, -2]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s have a quick look at a few random walks</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">walks</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;A few random walks&quot;</span><span class="p">)</span>

<span class="c1"># Let&#39;s see how the root mean square of the position evolves with time/nb of steps</span>
<span class="n">rms_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">walks</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rms_position</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s2">&quot;:b&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Just to show the fit</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rms_position</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># What are the highest/lowest positions</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Root Mean Square of Position by Time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Highest position:</span><span class="si">{max}</span><span class="s2"> - Lowest position:</span><span class="si">{min}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">walks</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">min</span><span class="o">=</span><span class="n">walks</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># How many walks wander further than 50?</span>
<span class="n">bound</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">hits_the_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">bound</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>  <span class="c1"># for each walk, do we go further than the bound at any time?</span>

<span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of walks over bound(=</span><span class="si">{</span><span class="n">bound</span><span class="si">:</span><span class="s2">1.2f</span><span class="si">}</span><span class="s2">):</span><span class="si">{</span><span class="n">hits_the_bound</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">1.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Among the walks that go beyond the bound, what is the mean of the first hits?</span>
<span class="c1"># we use argmax on the boolean array to get the first True value</span>
<span class="n">first_hits</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walks</span><span class="p">[</span><span class="n">hits_the_bound</span><span class="p">,</span> <span class="p">:])</span> <span class="o">&gt;</span> <span class="n">bound</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean crossing time:</span><span class="si">{</span><span class="n">first_hits</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">1.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">titles</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/c_data_nb_array_150_0.png" src="../_images/c_data_nb_array_150_0.png" />
</div>
</div>
<p>Dans cet exercice, on cherche à retrouver la série initiale à partir de la somme cumulée de celle-ci. On veut calculer en quelque sort sa dérivée.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">derivee</span> <span class="o">=</span> <span class="n">walks</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">walks</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">derivee</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1,  1,  1, -1,  1, -1, -1, -1, -1,  1],
       [ 1, -1,  1, -1,  1,  1, -1, -1,  1,  1],
       [ 1,  1, -1, -1, -1,  1,  1,  1,  1,  1],
       [ 1, -1,  1, -1,  1,  1,  1, -1,  1,  1],
       [-1,  1,  1,  1,  1,  1,  1, -1,  1,  1],
       [ 1,  1, -1,  1, -1,  1, -1,  1,  1,  1],
       [ 1,  1,  1,  1, -1,  1, -1,  1,  1, -1],
       [ 1, -1,  1, -1, -1, -1, -1, -1,  1, -1],
       [ 1,  1,  1,  1, -1,  1, -1,  1, -1, -1],
       [ 1, -1, -1, -1, -1,  1, -1, -1,  1, -1]])
</pre></div></div>
</div>
<ul class="simple">
<li><p>On commence par simuler la variable <img class="math" src="../_images/math/40ea4993533a0f2d5988f3601ab43a488a27be9b.svg" alt="Y = 3 X_1 -2 X_2 +2 + \epsilon"/> où <img class="math" src="../_images/math/382268cfedff8e6d26f7a73da02e86bd079ad8b6.svg" alt="X_1,X_2,\epsilon \sim \mathcal{N}(0,1)"/></p></li>
<li><p>On souhaite ensuite retrouver les coefficients dans la <a class="reference external" href="http://fr.wikipedia.org/wiki/R%C3%A9gression_lin%C3%A9aire">régression linéaire</a> de <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> sur <img class="math" src="../_images/math/4bd4cb3c78851a33f8380b338de7ef126fb3c74d.svg" alt="X_1"/> et <img class="math" src="../_images/math/67272339af25058949d56a3a223501543e900227.svg" alt="X_2"/> dans un modèle avec constante, par la méthode des Moindres Carrés Ordinaires. On rappelle que la forme matricielle de l’estimateur des MCO est <img class="math" src="../_images/math/1c739387855e8132908303a020870e052cb805fb.svg" alt="\hat{\beta} = (X'X)^{-1}X'Y"/></p></li>
<li><p>Enfin, <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> étant normale, on souhaite estimer ses paramètres par maximisation de vraisemblance:</p>
<ul>
<li><p>La densité s’écrit: <img class="math" src="../_images/math/d9c2a09f35b6002c4faec8f6d202ca6bfea34109.svg" alt="f(x, \mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi} } e^{ -\frac{(x-\mu)^2}{2\sigma^2} }"/></p></li>
<li><p>La log-vraisemblance: <img class="math" src="../_images/math/5e0c22acb0881c1638e0dea43a5792b70042c936.svg" alt="\ln\mathcal{L}(\mu,\sigma^2) = \sum_{i=1}^n \ln f(x_i;\,\mu,\sigma^2) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln\sigma^2 - \frac{1}{2\sigma^2}\sum_{i=1}^n (x_i-\mu)^2"/> ou encore en divisant par <img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> : <img class="math" src="../_images/math/4478a075d1952cae9f415627a9ad0f30d22d6d56.svg" alt="-\frac{1}{2}\ln(2\pi) - \frac{1}{2}\ln\sigma^2 - \frac{1}{2n\sigma^2}\sum_{i=1}^n (x_i-\mu)^2"/></p></li>
<li><p>L’écriture des conditions au premier ordre donne une formule fermée pour les estimateurs du maximum de vraisemblance: <img class="math" src="../_images/math/1fe7b94f89d067a5a9af7c4c8d1ab55339a17f7d.svg" alt="\hat{\mu} = \overline{x} \equiv \frac{1}{n}\sum_{i=1}^n x_i"/>, <img class="math" src="../_images/math/9e4d10882b86c888dba94ab69dfbf1ec16577f5f.svg" alt="\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \overline{x})^2"/>.</p></li>
<li><p>Vérifiez en les implémentant directement que vous trouvez bien la même solution que le minimum obtenu en utilisant <em>scipy.optimize.minimize</em> pour minimiser l’opposé de la log-vraissemblance.</p></li>
</ul>
</li>
</ul>
<p><strong>version matricielle</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">x1_x2_eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x1_x2_eps</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1_x2_eps</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x1_x2_eps</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x1_x2_eps</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
<span class="n">beta_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coef X1, coef X2, constante&quot;</span><span class="p">)</span>
<span class="n">beta_hat</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
coef X1, coef X2, constante
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 3.00221957, -2.00002224,  2.00752589])
</pre></div></div>
</div>
<p><strong>version scipy</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_likelihood</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma_square</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_square</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="n">sigma_square</span>
    <span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">neg_log_likelihood_vectorielle</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">log_likelihood</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>


<span class="n">theta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="n">optim_res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">neg_log_likelihood_vectorielle</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Nelder-Mead&quot;</span><span class="p">)</span>
<span class="n">optim_res</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
       message: Optimization terminated successfully.
       success: True
        status: 0
           fun: 1.8190958879314423
             x: [ 2.012e+00  1.399e+01]
           nit: 29
          nfev: 59
 final_simplex: (array([[ 2.012e+00,  1.399e+01],
                       [ 2.012e+00,  1.399e+01],
                       [ 2.012e+00,  1.399e+01]]), array([ 1.819e+00,  1.819e+00,  1.819e+00]))
</pre></div></div>
</div>
<p>Est-ce bien le résultat attendu :</p>
<ul class="simple">
<li><p><img class="math" src="../_images/math/ec32a0f2ad40d28757e040ed081da5aed6619cdc.svg" alt="\mathbb{E}Y = 3\mathbb{E}X_1 - 2\mathbb{E}X_2 + 2 + \mathbb{E}\epsilon = 2"/></p></li>
<li><p><img class="math" src="../_images/math/e04f616ff0256a5910d0470cc76f680b7a454bdb.svg" alt="\mathbb{V}Y = 9\mathbb{V}X_1 + 4\mathbb{V}X_2 + \mathbb{V}\epsilon = 14"/></p></li>
</ul>
<p>Toutes les variables sont indépendantes. On vérifie que cela correspond aux réponses cherchées :</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2.0124871630503782, 13.98788749023154)
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<p><a class="reference external" href="https://github.com/sdpython/teachpyx/tree/main/_doc/c_data/nb_array.ipynb">Notebook on github</a></p>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="nb_numpy.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Calcul matriciel avec numpy (version courte)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="matrices.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Calcul matriciel</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2023, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Calcul Matriciel, Optimisation</a><ul>
<li><a class="reference internal" href="#Numpy-arrays">Numpy arrays</a><ul>
<li><a class="reference internal" href="#Creation-d'un-array:-notion-de-datatype,-et-dimensions">Creation d’un array: notion de datatype, et dimensions</a><ul>
<li><a class="reference internal" href="#Indexation,-Slicing,-Fancy-indexing">Indexation, Slicing, Fancy indexing</a></li>
<li><a class="reference internal" href="#View-contre-Copy">View contre Copy</a></li>
<li><a class="reference internal" href="#Manipulation-de-shape">Manipulation de shape</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Exercice-1-:-Echiquier-et-Crible-d'Erathosthène">Exercice 1 : Echiquier et Crible d’Erathosthène</a></li>
<li><a class="reference internal" href="#Manipulation-et-Opérations-sur-les-arrays">Manipulation et Opérations sur les arrays</a><ul>
<li><a class="reference internal" href="#Opérations-élément-par-élément">Opérations élément par élément</a><ul>
<li><a class="reference internal" href="#Broadcasting">Broadcasting</a></li>
<li><a class="reference internal" href="#Réductions">Réductions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Algèbre-linéaire">Algèbre linéaire</a></li>
<li><a class="reference internal" href="#Génération-de-nombres-aléatoires-et-statistiques">Génération de nombres aléatoires et statistiques</a></li>
<li><a class="reference internal" href="#Exercice-2-:-marches-aléatoires">Exercice 2 : marches aléatoires</a></li>
<li><a class="reference internal" href="#Exercice-3-:-retrouver-la-série-aléatoire-à-partir-des-marches-aléatoires">Exercice 3 : retrouver la série aléatoire à partir des marches aléatoires</a></li>
<li><a class="reference internal" href="#Optimisation-avec-scipy">Optimisation avec scipy</a></li>
<li><a class="reference internal" href="#Exercice-4-:-simulation,-régression,-estimation-par-maximisation-de-la-vraisemblance">Exercice 4 : simulation, régression, estimation par maximisation de la vraisemblance</a></li>
<li><a class="reference internal" href="#Références">Références</a></li>
<li><a class="reference internal" href="#Eléments-de-réponses-pour-les-exercices">Eléments de réponses pour les exercices</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=aaad8c98"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>