
<!DOCTYPE html>


<html lang="fr" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Confidence Interval and p-Value &#8212; Documentation mlstatpy 0.4.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=e5fbc548" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=72ff47bc"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c_metric/pvalues';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="p-values" href="../notebooks/metric/pvalues_examples.html" />
    <link rel="prev" title="ROC" href="../notebooks/metric/roc_example.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Passer au contenu principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/project_ico.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/project_ico.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_clus/index.html">
                        Clustering
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index.html">
                        Non linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_lin.html">
                        Régression linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_log.html">
                        Régression logistique
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_nlp/index.html">
                        NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Métriques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_algo/index.html">
                        Algorithmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_garden/index.html">
                        Pérégrinations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Listes des définitions et théorèmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Gallery of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/index.html">
                        Galleries de notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_clus/index.html">
                        Clustering
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index.html">
                        Non linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_lin.html">
                        Régression linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_log.html">
                        Régression logistique
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_nlp/index.html">
                        NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Métriques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_algo/index.html">
                        Algorithmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_garden/index.html">
                        Pérégrinations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Listes des définitions et théorèmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Gallery of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/index.html">
                        Galleries de notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Navigation de la section">
  <p class="bd-links__title" role="heading" aria-level="1">Navigation de la section</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="roc.html">Courbe ROC</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/roc_example.html">ROC</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Confidence Interval and p-Value</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Fils d'Ariane">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Fil d'Ariane">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Acceuil">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Métriques</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Confidence Interval and p-Value</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="confidence-interval-and-p-value">
<span id="index-0"></span><h1>Confidence Interval and p-Value<a class="headerlink" href="#confidence-interval-and-p-value" title="Lien permanent vers cette rubrique">#</a></h1>
<nav class="contents local" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#why-p-value" id="id2">Why p-value?</a></p></li>
<li><p><a class="reference internal" href="#significant-difference-between-samples-mean" id="id3">Significant difference between samples mean</a></p></li>
<li><p><a class="reference internal" href="#application-on-binomial-variables" id="id4">Application on binomial variables</a></p></li>
<li><p><a class="reference internal" href="#estimate-a-p-value-by-using-the-distribution-function" id="id5">Estimate a p-value by using the distribution function</a></p></li>
<li><p><a class="reference internal" href="#correlated-variables" id="id6">Correlated variables</a></p></li>
<li><p><a class="reference internal" href="#multiple-comparisons-problem" id="id7">Multiple comparisons problem</a></p></li>
<li><p><a class="reference internal" href="#algorithm-expectation-maximization" id="id8">Algorithm Expectation-Maximization</a></p></li>
<li><p><a class="reference internal" href="#notebooks" id="id9">Notebooks</a></p></li>
<li><p><a class="reference internal" href="#bibliographie" id="id10">Bibliographie</a></p></li>
</ul>
</nav>
<p>This document explains the relationship between p-value and confidence intervals.
It goes on with the specific case of a binamial law. Assuming we want to determine
whether or not two binomial laws are significantly different, how many observations
we need to get the p-value under a given threshold.</p>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Lien permanent vers cette rubrique">#</a></h2>
<p>The term <a class="reference external" href="https://fr.wikipedia.org/wiki/Valeur_p">p-value</a> is very popular
in the world of search engines. I usually prefer confidence interval 95%,
I think it is easier to understand. Plus, because p-Value are real values,
we could be tempted to compare them and it is usually wrong. On the other hand,
it is more difficult to compare confidence intervals, especially if they are
related to complete different variables. Their nature prevents you from doing that.
Howerver p-Values and confidence interval are similar: they tell you whether
or not a metric difference is significant.</p>
<p>Usually, it starts from a set of identically distributed random variables
<img class="math" src="../_images/math/589b87e5844d6b4ab128bb802c93f6916bd5c467.svg" alt="(X_i)_{1 \infegal i \infegal N}"/>. We then estimate the average
<img class="math" src="../_images/math/bc06c4176017f1c68ce9d08358ea2dc6258e8273.svg" alt="\widehat{\theta}_N = \frac{1}{N} \sum_{i=1}^{N} X_i"/> and we ask
the question is <img class="math" src="../_images/math/b491ae30ba617c96145c0ca6f5f3fbedc0a7b120.svg" alt="\widehat{\theta}_N"/> null? In others terms, we
want to know if the average is significantly different from zero. If
the random variable <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> follows a random law which has a standard
deviation, we can use the <a class="reference external" href="https://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a>
which tells us:</p>
<div class="math">
<p><img src="../_images/math/b42503a2fc0d7284d6868b018fead4b8e7e3f41f.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{0}{\sigma}
\end{eqnarray*}"/></p>
</div><p>Not all of them have a standard deviation. For example, if <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> follows a
<a class="reference external" href="https://en.wikipedia.org/wiki/Cauchy_distribution">Cauchy law</a>,
<img class="math" src="../_images/math/60532d12dc1f68fd1dcd0d2ada5e297ef1130805.svg" alt="\esp{X^2} \sim \int \frac{x^2}{1+x^2}dx"/> which does not exist.
This remark also concerns every distribution known as heavy tail distribution.</p>
<p>If <img class="math" src="../_images/math/541210c426adf291f270ab865df44acdc6e2a83c.svg" alt="Y \sim \loinormale{0}{\sigma}"/>, then we have
<img class="math" src="../_images/math/9cd074420890de693ffbfc03a59e246232a67b48.svg" alt="\pr{\abs{Y} \infegal 1.96} = 0.95"/>. That is why we can say:</p>
<div class="math">
<p><img src="../_images/math/9aab13bbbf084f4287e96ddd783b560500ea99b5.svg" alt="\begin{eqnarray*}
\widehat{\theta}_N \text{ is not null with 95\% confidence if }
\sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} &gt; 1.96
\end{eqnarray*}"/></p>
</div><p>And the confidence intervalle at 95% would be:</p>
<div class="math">
<p><img src="../_images/math/1e1f16f9d3390ebff82a9da685e0ee9425830768.svg" alt="\begin{eqnarray*}
\cro{ %\widehat{\theta}_N
            - \frac{1.96 \sigma}{\sqrt{N}},
            %\widehat{\theta}_N +
            \frac{1.96 \sigma}{\sqrt{N}}}
\end{eqnarray*}"/></p>
</div><p>When <img class="math" src="../_images/math/848399a44872dfb5fa3806b0ce3a945626893a7d.svg" alt="\esp{ \widehat{\theta}_N } = \theta_0 \neq 0"/>, it becomes:</p>
<div class="math">
<p><img src="../_images/math/9fe30695557fd519350520d14e731b2930e1116b.svg" alt="\begin{eqnarray*}
\sqrt{N} \cro{ \widehat{\theta}_N - \theta_0}
\underset{N \rightarrow \infty}{\longrightarrow}
\loinormale{0}{\sigma}
\end{eqnarray*}"/></p>
</div><p>We usually want to check if the mean is equal to a specific value
using a statistical test:</p>
<div class="math">
<p><img src="../_images/math/d0d91a5c526412fea23f1d81a3d4483f283a5589.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; \widehat{\theta}_N = \theta_0 \\
H1: &amp;&amp; \widehat{\theta}_N \neq  \theta_0
\end{eqnarray*}"/></p>
</div><p>We validate <img class="math" src="../_images/math/bea31eb8d4d9fd1d5bbfaa8bf5c926533877893f.svg" alt="H0"/> if:</p>
<div class="math">
<p><img src="../_images/math/86c213281cad6baf0033401bb5e1cc7df690ff83.svg" alt="\begin{eqnarray*}
\widehat{\theta}_N \in \cro{ \theta_0 - \frac{1.96 \sigma}{\sqrt{N}},
\theta_0 + \frac{1.96 \sigma}{\sqrt{N}}}
\end{eqnarray*}"/></p>
</div></section>
<section id="why-p-value">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Why p-value?</a><a class="headerlink" href="#why-p-value" title="Lien permanent vers cette rubrique">#</a></h2>
<p>With confidence intervals, you first choose a confidence level and then you
get an interval. You then check if your value is inside or outside your interval.
Inside, the gain is not significant, outside, it is.</p>
<p>With a p-value, we consider the problem the other way, given
<img class="math" src="../_images/math/b491ae30ba617c96145c0ca6f5f3fbedc0a7b120.svg" alt="\widehat{\theta}_N"/>, what is the probability that the
difference <img class="math" src="../_images/math/75fece4ea7279e6423cf68b48ff29d406286cded.svg" alt="\abs{\widehat{\theta}_N - \theta_0}"/> is significant?
Let’s consider <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> following a normal law <img class="math" src="../_images/math/405981d3eea95ba3c42d0ac77b78e4837072ba51.svg" alt="\loinormale{0}{1}"/>.
We are looking for:</p>
<div class="math">
<p><img src="../_images/math/d79662b154b80e520522ae4985ea0a5b01f7bd67.svg" alt="\begin{eqnarray*}
\pr{ \abs{Y} &gt; \sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} } = \alpha
\end{eqnarray*}"/></p>
</div><p><img class="math" src="../_images/math/a1e7b66a55fc77cebd91d9a1ebfa93a29c1736fb.svg" alt="\alpha"/> is the p-value.</p>
<div class="math" id="equation-p-value-expression">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-p-value-expression" title="Lien permanent vers cette équation">#</a></span><img src="../_images/math/19451b23319914915e2c4ec460a7870498a67412.svg" alt="\begin{eqnarray*}
\alpha &amp;=&amp; 1-\int_{-\beta_N}^{\beta_N} \frac{1}{\sqrt{2\pi}}
e^{\frac{-x^2}{2}} dx =
2 \int_{\beta_N}^{\infty} \frac{1}{\sqrt{2\pi}} e^{\frac{-x^2}{2}} dx \\
\text{where } \beta_N &amp;=&amp; \sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma}
\end{eqnarray*}"/></p>
</div><p>At this point, we should not forget that we use a theorem which tells us that
<img class="math" src="../_images/math/8254c5168b12b2590c77880767e464cf41b81fc6.svg" alt="\sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} \sim \loinormale{0}{1}"/>
when <img class="math" src="../_images/math/fc50bcc40e676b6a5241a7a5430022975a6907dd.svg" alt="N \rightarrow \infty"/>, which means everything we said is true
when <img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/> is great enough.</p>
</section>
<section id="significant-difference-between-samples-mean">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Significant difference between samples mean</a><a class="headerlink" href="#significant-difference-between-samples-mean" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Usually, we do not want to test if an average is null but if the difference
between two averages is null. We consider two random samples having the same
size, each of them described by <img class="math" src="../_images/math/27472567e50161aef46885272e223c61b9956296.svg" alt="(X_i)"/> and <img class="math" src="../_images/math/9f52d5eea733fc02cbe44bafa7f8f7015452f524.svg" alt="(Y_i)"/>.
All variables are independant. <img class="math" src="../_images/math/27472567e50161aef46885272e223c61b9956296.svg" alt="(X_i)"/> are distributed according the
same law, we assume the same for <img class="math" src="../_images/math/9f52d5eea733fc02cbe44bafa7f8f7015452f524.svg" alt="(Y_i)"/>. We expect the following
difference to be null.</p>
<div class="math" id="equation-pvalues-exp2">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-pvalues-exp2" title="Lien permanent vers cette équation">#</a></span><img src="../_images/math/c44065ea6997c10bc5f4aa3c6ed51f92e9f5c9b5.svg" alt="\begin{eqnarray*}
\widehat{\eta}_N &amp;=&amp; \frac{1}{N} \sum_{i=1}^{N} X_i -
\frac{1}{N} \sum_{i=1}^{N} Y_i
= \frac{1}{N} \cro{ \sum_{i=1}^{N} X_i -  Y_i }
\end{eqnarray*}"/></p>
</div><p>Considering expression <a class="reference internal" href="#equation-pvalues-exp2">(2)</a>, we can applying the central
limit theorem on variable <img class="math" src="../_images/math/be8050fa58a1a8ab98cde57f6a4abf3676591902.svg" alt="Z=X-Y"/>, we get (<img class="math" src="../_images/math/221ce895d74b074c67da1955c0e77a8b1f1d4375.svg" alt="\eta_0=0"/>):</p>
<div class="math">
<p><img src="../_images/math/b04604070cc97c8923ecc2324211a829162100c3.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\eta}_N \underset{N \rightarrow \infty}{\longrightarrow}
\loinormale{\eta_0}{\sqrt{ \frac{\var{Z} }{N  } }}
\end{eqnarray*}"/></p>
</div><p>If both samples do not have the same number of observations,
this expression becomes:</p>
<div class="math">
<p><img src="../_images/math/fb04bb1b5d9490ed952ce9eb8541f2511bb6b988.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\eta}_N \underset{ \begin{subarray}{c} N_1
\rightarrow \infty \\
N_2 \rightarrow \infty \\
\frac{N_1}{N_2} \rightarrow x \end{subarray}}{\longrightarrow}
\loinormale{\eta_0}{\sqrt{ \frac{\var{X}}{N_1}+\frac{\var{Y}}{N_2} }}
\end{eqnarray*}"/></p>
</div></section>
<section id="application-on-binomial-variables">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Application on binomial variables</a><a class="headerlink" href="#application-on-binomial-variables" title="Lien permanent vers cette rubrique">#</a></h2>
<p>A binomial variable <img class="math" src="../_images/math/419c9ea59701ce43e7d043b5339d4cb8bbedf418.svg" alt="X \sim \loibinomialea{p}"/> is defined by:</p>
<div class="math">
<p><img src="../_images/math/b19e4a335a93d46078f6805f1fff43311ea9b543.svg" alt="\begin{eqnarray*}
\pr{X=0} &amp;=&amp; 1-p \\
\pr{X=1} &amp;=&amp; p
\end{eqnarray*}"/></p>
</div><p>Let’s consider two series of observations <img class="math" src="../_images/math/50273ccc4f548d27428eb0ae63079f3860a4c771.svg" alt="(X_i) \sim \loibinomialea{p}"/>
and <img class="math" src="../_images/math/e6fc42ef171c75c0fe8b955b11343a6193238cb8.svg" alt="(Y_i) \sim \loibinomialea{q}"/>. We assume <img class="math" src="../_images/math/7fa794a6094d9642edb31ae441a01db5591f6b59.svg" alt="p \neq q"/> and we want
to determine how many observations we need to get a p-value below 5%.
We know that <img class="math" src="../_images/math/e27040185eafb682896fb8b37b61a870f6f5aac8.svg" alt="\variance{X_i}=p(1-p)"/> and <img class="math" src="../_images/math/a5c29f149d8b8da904a19b675eb718629aff7274.svg" alt="\variance{Y_i}=q(1-q)"/>.
Next table shows the values. First column contains values for <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>,
first row contains values for <img class="math" src="../_images/math/41e218c0609dcc02c1e03f12f065fe6b70d3b300.svg" alt="q-p"/>. We also assume we have the same number
<img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/> of random observations for each variable. The statistical
test cen be defined like following:</p>
<div class="math">
<p><img src="../_images/math/f94938a28b8f753cca44aa1bd9e25fb2a5ecf26d.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; p = q = p_0 \\
H1: &amp;&amp; p \neq q
\end{eqnarray*}"/></p>
</div><p>If H0 is true, then:</p>
<div class="math">
<p><img src="../_images/math/d9784e255b591e4d5f254812b20ef83740a77b3c.svg" alt="\begin{eqnarray}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{0}{\sqrt{p_0(1-p_0)}
\sqrt{ \frac{1}{N_1}+\frac{1}{N_2} }}
\end{eqnarray}"/></p>
</div><div class="math">
<p><img src="../_images/math/aafe5b2f9755060eab2b9404e743302332342205.svg" alt="\begin{tabular}{r|r|r|r|r|r|r|r|r|r|r|r|r}
$p/d$&amp;\textbf{-0.200}&amp;\textbf{-0.100}&amp;\textbf{-0.020}&amp;\textbf{-0.010}&amp;\textbf{-0.002}&amp;\textbf{-0.001}&amp;\textbf{0.001}&amp;\textbf{0.002}&amp;\textbf{0.010}&amp;\textbf{0.020}&amp;\textbf{0.100}&amp;\textbf{0.200}\\\hline
\textbf{0.05}&amp;&amp;&amp;913&amp;3650&amp;91235&amp;364939&amp;364939&amp;91235&amp;3650&amp;913&amp;37&amp;10\\\hline
\textbf{0.10}&amp;&amp;70&amp;1729&amp;6915&amp;172866&amp;691463&amp;691463&amp;172866&amp;6915&amp;1729&amp;70&amp;18\\\hline
\textbf{0.15}&amp;&amp;98&amp;2449&amp;9796&amp;244893&amp;979572&amp;979572&amp;244893&amp;9796&amp;2449&amp;98&amp;25\\\hline
\textbf{0.20}&amp;31&amp;123&amp;3074&amp;12293&amp;307317&amp;1229267&amp;1229267&amp;307317&amp;12293&amp;3074&amp;123&amp;31\\\hline
\textbf{0.25}&amp;37&amp;145&amp;3602&amp;14406&amp;360137&amp;1440548&amp;1440548&amp;360137&amp;14406&amp;3602&amp;145&amp;37\\\hline
\textbf{0.30}&amp;41&amp;162&amp;4034&amp;16135&amp;403354&amp;1613413&amp;1613413&amp;403354&amp;16135&amp;4034&amp;162&amp;41\\\hline
\textbf{0.35}&amp;44&amp;175&amp;4370&amp;17479&amp;436966&amp;1747864&amp;1747864&amp;436966&amp;17479&amp;4370&amp;175&amp;44\\\hline
\textbf{0.40}&amp;47&amp;185&amp;4610&amp;18440&amp;460976&amp;1843901&amp;1843901&amp;460976&amp;18440&amp;4610&amp;185&amp;47\\\hline
\textbf{0.45}&amp;48&amp;191&amp;4754&amp;19016&amp;475381&amp;1901523&amp;1901523&amp;475381&amp;19016&amp;4754&amp;191&amp;48\\\hline
\textbf{0.50}&amp;49&amp;193&amp;4802&amp;19208&amp;480183&amp;1920730&amp;1920730&amp;480183&amp;19208&amp;4802&amp;193&amp;49\\\hline
\textbf{0.55}&amp;48&amp;191&amp;4754&amp;19016&amp;475381&amp;1901523&amp;1901523&amp;475381&amp;19016&amp;4754&amp;191&amp;48\\\hline
\textbf{0.60}&amp;47&amp;185&amp;4610&amp;18440&amp;460976&amp;1843901&amp;1843901&amp;460976&amp;18440&amp;4610&amp;185&amp;47\\\hline
\textbf{0.65}&amp;44&amp;175&amp;4370&amp;17479&amp;436966&amp;1747864&amp;1747864&amp;436966&amp;17479&amp;4370&amp;175&amp;44\\\hline
\textbf{0.70}&amp;41&amp;162&amp;4034&amp;16135&amp;403354&amp;1613413&amp;1613413&amp;403354&amp;16135&amp;4034&amp;162&amp;41\\\hline
\textbf{0.75}&amp;37&amp;145&amp;3602&amp;14406&amp;360137&amp;1440548&amp;1440548&amp;360137&amp;14406&amp;3602&amp;145&amp;37\\\hline
\textbf{0.80}&amp;31&amp;123&amp;3074&amp;12293&amp;307317&amp;1229267&amp;1229267&amp;307317&amp;12293&amp;3074&amp;123&amp;31\\\hline
\textbf{0.85}&amp;25&amp;98&amp;2449&amp;9796&amp;244893&amp;979572&amp;979572&amp;244893&amp;9796&amp;2449&amp;98&amp;\\\hline
\textbf{0.90}&amp;18&amp;70&amp;1729&amp;6915&amp;172866&amp;691463&amp;691463&amp;172866&amp;6915&amp;1729&amp;70&amp;\\\hline
\textbf{0.95}&amp;10&amp;37&amp;913&amp;3650&amp;91235&amp;364939&amp;364939&amp;91235&amp;3650&amp;913&amp;&amp;\\\hline
\end{tabular}"/></p>
</div><p>Given a binomial law with parameter <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/> and a difference
<img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/>, this table gives the number of
observations needed on both sides to get a significant difference
assuming <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/> is the expected pourcentage</p>
</section>
<section id="estimate-a-p-value-by-using-the-distribution-function">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Estimate a p-value by using the distribution function</a><a class="headerlink" href="#estimate-a-p-value-by-using-the-distribution-function" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Expression <a class="reference internal" href="#equation-p-value-expression">(1)</a> gives a way to estimate the p-value.
Computing the integral is not always possible but there is a way to do it
using <a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_method">Monte Carlo method</a>.
Let’s assume <img class="math" src="../_images/math/08a962419337b7d494a46c6544e753ae8c53cd2b.svg" alt="X \sim \loinormale{0}{1}"/>. We denote <img class="math" src="../_images/math/f696aa8b745774e3457cdc878aa064c1d85322d6.svg" alt="f_X"/> as the
density function of <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/>. We also consider an interval
<img class="math" src="../_images/math/90ba82909f2c062b4b51b9831b6b7ca09d310ff9.svg" alt="I=\cro{-a,a}"/>. Then we have <img class="math" src="../_images/math/8ce271565a3261585547c880e152dc060c1db25a.svg" alt="f(a)=f(-a)"/> and:</p>
<div class="math">
<p><img src="../_images/math/f2c09289d937c32eeed5ae962152523d0597e4de.svg" alt="\begin{eqnarray*}
\pr{X \in I} = \pr{ \abs{X} \infegal a } = \pr{ f(X) \supegal f(a)}
\end{eqnarray*}"/></p>
</div><p>This is true because <img class="math" src="../_images/math/bd1e0600a66dbe0f8deddbd57953774419ba4e4f.svg" alt="f"/> is decreasing for <img class="math" src="../_images/math/7554ee702596b4b557e263f5883c5a4f1e1d1119.svg" alt="x&gt;0"/>.
The p-value <img class="math" src="../_images/math/a1e7b66a55fc77cebd91d9a1ebfa93a29c1736fb.svg" alt="\alpha"/> for a estimator <img class="math" src="../_images/math/bd898b02c226d1ce791865c51d30012165adf53d.svg" alt="\beta"/> using Monte Carlo method is:</p>
<div class="math">
<p><img src="../_images/math/1f2a8750a2b7d7a775ff1c64aaf9bd586000cf51.svg" alt="\begin{eqnarray}
\frac{1}{N}\sum_{i=1}^{N} \indicatrice{ f(X_i) &lt; f(\beta)} \longrightarrow \alpha
\end{eqnarray}"/></p>
</div><p>Assuming every <img class="math" src="../_images/math/6cba74bdce3a6f91d99d7701293b0aa6c9400f0c.svg" alt="(X_i)_i"/> follows a normal law <img class="math" src="../_images/math/405981d3eea95ba3c42d0ac77b78e4837072ba51.svg" alt="\loinormale{0}{1}"/>.</p>
</section>
<section id="correlated-variables">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Correlated variables</a><a class="headerlink" href="#correlated-variables" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Let’s assume we now have a vector a correlated variables <img class="math" src="../_images/math/392324266f555f73d7737e04d1f08f2cea45e072.svg" alt="X=(X_1,...X_d)"/>
drawn following a law <img class="math" src="../_images/math/4b107155196156aa398a182ed7db419570d0b6ac.svg" alt="\loinormale{\theta_0}{\Sigma}"/>.</p>
<p>The central limit theorem is still valid:</p>
<div class="math">
<p><img src="../_images/math/5958bc7b5676ecff6b3f449e189277f136d5804c.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{\theta_0}{\Sigma}
\end{eqnarray*}"/></p>
</div><p>We know estimators for the average and the covariance matrix defined as follows:</p>
<div class="math">
<p><img src="../_images/math/7f1e82cdbbab4f1f2193b93e94859707bfb83ed6.svg" alt="\begin{eqnarray*}
\widehat{\theta_N} &amp;=&amp; \frac{1}{n} \sum_{i=1}^{N} X_i \\
\widehat{\Sigma_N} &amp;=&amp; \frac{1}{n} \sum_{i=1}^{N} (X_i - \widehat{\theta_N})(X_i - \widehat{\theta_N})'
\end{eqnarray*}"/></p>
</div><p>We usually want to check if:</p>
<div class="math">
<p><img src="../_images/math/d0d91a5c526412fea23f1d81a3d4483f283a5589.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; \widehat{\theta}_N = \theta_0 \\
H1: &amp;&amp; \widehat{\theta}_N \neq  \theta_0
\end{eqnarray*}"/></p>
</div><p>If <img class="math" src="../_images/math/b1af3dc07c90134c73c60fe7f1e002ccaced8485.svg" alt="\Lambda"/> is diagonal matrix of <img class="math" src="../_images/math/c2c1631ee66d456484eaf1742ce908c0d4cb206d.svg" alt="\Sigma"/> (diagonal matrix with eigen values).
All eigen values are real and positive, we then define:</p>
<div class="math">
<p><img src="../_images/math/f3741f2aaa767a622ddcfee080bf0a5910b9abc3.svg" alt="\begin{eqnarray*}
\Sigma &amp;=&amp; P \Lambda P' \text { and } \Sigma^{\frac{1}{2}} =  P \Lambda^{\frac{1}{2}} P'
\end{eqnarray*}"/></p>
</div><p>We consider <img class="math" src="../_images/math/61519b9598ce428b68128dfb857fc943caf5367c.svg" alt="Z_i = (X_i - \widehat{\theta_N}) \Sigma^{-\frac{1}{2}}"/>.
We then have <img class="math" src="../_images/math/edc642f548f0a6d9e8a4e6f7def44014633a89f5.svg" alt="\esp{Z_i} = 0"/> and <img class="math" src="../_images/math/52b0ad86cf93c0110e2a0852132f0e2264f288c1.svg" alt="\var{Z_i} = I_2"/> where
<img class="math" src="../_images/math/4cd6dce13bc9092f588909348a55b2e40c471447.svg" alt="I_2"/> is the identity matrix. We could now consider each
dimension of <img class="math" src="../_images/math/f17e8c265d7e0200ae83cb0ab155527cc9338d22.svg" alt="Z_i"/> independently as illustrated in next figure:
it shows the difference on an example if we consider the correlation of
two variables correlated such as
<img class="math" src="../_images/math/27523a2a20d4880c138ab37666995651bd740259.svg" alt="\Sigma=\pa{\begin{array}{cc} 0.1 &amp; 0.05 \\ 0.05 &amp;  0.2 \end{array}}"/>.</p>
<img alt="../_images/pvaluescor.png" src="../_images/pvaluescor.png" />
<p>We assume we observe two <a class="reference external" href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernouilli</a>
variables correlated. Red points represents the area
for which we would accept hypothesis <em>H0</em> in case both variables are independant.
Blue area represents the same but with the correlation.
But that would not be the best way to do it. The confidence interval for a couple
of indenpendant gaussian <img class="math" src="../_images/math/1b90718368ea70eb40f4e2a46974acb8f9c8288c.svg" alt="(N_1,N_2)"/> variables is an ellipse.
Two independent normal variables <img class="math" src="../_images/math/6022d1125f29d9d904368f44f010eb49cfa258d5.svg" alt="N_1^2+N_2^2"/> with a null mean
and standard deviation equal to one follows a <img class="math" src="../_images/math/88916934485ceae0b8c64aa3009ae62950c7fbee.svg" alt="\chi_2"/> law. Based on that,
we can deduce a boundary for the confidence zone at 95%.
Next figure shows this zone for a non-correlated couple and a correlated couple
(<img class="math" src="../_images/math/27523a2a20d4880c138ab37666995651bd740259.svg" alt="\Sigma=\pa{\begin{array}{cc} 0.1 &amp; 0.05 \\ 0.05 &amp;  0.2 \end{array}}"/>).</p>
<img alt="../_images/pvaluescor2.png" src="../_images/pvaluescor2.png" />
<p>We assume we observe two Bernouilli variables correlated. Red points represents the area
for which we would accept hypothesis <em>H0</em> in case both variables are independant.
Blue area represents the same but with the correlation.</p>
</section>
<section id="multiple-comparisons-problem">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Multiple comparisons problem</a><a class="headerlink" href="#multiple-comparisons-problem" title="Lien permanent vers cette rubrique">#</a></h2>
<p>The problem of <a class="reference external" href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Multiple comparisons</a>
happens when dealing with many metrics measyring a change.
That’s allways the case when two version of the sam websire are compared
in a test <a class="reference external" href="https://fr.wikipedia.org/wiki/Test_A/B">A/B</a>.
The metrics are correlated but it is unlikely that all metrics
differences will be significant or not.
The <a class="reference external" href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-Bonferroni method</a>
proposes a way to define an hypthesis on the top of the existing ones.</p>
</section>
<section id="algorithm-expectation-maximization">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Algorithm Expectation-Maximization</a><a class="headerlink" href="#algorithm-expectation-maximization" title="Lien permanent vers cette rubrique">#</a></h2>
<p>We here assume there are two populations mixed defined by random variable <img class="math" src="../_images/math/2c0e77bc741b692ecdf6e85966263a89422af4c8.svg" alt="C"/>.
Let’s <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> be a mixture of two binomial laws of parameters <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>
and <img class="math" src="../_images/math/53e75bcd7eafea2c0896729a913b09b70e220d12.svg" alt="q"/>. It is for example the case for a series draws coming from two different coins.</p>
<div class="math">
<p><img src="../_images/math/cde0736f6e2d3df2522076c63ee287fcd114f3f4.svg" alt="\begin{eqnarray*}
\pr{X} &amp;=&amp;  \pr{ X | C = a} \pr{C=a} + \pr{X | X =b} \pr{C = b}
\end{eqnarray*}"/></p>
</div><p>The likelihood of a random sample <img class="math" src="../_images/math/e5d39b159c64d098f66e9caf3790115f11566ab6.svg" alt="(X_1,...X_n)"/>,
the class we do not observe are <img class="math" src="../_images/math/dcd14ebe388510cd4ee4756d2caffb156e23edd3.svg" alt="(C_1,...C_n)"/>:</p>
<div class="math">
<p><img src="../_images/math/ec0bfc9e3dd631cc15c782c2ad4c44871d335c8d.svg" alt="\begin{eqnarray*}
L(\theta) = \prod_i \cro{ p^{X_i}(1-p)^{(1-X_i)} \pi }^{1-C_i} \cro{q^{X_i}(1-q)^{(1-X_i)}  (1-\pi)  }^{C_i}
\end{eqnarray*}"/></p>
</div><p>The parameters are <img class="math" src="../_images/math/4505c21b0ccb09d4810afceb347cedf8f447500b.svg" alt="\theta=(\pi,p,q)"/>. We use an algorithm
<a class="reference external" href="https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm">Expectation-Maximization (EM)</a>
to determine the parameters.
We define at iteration <img class="math" src="../_images/math/09c7628f51842c683db31bd6826cff8cc447ece3.svg" alt="t"/>:</p>
<div class="math">
<p><img src="../_images/math/e0fc687d6d4b1ee8bdf4a5ffbb359d65bd05f965.svg" alt="\begin{eqnarray*}
w_i &amp;=&amp; \espf{C_i | X_i, \theta_t }{X_i}  \\
    &amp;=&amp; \frac{ p_t^{X_i} (1-p_t)^{1-X_i} \pi_t }
               { p_t^{X_i}(1-p_t)^{1-X_i} \pi_t + q_t^{X_i} (1-q_t)^{1-X_i} (1-\pi_t) }
\end{eqnarray*}"/></p>
</div><p>We then update the parameters:</p>
<div class="math">
<p><img src="../_images/math/abddf7e650dc4e58e71f8d7912f778f6331fc119.svg" alt="\begin{eqnarray*}
\widehat{\pi}   &amp;=&amp;  \frac{1}{n} \sum_{i = 1}^n w_i \\
\widehat{p}     &amp;=&amp;  \frac{  \sum_{i = 1}^n w_i X_i }{  \sum_{i = 1}^n w_i} \\
\widehat{q}     &amp;=&amp;  \frac{  \sum_{i = 1}^n (1-w_i) X_i }{  \sum_{i = 1}^n (1-w_i)}
\end{eqnarray*}"/></p>
</div><p>See also <a class="reference external" href="https://statisticalrecipes.blogspot.fr/2012/04/applying-em-algorithm-binomial-mixtures.html">Applying the EM Algorithm: Binomial Mixtures</a>.</p>
</section>
<section id="notebooks">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Notebooks</a><a class="headerlink" href="#notebooks" title="Lien permanent vers cette rubrique">#</a></h2>
<p>The following notebook produces the figures displayed in this document.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-table">p-value table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-values-in-2D">p-values in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-ratio">p-value ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-values-and-EM">p-values and EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-and-heavy-tail">p-value and heavy tail</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="bibliographie">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Bibliographie</a><a class="headerlink" href="#bibliographie" title="Lien permanent vers cette rubrique">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/pvalues3.pdf">p-Value and Statistical Practice</a></p></li>
<li><p><a class="reference external" href="https://rsos.royalsocietypublishing.org/content/royopensci/1/3/140216.full.pdf">An investigation of the false discovery rate and the misinterpretation of p-values</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-Bonferroni method</a></p></li>
</ul>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../notebooks/metric/roc_example.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">ROC</p>
      </div>
    </a>
    <a class="right-next"
       href="../notebooks/metric/pvalues_examples.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">p-values</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sur cette page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-p-value">Why p-value?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#significant-difference-between-samples-mean">Significant difference between samples mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-on-binomial-variables">Application on binomial variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-a-p-value-by-using-the-distribution-function">Estimate a p-value by using the distribution function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlated-variables">Correlated variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-comparisons-problem">Multiple comparisons problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm-expectation-maximization">Algorithm Expectation-Maximization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebooks">Notebooks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliographie">Bibliographie</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/c_metric/pvalues.rst">
      <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2016-2023, Xavier Dupré.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Construit avec le <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">Thème PyData Sphinx</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>