
<!DOCTYPE html>


<html lang="fr" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Classification à l’aide des plus proches voisins &#8212; Documentation mlstatpy 0.4.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f45c5ce7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=d99ca74e"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"chtml": {"displayAlign": "left"}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c_ml/kppv';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Liens entre factorisation de matrices, ACP, k-means" href="missing_values_mf.html" />
    <link rel="prev" title="Bibliographie" href="rn/rn_biblio.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Passer au contenu principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Haut de page</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Navigation dans le site">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/project_ico.png" class="logo__image only-light" alt="Documentation mlstatpy 0.4.0 - Home"/>
    <script>document.write(`<img src="../_static/project_ico.png" class="logo__image only-dark" alt="Documentation mlstatpy 0.4.0 - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_clus/index.html">
    Clustering
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Non linéaire
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index_reg_lin.html">
    Régression linéaire
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index_reg_log.html">
    Régression logistique
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_nlp/index.html">
    NLP
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../c_metric/index.html">
    Métriques
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../c_algo/index.html">
    Algorithmes
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../c_garden/index.html">
    Pérégrinations
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../i_ex.html">
    Examples
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../defthe_index.html">
    Listes des définitions et théorèmes
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../auto_examples/index.html">
    Gallery of examples
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../notebooks/index.html">
    Galleries de notebooks
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../CHANGELOGS.html">
    Change Logs
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../license.html">
    License
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Recherche</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Recherche</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="Sur cette page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_clus/index.html">
    Clustering
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Non linéaire
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index_reg_lin.html">
    Régression linéaire
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index_reg_log.html">
    Régression logistique
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_nlp/index.html">
    NLP
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_metric/index.html">
    Métriques
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_algo/index.html">
    Algorithmes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../c_garden/index.html">
    Pérégrinations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../i_ex.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../defthe_index.html">
    Listes des définitions et théorèmes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Gallery of examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notebooks/index.html">
    Galleries de notebooks
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../CHANGELOGS.html">
    Change Logs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../license.html">
    License
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Navigation de la section">
  <p class="bd-links__title" role="heading" aria-level="1">Navigation de la section</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="rn/rn.html">Réseaux de neurones</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_1_def.html">Définition des réseaux de neurones multi-couches</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_2_reg.html">La régression</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_3_clas.html">La classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_4_densite.html">Démonstration du théorème de la densité des réseaux de neurones</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_5_newton.html">Descente de gradient</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_6_apprentissage.html">Apprentissage d’un réseau de neurones</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_7_clas2.html">Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_8_prol.html">Prolongements</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_9_auto.html">Analyse en composantes principales (ACP) et Auto Encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="rn/rn_biblio.html">Bibliographie</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Classification à l’aide des plus proches voisins</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="missing_values_mf.html">Liens entre factorisation de matrices, ACP, k-means</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/ml/neural_tree.html">Un arbre de décision en réseaux de neurones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/ml/neural_tree_onnx.html">NeuralTreeNet et ONNX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/ml/neural_tree_cost.html">NeuralTreeNet et coût</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Fil d'Ariane" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Accueil">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Non linéaire</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Classificati...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="classification-a-l-aide-des-plus-proches-voisins">
<h1>Classification à l’aide des plus proches voisins<a class="headerlink" href="#classification-a-l-aide-des-plus-proches-voisins" title="Link to this heading">#</a></h1>
<p id="index-0">La figure suivante représente un problème de classification
classique. On dispose d’un nuage de points réparti en deux classes.
Un nouveau point semblable aux précédents se présente, sa classe est
inconnue. L’objectif est de lui attribuer une classe en utilisant
le fait qu’on connaît la classe d’appartenance des autres points.</p>
<img alt="../_images/classif.png" src="../_images/classif.png" />
<p>A partir d’un nuage de points pour lesquels la classe d’appartenance est connue, comment classer
un nouveau point pour lequel cette classe est inconnue ?
Une méthode simple consiste à attribuer à ce nouveau point la même
classe que le plus proche des points appartenant au nuage initial.
C’est la méthode des plus proches voisins
(ou <a class="reference external" href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">nearest neighbours</a>)
Elle est facile à implémenter mais peu utilisée car souvent très
gourmande en temps de calcul lorsque le nuage de points est conséquent.
Le premier paragraphe décrit cette méthode, les suivants cherchent à
accélérer l’algorithme selon que le nuage de points appartient à un
espace vectoriel ou non. La dernière partie présente l’algorithme
<em>LAESA</em> pour le cas où le nuage de points appartient à un
espace métrique quelconque.</p>
<section id="principe">
<h2>Principe<a class="headerlink" href="#principe" title="Link to this heading">#</a></h2>
<p>Cette méthode est la plus simple puisqu’elle consiste à associer
à <span class="math notranslate nohighlight">\(x\)</span>, l’élément à classer, le label
<span class="math notranslate nohighlight">\(c\pa{x_{i^*}}\)</span> de l’élément le plus proche
<span class="math notranslate nohighlight">\(x_{i^*}\)</span> dans l’ensemble <span class="math notranslate nohighlight">\(\vecteur{x_1}{x_N}\)</span>.
Ceci mène à l’algorithme de classification suivant :</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme0">
<span id="index-1"></span><div class="docutils container">
</div>
<p class="admonition-title" id="clas-super-1ppv-algo">Algorithme A1 : 1-PPV ou plus proche voisin</p>
<p>Soit <span class="math notranslate nohighlight">\(X = \vecteur{x_1}{x_N} \subset E\)</span> un ensemble
d’éléments d’un espace métrique quelconque,
soit <span class="math notranslate nohighlight">\(\vecteur{c\pa{x_1}}{c\pa{x_N}}\)</span> les classes
associées à chacun des éléments de <span class="math notranslate nohighlight">\(X\)</span>. On note
<span class="math notranslate nohighlight">\(d\)</span> la distance définie sur l’espace métrique
<span class="math notranslate nohighlight">\(E\)</span>. Soit <span class="math notranslate nohighlight">\(x\)</span> un élément à classer, on cherche
à déterminer la classe <span class="math notranslate nohighlight">\(\hat{c}(x)\)</span> associée à <span class="math notranslate nohighlight">\(x\)</span>.
On définit <span class="math notranslate nohighlight">\(x_{i^*}\)</span> comme étant :</p>
<div class="math notranslate nohighlight">
\[x_{i^*} = \underset{i \in \intervalle{1}{N}}{\arg \min} \; d\pa{x_i,x}\]</div>
<p>Alors <span class="math notranslate nohighlight">\(\hat{c}(x) = c\pa{x_i^*}\)</span>.</p>
</div>
<p>Cet algorithme est souvent appelé <em>1-PPV</em>
(ou <em>1-NN</em> pour Nearest Neighbors).
Il existe une version améliorée <em>k-PPV</em> qui
consiste à attribuer à <span class="math notranslate nohighlight">\(x\)</span> la classe
la plus représentée parmi ses <span class="math notranslate nohighlight">\(k\)</span> plus proches voisins.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme1">
<div class="docutils container">
</div>
<p class="admonition-title" id="clas-super-kppv-simple">Algorithme A2 : k-PPV ou k-plus proches voisins</p>
<p>Soit <span class="math notranslate nohighlight">\(X = \vecteur{x_1}{x_N} \subset E\)</span> un ensemble
d’éléments d’un espace métrique quelconque,
soit <span class="math notranslate nohighlight">\(\vecteur{c\pa{x_1}}{c\pa{x_N}}\)</span> les classes
associées à chacun des éléments de <span class="math notranslate nohighlight">\(X\)</span>. On note
<span class="math notranslate nohighlight">\(d\)</span> la distance définie sur l’espace métrique <span class="math notranslate nohighlight">\(E\)</span>.
<span class="math notranslate nohighlight">\(\omega\pa{x,y}\)</span> est une fonction strictement positive
mesurant la ressemblance entre <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\(y\)</span>.
Soit <span class="math notranslate nohighlight">\(x\)</span> un élément à classer, on cherche à déterminer la
classe <span class="math notranslate nohighlight">\(c(x)\)</span> associée à <span class="math notranslate nohighlight">\(x\)</span>.
On définit l’ensemble <span class="math notranslate nohighlight">\(S^*_k\)</span>
incluant les <span class="math notranslate nohighlight">\(k\)</span>-plus proches voisins de
<span class="math notranslate nohighlight">\(x\)</span>, cet ensemble vérifie :</p>
<div class="math notranslate nohighlight">
\[card{S^*_k} = 0 \text{ et } \underset{y \in S^*_k}{\max} \; d\pa{y,x}
\infegal \underset{y \in X - S^*_k}{\min} \; d\pa{y,x}\]</div>
<p>On calcule les occurrences <span class="math notranslate nohighlight">\(f(i)\)</span> de chaque classe
<span class="math notranslate nohighlight">\(i\)</span> dans l’ensemble <span class="math notranslate nohighlight">\(S^*_k\)</span> :</p>
<div class="math notranslate nohighlight" id="equation-class-super-kppv-contribution-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-class-super-kppv-contribution-eq" title="Link to this equation">#</a></span>\[f(i) = \sum_{y \in S^*_k} \, \omega\pa{x,y} \, \indicatrice{c(y) = i}\]</div>
<p>On assigne alors à <span class="math notranslate nohighlight">\(x\)</span> la classe <span class="math notranslate nohighlight">\(c(x)\)</span> choisie dans l’ensemble :</p>
<div class="math notranslate nohighlight">
\[\hat{c}(x) \in \underset{i \in \N}{\arg \max} \; f(i)\]</div>
</div>
<p>Dans sa version la plus simple, la fonction <span class="math notranslate nohighlight">\(\omega\pa{x,y}\)</span>
utilisée lors du calcul de la contribution <span class="math notranslate nohighlight">\(f\)</span> <a class="reference internal" href="#equation-class-super-kppv-contribution-eq">(1)</a>
est constante. Mais il est possible de lui affecter une valeur tenant
compte de la proximité entre <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\(y\)</span>.
La table suivante donne quelques exemples de contributions possibles.</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>fonction constante</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega\pa{x,y} = 1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>distance inverse</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega\pa{x,y} = \frac{1}{1 + d\pa{x,y}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>noyau</p></td>
<td><p><span class="math notranslate nohighlight">\(\omega\pa{x,y} = \exp\pa{ - d^2 \pa{x,y}}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Exemple de contribution <span class="math notranslate nohighlight">\(w\pa{x,y}\)</span> pour
l’algorithme des <a class="reference internal" href="#clas-super-kppv-simple"><span class="std std-ref">k-ppv</span></a>.
Ces fonctions sont toutes décroissantes (strictement ou non)
par rapport à la distance <span class="math notranslate nohighlight">\(d\)</span>.
L’inconvénient majeur de la méthode des plus proches voisins
est sa longueur puisqu’elle implique le calcul des distances
entre <span class="math notranslate nohighlight">\(x\)</span> et chacun des éléments de l’ensemble
<span class="math notranslate nohighlight">\(\vecteur{x_1}{x_N}\)</span>. C’est pourquoi de nombreuses
méthodes d’optimisation ont été développées afin d’accélérer ce
processus. Les deux premiers paragraphes traitent le cas où les
points <span class="math notranslate nohighlight">\(x_i\)</span> appartiennent à un espace vectoriel et ont donc
des coordonnées. Les suivant traitent le cas où les points <span class="math notranslate nohighlight">\(x_i\)</span>
n’ont pas de coordonnées et appartiennent à un espace métrique quelconque.</p>
</section>
<section id="b-tree">
<h2>B+ tree<a class="headerlink" href="#b-tree" title="Link to this heading">#</a></h2>
<p id="index-2">Ce premier algorithme <a class="reference external" href="https://en.wikipedia.org/wiki/B%2B_tree">B+ tree</a>
s’applique dans le cas réel afin d’ordonner
des nombres dans un arbre de sorte que chaque noeud ait un
père et pas plus de <span class="math notranslate nohighlight">\(n\)</span> fils.</p>
<img alt="../_images/btree.png" src="../_images/btree.png" />
<div class="admonition-mathdef admonition" id="indexmathe-Définition0">
<p class="admonition-title">Définition D1 : B+ tree</p>
<p>Soit <span class="math notranslate nohighlight">\(B_n\)</span> un <a class="reference external" href="https://en.wikipedia.org/wiki/B%2B_tree">B+ tree</a>, soit <span class="math notranslate nohighlight">\(N\)</span> un noeud de <span class="math notranslate nohighlight">\(B_n\)</span>,
il contient un vecteur <span class="math notranslate nohighlight">\(V\pa{N} = \vecteur{x_1}{x_t}\)</span>
avec <span class="math notranslate nohighlight">\(0 \infegal t \infegal n\)</span> et <span class="math notranslate nohighlight">\(x_1 &lt; ... &lt; x_t\)</span>.
Ce noeud contient aussi exactement <span class="math notranslate nohighlight">\(t-1\)</span> noeuds fils
notés <span class="math notranslate nohighlight">\(\vecteur{N_1}{N_{t-1}}\)</span>. On désigne par <span class="math notranslate nohighlight">\(D\pa{N_t}\)</span>
l’ensemble des descendants du noeud <span class="math notranslate nohighlight">\(N_t\)</span> et
<span class="math notranslate nohighlight">\(G\pa{N_t} = \acc{ V\pa{M} \sac M \in D\pa{N_t}}\)</span>.
Le noeud <span class="math notranslate nohighlight">\(N\)</span> vérifie :</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
&amp;&amp; \forall x \in G\pa{N_t}, \; x_{t} \infegal x &lt; x_{t+1} \\
&amp;&amp; \text{avec par convention } x_0 = -\infty \text{ et } x_{t+1} = + \infty
\end{eqnarray*}</div></div>
<p id="index-3">Cet arbre permet de trier une liste de nombres, c’est une
généralisation du tri <a class="reference external" href="https://fr.wikipedia.org/wiki/Tri_rapide">quicksort</a>
pour lequel <span class="math notranslate nohighlight">\(n=2\)</span>. Comme pour le tri <em>quicksort</em>, l’arbre est construit
à partir d’une série d’insertions et de cet ordre dépend la rapidité du
tri. L’espérance du coût (moyenne sur tous les permutations possibles de
<span class="math notranslate nohighlight">\(k\)</span> éléments), le coût de l’algorithme est en <span class="math notranslate nohighlight">\(O\pa{k \log_n k}\)</span>.</p>
</section>
<section id="r-tree-ou-rectangular-tree">
<h2>R-tree ou Rectangular Tree<a class="headerlink" href="#r-tree-ou-rectangular-tree" title="Link to this heading">#</a></h2>
<p id="index-4">L’arbre <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a> est l’adaptation du mécanisme du <a class="reference external" href="https://en.wikipedia.org/wiki/B%2B_tree">B+ tree</a> au cas multidimensionnel
(voir <a class="reference internal" href="#guttman1984" id="id1"><span>[Guttman1984]</span></a>). La construction de cet arbre peut se faire
de manière globale - construction de l’arbre sachant l’ensemble de points à classer -
ou de manière progressive - insertion des points dans l’arbre les uns à la suite des autres -.
Toutefois, ces méthodes sont resteintes à des espaces vectoriels.</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><img alt="../_images/rtree1.png" src="../_images/rtree1.png" />
</td>
<td><img alt="../_images/rtree2.png" src="../_images/rtree2.png" />
</td>
</tr>
</tbody>
</table>
</div>
<p>Illustration d’un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a> en deux dimensions,
figure extraite de <a class="reference internal" href="#sellis1987" id="id2"><span>[Sellis1987]</span></a>, la première image montre des rectangles
pointillés englobant d’autres rectangles en trait plein. Chaque style de trait correspond
à un niveau dans le graphe de la seconde image.</p>
<p>Il n’existe pas une seule manière de construire un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a>,
les noeuds de ces arbres suivent toujours la contrainte des
<a class="reference external" href="https://en.wikipedia.org/wiki/B%2B_tree">B+ tree</a> qui est d’avoir un père et au plus <span class="math notranslate nohighlight">\(n\)</span> fils.
Les <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a> ont la même structure que les <a class="reference external" href="https://en.wikipedia.org/wiki/B%2B_tree">B+ tree</a> ôtée de
leurs contraintes d’ordonnancement des fils. De plus, ces arbres organisent
spatialement des rectangles ou boîtes en plusieurs dimensions comme le suggère la
figure précédente. Les boîtes à organiser seront nommés les objets,
ces objets sont ensuite regroupés dans des boîtes englobantes.
Un noeud <span class="math notranslate nohighlight">\(n\)</span> d’un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a> est donc soit une feuille,
auquel cas la boîte qu’il désigne est un objet, dans ce cas, il n’a
aucun fils, soit le noeud désigne une boîte englobante <span class="math notranslate nohighlight">\(B\pa{n}\)</span>.
On désigne par <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> l’ensemble des boîtes d’un espace
vectoriel quelconque et <span class="math notranslate nohighlight">\(v\pa{b}\)</span> désigne son volume. Pour un
noeud <span class="math notranslate nohighlight">\(n\)</span> non feuille, <span class="math notranslate nohighlight">\(A\pa{n}\)</span> désigne l’ensemble
des descendants de ce noeud. <span class="math notranslate nohighlight">\(B\pa{n}\)</span> est défini par :</p>
<div class="math notranslate nohighlight">
\[B\pa{n} = \arg \min \acc{ v\pa{b} \sac b \in \mathcal{B} \text{ et } \forall n' \in A\pa{n'}, \; B\pa{n'} \subset B\pa{n} }\]</div>
<p>La recherche dans un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a> consiste à trouver tous les objets
ayant une intersection avec une autre boîte ou fenêtre <span class="math notranslate nohighlight">\(W\)</span>, soit l’ensemble <span class="math notranslate nohighlight">\(L\)</span> :</p>
<div class="math notranslate nohighlight">
\[L = \acc{ B\pa{n} \sac B\pa{n} \text{ est un objet et } B\pa{n} \cap W \neq \emptyset }\]</div>
<p>Cet ensemble est construit grâce à l’algorithme suivant :</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme2">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-algo-r-tree-search">Algorithme A3 : recherche dans un R-tree</p>
<p>Les notations sont celles utilisées dans ce paragraphe.
On désigne par <span class="math notranslate nohighlight">\(r\)</span> le noeud racine d’un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a>.
Soit <span class="math notranslate nohighlight">\(n\)</span> un noeud, on désigne par <span class="math notranslate nohighlight">\(F\pa{n}\)</span>
l’ensemble des fils de ce noeud.</p>
<p><em>initialisation</em></p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(L \longleftarrow 0\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(N \longleftarrow \acc{r}\)</span></div>
</div>
<p><em>itération</em></p>
<div class="line-block">
<div class="line">while <span class="math notranslate nohighlight">\(N \neq \emptyset\)</span></div>
<div class="line-block">
<div class="line">for n in <span class="math notranslate nohighlight">\(1..N\)</span></div>
<div class="line-block">
<div class="line">if <span class="math notranslate nohighlight">\(W \cap B\pa{n} \neq \emptyset\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(N \longleftarrow N \cup F\pa{n}\)</span></div>
<div class="line">if <span class="math notranslate nohighlight">\(B\pa{n}\)</span> est un objet</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(L \longleftarrow B\pa{n}\)</span></div>
</div>
</div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(L\)</span> est l’ensemble cherché.</p>
</div>
<p>Il reste à construire le <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a>, opération effectuée
par la répétition successive de l’algorithme suivant
permettant d’insérer un objet dans un <a class="reference external" href="https://en.wikipedia.org/wiki/R-tree">R-tree</a>.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme3">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-algo-r-tree-insert">Algorithme A4 : insertion d’un objet dans un R-tree</p>
<p>Les notations utilisées sont les mêmes que celles de
l’algorithme de <a class="reference internal" href="#space-metric-algo-r-tree-search"><span class="std std-ref">recherche</span></a>.
On cherche à insérer l’object <span class="math notranslate nohighlight">\(E\)</span> désigné par son noeud
feuille <span class="math notranslate nohighlight">\(e\)</span>. On suppose que l’arbre contient au
moins un noeud, sa racine <span class="math notranslate nohighlight">\(r\)</span>. On désigne également
par <span class="math notranslate nohighlight">\(p\pa{n}\)</span> le père du noeud <span class="math notranslate nohighlight">\(n\)</span>. Chaque noeud
ne peut contenir plus de <span class="math notranslate nohighlight">\(s\)</span> fils. On désigne par
<span class="math notranslate nohighlight">\(v^*\pa{G} = \min \acc{ P \sac P \in \mathcal{B} \text{ et } \cup_{g \in G} B\pa{g}  \subset P }\)</span>.</p>
<p><em>sélection du noeud d’insertion</em></p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(n^* \longleftarrow r\)</span></div>
<div class="line">tant que <span class="math notranslate nohighlight">\(n^*\)</span> n’est pas un noeud feuille</div>
<div class="line-block">
<div class="line">On choisit le fils <span class="math notranslate nohighlight">\(f\)</span> de <span class="math notranslate nohighlight">\(n^*\)</span></div>
<div class="line">qui minimise l’accroissement <span class="math notranslate nohighlight">\(v_f - v\pa{B\pa{f}}\)</span></div>
<div class="line">du volume avec <span class="math notranslate nohighlight">\(v_f\)</span> défini par :</div>
<div class="line"><span class="math notranslate nohighlight">\(v_f = \min \acc{ v\pa{P} \sac P \in \mathcal{B} \text{ et } B\pa{f} \cup B\pa{e}  \subset P }\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(n^* \longleftarrow f\)</span></div>
</div>
</div>
<p><em>ajout du noeud</em></p>
<p>Si <span class="math notranslate nohighlight">\(p\pa{n^*}\)</span> a moins de <span class="math notranslate nohighlight">\(s\)</span> fils, alors le
noeud <span class="math notranslate nohighlight">\(e\)</span> devient le fils de <span class="math notranslate nohighlight">\(p\pa{n^*}\)</span>
et <span class="math notranslate nohighlight">\(B\pa{p\pa{n^*}}\)</span> est mis à jour d’après l’étape précédente.
L’insertion est terminée. Dans le cas contraire, on sépare découpe le
noeud <span class="math notranslate nohighlight">\(p\pa{n^*}\)</span> en deux grâce à l’étape suivante.</p>
<p><em>découpage des noeuds</em></p>
<p>L’objectif est de diviser le groupe <span class="math notranslate nohighlight">\(G\)</span> composé de
<span class="math notranslate nohighlight">\(s+1\)</span> noeuds en deux groupes <span class="math notranslate nohighlight">\(G_1\)</span> et <span class="math notranslate nohighlight">\(G_1\)</span>.
Tout d’abord, on cherche le couple <span class="math notranslate nohighlight">\(\pa{n_1,n_2}\)</span> qui minimise
le critère <span class="math notranslate nohighlight">\(d = v^*\pa{\acc{n_1,n_2}} - v\pa{B\pa{n_1}} - v\pa{B\pa{n_2}}\)</span>
alors : <span class="math notranslate nohighlight">\(G_1 \longleftarrow n_1\)</span>, <span class="math notranslate nohighlight">\(G_2 \longleftarrow n_2\)</span> et
<span class="math notranslate nohighlight">\(G \longleftarrow G - G_1 \cup G_2\)</span></p>
<div class="line-block">
<div class="line">tant que <span class="math notranslate nohighlight">\(G \neq \emptyset\)</span></div>
<div class="line-block">
<div class="line">On choisit un noeud <span class="math notranslate nohighlight">\(n \in G\)</span>, on détermine <span class="math notranslate nohighlight">\(i^*\)</span></div>
<div class="line">tel que <span class="math notranslate nohighlight">\(v\pa{\acc{n} \cup G_i} - v\pa{G_i}\)</span> soit minimal.</div>
<div class="line"><span class="math notranslate nohighlight">\(G \longleftarrow G - \acc{n}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(G_{i^*} \longleftarrow G_{i^*} \cup \acc{n}\)</span></div>
</div>
</div>
</div>
<p>Si la recherche est identique quel que soit l’arbre construit,
chaque variante de la construction de l’arbre tente de minimiser
les intersections des boîtes et leur couverture. Plus précisément,
l’étape qui permet de découper les noeuds est conçue de manière à obtenir
des boîtes englobantes de volume minimale et/ou d’intersection minimale
avec d’autres boîtes englobantes. L’algorithme R+~Tree (voir <a class="reference internal" href="#sellis1987" id="id3"><span>[Sellis1987]</span></a>)
essaye de minimiser les intersections entre boîtes et les objets à
organiser sont supposés n’avoir aucune intersection commune.
La variante <a class="reference external" href="https://en.wikipedia.org/wiki/R*_tree">R* tree</a> (voir <a class="reference internal" href="#beckmann1990" id="id4"><span>[Beckmann1990]</span></a>) effectue un compromis
entre l’intersection et la couverture des boîtes englobantes.
L’algorithme <a class="reference external" href="https://en.wikipedia.org/wiki/X-tree">X-tree</a> (voir <a class="reference internal" href="#berchtold1996" id="id5"><span>[Berchtold1996]</span></a>) conserve
l’historique de la construction de l’arbre ce qui lui
permet de mieux éviter les intersections communes entre boîtes.
Ces techniques appartiennent à une classe plus larges d’algorithmes
de type <a class="reference external" href="https://en.wikipedia.org/wiki/Branch_and_bound">Branch and Bound</a>.</p>
</section>
<section id="laesa">
<h2>LAESA<a class="headerlink" href="#laesa" title="Link to this heading">#</a></h2>
<p id="index-5">Cet algorithme permet de chercher les plus proches voisins
dans un ensemble inclus dans un espace métrique quelconque.
Il s’appuie sur l’inégalité triangulaire. L’algorithme <a class="reference external" href="https://tavianator.com/aesa/">LAESA</a>
ou <em>Linear Approximating Eliminating Search Algorithm</em>,
(voir <a class="reference internal" href="#rico-juan2003" id="id6"><span>[Rico-Juan2003]</span></a>) consiste à éviter un trop grand nombre
de calculs de distances en se servant de distances déjà calculées
entre les éléments de <span class="math notranslate nohighlight">\(E\)</span> et un sous-ensemble <span class="math notranslate nohighlight">\(B\)</span>
inclus dans <span class="math notranslate nohighlight">\(E\)</span> contenant des <em>pivots</em>. La sélection des pivots
peut être aléatoire ou plus élaborée comme celle effectuée par
l’algorithme qui suit, décrit dans l’article <a class="reference internal" href="#moreno2003" id="id7"><span>[Moreno2003]</span></a>.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme4">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-algo-laesa-pivtos-sel">Algorithme A5 : LAESA : sélection des pivots</p>
<p>Soit <span class="math notranslate nohighlight">\(E = \ensemble{y_1}{y_N}\)</span> un ensemble de
points, on cherche à déterminer un sous-ensemble de pivots
<span class="math notranslate nohighlight">\(B = \ensemble{p_1}{p_P} \subset E\)</span>.</p>
<p><em>initialisation</em></p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(B \longleftarrow y \in E\)</span> choisi arbitrairement.</div>
</div>
<p><em>calcul de la fonction</em> <span class="math notranslate nohighlight">\(g\)</span></p>
<div class="line-block">
<div class="line">for y in <span class="math notranslate nohighlight">\(E - B\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(g\pa{y} \longleftarrow 0\)</span></div>
<div class="line">for p in <span class="math notranslate nohighlight">\(B\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(g\pa{y} \longleftarrow g\pa{y} + d\pa{y,p}\)</span></div>
</div>
</div>
</div>
<p><em>mise à jour de</em> <span class="math notranslate nohighlight">\(B\)</span></p>
<div class="line-block">
<div class="line">Trouver <span class="math notranslate nohighlight">\(p^* \in \arg \max \acc { g\pa{p} \sac p \in E - B}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(B \longleftarrow B \cup \acc{ p^*}\)</span></div>
<div class="line">Si <span class="math notranslate nohighlight">\(card{B} &lt; P\)</span>, retour à l’étape précédente sinon fin.</div>
</div>
</div>
<p>L’algorithme <a class="reference external" href="https://tavianator.com/aesa/">LAESA</a> utilise les pivots pour diminuer
le nombre de calculs en utilisant l’inégalité triangulaire.
Par exemple, soit <span class="math notranslate nohighlight">\(x\)</span> un élément à classer, <span class="math notranslate nohighlight">\(p_j\)</span>
un pivot, <span class="math notranslate nohighlight">\(y_i\)</span> un point du nuage. On suppose qu’on connaît
<span class="math notranslate nohighlight">\(d\pa{x,p_j}\)</span>, <span class="math notranslate nohighlight">\(d\pa{p_j,y_i}\)</span> et <span class="math notranslate nohighlight">\(d^*\)</span> la distance
du point <span class="math notranslate nohighlight">\(x\)</span> à un autre point du nuage. L’inégalité triangulaire
permet d’affirmer que si : <span class="math notranslate nohighlight">\(d\pa{x,y_i} \supegal \abs{ d\pa{x,p_j} - d\pa{p_j,y_i}} &gt; d^*\)</span>,
alors il n’est pas nécessaire de calculer la distance <span class="math notranslate nohighlight">\(d\pa{x,y_i}\)</span>
pour affirmer que <span class="math notranslate nohighlight">\(d\pa{x,y_i} &gt; d^*\)</span>. L’élément <span class="math notranslate nohighlight">\(y_i\)</span>
ne peut être l’élément le plus proche.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme5">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-algo-laesa-prime">Algorithme A6 : LAESA</p>
<p>Soit <span class="math notranslate nohighlight">\(E = \ensemble{y_1}{y_N}\)</span> un ensemble de points,
<span class="math notranslate nohighlight">\(B = \ensemble{p_1}{p_P} \subset E\)</span>
un ensemble de pivots inclus dans <span class="math notranslate nohighlight">\(E\)</span>.
On cherche à déterminer le voisinage <span class="math notranslate nohighlight">\(V\pa{x}\)</span> de <span class="math notranslate nohighlight">\(x\)</span>
inclus dans <span class="math notranslate nohighlight">\(E\)</span> vérifiant :</p>
<div class="math notranslate nohighlight">
\[\forall y \in V\pa{x}, \; d\pa{x,y} \infegal \rho\]</div>
<p>On suppose que la matrice
<span class="math notranslate nohighlight">\(M = \pa{m_{ij}}_{ \begin{subarray} 1 \infegal i \infegal P \\ 1 \infegal j \infegal N \end{subarray} }\)</span>
a été calculée préalablement comme suit :</p>
<div class="math notranslate nohighlight">
\[\forall \pa{i,j}, \; m_{ij} = d\pa{p_i, y_j}\]</div>
<p><em>initialisation</em></p>
<div class="line-block">
<div class="line">for i in <span class="math notranslate nohighlight">\(1..P\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(d_i \longleftarrow d\pa{x, p_i}\)</span></div>
</div>
<div class="line"><span class="math notranslate nohighlight">\(d^* \longleftarrow  \min \acc{ d_i \sac 1 \infegal i \infegal P }\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(d^*\)</span> est la distance du point <span class="math notranslate nohighlight">\(x\)</span> au pivot le plus proche.</div>
</div>
<p><em>recherche du plus proche élément</em></p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(S \longleftarrow \emptyset\)</span></div>
<div class="line">for i in <span class="math notranslate nohighlight">\(1..N\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(d' \longleftarrow \max \acc{ \abs{ d_j - m_{ji} } }\)</span></div>
<div class="line">if <span class="math notranslate nohighlight">\(d' &lt; d^*\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(d \longleftarrow d\pa{x,y_i}\)</span></div>
<div class="line">if <span class="math notranslate nohighlight">\(d' \infegal d^*\)</span></div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(d^* \longleftarrow d'\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(S \longleftarrow \acc{y_i}\)</span></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="resultats-theoriques">
<h2>Résultats théoriques<a class="headerlink" href="#resultats-theoriques" title="Link to this heading">#</a></h2>
<p>L’article <a class="reference internal" href="#farago1993" id="id8"><span>[Farago1993]</span></a> démontre également qu’il existe une
majoration du nombre moyen de calcul de distances pour peu
que la mesure de l’espace contenant l’ensemble <span class="math notranslate nohighlight">\(E\)</span>
et l’élément <span class="math notranslate nohighlight">\(x\)</span> soit connue et que l’ensemble
<span class="math notranslate nohighlight">\(B = \ensemble{p_1}{p_P}\)</span> des pivots vérifie :</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
\exists \pa{\alpha,\beta} \in \R^+_* \text{ tels que } &amp;&amp; \nonumber\\
\forall \pa{x,y} \in E^2, \; \forall i\, &amp;&amp; \alpha \, d\pa{x,y} \supegal
                \abs{d\pa{x,p_i} - d\pa{p_i,y}} \label{space_metric_cond_1} \\
\forall \pa{x,y} \in E^2, &amp;&amp; \underset{i}{\max} \; \abs{d\pa{x,p_i} - d\pa{p_i,y}} \supegal
                \beta \, d\pa{x,y} \label{space_metric_cond_1}
\end{eqnarray*}</div><p>L’algorithme développé dans <a class="reference internal" href="#farago1993" id="id9"><span>[Farago1993]</span></a> permet de trouver
le point de plus proche d’un élément <span class="math notranslate nohighlight">\(x\)</span> dans un
ensemble <span class="math notranslate nohighlight">\(E = \ensemble{x_1}{x_N}\)</span> selon l’algorithme suivant :</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme6">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-algo-farago">Algorithme A7 : plus proche voisin d’après [Farago1993]_</p>
<p>Soit <span class="math notranslate nohighlight">\(E = \ensemble{x_1}{x_N}\)</span> et
<span class="math notranslate nohighlight">\(B = \ensemble{p_1}{p_P} \subset E \subset X\)</span>.
Soit <span class="math notranslate nohighlight">\(x \in X\)</span>, un élément quelconque.
On suppose que les valeurs <span class="math notranslate nohighlight">\(m_{ij} = d\pa{x_i, p_j}\)</span>
ont été préalablement calculées.</p>
<p><em>initialisation</em></p>
<p>On calcule préalablement les coefficients
<span class="math notranslate nohighlight">\(\gamma\pa{x_i}\)</span> :</p>
<div class="math notranslate nohighlight">
\[\forall i \in \ensemble{1}{N}, \; \gamma\pa{x_i} \longleftarrow
\underset{j \in \ensemble{1}{P} } {\max} \; \abs{ m_{ij} - d\pa{x,p_j} }\]</div>
<p><em>élaguage</em></p>
<p>On définit <span class="math notranslate nohighlight">\(t_0 \longleftarrow \underset{i} {\min} \; \gamma\pa{x_i}\)</span>.
Puis on construit l’ensemble
<span class="math notranslate nohighlight">\(F\pa{x} = \acc{ x_i \in E \sac \gamma\pa{x_i} }\infegal \frac{\alpha}{\beta} \, t_0\)</span>.</p>
<p><em>plus proche voisin</em></p>
<p>Le plus proche <span class="math notranslate nohighlight">\(x^*\)</span> voisin est défini par :
<span class="math notranslate nohighlight">\(x^* \in \arg \min \acc{ d\pa{x,y} \sac y \in F\pa{x}}\)</span>.</p>
</div>
<p>Et un petit théorème.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Théorème0">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-farago-1">Théorème T1 : [Farago1993]_ 1</p>
<p>Les notations sont celles de l’algorithme précédent.
Il retourne le plus proche voisin <span class="math notranslate nohighlight">\(x^*\)</span> de
<span class="math notranslate nohighlight">\(x\)</span> inclus dans <span class="math notranslate nohighlight">\(E\)</span>.
Autrement dit, <span class="math notranslate nohighlight">\(\forall x \in X, \; x^* \in F\pa{x}\)</span>.</p>
</div>
<div class="admonition-mathdef admonition" id="indexmathe-Théorème1">
<div class="docutils container">
</div>
<p class="admonition-title" id="space-metric-farago-2">Théorème T2 : [Farago1993]_ 2</p>
<p>Les notations sont celles du même algorithme.
On définit une mesure sur l’ensemble <span class="math notranslate nohighlight">\(X\)</span>,
<span class="math notranslate nohighlight">\(B\pa{x,r}\)</span> désigne la boule de centre
<span class="math notranslate nohighlight">\(x\)</span> et de rayon <span class="math notranslate nohighlight">\(r\)</span>,
<span class="math notranslate nohighlight">\(Z \in X\)</span> une variable  aléatoire, de plus :</p>
<div class="math notranslate nohighlight">
\[p\pa{x,r} = P_X \pa{B\pa{x,r}} = \pr{  Z \in B\pa{x,r}}\]</div>
<p>On suppose qu’il existe <span class="math notranslate nohighlight">\(d &gt; 0\)</span> et une fonction <span class="math notranslate nohighlight">\(f : X \longrightarrow \R\)</span>
tels que :</p>
<div class="math notranslate nohighlight">
\[\underset { r \rightarrow 0 } { \lim } \; \frac{ p\pa{x,r} } { r^d } = f\pa{x} &gt; 0\]</div>
<p>La convergence doit être uniforme et presque sûre.
On note également <span class="math notranslate nohighlight">\(F_N\)</span> le nombre de calculs de
dissimilarité effectués par l’algorithme
où <span class="math notranslate nohighlight">\(N\)</span> est le nombre d’élément de <span class="math notranslate nohighlight">\(E\)</span>,
<span class="math notranslate nohighlight">\(P\)</span> désigne toujours le nombre de pivots, alors :</p>
<div class="math notranslate nohighlight">
\[\underset{ n \rightarrow \infty } { \lim \sup } \; \esp{F_N} \infegal k + \pa{\frac{\alpha}{\beta}}^{2d}\]</div>
</div>
</section>
<section id="implementation">
<h2>Implémentation<a class="headerlink" href="#implementation" title="Link to this heading">#</a></h2>
<p>La classe <a class="reference internal" href="../api/modules/kppv.html#mlstatpy.ml.kppv.NuagePoints" title="mlstatpy.ml.kppv.NuagePoints"><code class="xref py py-class docutils literal notranslate"><span class="pre">NuagePoints</span></code></a> implémente
les nuages de points sans optimisation. Il utilise la même interface que
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="(disponible dans scikit-learn v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.NearestNeighbors</span></code></a>. La second classe
<a class="reference internal" href="../api/modules/kppv_laesa.html#mlstatpy.ml.kppv_laesa.NuagePointsLaesa" title="mlstatpy.ml.kppv_laesa.NuagePointsLaesa"><code class="xref py py-class docutils literal notranslate"><span class="pre">NuagePointsLaesa</span></code></a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlstatpy.ml.kppv_laesa</span> <span class="kn">import</span> <span class="n">NuagePointsLaesa</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">nuage</span> <span class="o">=</span> <span class="n">NuagePointsLaesa</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nuage</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dist</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">nuage</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;indices&quot;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">distance</span> <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
    <span class="n">indices</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="bilbiographie">
<h2>Bilbiographie<a class="headerlink" href="#bilbiographie" title="Link to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="beckmann1990" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Beckmann1990</a><span class="fn-bracket">]</span></span>
<p>The R$^*$-tree: an efficient and robust access method for points and rectangles,
N. Beckmann, H. P. Kriegel, P. Schneider, B. Seeger,
Proceedings of SIGMOD conference, Atlantic City, pages 322-331</p>
</div>
<div class="citation" id="berchtold1996" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">Berchtold1996</a><span class="fn-bracket">]</span></span>
<p>The X-Tree: An index structure for high dimension data,
S. Berchtold, D. A. Keim, H. P. Kriegel,
Proceedings of the 22nd Internation Conference on Very Large Databases, Bombay, India</p>
</div>
<div class="citation" id="farago1993" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Farago1993<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id8">1</a>,<a role="doc-backlink" href="#id9">2</a>)</span>
<p>Fast Nearest-Neighbor Search in Dissimilarity Spaces,
A. Farago, T. Linder, G. Lugosi,
IEEE Transactions on Pattern Analysis and Machine Intelligence, volume 15(9), pages 957-962</p>
</div>
<div class="citation" id="guttman1984" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Guttman1984</a><span class="fn-bracket">]</span></span>
<p>R-Trees: A Dynamic Index Structure for Spatial Searching,
A. Guttman, Proceedings ACM SIGMOD, pages 47-57</p>
</div>
<div class="citation" id="moreno2003" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">Moreno2003</a><span class="fn-bracket">]</span></span>
<p>A modification of the LAESA algorithm for approximated k-NN classification,
Francisco Moreno-Seco, Luisa Mico, Jose Oncina,
Pattern Recognition Letters, volumne 24, pages 47-53</p>
</div>
<div class="citation" id="rico-juan2003" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">Rico-Juan2003</a><span class="fn-bracket">]</span></span>
<p>Comparison of AESA and LAESA search algorithms using string and tree-edit-distances,
J. R. Rico-Juan, L. Mico,
Pattern Recognition Letters, volume 24, pages 1417-1426</p>
</div>
<div class="citation" id="sellis1987" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Sellis1987<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>The R+tree - a Dynamic Index for Multi-Dimensional Objects,
T. Sellis, N. Roussopoulos, C. Faloutos,
Proceedings of the 13th VLDB conference, pages 507-518</p>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="rn/rn_biblio.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">Bibliographie</p>
      </div>
    </a>
    <a class="right-next"
       href="missing_values_mf.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Liens entre factorisation de matrices, ACP, k-means</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sur cette page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principe">Principe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-tree">B+ tree</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#r-tree-ou-rectangular-tree">R-tree ou Rectangular Tree</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#laesa">LAESA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultats-theoriques">Résultats théoriques</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implémentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bilbiographie">Bilbiographie</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/c_ml/kppv.rst">
      <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2016-2024, Xavier Dupré.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Construit avec le <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">Thème PyData Sphinx</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>