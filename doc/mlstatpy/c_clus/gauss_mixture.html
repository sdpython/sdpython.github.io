
<!DOCTYPE html>


<html lang="fr" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mélange de lois normales &#8212; Documentation mlstatpy 0.4.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c_clus/gauss_mixture';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Carte de Kohonen" href="kohonen.html" />
    <link rel="prev" title="k-means" href="kmeans.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Passer au contenu principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/project_ico.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/project_ico.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Clustering
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index.html">
                        Non linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_lin.html">
                        Régression linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_log.html">
                        Régression logistique
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_nlp/index.html">
                        NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_metric/index.html">
                        Métriques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_algo/index.html">
                        Algorithmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_garden/index.html">
                        Pérégrinations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Listes des définitions et théorèmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Gallery of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/index.html">
                        Galleries de notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Navigation du site">
    Navigation du site
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Clustering
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index.html">
                        Non linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_lin.html">
                        Régression linéaire
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_ml/index_reg_log.html">
                        Régression logistique
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_nlp/index.html">
                        NLP
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_metric/index.html">
                        Métriques
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_algo/index.html">
                        Algorithmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../c_garden/index.html">
                        Pérégrinations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../i_ex.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../defthe_index.html">
                        Listes des définitions et théorèmes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../auto_examples/index.html">
                        Gallery of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/index.html">
                        Galleries de notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../CHANGELOGS.html">
                        Change Logs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../license.html">
                        License
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Navigation de la section">
  <p class="bd-links__title" role="heading" aria-level="1">Navigation de la section</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="kmeans.html">k-means</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mélange de lois normales</a></li>
<li class="toctree-l1"><a class="reference internal" href="kohonen.html">Carte de Kohonen</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Fils d'Ariane">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Fil d'Ariane">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Acceuil">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Clustering</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Mélange de lois normales</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="melange-de-lois-normales">
<span id="classification-melange-loi-normale"></span><h1>Mélange de lois normales<a class="headerlink" href="#melange-de-lois-normales" title="Lien permanent vers cette rubrique">#</a></h1>
<nav class="contents local" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#algorithme-em" id="id9">Algorithme EM</a></p></li>
<li><p><a class="reference internal" href="#competitive-em-algorithm" id="id10">Competitive EM algorithm</a></p></li>
<li><p><a class="reference internal" href="#bibliographie" id="id11">Bibliographie</a></p></li>
</ul>
</nav>
<section id="algorithme-em">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Algorithme EM</a><a class="headerlink" href="#algorithme-em" title="Lien permanent vers cette rubrique">#</a></h2>
<div class="admonition-mathdef admonition" id="indexmathe-Définition0">
<p class="admonition-title">Définition D1 : mélange de lois normales</p>
<p>Soit <span class="math notranslate nohighlight">\(X\)</span> une variable aléatoire d’un espace vectoriel de dimension <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(X\)</span>
suit un la loi d’un mélange de <span class="math notranslate nohighlight">\(N\)</span> lois gaussiennes de paramètres
<span class="math notranslate nohighlight">\(\pa{\mu_i, \Sigma_i}_ {1 \infegal i \infegal N}\)</span>,
alors la densité <span class="math notranslate nohighlight">\(f\)</span> de <span class="math notranslate nohighlight">\(X\)</span> est de la forme :</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
f\pa{x} &amp;=&amp;  \sum_{i=1}^{N} \; p_i \; \dfrac{1}{\pa{2 \pi}^{\frac{d}{2}}\sqrt{\det \Sigma_i}} \;
exp \pa{-\frac{1}{2}  \pa{x-\mu_i}' \Sigma_i^{-1} \pa{x-\mu_i} } \\
\end{eqnarray}</div><p>Avec : <span class="math notranslate nohighlight">\(\sum_{i=1}^{N} \; p_i = 1\)</span>.</p>
</div>
<p>Dans le cas d’une loi normale à valeur réelle
<span class="math notranslate nohighlight">\(\Sigma = \sigma^2\)</span>, l’algorithme permet d’estimer la loi de
l’échantillon <span class="math notranslate nohighlight">\(\vecteur{X_1}{X_T}\)</span>, il s’effectue en plusieurs itérations,
les paramètres <span class="math notranslate nohighlight">\(p_i\pa{0}\)</span>, <span class="math notranslate nohighlight">\(\mu_i\pa{0}\)</span>,
<span class="math notranslate nohighlight">\(\sigma^2\pa{0}\)</span> sont choisis de manière aléatoire,
à l’itération <span class="math notranslate nohighlight">\(t+1\)</span>, la mise à jour des coefficients est faite comme suit :</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
f_{k,i}\pa{t} &amp;=&amp;  p_i \pa{t} \; \dfrac{1}{\pa{2 \pi}^{\frac{d}{2}}\sqrt{\det \Sigma_i\pa{t}}} \;
\exp \pa{-\frac{1}{2}  \pa{X_k-\mu_i\pa{t}}' \Sigma_i^{-1}\pa{t} \pa{X_k-\mu_i\pa{t}} } \\
\overline{f_{k,i}}\pa{t} &amp;=&amp; \frac{ f_{k,i}\pa{t} } { \sum_{i} \, f_{k,i}\pa{t} } \\
p_i\pa{t+1} &amp;=&amp;  \frac{1}{T} \;  \sum_{k=1}^{T} \; \overline{f_{k,i}}\pa{t} \\
\mu_i\pa{t+1} &amp;=&amp; \cro{ \sum_{k=1}^{T} \; \overline{f_{k,i}}\pa{t} }^{-1}
\; \sum_{k=1}^{T} \overline{f_{k,i}}\pa{t} X_k  \\
\Sigma^2_i\pa{t+1} &amp;=&amp;   \cro{ \sum_{k=1}^{T} \; \overline{f_{k,i}}\pa{t} }^{-1}
\; \sum_{k=1}^{T} \overline{f_{k,i}}\pa{t} \,
\pa{ X_k  - \mu_i\pa{t+1}} \pa{ X_k  - \mu_i\pa{t+1}}'
\end{eqnarray}</div><p>L’estimation d’une telle densité s’effectue par l’intermédiaire
d’un algorithme de type <a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_esp%C3%A9rance-maximisation">Expectation Maximization (EM)</a>
(voir <a class="reference internal" href="#dempster1977" id="id1"><span>[Dempster1977]</span></a>) ou de ses variantes
<a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_esp%C3%A9rance-maximisation#Algorithme_SEM">SEM</a>,
<a class="reference external" href="http://wiki.webpopix.org/index.php/The_SAEM_algorithm_for_estimating_population_parameters">SAEM</a>, …
(voir <a class="reference internal" href="#celeux1985" id="id2"><span>[Celeux1985]</span></a>, <a class="reference internal" href="#celeux1985b" id="id3"><span>[Celeux1985b]</span></a>).
La sélection du nombre de lois dans le mélange reste un
problème ouvert abordé par l’article <a class="reference internal" href="#biernacki2001" id="id4"><span>[Biernacki2001]</span></a>.</p>
</section>
<section id="competitive-em-algorithm">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Competitive EM algorithm</a><a class="headerlink" href="#competitive-em-algorithm" title="Lien permanent vers cette rubrique">#</a></h2>
<p>L’algorithme développé dans l’article <a class="reference internal" href="#zhangb2004" id="id5"><span>[ZhangB2004]</span></a>
tente de corriger les défauts de l’algorithme EM.
Cette nouvelle version appelée « Competitive EM » ou CEM s’applique à
un mélange de lois - normales en particulier -,
il détermine le nombre de classes optimal en supprimant ou en ajoutant des classes.</p>
<table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="../_images/zhangc1.png" src="../_images/zhangc1.png" />
</td>
<td><img alt="../_images/zhangc2.png" src="../_images/zhangc2.png" />
</td>
<td><img alt="../_images/zhangc3.png" src="../_images/zhangc3.png" />
</td>
</tr>
</tbody>
</table>
<p>Figures extraites de <a class="reference internal" href="#zhangb2004" id="id6"><span>[ZhangB2004]</span></a>, la première image montre deux classes
incluant deux autres classes qui devrait donc être supprimées. La seconde image
montre une classe aberrante tandis que la troisième image montre des classes
se recouvrant partiellement.</p>
<p>On considère un échantillon de variables aléatoires indépendantes et
identiquement distribuées à valeur dans un espace vectoriel de
dimension <span class="math notranslate nohighlight">\(d\)</span>. Soit <span class="math notranslate nohighlight">\(X\)</span> une telle variable,
on suppose que <span class="math notranslate nohighlight">\(X\)</span> suit la loi du mélange suivant :</p>
<div class="math notranslate nohighlight">
\[f\pa{X \sac \theta} = \sum_{i=1}^{k}  \alpha_i \, f\pa{X \sac \theta_i}\]</div>
<p>Avec : <span class="math notranslate nohighlight">\(\theta = \pa{\alpha_i,\theta_i}_{1 \infegal i \infegal k}, \; \forall i, \; \alpha_i \supegal 0\)</span>
et <span class="math notranslate nohighlight">\(\sum_{i=1}^{k} \alpha_i = 1\)</span>.</p>
<p>On définit pour une classe <span class="math notranslate nohighlight">\(m\)</span> la probabilité
<span class="math notranslate nohighlight">\(P_{split}(m, \theta)\)</span> qu’elle doive être divisée
et celle qu’elle doive être associée à une autre
<span class="math notranslate nohighlight">\(P_{merge}(m,l, \theta)\)</span>.
Celles ci sont définies comme suit :</p>
<div class="math notranslate nohighlight" id="equation-eq-split-merge">
\begin{eqnarray}
P_{split}(m, \theta) &amp;=&amp;  \frac{J\pa{m,\theta}}{Z\pa{\theta}} \\
P_{merge}(m,l, \theta) &amp;=&amp;  \frac{\beta}{J\pa{m,\theta}Z\pa{\theta}}
\end{eqnarray}</div><p><span class="math notranslate nohighlight">\(\beta\)</span> est une constante définie par expériences.
<span class="math notranslate nohighlight">\(J\pa{m,\theta}\)</span> est défini pour l’échantillon <span class="math notranslate nohighlight">\(\vecteur{x_1}{x_n}\)</span> par :</p>
<div class="math notranslate nohighlight">
\[J\pa{m,\theta} = \int f_m\pa{x,\theta} \; \log \frac{f_m\pa{x,\theta}}{p_m\pa{x,\theta_m}} \, dx\]</div>
<p>Où : <span class="math notranslate nohighlight">\(f_m\pa{x,\theta} = \frac{ \sum_{i=1}^{n} \, \indicatrice{x = x_i} \, \pr{ m \sac x_i,\theta} }
{ \sum_{i=1}^{n} \, \pr{ m \sac x_i,\theta}}\)</span>.</p>
<p>La constante <span class="math notranslate nohighlight">\(Z\pa{\theta}\)</span> est choisie de telle sorte que les
probabilités <span class="math notranslate nohighlight">\(P_{split}(m, \theta)\)</span> et
<span class="math notranslate nohighlight">\(P_{merge}(m,l, \theta)\)</span> vérifient :</p>
<div class="math notranslate nohighlight">
\[\sum_{m=1}^{k} \, P_{split}(m, \theta) + \sum_{m=1}^{k} \, \sum_{l=m+1}^{k} \, P_{merge}(m,l, \theta) = 1\]</div>
<p>L’algorithme EM permet de construire une suite
<span class="math notranslate nohighlight">\(\hat{\theta_t}\)</span> maximisant la vraisemblance à partir de poids <span class="math notranslate nohighlight">\(\hat{\theta_0}\)</span>.
L’algorithme <a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_esp%C3%A9rance-maximisation#Algorithme_CEM">CEM</a>
est dérivé de l’algorithme EM :</p>
<div class="admonition-mathdef admonition" id="indexmathe-Algorithme0">
<p class="admonition-title">Algorithme A1 : CEM</p>
<p>Les notations sont celles utilisées dans les paragraphes précédents.
On suppose que la variable
aléatoire <span class="math notranslate nohighlight">\(Z=\pa{X,Y}\)</span> où <span class="math notranslate nohighlight">\(X\)</span> est la variable
observée et <span class="math notranslate nohighlight">\(Y\)</span> la variable cachée. <span class="math notranslate nohighlight">\(T\)</span> désigne
le nombre maximal d’itérations.</p>
<p><em>initialisation</em></p>
<p>Choix arbitraire de <span class="math notranslate nohighlight">\(k\)</span> et <span class="math notranslate nohighlight">\(\hat{\theta}_0\)</span>.</p>
<p><em>Expectation</em></p>
<div class="math notranslate nohighlight">
\[Q\pa{\theta,\hat{\theta}_t } = \esp{ \pa{\log \cro{ f\pa{ X,Y \sac \theta }} \sac X, \hat{\theta}_t }}\]</div>
<p><em>Maximization</em></p>
<div class="math notranslate nohighlight">
\[\hat{\theta}_{t+1} =  \underset{\theta}{\arg \max} \; Q\pa{\theta,\hat{\theta}_t }\]</div>
<p><em>convergence</em></p>
<p><span class="math notranslate nohighlight">\(t \longleftarrow t + 1\)</span>,
si <span class="math notranslate nohighlight">\(\hat{\theta}_t\)</span> n’a pas convergé vers un maximum local, alors on retourne à
l’étape Expectation.</p>
<p><em>division ou regroupement</em></p>
<p>Dans le cas contraire, on estime les probabilités
<span class="math notranslate nohighlight">\(P_{split}(m, \theta)\)</span> et <span class="math notranslate nohighlight">\(P_{merge}(m,l, \theta)\)</span>
définie par les expressions <a class="reference internal" href="#equation-eq-split-merge">(1)</a>. On choisit aléatoirement
une division ou un regroupement (les choix les plus probables ayant le plus de chance
d’être sélectionnés). Ceci mène au paramètre <span class="math notranslate nohighlight">\(\theta'_t\)</span> dont la partie modifiée par rapport à
<span class="math notranslate nohighlight">\(\hat{\theta}_t\)</span> est déterminée de manière aléatoire. L’algorithme EM est alors appliqué aux
paramètres <span class="math notranslate nohighlight">\(\theta'_t\)</span> jusqu’à convergence aux paramètres <span class="math notranslate nohighlight">\(\theta''_t\)</span>.</p>
<p><em>acceptation</em></p>
<p>On calcule le facteur suivant :</p>
<div class="math notranslate nohighlight">
\[P_a = \min \acc{ \exp\cro{ \frac{ L\pa{ \theta''_t, X} - L\pa{ \theta_t, X} }{\gamma} }, 1}\]</div>
<p>On génére aléatoirement une variable <span class="math notranslate nohighlight">\(u \sim U\cro{0,1}\)</span>,
si <span class="math notranslate nohighlight">\(u \infegal P_a\)</span>, alors les paramètres <span class="math notranslate nohighlight">\(\theta''_t\)</span>
sont validés. <span class="math notranslate nohighlight">\(\hat{\theta}_t \longleftarrow \theta''_t\)</span>
et retour à l’étape d’expectation. Dans le cas contraire, les paramètres
<span class="math notranslate nohighlight">\(\theta''_t\)</span> sont refusés et retour à l’étape précédente.</p>
<p><em>terminaison</em></p>
<p>Si <span class="math notranslate nohighlight">\(t &lt; T\)</span>, on retoure à l’étape d’expectation,
Sinon, on choisit les paramètres <span class="math notranslate nohighlight">\(\theta^*=\hat{\theta}_{t^*}\)</span>
qui maximisent l’expression :</p>
<div class="math notranslate nohighlight" id="equation-classif-cem-cirtere">
\begin{eqnarray}
L\pa{\theta^* \sac X} &amp;=&amp; \log f \pa{X \sac \theta} -
\frac{N^*}{2} \;  \sum_{i=1}^{k^*} \log \frac{n \alpha_i^*}{12} -
\frac{k^*}{2} \log \frac{n}{12} - \frac{k^*(N^*+1)}{2}
\end{eqnarray}</div><p>Avec <span class="math notranslate nohighlight">\(n\)</span> le nombre d’exemples et <span class="math notranslate nohighlight">\(N\)</span>
est le nombre de paramètres spécifiant chaque composant.</p>
</div>
<p>L’article <a class="reference internal" href="#zhangb2004" id="id7"><span>[ZhangB2004]</span></a> prend <span class="math notranslate nohighlight">\(\gamma = 10\)</span> mais ne précise pas de valeur pour
<span class="math notranslate nohighlight">\(\beta\)</span> qui dépend du problème. Toutefois, il existe un cas supplémentaire
où la classe <span class="math notranslate nohighlight">\(m\)</span> doit être supprimée afin d’éviter sa convergence vers
les extrêmes du nuage de points à modéliser. Si <span class="math notranslate nohighlight">\(n \alpha_m &lt; N\)</span>,
le nombre moyen de points inclus dans une classe est inférieur au
nombre de paramètres attribués à cette classe qui est alors supprimée.
Cette condition comme l’ensemble de l’article s’inspire de l’article <a class="reference internal" href="#figueiredo2002" id="id8"><span>[Figueiredo2002]</span></a>
dont est tiré le critère décrit en (ref{classif_cem_cirtere}).</p>
</section>
<section id="bibliographie">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Bibliographie</a><a class="headerlink" href="#bibliographie" title="Lien permanent vers cette rubrique">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="biernacki2001" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Biernacki2001</a><span class="fn-bracket">]</span></span>
<p>{Assessing a Mixture Model for Clustering with the Integrated Completed Likelihood (2001),
C. Biernacki, G. Deleux, G. Govaert,
<em>IEEE Transactions on Image Analysis and Machine Intelligence</em>, volume {22(7), pages 719-725</p>
</div>
<div class="citation" id="celeux1985" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Celeux1985</a><span class="fn-bracket">]</span></span>
<p>The SEM algorithm: a probabilistic teacher algorithm derived from the EM algorithm for the mixture problem (1985),
G. Celeux, J. Diebolt,
<em>Computational Statistics Quarterly</em>, Volume 2(1), pages 73-82</p>
</div>
<div class="citation" id="celeux1985b" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Celeux1985b</a><span class="fn-bracket">]</span></span>
<p>On stochastic version of the EM algorithm (1985),
Gilles Celeux, Didier Chauveau, Jean Diebolt,
Rapport de recherche de l’INRIA*, n 2514</p>
</div>
<div class="citation" id="dempster1977" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Dempster1977</a><span class="fn-bracket">]</span></span>
<p>Maximum-Likelihood from incomplete data via the EM algorithm (1977),
A. P. Dempster, N. M. Laird, D. B. Rubin,
<em>Journal of Royal Statistical Society B</em>, volume 39, pages 1-38</p>
</div>
<div class="citation" id="figueiredo2002" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">Figueiredo2002</a><span class="fn-bracket">]</span></span>
<p>Unsupervised learning of finite mixture models (2002),
M. A. T. Figueiredo, A. K. Jain,
IEEE Transactions on Pattern Analysis and Machine Intelligence, volume 24(3), pages 381-396</p>
</div>
<div class="citation" id="zhangb2004" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>ZhangB2004<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id6">2</a>,<a role="doc-backlink" href="#id7">3</a>)</span>
<p>Competitive EM algorithm for finite mixture models (2004),
Baibo Zhang, Changshui Zhang, Xing Yi,
<em>Pattern Recognition</em>, volume 37, pages 131-144</p>
</div>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="kmeans.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">k-means</p>
      </div>
    </a>
    <a class="right-next"
       href="kohonen.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Carte de Kohonen</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sur cette page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithme-em">Algorithme EM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#competitive-em-algorithm">Competitive EM algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliographie">Bibliographie</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/c_clus/gauss_mixture.rst">
      <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2016-2023, Xavier Dupré.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Construit avec le <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">Thème PyData Sphinx</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>