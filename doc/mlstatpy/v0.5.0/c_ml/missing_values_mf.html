<!doctype html>
<html class="no-js" lang="fr" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Recherche" href="../search.html" /><link rel="next" title="Factorisation et matrice et ACP" href="../notebooks/ml/mf_acp.html" /><link rel="prev" title="Classification à l’aide des plus proches voisins" href="kppv.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Liens entre factorisation de matrices, ACP, k-means - Documentation mlstatpy 0.5.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation mlstatpy 0.5.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation mlstatpy 0.5.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Mathematics</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_clus/index.html">Clustering</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Clustering</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/kmeans.html">k-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/gauss_mixture.html">Mélange de lois normales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/kohonen.html">Carte de Kohonen</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Non linéaire</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Non linéaire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="rn/rn.html">Réseaux de neurones</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Réseaux de neurones</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_1_def.html">Définition des réseaux de neurones multi-couches</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_2_reg.html">La régression</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_3_clas.html">La classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_4_densite.html">Démonstration du théorème de la densité des réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_5_newton.html">Descente de gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_6_apprentissage.html">Apprentissage d’un réseau de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_7_clas2.html">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_8_prol.html">Prolongements</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_9_auto.html">Analyse en composantes principales (ACP) et Auto Encoders</a></li>
<li class="toctree-l3"><a class="reference internal" href="rn/rn_biblio.html">Bibliographie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kppv.html">Classification à l’aide des plus proches voisins</a></li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">Liens entre factorisation de matrices, ACP, k-means</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Liens entre factorisation de matrices, ACP, k-means</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree.html">Un arbre de décision en réseaux de neurones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree_onnx.html">NeuralTreeNet et ONNX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree_cost.html">NeuralTreeNet et coût</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index_reg_lin.html">Régression linéaire</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Régression linéaire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/regression_lineaire.html">Régression linéaire</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="regression_quantile.html">Régression quantile ou régression L1</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Régression quantile ou régression L1</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantile_regression_example.html">Régression quantile illustrée</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="piecewise.html">Régression linéaire par morceaux</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Régression linéaire par morceaux</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/piecewise_linear_regression.html">Régression linéaire par morceaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/regression_no_inversion.html">Régression sans inversion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="l1l2.html">Normalisation des coefficients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index_reg_log.html">Régression logistique</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Régression logistique</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="lr_voronoi.html">Régression logistique, diagramme de Voronoï, k-Means</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Régression logistique, diagramme de Voronoï, k-Means</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/logreg_voronoi.html">Voronoï et régression logistique</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lr_trees.html">Régression logistique par morceaux, arbres de décision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/reseau_neurones.html">Réseaux de neurones</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="survival_analysis.html">Analyse de survie</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Analyse de survie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/survival.html">Analyse de survie en pratique</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_nlp/index.html">NLP</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of NLP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_nlp/completion.html">Complétion</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Complétion</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_formalisation.html">Formalisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_fausse.html">Fausses idées reçues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_metrique.html">Nouvelle métrique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_propriete.html">Propriétés mathématiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_optimisation.html">Problème d’optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_implementation.html">Implémentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_digression.html">Digressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie.html">Complétion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_profiling.html">Completion profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie_long.html">Completion Trie and metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_simple.html">Complétion Simple</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_metric/index.html">Métriques</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Métriques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_metric/roc.html">Courbe ROC</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Courbe ROC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/roc_example.html">ROC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_metric/pvalues.html">Confidence Interval and p-Value</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Confidence Interval and p-Value</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_algo/index.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_algo/edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_algo/graph_distance.html">Distance between two graphs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_algo/gest.html">Détection de segments</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Détection de segments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image/segment_detection.html">Détection de segments dans une image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_garden/index.html">Pérégrinations</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Pérégrinations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/split_train_test.html">Répartir en base d’apprentissage et de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/correlation_non_lineaire.html">Corrélations non linéaires</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_garden/file_dattente.html">File d’attente, un petit exemple</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of File d’attente, un petit exemple</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/file_dattente_ex.html">File d’attente, un exemple simple</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_garden/strategie_avec_alea.html">Optimisation avec données aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/discret_gradient.html">Le gradient et le discret</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_garden/quantization.html">Quantization</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Quantization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantization_f8.html">Quantization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/classification_multiple.html">Classification multiple</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/ml.html">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/optim.html">Optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/text.html">Traitement du langage naturel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">Source de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/graph.html">Graphes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/image.html">Image</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/poulet.html">mlstatpy.garden.poulet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/graph_distance.html">mlstatpy.graph.graph_distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/kppv.html">mlstatpy.ml.kppv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/kppv_laesa.html">mlstatpy.ml.kppv_laesa</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/logreg.html">mlstatpy.ml.logreg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/neural_tree.html">mlstatpy.ml.neural_tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/roc.html">mlstatpy.ml.roc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/completion.html">mlstatpy.nlp.completion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/completion_simple.html">mlstatpy.nlp.completion_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/sgd.html">mlstatpy.optim.sgd</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i_ex.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../defthe_index.html">Listes des définitions et théorèmes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">Gallery of examples</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Gallery of examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_logistic_decision.html">Arbre d’indécision</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Galleries de notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Galleries de notebooks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/dsgarden/index.html">Le petit coin des data scientists</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Le petit coin des data scientists</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/classification_multiple.html">Classification multiple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/correlation_non_lineaire.html">Corrélations non linéaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/discret_gradient.html">Le gradient et le discret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/file_dattente_ex.html">File d’attente, un exemple simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantile_regression_example.html">Régression quantile illustrée</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantization_f8.html">Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/regression_lineaire.html">Régression linéaire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/split_train_test.html">Répartir en base d’apprentissage et de test</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/image/index.html">Images</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Images</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image/segment_detection.html">Détection de segments dans une image</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/metric/index.html">Métriques</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Métriques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/roc_example.html">ROC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/ml/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/logreg_voronoi.html">Voronoï et régression logistique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree.html">Un arbre de décision en réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree_cost.html">NeuralTreeNet et coût</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree_onnx.html">NeuralTreeNet et ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/piecewise_linear_regression.html">Régression linéaire par morceaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/regression_no_inversion.html">Régression sans inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/reseau_neurones.html">Réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/survival.html">Analyse de survie en pratique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/nlp/index.html">NLP - Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of NLP - Natural Language Processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_profiling.html">Completion profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_simple.html">Complétion Simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie.html">Complétion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie_long.html">Completion Trie and metrics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html#id2">0.4.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/c_ml/missing_values_mf.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="liens-entre-factorisation-de-matrices-acp-k-means">
<h1>Liens entre factorisation de matrices, ACP, k-means<a class="headerlink" href="#liens-entre-factorisation-de-matrices-acp-k-means" title="Lien vers cette rubrique">¶</a></h1>
<p id="index-0">La <a class="reference external" href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">factorisation de matrice non négative</a>.
Cette méthode est utilisée dans le cadre de la recommandation de produits
à des utilisateurs.
Lire également <a class="reference internal" href="#acara2011" id="id1"><span>[Acara2011]</span></a>, <a class="reference internal" href="#gupta2010" id="id2"><span>[Gupta2010]</span></a>.</p>
<nav class="contents local" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#factorisation-de-matrices-et-rang" id="id8">Factorisation de matrices et rang</a></p></li>
<li><p><a class="reference internal" href="#quelques-cas-simples" id="id9">Quelques cas simples</a></p></li>
<li><p><a class="reference internal" href="#intuition-geometrique" id="id10">Intuition géométrique</a></p></li>
<li><p><a class="reference internal" href="#k-means" id="id11">k-means</a></p></li>
<li><p><a class="reference internal" href="#quelques-resultats" id="id12">Quelques résultats</a></p></li>
<li><p><a class="reference internal" href="#prolongements" id="id13">Prolongements</a></p>
<ul>
<li><p><a class="reference internal" href="#factorisation-non-negative" id="id14">Factorisation non-négative</a></p></li>
<li><p><a class="reference internal" href="#prediction" id="id15">Prédiction</a></p></li>
<li><p><a class="reference internal" href="#norme" id="id16">Norme</a></p></li>
<li><p><a class="reference internal" href="#sparsite" id="id17">Sparsité</a></p></li>
<li><p><a class="reference internal" href="#valeurs-manquantes" id="id18">Valeurs manquantes</a></p></li>
<li><p><a class="reference internal" href="#interpretation" id="id19">Interprétation</a></p></li>
<li><p><a class="reference internal" href="#ntf" id="id20">NTF</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#bibliographie" id="id21">Bibliographie</a></p></li>
</ul>
</nav>
<section id="factorisation-de-matrices-et-rang">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Factorisation de matrices et rang</a><a class="headerlink" href="#factorisation-de-matrices-et-rang" title="Lien vers cette rubrique">¶</a></h2>
<p>La <a class="reference external" href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">factorisation d’une matrice</a>
est un problème d’optimisation qui consiste à trouver pour une matrice
<img class="math" src="../_images/math/37c41e916e78ff665214e87954500647c5ce8889.svg" alt="M \in \mathcal{M}_{pq}"/> à coefficients positifs ou nuls :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/a4a2b97f013c87ff5f2904a77df8c130dc5dae09.svg" alt="M = WH"/></p>
</div></div>
<p>Où <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/> et <img class="math" src="../_images/math/dd8a8ece0b1684a9537eb7947dc6b8fdc1652abc.svg" alt="H"/> sont de rang <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> et de dimension
<img class="math" src="../_images/math/626cd4298d9ff7ff6262744ac25451f6882f5506.svg" alt="W \in \mathcal{M}_{pk}"/> et <img class="math" src="../_images/math/b1e93b8c32e4e1b85a895cd2872c3720203ad8a5.svg" alt="H \in \mathcal{M}_{kq}"/>.
<em>On s’intéresse ici au cas où les coefficients ne sont pas nécessairement positifs.</em>
Si <img class="math" src="../_images/math/4bc53c52b647e95ff42bdfa33859df2170b1d86f.svg" alt="k &lt; rang(M)"/>, le produit <img class="math" src="../_images/math/b17e4d72fbcc273dfd8b44bd45e91bb37c3920a8.svg" alt="WH"/> ne peut être égal à <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/>.
Dans ce cas, on cherchera les matrices qui minimise :</p>
<div class="admonition-mathdef admonition" id="indexmathe-Problème0">
<p class="admonition-title">Problème P1 : Factorisation de matrices positifs</p>
<p>Soit <img class="math" src="../_images/math/37c41e916e78ff665214e87954500647c5ce8889.svg" alt="M \in \mathcal{M}_{pq}"/>, on cherche les matrices à coefficients positifs
<img class="math" src="../_images/math/626cd4298d9ff7ff6262744ac25451f6882f5506.svg" alt="W \in \mathcal{M}_{pk}"/> et <img class="math" src="../_images/math/b1e93b8c32e4e1b85a895cd2872c3720203ad8a5.svg" alt="H \in \mathcal{M}_{kq}"/> qui sont solution
du problème d’optimisation :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/90e7608cf68377ea855c030aa24dc7cebff52a05.svg" alt="\min_{W,H}\acc{\norme{M-WH}^2} = \min_{W,H} \sum_{ij} (m_{ij} - \sum_k w_{ik} h_{kj})^2"/></p>
</div></div>
</div>
</section>
<section id="quelques-cas-simples">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Quelques cas simples</a><a class="headerlink" href="#quelques-cas-simples" title="Lien vers cette rubrique">¶</a></h2>
<p>Le notebook <a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html"><span class="std std-ref">Valeurs manquantes et factorisation de matrices</span></a> montre la décroissante de l’erreur
en fonction du rang et l’impact de la corrélation sur cette même erreur.
Le dernier paragraphe montre qu’il n’existe pas de solution unique à un problème donné.
L’exemple suivant s’intéresse à une matrice 3x3.
Les trois points forment un triangle dans un plan.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">identity</span><span class="p">,</span> <span class="n">array</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="n">wh</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">H</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">M</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/66261d6b654ae1d96f884a712848c85b/missing_values_mf-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/6792215b573864eb6d67c303fda13cda/missing_values_mf-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/69649febc724c20f9dfd7e349fcb8a4b/missing_values_mf-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/82b6a03568798d0fc8349fa859bb9dc1/missing_values_mf-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/missing_values_mf-1.png" class="plot-directive" src="../_images/missing_values_mf-1.png" />
</figure>
<p>On peut voir la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> comme un ensemble de <img class="math" src="../_images/math/59966a3ae98aee3c5ee17f5d0f476547dfca18af.svg" alt="n=3"/> points dans un espace vectoriel.
La matrice <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/> est un ensemble de <img class="math" src="../_images/math/50dc162459fdef562c50063a7066032446c791e8.svg" alt="k &lt; n"/> points dans le même espace.
La matrice <img class="math" src="../_images/math/b17e4d72fbcc273dfd8b44bd45e91bb37c3920a8.svg" alt="WH"/>, de rang <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> est une approximation de cet ensemble
dans le même espace, c’est aussi <img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> combinaisons linéaires de <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/>
points de façon à former <img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> points les plus proches proches de
<img class="math" src="../_images/math/a5b5dc4891ce586bae4dd632d5cd833fbd1c26cc.svg" alt="n"/> points de la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/>.</p>
</section>
<section id="intuition-geometrique">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Intuition géométrique</a><a class="headerlink" href="#intuition-geometrique" title="Lien vers cette rubrique">¶</a></h2>
<p id="index-1">L’exemple précédente suggère une interprétation géométrique d’une factorisation
de matrice. Sans valeur manquante, ce problème est équivalent à une
<a class="reference external" href="https://fr.wikipedia.org/wiki/Analyse_en_composantes_principales">Analyse en Composantes Principales (ACP)</a>
(voir aussi <a class="reference internal" href="#boutsidis2008" id="id3"><span>[Boutsidis2008]</span></a> (décomposition en valeurs singulières comme algorithme d’initialisation).
Nous allons le montrer grâce à quelques lemmes et théorèmes.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Lemme0">
<div class="docutils container">
</div>
<p class="admonition-title" id="lemme-mf-0">Lemme L1 : Rang k</p>
<p>On note <img class="math" src="../_images/math/8238a702c12f033ac30d4d4d5f17c7aae479fe0f.svg" alt="M=(m_{ij})"/>,
<img class="math" src="../_images/math/4c617a7dca9991a77882a5cbad371f1e95ac8ae6.svg" alt="W^k=(w^k_{il})"/>, <img class="math" src="../_images/math/56f38c2cfa1bdbfda46a9ec81300dd04fa97a73e.svg" alt="H^k=(h^k_{lj})"/> avec
<img class="math" src="../_images/math/6a1a74e3dc2a9f206e1958c549a2c55e67e78da9.svg" alt="1 \leqslant i \leqslant p"/>, <img class="math" src="../_images/math/909cd225a0fb4234c17c930b341b350ec359cc91.svg" alt="1 \leqslant j \leqslant q"/>,
et <img class="math" src="../_images/math/8e082e01de50f95a475c9cd04f19dbee173832c3.svg" alt="1 \leqslant l \leqslant k"/> avec <img class="math" src="../_images/math/bcfaefa268474c5f871fb357ea7466c718b12d5d.svg" alt="k &lt; \min(p,q)"/>.
On suppose que les matrices
sont solution du problème d’optimisation
<img class="math" src="../_images/math/6050136482b81262e78d932b12f3d4206f932799.svg" alt="\min_{W,H} \norm{ M - WH }^2"/>.
On suppose que <img class="math" src="../_images/math/6cc0a501c984ae0a4ca0bd94513c39318ce0be5d.svg" alt="rang(M) \supegal k"/>.
Alors les les matrices <img class="math" src="../_images/math/68455bc6e7d697a95a84b4db49e97d6f22d97ac1.svg" alt="W^k"/> et <img class="math" src="../_images/math/03ef7c41d1afe22800dc5a10d54c10cfd1a1e7a0.svg" alt="H^k"/>
sont de rang <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/>.</p>
</div>
<p>On procède par récurrence. Ce lemme est nécessairement vrai pour
<img class="math" src="../_images/math/a93fc678804463d20118c9d381587ffe845be391.svg" alt="k=1"/> car la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> n’est pas nulle.
De manière évidente,
<img class="math" src="../_images/math/93c55d0f8d669beb33768e0790f703d117479fc6.svg" alt="\norm{ M - W^{k-1}H^{k-1} }^2 \supegal \norm{ M - W^kH^k }^2"/>.
Comme <img class="math" src="../_images/math/6cc0a501c984ae0a4ca0bd94513c39318ce0be5d.svg" alt="rang(M) \supegal k"/>, il existe un vecteur colonne <img class="math" src="../_images/math/3f07e082745e744a189091767318aa64a01add9c.svg" alt="V"/> de la matrice
<img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> qui ne fait pas partie de l’espace vectoriel engendré par les
<img class="math" src="../_images/math/0c4dd8d0be506d0d237b24221334da3307eb3d78.svg" alt="k-1"/> vecteurs de la matrice <img class="math" src="../_images/math/84c77ac8908fea06dc104f7b299a7637e9169c7a.svg" alt="W^{k-1}"/>. On construit la matrice
<img class="math" src="../_images/math/0980e342fb3a8ff9b13bcb435ba77248e8ee32d1.svg" alt="Y^k= [W^{k-1}, V]"/>. Par construction, <img class="math" src="../_images/math/e9bc2aff8231a98ce6321847b2d5a97e92970016.svg" alt="rang(Y) = k"/>. De même,
on construit <img class="math" src="../_images/math/a187ea727afc1268182cdc1b033e9e8e82365d36.svg" alt="G^k"/> à partir de <img class="math" src="../_images/math/4e3efc17635be30dd8f4f988bab90d67e01aa39d.svg" alt="H^{k-1}"/> en remplaçant la dernière colonne et
en ajoutant une ligne :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/dffeb25674d4677655104896dc01c1d0982716dc.svg" alt="G^k=\cro{\begin{array}{cc} H^{k-1}[1..p-1] &amp; 0 \\ 0 &amp; 1 \end{array}}"/></p>
</div></div>
<p>Par construction, le dernier vecteur est de la matrice produit est identique
à celui de la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/>.</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/8c74a1482df22020618699a26518f7d0adf587a9.svg" alt="\norme{M - Y^{k-1}G^{k-1}}^2 = \norme{M - W^{k-1}H^{k-1}}^2 - \sum_i (m_{iq} - w^{k-1}_{ik} h^{k-1}_{kq})^2"/></p>
</div></div>
<p>Nous avons fabriqué une matrice de rang <em>k</em> qui fait décroître l’erreur
du problème d’optimisation.
On procède par l’absurde pour dire que si
<img class="math" src="../_images/math/b66fc654d79f0894a63461dc2d32aa11a07cc4f9.svg" alt="rang(W) = k-1"/>, on peut construire une matrice de rang <em>k</em>
qui fait décroître l’erreur ce qui est impossible. Le lemme est donc vrai.</p>
<p>Ce lemme fait également apparaître la construction de <em>q</em> points
dans un espace vectoriel engendré par les <em>k</em> vecteurs colonnes
de la matrice <img class="math" src="../_images/math/a3987d12830f259e455cc788b6e7dcdbf68d25d4.svg" alt="W_k"/>. Il est donc possible de choisir
n’importe quel base <img class="math" src="../_images/math/d415cc4aa35b7097b7251a80986ca13eb28581fe.svg" alt="W'_{k}"/> de cet espace et d’exprimer
les <em>q</em> points de <img class="math" src="../_images/math/1a03b0483414ab03e90a11bdcb088d94d97e201b.svg" alt="W_kH_k"/> avec cette nouvelle base.
Cela signifie qu’on peut écrire la matrice <img class="math" src="../_images/math/a3987d12830f259e455cc788b6e7dcdbf68d25d4.svg" alt="W_k"/> dans une base
<img class="math" src="../_images/math/0e2f9507d1dde2041630f02ed78d9e2d7fca2b3e.svg" alt="B_k"/> comme <img class="math" src="../_images/math/cfb5b457f734429e30722a02ebaa46a4994d8b80.svg" alt="W_k = B_k C_k"/> et <img class="math" src="../_images/math/92b8ac473cd62f54d9dea56e4a1c0c9958e7f94e.svg" alt="W_k H_k = B_k C_k C_k^{-1} G_k"/>.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Lemme1">
<div class="docutils container">
</div>
<p class="admonition-title" id="lemme-mf-1">Lemme L2 : Projection</p>
<p>On note <img class="math" src="../_images/math/8238a702c12f033ac30d4d4d5f17c7aae479fe0f.svg" alt="M=(m_{ij})"/>,
<img class="math" src="../_images/math/4c617a7dca9991a77882a5cbad371f1e95ac8ae6.svg" alt="W^k=(w^k_{il})"/>, <img class="math" src="../_images/math/56f38c2cfa1bdbfda46a9ec81300dd04fa97a73e.svg" alt="H^k=(h^k_{lj})"/> avec
<img class="math" src="../_images/math/6a1a74e3dc2a9f206e1958c549a2c55e67e78da9.svg" alt="1 \leqslant i \leqslant p"/>, <img class="math" src="../_images/math/909cd225a0fb4234c17c930b341b350ec359cc91.svg" alt="1 \leqslant j \leqslant q"/>,
et <img class="math" src="../_images/math/8e082e01de50f95a475c9cd04f19dbee173832c3.svg" alt="1 \leqslant l \leqslant k"/> avec <img class="math" src="../_images/math/bcfaefa268474c5f871fb357ea7466c718b12d5d.svg" alt="k &lt; \min(p,q)"/>.
On suppose que les matrices
sont solution du problème d’optimisation
<img class="math" src="../_images/math/6050136482b81262e78d932b12f3d4206f932799.svg" alt="\min_{W,H} \norm{ M - WH }^2"/>.
On considère que la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> est un ensemble de <img class="math" src="../_images/math/53e75bcd7eafea2c0896729a913b09b70e220d12.svg" alt="q"/>
points dans dans un espace vectoriel de dimension <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>.
La matrice <img class="math" src="../_images/math/b17e4d72fbcc273dfd8b44bd45e91bb37c3920a8.svg" alt="WH"/> représente des projections de ces points
dans l’espace vectoriel engendré par les <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> vecteurs colonnes
de la matrice <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/>.</p>
</div>
<p>La figure suivante illustre ce lemme.
<img class="math" src="../_images/math/babfe967ef6a4c2fb4e6775eea33157c27e97e53.svg" alt="\norm{ M - WH }^2"/> s’écrit comme la somme des distances entre
<em>q</em> points :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/57d0ccecc393ab6b40fed122dbe268e48b566833.svg" alt="\norm{ M - WH }^2 = \sum_{j=1}^q \norme{M[j] - W_kH_k[j]}^2"/></p>
</div></div>
<a class="reference internal image-reference" href="../_images/plan.jpg"><img alt="../_images/plan.jpg" src="../_images/plan.jpg" style="width: 400px;" />
</a>
<p>Or on sait que si <img class="math" src="../_images/math/a3987d12830f259e455cc788b6e7dcdbf68d25d4.svg" alt="W_k"/> est fixé, les <em>q</em> points de la matrice
<img class="math" src="../_images/math/1a03b0483414ab03e90a11bdcb088d94d97e201b.svg" alt="W_kH_k"/> évolue sur un hyperplan de dimension <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/>.
Le point de ce plan le plus du vecteur <img class="math" src="../_images/math/f87c6da6694698ed1e64ed901149a07b07797052.svg" alt="M[j]"/> est sa projection
sur ce plan.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Théorème0">
<div class="docutils container">
</div>
<p class="admonition-title" id="th-mf-1">Théorème T1 : La factorisation de matrice est équivalente à une analyse en composantes principales</p>
<p>On note <img class="math" src="../_images/math/8238a702c12f033ac30d4d4d5f17c7aae479fe0f.svg" alt="M=(m_{ij})"/>,
<img class="math" src="../_images/math/4c617a7dca9991a77882a5cbad371f1e95ac8ae6.svg" alt="W^k=(w^k_{il})"/>, <img class="math" src="../_images/math/56f38c2cfa1bdbfda46a9ec81300dd04fa97a73e.svg" alt="H^k=(h^k_{lj})"/> avec
<img class="math" src="../_images/math/6a1a74e3dc2a9f206e1958c549a2c55e67e78da9.svg" alt="1 \leqslant i \leqslant p"/>, <img class="math" src="../_images/math/909cd225a0fb4234c17c930b341b350ec359cc91.svg" alt="1 \leqslant j \leqslant q"/>,
et <img class="math" src="../_images/math/8e082e01de50f95a475c9cd04f19dbee173832c3.svg" alt="1 \leqslant l \leqslant k"/> avec <img class="math" src="../_images/math/bcfaefa268474c5f871fb357ea7466c718b12d5d.svg" alt="k &lt; \min(p,q)"/>.
On suppose que les matrices
sont solution du problème d’optimisation
<img class="math" src="../_images/math/6050136482b81262e78d932b12f3d4206f932799.svg" alt="\min_{W,H} \norm{ M - WH }^2"/>.
On considère que la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> est un ensemble de <img class="math" src="../_images/math/53e75bcd7eafea2c0896729a913b09b70e220d12.svg" alt="q"/>
points dans dans un espace vectoriel de dimension <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>.
On suppose <img class="math" src="../_images/math/3eb85d561484bde4d2ebc095a9188d915cac7264.svg" alt="p &lt; q"/>.
La matrice <img class="math" src="../_images/math/a3987d12830f259e455cc788b6e7dcdbf68d25d4.svg" alt="W_k"/> définit un hyperplan identique à celui défini
par les <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> vecteurs propres associés aux <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/>
plus grande valeurs propres de la matrice
<img class="math" src="../_images/math/aa64ac2d27336d78ca51b4ff594fdc65d64fb7a8.svg" alt="MM'"/> où <img class="math" src="../_images/math/fe4fe50f0877cd412ed6cd7f1a87e2ae67deca8e.svg" alt="M'"/> est la transposée de <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/>.</p>
</div>
<p>Une analyse en composante principale consiste à trouver
l’hyperplan qui maximise l’inertie de la projection d’un nuage
sur ce plan.
Le théorème <a class="reference internal" href="rn/rn_9_auto.html#theorem-acp-resolution"><span class="std std-ref">résolution de l’ACP</span></a>
a montré que :</p>
<div class="math-wrapper docutils container" id="equation-rn-acp-contrainte-rep">
<div class="math" id="equation-rn-acp-contrainte-rep">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-rn-acp-contrainte-rep" title="Lien vers cette équation">¶</a></span><img src="../_images/math/2d4828f17ee24a47e42d41cde915733e62f6c8c0.svg" alt="\begin{eqnarray*}
S =
\underset{ \begin{subarray}{c} W \in M_{p,d}\pa{\mathbb{R}} \\ W'W = I_d \end{subarray} } { \arg \max } \;
                    \cro { \sum_{i=1}^{N} \norm{W'X_i}^2 } &amp;=&amp;
\underset{ W \in M_{p,d}\pa{\mathbb{R}} } { \arg \min } \;  \cro { \sum_{i=1}^{N} \norm{WW'X_i - X_i}^2 }
\end{eqnarray*}"/></p>
</div></div>
<p>Dans notre cas, chaque ligne de la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> est un vecteur <img class="math" src="../_images/math/c15b262677ad7177c2e37298a2eb382d712b3a52.svg" alt="X_i"/>.
La matrice <img class="math" src="../_images/math/a3987d12830f259e455cc788b6e7dcdbf68d25d4.svg" alt="W_k"/> est identique à celle cherchée lors du problème de factorisation
de matrices. Les colonnes de la matrice <img class="math" src="../_images/math/b9ef0c6cb32b01d873d98765aa13747981d3afc2.svg" alt="H_k"/> sont égales à <img class="math" src="../_images/math/06e1f57f94f06669420bef14f900c49aea4af9e8.svg" alt="W'X_i"/>.
Il reste à montrer que le minimum trouvé dans les deux problèmes est le même.
La démonstration du théorème montre également que <img class="math" src="../_images/math/53ee03fba0a5ac8c290fff60225b93e2c56ffa62.svg" alt="W'W = I_d"/>
et dans ce cas précis, <img class="math" src="../_images/math/125247a0f788db0f0edf0cb774701e0e63885577.svg" alt="WW'X_i"/> représente les coordonnées de la projection
du point <img class="math" src="../_images/math/c15b262677ad7177c2e37298a2eb382d712b3a52.svg" alt="X_i"/> sur le plan défini par les vecteurs <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/>.
C’est aussi ce que montre <a class="reference internal" href="#lemme-mf-1"><span class="std std-ref">second lemmme</span></a>.
S’il s’agit du même plan, cela signifie que les deux formulations, ACP et factorisation
de matrices, aboutissent au même minimum. Comme l’algorithme de l’ACP détermine le meilleur
plan projecteur, nécessairement, il correspond à celui trouvé par la factorisation de matrice.</p>
</section>
<section id="k-means">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">k-means</a><a class="headerlink" href="#k-means" title="Lien vers cette rubrique">¶</a></h2>
<p>On peut construire deux matrices <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/> et <img class="math" src="../_images/math/dd8a8ece0b1684a9537eb7947dc6b8fdc1652abc.svg" alt="H"/> à partir des résultats d’un
<a class="reference internal" href="../c_clus/kmeans.html#l-k-means"><span class="std std-ref">k-means</span></a>. Celui-ci détermine <img class="math" src="../_images/math/312028c07e271534bd0dbde5434e49e76880744f.svg" alt="k"/> centres auxquels on effecte les points
du nuage de départ. Dans ce cas-ci, la matrice <img class="math" src="../_images/math/6ed861ef9c1c0829f1587232c699cfac35dacce7.svg" alt="W"/> est constituée des coordonnées
de ces centres. On note <img class="math" src="../_images/math/ef00b3853db500e11bb0e3304f9a95bc3ffb1471.svg" alt="C_l"/> le cluster <img class="math" src="../_images/math/b40d7de3530507b378090edb54198bdc06e33be9.svg" alt="l"/>,
la matrice <img class="math" src="../_images/math/56f38c2cfa1bdbfda46a9ec81300dd04fa97a73e.svg" alt="H^k=(h^k_{lj})"/> est définie comme suit :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/30ded5b45662c03db5177e2df3b0351231c01f4b.svg" alt="h^k_{lj} = \indicatrice{X_j \in C_l}"/></p>
</div></div>
<p>Les coefficients sont soit 0 ou 1.
On peut alors essayer de forcer la factorisation de matrice vers une matrice
<img class="math" src="../_images/math/dd8a8ece0b1684a9537eb7947dc6b8fdc1652abc.svg" alt="H"/> avec pas de un 1 sur chaque colonne et des zéros partout ailleurs.
Le résultat sera assez proche d’un clustering.</p>
</section>
<section id="quelques-resultats">
<span id="l-mf-acp-notebook"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">Quelques résultats</a><a class="headerlink" href="#quelques-resultats" title="Lien vers cette rubrique">¶</a></h2>
<p>Le notebook suivant illustre le lien entre ACP et
factorisation de matrices en deux dimensions.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/mf_acp.html#Factorisation-de-matrices">Factorisation de matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/mf_acp.html#ACP-:-analyse-en-composantes-principales">ACP : analyse en composantes principales</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html#Matrice-à-coefficients-aléatoires">Matrice à coefficients aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html#Matrice-avec-des-vecteurs-colonnes-corrélés">Matrice avec des vecteurs colonnes corrélés</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html#Matrice-identité">Matrice identité</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html#Matrice-identité-et-représentation-spatiale">Matrice identité et représentation spatiale</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="prolongements">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Prolongements</a><a class="headerlink" href="#prolongements" title="Lien vers cette rubrique">¶</a></h2>
<p>Tous les résultats montrés ici ne sont valables que si la norme <img class="math" src="../_images/math/e8db2cfafd3b476938645cbf31d05c45bb5a9796.svg" alt="L_2"/>
est utilisée. Cela permet de mieux comprendre
les références proposées dans la documentation de
<a class="reference external" href="http://scikit-learn.org/stable/modules/decomposition.html#nmf">Non-negative matrix factorization (NMF or NNMF)</a>.
Si l’ACP et la factorisation de matrices sont équivalentes, les algorithmes pour
trouver le minimum diffèrent et sont plus ou moins appropriés dans
certaines configurations.
Lire <a class="reference internal" href="#gilles2014" id="id4"><span>[Gilles2014]</span></a>.</p>
<section id="factorisation-non-negative">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Factorisation non-négative</a><a class="headerlink" href="#factorisation-non-negative" title="Lien vers cette rubrique">¶</a></h3>
<p>Le problème le plus souvent évoqué est celui de la factorisation
non-négative : <a class="reference external" href="https://www.math.univ-toulouse.fr/~besse/Wikistat/pdf/st-m-explo-nmf.pdf">NMF</a>.
Ce problème est une optimisation avec contrainte : les coefficients doivent
tous être positifs ou nuls. Il n’est bien sûr plus équivalent
à une ACP. En revanche, la factorisation de matrice est un problème
équivalent à celui résolu par la
<a class="reference external" href="https://fr.wikipedia.org/wiki/D%C3%A9composition_en_valeurs_singuli%C3%A8res">Décomposition en Valeur Singulière (SVD)</a>
qui cherche à décomposer une matrice <img class="math" src="../_images/math/654ded547f61cb27eb4abc9e12b3871a0ad973ee.svg" alt="M=U\Sigma V^*"/>. La matrice <img class="math" src="../_images/math/c2c1631ee66d456484eaf1742ce908c0d4cb206d.svg" alt="\Sigma"/>
est une matrice diagonale et la matrice initiale <em>M</em>
n’est pas nécessairement carrée contrairement au cas d’une ACP
mais SVD et ACP sont très similaires.</p>
</section>
<section id="prediction">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Prédiction</a><a class="headerlink" href="#prediction" title="Lien vers cette rubrique">¶</a></h3>
<p>Prédire revient à supposer que la matrice <img class="math" src="../_images/math/e5c619f0600e251cabb3318b03870bc6f2c4870f.svg" alt="M"/> est composée de vecteurs
lignes <img class="math" src="../_images/math/c2c17c26588a557c3e5a5c09a15c6a9fd83d0201.svg" alt="X_1, ..., X_q"/>. La matrice <img class="math" src="../_images/math/dd8a8ece0b1684a9537eb7947dc6b8fdc1652abc.svg" alt="H"/> reste inchangée et la prédiction
revient à déterminer les coordonnées de la projection d’un nouveau point <img class="math" src="../_images/math/8399617dd56edad930099c90e02b77cd09a8ecd0.svg" alt="X_{q+1}"/>
dans le plan défini par les vecteurs de la matrice <img class="math" src="../_images/math/dd8a8ece0b1684a9537eb7947dc6b8fdc1652abc.svg" alt="H"/>.
Pour de nouvelles observations <img class="math" src="../_images/math/100b83286521b8b15121ea7b71c614b1dd5bfc90.svg" alt="M_2=X_{q+1}"/>,
la fonction <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html#sklearn.decomposition.NMF.transform">transform</a>
de la classe <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html#sklearn.decomposition.NMF" title="(disponible dans scikit-learn v1.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.NMF</span></code></a> réestime une matrice
<img class="math" src="../_images/math/ea56299ac24b89737f6ad22910ce4115fc028ab3.svg" alt="W_2"/> qui projette les vecteurs lignes de <img class="math" src="../_images/math/e48f98cc1aae5697620af23b319e2e6611bdb867.svg" alt="M_2"/> sur
les vecteurs de <em>H</em> en conservant des coefficients de projection positifs.</p>
<div class="admonition-mathdef admonition" id="indexmathe-Problème1">
<p class="admonition-title">Problème P2 : Prédiction</p>
<p>Soit <img class="math" src="../_images/math/37c41e916e78ff665214e87954500647c5ce8889.svg" alt="M \in \mathcal{M}_{pq}"/> et <img class="math" src="../_images/math/b1e93b8c32e4e1b85a895cd2872c3720203ad8a5.svg" alt="H \in \mathcal{M}_{kq}"/>,
on cherche les matrices à coefficients positifs
<img class="math" src="../_images/math/626cd4298d9ff7ff6262744ac25451f6882f5506.svg" alt="W \in \mathcal{M}_{pk}"/> qui sont solution
du problème d’optimisation :</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/f8c9fc1b2c5db72b658d588e5c960a27c4ad473d.svg" alt="\min_{W}\acc{\norme{M-WH}^2} = \min_{W,H} \sum_{ij} (m_{ij} - \sum_k w_{ik} h_{kj})^2"/></p>
</div></div>
</div>
<p>Les recommandations s’obtiennent en multipliant <img class="math" src="../_images/math/ea56299ac24b89737f6ad22910ce4115fc028ab3.svg" alt="W_2"/> par <img class="math" src="../_images/math/8399617dd56edad930099c90e02b77cd09a8ecd0.svg" alt="X_{q+1}"/>.
Ce produit peut être approchée en relâchant la contrainte des poids
positifs pour la matrice <em>W</em>. C’est la piste proposée par le
modèle <a class="reference external" href="https://sdpython.github.io/doc/mlinsights/dev/api/mlmodel.html">ApproximateNMFPredictor</a> qui utilise une transformation
<em>SVD</em> pour projeter sur l’espace vectoriel formé par les vecteurs
de <em>H</em>.</p>
</section>
<section id="norme">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Norme</a><a class="headerlink" href="#norme" title="Lien vers cette rubrique">¶</a></h3>
<p>L’ACP avec une norme <img class="math" src="../_images/math/1a5b3c907a4bcdbe74db6675750947320ee0c514.svg" alt="L_1"/> revient à trouver le plan qui minimise la somme
des distances à la projection et non la somme des distances au carrés. Cela réduit
l’impact des points aberrants mais le problème n’est plus équivalent à la factorisation
de matrices avec une norme <img class="math" src="../_images/math/1a5b3c907a4bcdbe74db6675750947320ee0c514.svg" alt="L_1"/>.</p>
</section>
<section id="sparsite">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Sparsité</a><a class="headerlink" href="#sparsite" title="Lien vers cette rubrique">¶</a></h3>
<p>Une ACP suppose que le calcul de valeurs propres d’une matrice
et c’est fastidieux lorsque la dimension du problème est très grande.
On lui préfère alors un algorithme tel que
<a class="reference external" href="http://scikit-learn.org/stable/modules/decomposition.html#sparsepca">Sparse PCA</a>.
La factorisation de matrice est plus efficace qu’une ACP sur les problèmes
sparses et de grande dimension. Lire
<a class="reference external" href="http://www.jmlr.org/papers/volume5/hoyer04a/hoyer04a.pdf">Non-negative Matrix Factorization with Sparseness Constraints</a>.</p>
</section>
<section id="valeurs-manquantes">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Valeurs manquantes</a><a class="headerlink" href="#valeurs-manquantes" title="Lien vers cette rubrique">¶</a></h3>
<p id="index-2">Contourner le problème des valeurs manquantes veut souvent dire,
soit supprimer les enregistrements contenant des valeurs manquantes,
soit choisir un modèle capable de faire avec ou soit trouver un moyen de les
remplacer. On peut gérer plus facilement le problème des valeurs manquantes
avec une factorisation de matrices. On peut également se server de la méthode
pour calculer une ACP avec des valeurs manquantes.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.math.univ-toulouse.fr/~besse/Wikistat/pdf/st-m-app-idm.pdf">Imputation de données manquantes</a></p></li>
<li><p><a class="reference external" href="https://www.researchgate.net/publication/273901434_Principal_component_analysis_with_missing_values_a_comparative_survey_of_methods">Principal component analysis with missing values: a comparative survey of methods</a></p></li>
</ul>
</section>
<section id="interpretation">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Interprétation</a><a class="headerlink" href="#interpretation" title="Lien vers cette rubrique">¶</a></h3>
<p>La factorisation de matrice peut être utilisée comme outil
de segmentation et d’interprétation pour des images, des vidéos.
Lire <a class="reference external" href="http://perso.telecom-paristech.fr/~essid/teach/NMF_tutorial_ICME-2014.pdf">A tutorial on Non-Negative Matrix Factorisation with Applications to Audiovisual Content Analysis</a>.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://hal.archives-ouvertes.fr/hal-00990252/document">Gesture recognition using a NMF-based representation of motion-traces extracted from depth silhouettes</a></p></li>
</ul>
</section>
<section id="ntf">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">NTF</a><a class="headerlink" href="#ntf" title="Lien vers cette rubrique">¶</a></h3>
<p>Le problème de <a class="reference external" href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">Non-Negative Matrix Factorisation (NMF)</a>
est un cas particulier de
<a class="reference external" href="http://www.cs.huji.ac.il/~shashua/papers/NTF-icml.pdf">Non-Negative Tensor Factorisation (NTF)</a>.
Lire aussi
<a class="reference external" href="https://www.cs.cmu.edu/~pmuthuku/mlsp_page/lectures/Parafac.pdf">PARAFAC. Tutorial and applications</a>.</p>
</section>
</section>
<section id="bibliographie">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Bibliographie</a><a class="headerlink" href="#bibliographie" title="Lien vers cette rubrique">¶</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="acara2011" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Acara2011</a><span class="fn-bracket">]</span></span>
<p>Scalable tensorfactorizations for incomplete data,
<em>Evrim Acara Daniel, M.Dunlavyc, Tamara G.Koldab. Morten Mørupd</em>,
Chemometrics and Intelligent Laboratory Systems,
Volume 106, Issue 1, 15 March 2011, Pages 41-56,
or ArXiv <a class="reference external" href="https://arxiv.org/pdf/1005.2197.pdf">1005.2197</a></p>
</div>
<div class="citation" id="boutsidis2008" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Boutsidis2008</a><span class="fn-bracket">]</span></span>
<p>SVD-based initialization: A head start for nonnegative matrix factorization.
<em>Christos Boutsidis and Efstratios Gallopoulos</em>
Pattern Recognition, 41(4): 1350-1362, 2008.</p>
</div>
<div class="citation" id="gilles2014" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Gilles2014</a><span class="fn-bracket">]</span></span>
<p>The Why and How of Nonnegative Matrix Factorization,
<em>Nicolas Gillis</em>,
ArXiv <a class="reference external" href="https://arxiv.org/abs/1401.5226">1401.5226</a></p>
</div>
<div class="citation" id="gupta2010" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Gupta2010</a><span class="fn-bracket">]</span></span>
<p>Additive Non-negative Matrix Factorization for Missing Data,
<em>Mithun Das Gupta</em>,
ArXiv <a class="reference external" href="https://arxiv.org/abs/1007.0380">1007.0380</a></p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../notebooks/ml/mf_acp.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Factorisation et matrice et ACP</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="kppv.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Classification à l’aide des plus proches voisins</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2025, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Liens entre factorisation de matrices, ACP, k-means</a><ul>
<li><a class="reference internal" href="#factorisation-de-matrices-et-rang">Factorisation de matrices et rang</a></li>
<li><a class="reference internal" href="#quelques-cas-simples">Quelques cas simples</a></li>
<li><a class="reference internal" href="#intuition-geometrique">Intuition géométrique</a></li>
<li><a class="reference internal" href="#k-means">k-means</a></li>
<li><a class="reference internal" href="#quelques-resultats">Quelques résultats</a></li>
<li><a class="reference internal" href="#prolongements">Prolongements</a><ul>
<li><a class="reference internal" href="#factorisation-non-negative">Factorisation non-négative</a></li>
<li><a class="reference internal" href="#prediction">Prédiction</a></li>
<li><a class="reference internal" href="#norme">Norme</a></li>
<li><a class="reference internal" href="#sparsite">Sparsité</a></li>
<li><a class="reference internal" href="#valeurs-manquantes">Valeurs manquantes</a></li>
<li><a class="reference internal" href="#interpretation">Interprétation</a></li>
<li><a class="reference internal" href="#ntf">NTF</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bibliographie">Bibliographie</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=0886690b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/translations.js?v=e6b791cb"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>