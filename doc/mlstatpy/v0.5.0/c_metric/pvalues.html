<!doctype html>
<html class="no-js" lang="fr" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Recherche" href="../search.html" /><link rel="next" title="p-values" href="../notebooks/metric/pvalues_examples.html" /><link rel="prev" title="ROC" href="../notebooks/metric/roc_example.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Confidence Interval and p-Value - Documentation mlstatpy 0.5.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation mlstatpy 0.5.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/project_ico.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation mlstatpy 0.5.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Mathematics</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_clus/index.html">Clustering</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Clustering</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/kmeans.html">k-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/gauss_mixture.html">Mélange de lois normales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_clus/kohonen.html">Carte de Kohonen</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_ml/index.html">Non linéaire</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Non linéaire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/rn/rn.html">Réseaux de neurones</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Réseaux de neurones</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_1_def.html">Définition des réseaux de neurones multi-couches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_2_reg.html">La régression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_3_clas.html">La classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_4_densite.html">Démonstration du théorème de la densité des réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_5_newton.html">Descente de gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_6_apprentissage.html">Apprentissage d’un réseau de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_7_clas2.html">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_8_prol.html">Prolongements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_9_auto.html">Analyse en composantes principales (ACP) et Auto Encoders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_ml/rn/rn_biblio.html">Bibliographie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_ml/kppv.html">Classification à l’aide des plus proches voisins</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/missing_values_mf.html">Liens entre factorisation de matrices, ACP, k-means</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Liens entre factorisation de matrices, ACP, k-means</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree.html">Un arbre de décision en réseaux de neurones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree_onnx.html">NeuralTreeNet et ONNX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/neural_tree_cost.html">NeuralTreeNet et coût</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_ml/index_reg_lin.html">Régression linéaire</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Régression linéaire</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/regression_lineaire.html">Régression linéaire</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/regression_quantile.html">Régression quantile ou régression L1</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Régression quantile ou régression L1</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantile_regression_example.html">Régression quantile illustrée</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/piecewise.html">Régression linéaire par morceaux</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Régression linéaire par morceaux</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/piecewise_linear_regression.html">Régression linéaire par morceaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/regression_no_inversion.html">Régression sans inversion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_ml/l1l2.html">Normalisation des coefficients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_ml/index_reg_log.html">Régression logistique</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Régression logistique</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/lr_voronoi.html">Régression logistique, diagramme de Voronoï, k-Means</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Régression logistique, diagramme de Voronoï, k-Means</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/logreg_voronoi.html">Voronoï et régression logistique</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_ml/lr_trees.html">Régression logistique par morceaux, arbres de décision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/ml/reseau_neurones.html">Réseaux de neurones</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_ml/survival_analysis.html">Analyse de survie</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Analyse de survie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/survival.html">Analyse de survie en pratique</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_nlp/index.html">NLP</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of NLP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_nlp/completion.html">Complétion</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Complétion</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_formalisation.html">Formalisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_fausse.html">Fausses idées reçues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_metrique.html">Nouvelle métrique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_propriete.html">Propriétés mathématiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_optimisation.html">Problème d’optimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_implementation.html">Implémentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c_nlp/completion_digression.html">Digressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie.html">Complétion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_profiling.html">Completion profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie_long.html">Completion Trie and metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_simple.html">Complétion Simple</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Métriques</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Métriques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="roc.html">Courbe ROC</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Courbe ROC</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/roc_example.html">ROC</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">Confidence Interval and p-Value</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Confidence Interval and p-Value</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_algo/index.html">Algorithmes</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Algorithmes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c_algo/edit_distance.html">Distance d’édition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_algo/graph_distance.html">Distance between two graphs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_algo/gest.html">Détection de segments</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Détection de segments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image/segment_detection.html">Détection de segments dans une image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c_garden/index.html">Pérégrinations</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Pérégrinations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/split_train_test.html">Répartir en base d’apprentissage et de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/correlation_non_lineaire.html">Corrélations non linéaires</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_garden/file_dattente.html">File d’attente, un petit exemple</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of File d’attente, un petit exemple</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/file_dattente_ex.html">File d’attente, un exemple simple</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_garden/strategie_avec_alea.html">Optimisation avec données aléatoires</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/discret_gradient.html">Le gradient et le discret</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c_garden/quantization.html">Quantization</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Quantization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantization_f8.html">Quantization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/dsgarden/classification_multiple.html">Classification multiple</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/ml.html">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/optim.html">Optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/text.html">Traitement du langage naturel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">Source de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/graph.html">Graphes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/image.html">Image</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/poulet.html">mlstatpy.garden.poulet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/graph_distance.html">mlstatpy.graph.graph_distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/kppv.html">mlstatpy.ml.kppv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/kppv_laesa.html">mlstatpy.ml.kppv_laesa</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/logreg.html">mlstatpy.ml.logreg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/neural_tree.html">mlstatpy.ml.neural_tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/roc.html">mlstatpy.ml.roc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/completion.html">mlstatpy.nlp.completion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/completion_simple.html">mlstatpy.nlp.completion_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/modules/sgd.html">mlstatpy.optim.sgd</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i_ex.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../defthe_index.html">Listes des définitions et théorèmes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">Gallery of examples</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Gallery of examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/plot_logistic_decision.html">Arbre d’indécision</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Galleries de notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Galleries de notebooks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/dsgarden/index.html">Le petit coin des data scientists</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Le petit coin des data scientists</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/classification_multiple.html">Classification multiple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/correlation_non_lineaire.html">Corrélations non linéaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/discret_gradient.html">Le gradient et le discret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/file_dattente_ex.html">File d’attente, un exemple simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantile_regression_example.html">Régression quantile illustrée</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/quantization_f8.html">Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/regression_lineaire.html">Régression linéaire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/dsgarden/split_train_test.html">Répartir en base d’apprentissage et de test</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/image/index.html">Images</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Images</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/image/segment_detection.html">Détection de segments dans une image</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/metric/index.html">Métriques</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Métriques</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/metric/roc_example.html">ROC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/ml/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/logreg_voronoi.html">Voronoï et régression logistique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/mf_acp.html">Factorisation et matrice et ACP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree.html">Un arbre de décision en réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree_cost.html">NeuralTreeNet et coût</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/neural_tree_onnx.html">NeuralTreeNet et ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/piecewise_linear_regression.html">Régression linéaire par morceaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/regression_no_inversion.html">Régression sans inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/reseau_neurones.html">Réseaux de neurones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/survival.html">Analyse de survie en pratique</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/ml/valeurs_manquantes_mf.html">Valeurs manquantes et factorisation de matrices</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../notebooks/nlp/index.html">NLP - Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of NLP - Natural Language Processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_profiling.html">Completion profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_simple.html">Complétion Simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie.html">Complétion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/nlp/completion_trie_long.html">Completion Trie and metrics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOGS.html#id2">0.4.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/c_metric/pvalues.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="confidence-interval-and-p-value">
<span id="index-0"></span><h1>Confidence Interval and p-Value<a class="headerlink" href="#confidence-interval-and-p-value" title="Lien vers cette rubrique">¶</a></h1>
<nav class="contents local" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#why-p-value" id="id2">Why p-value?</a></p></li>
<li><p><a class="reference internal" href="#significant-difference-between-samples-mean" id="id3">Significant difference between samples mean</a></p></li>
<li><p><a class="reference internal" href="#application-on-binomial-variables" id="id4">Application on binomial variables</a></p></li>
<li><p><a class="reference internal" href="#estimate-a-p-value-by-using-the-distribution-function" id="id5">Estimate a p-value by using the distribution function</a></p></li>
<li><p><a class="reference internal" href="#correlated-variables" id="id6">Correlated variables</a></p></li>
<li><p><a class="reference internal" href="#multiple-comparisons-problem" id="id7">Multiple comparisons problem</a></p></li>
<li><p><a class="reference internal" href="#algorithm-expectation-maximization" id="id8">Algorithm Expectation-Maximization</a></p></li>
<li><p><a class="reference internal" href="#notebooks" id="id9">Notebooks</a></p></li>
<li><p><a class="reference internal" href="#bibliographie" id="id10">Bibliographie</a></p></li>
</ul>
</nav>
<p>This document explains the relationship between p-value and confidence intervals.
It goes on with the specific case of a binamial law. Assuming we want to determine
whether or not two binomial laws are significantly different, how many observations
we need to get the p-value under a given threshold.</p>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Lien vers cette rubrique">¶</a></h2>
<p>The term <a class="reference external" href="https://fr.wikipedia.org/wiki/Valeur_p">p-value</a> is very popular
in the world of search engines. I usually prefer confidence interval 95%,
I think it is easier to understand. Plus, because p-Value are real values,
we could be tempted to compare them and it is usually wrong. On the other hand,
it is more difficult to compare confidence intervals, especially if they are
related to complete different variables. Their nature prevents you from doing that.
Howerver p-Values and confidence interval are similar: they tell you whether
or not a metric difference is significant.</p>
<p>Usually, it starts from a set of identically distributed random variables
<img class="math" src="../_images/math/dafbf3fd504f174242ac1db44a55c327abb6de1b.svg" alt="(X_i)_{1 \leqslant i \leqslant N}"/>. We then estimate the average
<img class="math" src="../_images/math/bc06c4176017f1c68ce9d08358ea2dc6258e8273.svg" alt="\widehat{\theta}_N = \frac{1}{N} \sum_{i=1}^{N} X_i"/> and we ask
the question is <img class="math" src="../_images/math/b491ae30ba617c96145c0ca6f5f3fbedc0a7b120.svg" alt="\widehat{\theta}_N"/> null? In others terms, we
want to know if the average is significantly different from zero. If
the random variable <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> follows a random law which has a standard
deviation, we can use the <a class="reference external" href="https://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a>
which tells us:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/b42503a2fc0d7284d6868b018fead4b8e7e3f41f.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{0}{\sigma}
\end{eqnarray*}"/></p>
</div></div>
<p>Not all of them have a standard deviation. For example, if <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> follows a
<a class="reference external" href="https://en.wikipedia.org/wiki/Cauchy_distribution">Cauchy law</a>,
<img class="math" src="../_images/math/60532d12dc1f68fd1dcd0d2ada5e297ef1130805.svg" alt="\esp{X^2} \sim \int \frac{x^2}{1+x^2}dx"/> which does not exist.
This remark also concerns every distribution known as heavy tail distribution.</p>
<p>If <img class="math" src="../_images/math/541210c426adf291f270ab865df44acdc6e2a83c.svg" alt="Y \sim \loinormale{0}{\sigma}"/>, then we have
<img class="math" src="../_images/math/8c5df97019fea763cecfd9c541214647543e48ca.svg" alt="\pr{\abs{Y} \leqslant 1.96} = 0.95"/>. That is why we can say:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/9aab13bbbf084f4287e96ddd783b560500ea99b5.svg" alt="\begin{eqnarray*}
\widehat{\theta}_N \text{ is not null with 95\% confidence if }
\sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} &gt; 1.96
\end{eqnarray*}"/></p>
</div></div>
<p>And the confidence intervalle at 95% would be:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/1e1f16f9d3390ebff82a9da685e0ee9425830768.svg" alt="\begin{eqnarray*}
\cro{ %\widehat{\theta}_N
            - \frac{1.96 \sigma}{\sqrt{N}},
            %\widehat{\theta}_N +
            \frac{1.96 \sigma}{\sqrt{N}}}
\end{eqnarray*}"/></p>
</div></div>
<p>When <img class="math" src="../_images/math/848399a44872dfb5fa3806b0ce3a945626893a7d.svg" alt="\esp{ \widehat{\theta}_N } = \theta_0 \neq 0"/>, it becomes:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/9fe30695557fd519350520d14e731b2930e1116b.svg" alt="\begin{eqnarray*}
\sqrt{N} \cro{ \widehat{\theta}_N - \theta_0}
\underset{N \rightarrow \infty}{\longrightarrow}
\loinormale{0}{\sigma}
\end{eqnarray*}"/></p>
</div></div>
<p>We usually want to check if the mean is equal to a specific value
using a statistical test:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/d0d91a5c526412fea23f1d81a3d4483f283a5589.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; \widehat{\theta}_N = \theta_0 \\
H1: &amp;&amp; \widehat{\theta}_N \neq  \theta_0
\end{eqnarray*}"/></p>
</div></div>
<p>We validate <img class="math" src="../_images/math/bea31eb8d4d9fd1d5bbfaa8bf5c926533877893f.svg" alt="H0"/> if:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/86c213281cad6baf0033401bb5e1cc7df690ff83.svg" alt="\begin{eqnarray*}
\widehat{\theta}_N \in \cro{ \theta_0 - \frac{1.96 \sigma}{\sqrt{N}},
\theta_0 + \frac{1.96 \sigma}{\sqrt{N}}}
\end{eqnarray*}"/></p>
</div></div>
</section>
<section id="why-p-value">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Why p-value?</a><a class="headerlink" href="#why-p-value" title="Lien vers cette rubrique">¶</a></h2>
<p>With confidence intervals, you first choose a confidence level and then you
get an interval. You then check if your value is inside or outside your interval.
Inside, the gain is not significant, outside, it is.</p>
<p>With a p-value, we consider the problem the other way, given
<img class="math" src="../_images/math/b491ae30ba617c96145c0ca6f5f3fbedc0a7b120.svg" alt="\widehat{\theta}_N"/>, what is the probability that the
difference <img class="math" src="../_images/math/75fece4ea7279e6423cf68b48ff29d406286cded.svg" alt="\abs{\widehat{\theta}_N - \theta_0}"/> is significant?
Let’s consider <img class="math" src="../_images/math/b59453388a752e340d555df9064bfb27e7112e68.svg" alt="Y"/> following a normal law <img class="math" src="../_images/math/405981d3eea95ba3c42d0ac77b78e4837072ba51.svg" alt="\loinormale{0}{1}"/>.
We are looking for:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/d79662b154b80e520522ae4985ea0a5b01f7bd67.svg" alt="\begin{eqnarray*}
\pr{ \abs{Y} &gt; \sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} } = \alpha
\end{eqnarray*}"/></p>
</div></div>
<p><img class="math" src="../_images/math/a1e7b66a55fc77cebd91d9a1ebfa93a29c1736fb.svg" alt="\alpha"/> is the p-value.</p>
<div class="math-wrapper docutils container" id="equation-p-value-expression">
<div class="math" id="equation-p-value-expression">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-p-value-expression" title="Lien vers cette équation">¶</a></span><img src="../_images/math/19451b23319914915e2c4ec460a7870498a67412.svg" alt="\begin{eqnarray*}
\alpha &amp;=&amp; 1-\int_{-\beta_N}^{\beta_N} \frac{1}{\sqrt{2\pi}}
e^{\frac{-x^2}{2}} dx =
2 \int_{\beta_N}^{\infty} \frac{1}{\sqrt{2\pi}} e^{\frac{-x^2}{2}} dx \\
\text{where } \beta_N &amp;=&amp; \sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma}
\end{eqnarray*}"/></p>
</div></div>
<p>At this point, we should not forget that we use a theorem which tells us that
<img class="math" src="../_images/math/8254c5168b12b2590c77880767e464cf41b81fc6.svg" alt="\sqrt{N} \frac{|\widehat{\theta}_N|}{\sigma} \sim \loinormale{0}{1}"/>
when <img class="math" src="../_images/math/fc50bcc40e676b6a5241a7a5430022975a6907dd.svg" alt="N \rightarrow \infty"/>, which means everything we said is true
when <img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/> is great enough.</p>
</section>
<section id="significant-difference-between-samples-mean">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Significant difference between samples mean</a><a class="headerlink" href="#significant-difference-between-samples-mean" title="Lien vers cette rubrique">¶</a></h2>
<p>Usually, we do not want to test if an average is null but if the difference
between two averages is null. We consider two random samples having the same
size, each of them described by <img class="math" src="../_images/math/27472567e50161aef46885272e223c61b9956296.svg" alt="(X_i)"/> and <img class="math" src="../_images/math/9f52d5eea733fc02cbe44bafa7f8f7015452f524.svg" alt="(Y_i)"/>.
All variables are independant. <img class="math" src="../_images/math/27472567e50161aef46885272e223c61b9956296.svg" alt="(X_i)"/> are distributed according the
same law, we assume the same for <img class="math" src="../_images/math/9f52d5eea733fc02cbe44bafa7f8f7015452f524.svg" alt="(Y_i)"/>. We expect the following
difference to be null.</p>
<div class="math-wrapper docutils container" id="equation-pvalues-exp2">
<div class="math" id="equation-pvalues-exp2">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-pvalues-exp2" title="Lien vers cette équation">¶</a></span><img src="../_images/math/c44065ea6997c10bc5f4aa3c6ed51f92e9f5c9b5.svg" alt="\begin{eqnarray*}
\widehat{\eta}_N &amp;=&amp; \frac{1}{N} \sum_{i=1}^{N} X_i -
\frac{1}{N} \sum_{i=1}^{N} Y_i
= \frac{1}{N} \cro{ \sum_{i=1}^{N} X_i -  Y_i }
\end{eqnarray*}"/></p>
</div></div>
<p>Considering expression <a class="reference internal" href="#equation-pvalues-exp2">(2)</a>, we can applying the central
limit theorem on variable <img class="math" src="../_images/math/be8050fa58a1a8ab98cde57f6a4abf3676591902.svg" alt="Z=X-Y"/>, we get (<img class="math" src="../_images/math/221ce895d74b074c67da1955c0e77a8b1f1d4375.svg" alt="\eta_0=0"/>):</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/b04604070cc97c8923ecc2324211a829162100c3.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\eta}_N \underset{N \rightarrow \infty}{\longrightarrow}
\loinormale{\eta_0}{\sqrt{ \frac{\var{Z} }{N  } }}
\end{eqnarray*}"/></p>
</div></div>
<p>If both samples do not have the same number of observations,
this expression becomes:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/fb04bb1b5d9490ed952ce9eb8541f2511bb6b988.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\eta}_N \underset{ \begin{subarray}{c} N_1
\rightarrow \infty \\
N_2 \rightarrow \infty \\
\frac{N_1}{N_2} \rightarrow x \end{subarray}}{\longrightarrow}
\loinormale{\eta_0}{\sqrt{ \frac{\var{X}}{N_1}+\frac{\var{Y}}{N_2} }}
\end{eqnarray*}"/></p>
</div></div>
</section>
<section id="application-on-binomial-variables">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Application on binomial variables</a><a class="headerlink" href="#application-on-binomial-variables" title="Lien vers cette rubrique">¶</a></h2>
<p>A binomial variable <img class="math" src="../_images/math/419c9ea59701ce43e7d043b5339d4cb8bbedf418.svg" alt="X \sim \loibinomialea{p}"/> is defined by:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/b19e4a335a93d46078f6805f1fff43311ea9b543.svg" alt="\begin{eqnarray*}
\pr{X=0} &amp;=&amp; 1-p \\
\pr{X=1} &amp;=&amp; p
\end{eqnarray*}"/></p>
</div></div>
<p>Let’s consider two series of observations <img class="math" src="../_images/math/50273ccc4f548d27428eb0ae63079f3860a4c771.svg" alt="(X_i) \sim \loibinomialea{p}"/>
and <img class="math" src="../_images/math/e6fc42ef171c75c0fe8b955b11343a6193238cb8.svg" alt="(Y_i) \sim \loibinomialea{q}"/>. We assume <img class="math" src="../_images/math/7fa794a6094d9642edb31ae441a01db5591f6b59.svg" alt="p \neq q"/> and we want
to determine how many observations we need to get a p-value below 5%.
We know that <img class="math" src="../_images/math/e27040185eafb682896fb8b37b61a870f6f5aac8.svg" alt="\variance{X_i}=p(1-p)"/> and <img class="math" src="../_images/math/a5c29f149d8b8da904a19b675eb718629aff7274.svg" alt="\variance{Y_i}=q(1-q)"/>.
Next table shows the values. First column contains values for <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>,
first row contains values for <img class="math" src="../_images/math/41e218c0609dcc02c1e03f12f065fe6b70d3b300.svg" alt="q-p"/>. We also assume we have the same number
<img class="math" src="../_images/math/bceb9186b5004313ecccd0d22d07ea9617b62f98.svg" alt="N"/> of random observations for each variable. The statistical
test cen be defined like following:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/f94938a28b8f753cca44aa1bd9e25fb2a5ecf26d.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; p = q = p_0 \\
H1: &amp;&amp; p \neq q
\end{eqnarray*}"/></p>
</div></div>
<p>If H0 is true, then:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/d9784e255b591e4d5f254812b20ef83740a77b3c.svg" alt="\begin{eqnarray}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{0}{\sqrt{p_0(1-p_0)}
\sqrt{ \frac{1}{N_1}+\frac{1}{N_2} }}
\end{eqnarray}"/></p>
</div></div>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/aafe5b2f9755060eab2b9404e743302332342205.svg" alt="\begin{tabular}{r|r|r|r|r|r|r|r|r|r|r|r|r}
$p/d$&amp;\textbf{-0.200}&amp;\textbf{-0.100}&amp;\textbf{-0.020}&amp;\textbf{-0.010}&amp;\textbf{-0.002}&amp;\textbf{-0.001}&amp;\textbf{0.001}&amp;\textbf{0.002}&amp;\textbf{0.010}&amp;\textbf{0.020}&amp;\textbf{0.100}&amp;\textbf{0.200}\\\hline
\textbf{0.05}&amp;&amp;&amp;913&amp;3650&amp;91235&amp;364939&amp;364939&amp;91235&amp;3650&amp;913&amp;37&amp;10\\\hline
\textbf{0.10}&amp;&amp;70&amp;1729&amp;6915&amp;172866&amp;691463&amp;691463&amp;172866&amp;6915&amp;1729&amp;70&amp;18\\\hline
\textbf{0.15}&amp;&amp;98&amp;2449&amp;9796&amp;244893&amp;979572&amp;979572&amp;244893&amp;9796&amp;2449&amp;98&amp;25\\\hline
\textbf{0.20}&amp;31&amp;123&amp;3074&amp;12293&amp;307317&amp;1229267&amp;1229267&amp;307317&amp;12293&amp;3074&amp;123&amp;31\\\hline
\textbf{0.25}&amp;37&amp;145&amp;3602&amp;14406&amp;360137&amp;1440548&amp;1440548&amp;360137&amp;14406&amp;3602&amp;145&amp;37\\\hline
\textbf{0.30}&amp;41&amp;162&amp;4034&amp;16135&amp;403354&amp;1613413&amp;1613413&amp;403354&amp;16135&amp;4034&amp;162&amp;41\\\hline
\textbf{0.35}&amp;44&amp;175&amp;4370&amp;17479&amp;436966&amp;1747864&amp;1747864&amp;436966&amp;17479&amp;4370&amp;175&amp;44\\\hline
\textbf{0.40}&amp;47&amp;185&amp;4610&amp;18440&amp;460976&amp;1843901&amp;1843901&amp;460976&amp;18440&amp;4610&amp;185&amp;47\\\hline
\textbf{0.45}&amp;48&amp;191&amp;4754&amp;19016&amp;475381&amp;1901523&amp;1901523&amp;475381&amp;19016&amp;4754&amp;191&amp;48\\\hline
\textbf{0.50}&amp;49&amp;193&amp;4802&amp;19208&amp;480183&amp;1920730&amp;1920730&amp;480183&amp;19208&amp;4802&amp;193&amp;49\\\hline
\textbf{0.55}&amp;48&amp;191&amp;4754&amp;19016&amp;475381&amp;1901523&amp;1901523&amp;475381&amp;19016&amp;4754&amp;191&amp;48\\\hline
\textbf{0.60}&amp;47&amp;185&amp;4610&amp;18440&amp;460976&amp;1843901&amp;1843901&amp;460976&amp;18440&amp;4610&amp;185&amp;47\\\hline
\textbf{0.65}&amp;44&amp;175&amp;4370&amp;17479&amp;436966&amp;1747864&amp;1747864&amp;436966&amp;17479&amp;4370&amp;175&amp;44\\\hline
\textbf{0.70}&amp;41&amp;162&amp;4034&amp;16135&amp;403354&amp;1613413&amp;1613413&amp;403354&amp;16135&amp;4034&amp;162&amp;41\\\hline
\textbf{0.75}&amp;37&amp;145&amp;3602&amp;14406&amp;360137&amp;1440548&amp;1440548&amp;360137&amp;14406&amp;3602&amp;145&amp;37\\\hline
\textbf{0.80}&amp;31&amp;123&amp;3074&amp;12293&amp;307317&amp;1229267&amp;1229267&amp;307317&amp;12293&amp;3074&amp;123&amp;31\\\hline
\textbf{0.85}&amp;25&amp;98&amp;2449&amp;9796&amp;244893&amp;979572&amp;979572&amp;244893&amp;9796&amp;2449&amp;98&amp;\\\hline
\textbf{0.90}&amp;18&amp;70&amp;1729&amp;6915&amp;172866&amp;691463&amp;691463&amp;172866&amp;6915&amp;1729&amp;70&amp;\\\hline
\textbf{0.95}&amp;10&amp;37&amp;913&amp;3650&amp;91235&amp;364939&amp;364939&amp;91235&amp;3650&amp;913&amp;&amp;\\\hline
\end{tabular}"/></p>
</div></div>
<p>Given a binomial law with parameter <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/> and a difference
<img class="math" src="../_images/math/2160a217243173398700954f681412f83f781a6e.svg" alt="d"/>, this table gives the number of
observations needed on both sides to get a significant difference
assuming <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/> is the expected pourcentage</p>
</section>
<section id="estimate-a-p-value-by-using-the-distribution-function">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Estimate a p-value by using the distribution function</a><a class="headerlink" href="#estimate-a-p-value-by-using-the-distribution-function" title="Lien vers cette rubrique">¶</a></h2>
<p>Expression <a class="reference internal" href="#equation-p-value-expression">(1)</a> gives a way to estimate the p-value.
Computing the integral is not always possible but there is a way to do it
using <a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_method">Monte Carlo method</a>.
Let’s assume <img class="math" src="../_images/math/08a962419337b7d494a46c6544e753ae8c53cd2b.svg" alt="X \sim \loinormale{0}{1}"/>. We denote <img class="math" src="../_images/math/f696aa8b745774e3457cdc878aa064c1d85322d6.svg" alt="f_X"/> as the
density function of <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/>. We also consider an interval
<img class="math" src="../_images/math/90ba82909f2c062b4b51b9831b6b7ca09d310ff9.svg" alt="I=\cro{-a,a}"/>. Then we have <img class="math" src="../_images/math/8ce271565a3261585547c880e152dc060c1db25a.svg" alt="f(a)=f(-a)"/> and:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/7fb97587651a9f461dff15520c3f31c280516776.svg" alt="\begin{eqnarray*}
\pr{X \in I} = \pr{ \abs{X} \leqslant a } = \pr{ f(X) \supegal f(a)}
\end{eqnarray*}"/></p>
</div></div>
<p>This is true because <img class="math" src="../_images/math/bd1e0600a66dbe0f8deddbd57953774419ba4e4f.svg" alt="f"/> is decreasing for <img class="math" src="../_images/math/7554ee702596b4b557e263f5883c5a4f1e1d1119.svg" alt="x&gt;0"/>.
The p-value <img class="math" src="../_images/math/a1e7b66a55fc77cebd91d9a1ebfa93a29c1736fb.svg" alt="\alpha"/> for a estimator <img class="math" src="../_images/math/bd898b02c226d1ce791865c51d30012165adf53d.svg" alt="\beta"/> using Monte Carlo method is:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/1f2a8750a2b7d7a775ff1c64aaf9bd586000cf51.svg" alt="\begin{eqnarray}
\frac{1}{N}\sum_{i=1}^{N} \indicatrice{ f(X_i) &lt; f(\beta)} \longrightarrow \alpha
\end{eqnarray}"/></p>
</div></div>
<p>Assuming every <img class="math" src="../_images/math/6cba74bdce3a6f91d99d7701293b0aa6c9400f0c.svg" alt="(X_i)_i"/> follows a normal law <img class="math" src="../_images/math/405981d3eea95ba3c42d0ac77b78e4837072ba51.svg" alt="\loinormale{0}{1}"/>.</p>
</section>
<section id="correlated-variables">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Correlated variables</a><a class="headerlink" href="#correlated-variables" title="Lien vers cette rubrique">¶</a></h2>
<p>Let’s assume we now have a vector a correlated variables <img class="math" src="../_images/math/392324266f555f73d7737e04d1f08f2cea45e072.svg" alt="X=(X_1,...X_d)"/>
drawn following a law <img class="math" src="../_images/math/4b107155196156aa398a182ed7db419570d0b6ac.svg" alt="\loinormale{\theta_0}{\Sigma}"/>.</p>
<p>The central limit theorem is still valid:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/5958bc7b5676ecff6b3f449e189277f136d5804c.svg" alt="\begin{eqnarray*}
\sqrt{N} \widehat{\theta}_N \underset{N \rightarrow \infty}{\longrightarrow}   \loinormale{\theta_0}{\Sigma}
\end{eqnarray*}"/></p>
</div></div>
<p>We know estimators for the average and the covariance matrix defined as follows:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/7f1e82cdbbab4f1f2193b93e94859707bfb83ed6.svg" alt="\begin{eqnarray*}
\widehat{\theta_N} &amp;=&amp; \frac{1}{n} \sum_{i=1}^{N} X_i \\
\widehat{\Sigma_N} &amp;=&amp; \frac{1}{n} \sum_{i=1}^{N} (X_i - \widehat{\theta_N})(X_i - \widehat{\theta_N})'
\end{eqnarray*}"/></p>
</div></div>
<p>We usually want to check if:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/d0d91a5c526412fea23f1d81a3d4483f283a5589.svg" alt="\begin{eqnarray*}
H0: &amp;&amp; \widehat{\theta}_N = \theta_0 \\
H1: &amp;&amp; \widehat{\theta}_N \neq  \theta_0
\end{eqnarray*}"/></p>
</div></div>
<p>If <img class="math" src="../_images/math/b1af3dc07c90134c73c60fe7f1e002ccaced8485.svg" alt="\Lambda"/> is diagonal matrix of <img class="math" src="../_images/math/c2c1631ee66d456484eaf1742ce908c0d4cb206d.svg" alt="\Sigma"/> (diagonal matrix with eigen values).
All eigen values are real and positive, we then define:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/f3741f2aaa767a622ddcfee080bf0a5910b9abc3.svg" alt="\begin{eqnarray*}
\Sigma &amp;=&amp; P \Lambda P' \text { and } \Sigma^{\frac{1}{2}} =  P \Lambda^{\frac{1}{2}} P'
\end{eqnarray*}"/></p>
</div></div>
<p>We consider <img class="math" src="../_images/math/61519b9598ce428b68128dfb857fc943caf5367c.svg" alt="Z_i = (X_i - \widehat{\theta_N}) \Sigma^{-\frac{1}{2}}"/>.
We then have <img class="math" src="../_images/math/edc642f548f0a6d9e8a4e6f7def44014633a89f5.svg" alt="\esp{Z_i} = 0"/> and <img class="math" src="../_images/math/52b0ad86cf93c0110e2a0852132f0e2264f288c1.svg" alt="\var{Z_i} = I_2"/> where
<img class="math" src="../_images/math/4cd6dce13bc9092f588909348a55b2e40c471447.svg" alt="I_2"/> is the identity matrix. We could now consider each
dimension of <img class="math" src="../_images/math/f17e8c265d7e0200ae83cb0ab155527cc9338d22.svg" alt="Z_i"/> independently as illustrated in next figure:
it shows the difference on an example if we consider the correlation of
two variables correlated such as
<img class="math" src="../_images/math/27523a2a20d4880c138ab37666995651bd740259.svg" alt="\Sigma=\pa{\begin{array}{cc} 0.1 &amp; 0.05 \\ 0.05 &amp;  0.2 \end{array}}"/>.</p>
<img alt="../_images/pvaluescor.png" src="../_images/pvaluescor.png" />
<p>We assume we observe two <a class="reference external" href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernouilli</a>
variables correlated. Red points represents the area
for which we would accept hypothesis <em>H0</em> in case both variables are independant.
Blue area represents the same but with the correlation.
But that would not be the best way to do it. The confidence interval for a couple
of indenpendant gaussian <img class="math" src="../_images/math/1b90718368ea70eb40f4e2a46974acb8f9c8288c.svg" alt="(N_1,N_2)"/> variables is an ellipse.
Two independent normal variables <img class="math" src="../_images/math/6022d1125f29d9d904368f44f010eb49cfa258d5.svg" alt="N_1^2+N_2^2"/> with a null mean
and standard deviation equal to one follows a <img class="math" src="../_images/math/88916934485ceae0b8c64aa3009ae62950c7fbee.svg" alt="\chi_2"/> law. Based on that,
we can deduce a boundary for the confidence zone at 95%.
Next figure shows this zone for a non-correlated couple and a correlated couple
(<img class="math" src="../_images/math/27523a2a20d4880c138ab37666995651bd740259.svg" alt="\Sigma=\pa{\begin{array}{cc} 0.1 &amp; 0.05 \\ 0.05 &amp;  0.2 \end{array}}"/>).</p>
<img alt="../_images/pvaluescor2.png" src="../_images/pvaluescor2.png" />
<p>We assume we observe two Bernouilli variables correlated. Red points represents the area
for which we would accept hypothesis <em>H0</em> in case both variables are independant.
Blue area represents the same but with the correlation.</p>
</section>
<section id="multiple-comparisons-problem">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Multiple comparisons problem</a><a class="headerlink" href="#multiple-comparisons-problem" title="Lien vers cette rubrique">¶</a></h2>
<p>The problem of <a class="reference external" href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Multiple comparisons</a>
happens when dealing with many metrics measyring a change.
That’s allways the case when two version of the sam websire are compared
in a test <a class="reference external" href="https://fr.wikipedia.org/wiki/Test_A/B">A/B</a>.
The metrics are correlated but it is unlikely that all metrics
differences will be significant or not.
The <a class="reference external" href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-Bonferroni method</a>
proposes a way to define an hypthesis on the top of the existing ones.</p>
</section>
<section id="algorithm-expectation-maximization">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Algorithm Expectation-Maximization</a><a class="headerlink" href="#algorithm-expectation-maximization" title="Lien vers cette rubrique">¶</a></h2>
<p>We here assume there are two populations mixed defined by random variable <img class="math" src="../_images/math/2c0e77bc741b692ecdf6e85966263a89422af4c8.svg" alt="C"/>.
Let’s <img class="math" src="../_images/math/b66c7d6c52c7b12bee7fb24d76c38fc70cfc0a2f.svg" alt="X"/> be a mixture of two binomial laws of parameters <img class="math" src="../_images/math/6fe7973e241cac84eec5598231dc7f6e68e88282.svg" alt="p"/>
and <img class="math" src="../_images/math/53e75bcd7eafea2c0896729a913b09b70e220d12.svg" alt="q"/>. It is for example the case for a series draws coming from two different coins.</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/cde0736f6e2d3df2522076c63ee287fcd114f3f4.svg" alt="\begin{eqnarray*}
\pr{X} &amp;=&amp;  \pr{ X | C = a} \pr{C=a} + \pr{X | X =b} \pr{C = b}
\end{eqnarray*}"/></p>
</div></div>
<p>The likelihood of a random sample <img class="math" src="../_images/math/e5d39b159c64d098f66e9caf3790115f11566ab6.svg" alt="(X_1,...X_n)"/>,
the class we do not observe are <img class="math" src="../_images/math/dcd14ebe388510cd4ee4756d2caffb156e23edd3.svg" alt="(C_1,...C_n)"/>:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/ec0bfc9e3dd631cc15c782c2ad4c44871d335c8d.svg" alt="\begin{eqnarray*}
L(\theta) = \prod_i \cro{ p^{X_i}(1-p)^{(1-X_i)} \pi }^{1-C_i} \cro{q^{X_i}(1-q)^{(1-X_i)}  (1-\pi)  }^{C_i}
\end{eqnarray*}"/></p>
</div></div>
<p>The parameters are <img class="math" src="../_images/math/4505c21b0ccb09d4810afceb347cedf8f447500b.svg" alt="\theta=(\pi,p,q)"/>. We use an algorithm
<a class="reference external" href="https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm">Expectation-Maximization (EM)</a>
to determine the parameters.
We define at iteration <img class="math" src="../_images/math/09c7628f51842c683db31bd6826cff8cc447ece3.svg" alt="t"/>:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/e0fc687d6d4b1ee8bdf4a5ffbb359d65bd05f965.svg" alt="\begin{eqnarray*}
w_i &amp;=&amp; \espf{C_i | X_i, \theta_t }{X_i}  \\
    &amp;=&amp; \frac{ p_t^{X_i} (1-p_t)^{1-X_i} \pi_t }
               { p_t^{X_i}(1-p_t)^{1-X_i} \pi_t + q_t^{X_i} (1-q_t)^{1-X_i} (1-\pi_t) }
\end{eqnarray*}"/></p>
</div></div>
<p>We then update the parameters:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="../_images/math/abddf7e650dc4e58e71f8d7912f778f6331fc119.svg" alt="\begin{eqnarray*}
\widehat{\pi}   &amp;=&amp;  \frac{1}{n} \sum_{i = 1}^n w_i \\
\widehat{p}     &amp;=&amp;  \frac{  \sum_{i = 1}^n w_i X_i }{  \sum_{i = 1}^n w_i} \\
\widehat{q}     &amp;=&amp;  \frac{  \sum_{i = 1}^n (1-w_i) X_i }{  \sum_{i = 1}^n (1-w_i)}
\end{eqnarray*}"/></p>
</div></div>
<p>See also <a class="reference external" href="https://statisticalrecipes.blogspot.fr/2012/04/applying-em-algorithm-binomial-mixtures.html">Applying the EM Algorithm: Binomial Mixtures</a>.</p>
</section>
<section id="notebooks">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Notebooks</a><a class="headerlink" href="#notebooks" title="Lien vers cette rubrique">¶</a></h2>
<p>The following notebook produces the figures displayed in this document.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html">p-values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-table">p-value table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-values-in-2D">p-values in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-ratio">p-value ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-values-and-EM">p-values and EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/metric/pvalues_examples.html#p-value-and-heavy-tail">p-value and heavy tail</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="bibliographie">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Bibliographie</a><a class="headerlink" href="#bibliographie" title="Lien vers cette rubrique">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/pvalues3.pdf">p-Value and Statistical Practice</a></p></li>
<li><p><a class="reference external" href="https://rsos.royalsocietypublishing.org/content/royopensci/1/3/140216.full.pdf">An investigation of the false discovery rate and the misinterpretation of p-values</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-Bonferroni method</a></p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../notebooks/metric/pvalues_examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">p-values</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../notebooks/metric/roc_example.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">ROC</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2025, Xavier Dupré
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Confidence Interval and p-Value</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#why-p-value">Why p-value?</a></li>
<li><a class="reference internal" href="#significant-difference-between-samples-mean">Significant difference between samples mean</a></li>
<li><a class="reference internal" href="#application-on-binomial-variables">Application on binomial variables</a></li>
<li><a class="reference internal" href="#estimate-a-p-value-by-using-the-distribution-function">Estimate a p-value by using the distribution function</a></li>
<li><a class="reference internal" href="#correlated-variables">Correlated variables</a></li>
<li><a class="reference internal" href="#multiple-comparisons-problem">Multiple comparisons problem</a></li>
<li><a class="reference internal" href="#algorithm-expectation-maximization">Algorithm Expectation-Maximization</a></li>
<li><a class="reference internal" href="#notebooks">Notebooks</a></li>
<li><a class="reference internal" href="#bibliographie">Bibliographie</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=0886690b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/translations.js?v=e6b791cb"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>